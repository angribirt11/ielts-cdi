<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Full Reading Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            line-height: 1.4;
            font-size: 16px;
        }



        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
        }

        .ielts-logo {
            display: none;
        }

        .test-info {
            display: flex;
            align-items: center;
            gap: 30px;
            font-size: 14px;
            color: #333;
        }

        .audio-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .audio-icon {
            width: 16px;
            height: 16px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>') no-repeat center;
        }

        .header-icons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .telegram-link {
            color: #0088cc;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .telegram-link:hover {
            text-decoration: underline;
        }

        .telegram-link::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: currentColor;
            -webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }

        #volume-slider {
            -webkit-appearance: none;
            width: 80px;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
        }

        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
        }

        #volume-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            border: none;
        }

        .icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0.7;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .icon:hover {
            opacity: 1;
        }
        
        #play-pause-btn {
            background: none;
            border: none;
            padding: 0;
        }

        .main-container {
            margin-top: 60px;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            height: calc(100vh - 60px); /* Full height minus header */
        }

        .panels-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .passage-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px; /* Minimum width */
        }

        /* Passage Content */
        .text-center {
            text-align: center;
        }
        .reading-passage h4 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
       
        .reading-passage p {
            margin-bottom: 1.2em;
        }

        .question ul li label {
            display: block;
            margin-top: 8px;
            cursor: pointer;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px; /* Minimum width */
            border-left: 1px solid #e0e0e0;
        }

        .resizer {
            width: 10px;
            cursor: col-resize;
            background-color: #f0f0f0;
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="30" viewBox="0 0 10 30"><path d="M4 11h2v2H4zM4 15h2v2H4zM4 19h2v2H4z" fill="%23888"/></svg>');
            background-repeat: no-repeat;
            background-position: center;
            flex-shrink: 0;
            flex-grow: 0;
        }

        /* Left Panel */
        .left-panel {
            width: 100%;
            padding: 20px;
        }

        /* Right Panel */
        .right-panel {
            display: none;
            width: 50%;
            padding: 20px;
            position: relative;
        }

        .help-button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        .help-button:hover {
            background: #357abd;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .people-section {
            margin-bottom: 30px;
        }

        .people-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
        }

        .people-table th {
            text-align: left;
            padding: 10px;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .people-table td {
            padding: 8px 10px;
            border: 1px solid #ddd;
        }

        .person-name {
            font-size: 16px;
        }

        .question-number {
            background: white;
            border: 1px solid #4a90e2;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 14px;
            color: #4a90e2;
            min-width: 30px;
            text-align: center;
        }

        .assigned-responsibility {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 14px;
            border: 1px solid #ddd;
        }

        .responsibilities-section {
            margin-bottom: 30px;
        }

        .responsibility-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .responsibility-item {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .responsibility-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .responsibility-item.dragging {
            opacity: 0.5;
        }

        .questions-section {
            margin-bottom: 20px;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .instruction {
            margin-bottom: 20px;
            font-size: 16px;
            color: #666;
        }

        /* Map Styles */
        .map-container {
            position: relative;
            margin: 20px 0;
            display: flex;
            justify-content: center;
        }

        .map-svg {
            border: 2px solid #333;
            background: white;
        }

        .map-room {
            fill: #f9f9f9;
            stroke: #333;
            stroke-width: 1;
        }

        .map-text {
            font-family: Arial, sans-serif;
            font-size: 13px;
            text-anchor: middle;
            fill: #333;
        }

        .map-number {
            font-family: Arial, sans-serif;
            font-size: 16px;
            font-weight: bold;
            text-anchor: middle;
            fill: #333;
        }

        .room-labels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .room-label {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .room-label:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .room-label.dragging {
            opacity: 0.5;
        }

        /* Navigation Arrows */
        .nav-arrows {
            position: fixed;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 5px;
            z-index: 101;
        }

        .nav-arrow {
            width: 50px;
            height: 50px;
            background: #333;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: bold;
        }

        .nav-arrow:hover {
            background: #555;
        }

        .nav-arrow:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Bottom Navigation - Exact Match */
        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;
        
            padding: 0;
            display: flex;
            align-items: center;
            height: 80px;
            z-index: 100;
        }

        .footer__questionWrapper___1tZ46 {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }


        .footer__questionNo___3WNct {
            background: none;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .footer__questionNo___3WNct:hover {
            background-color: #f8f9fa;
        }

        .section-prefix {
            font-size: 16px;
        }

        .sectionNr {
            font-size: 16px;
            font-weight: bold;
        }

        .attemptedCount {
            font-size: 14px;
            color: #666;
            margin-left: 5px;
            font-weight: 400; /* Normal weight */
        }

        @media (max-width: 768px) {
            .attemptedCount {
                display: none;
            }
        }

        .footer__questionWrapper___1tZ46.selected .attemptedCount {
            display: none;
        }

        .footer__subquestionWrapper___9GgoP {
            display: none;
            gap: 2px;
            margin-left: 10px;
        }

        .footer__questionWrapper___1tZ46.selected .footer__subquestionWrapper___9GgoP {
            display: flex;
        }

        .subQuestion {
            width: 32px;
            height: 32px;
            border: 1px solid #ccc;
            background: white;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-radius: 2px;
        }

        .subQuestion.answered {
            background-color: #e9ecef;
            border-color: #ddd;
        }
        .subQuestion.correct {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }
        .subQuestion.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .subQuestion:hover {
            background-color: #f0f0f0;
            border-color: #999;
        }

        .subQuestion.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .subQuestion.completed {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .footer__deliverButton___3FM07 {
            margin-left: auto;
            margin-right: 20px;
            background-color: #f0f0f0;
            color: #333;
            border: 1px solid #ccc;
            padding: 12px 20px;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s, border-color 0.2s;
            min-width: 170px;
            justify-content: center;
        }

        .footer__deliverButton___3FM07:hover {
            background-color: #e0e0e0;
            border-color: #bbb;
        }

        .footer__deliverButton___3FM07:disabled {
            background: #e9ecef;
            color: #6c757d;
            cursor: not-allowed;
            border-color: #ddd;
        }

        .fa-check::before {
            content: "✓";
        }

        .hidden {
            display: none !important;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
            min-width: 140px;
        }

        .context-menu-item {
            padding: 12px 16px;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .context-menu-item:hover {
            background-color: #f8f9fa;
        }

        .context-menu-item:last-child {
            border-bottom: none;
        }

        .highlight {
            background-color: #ffff00;
        }

        .comment-highlight {
            background-color: #90EE90;
            position: relative;
            cursor: help;
        }

        .comment-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .comment-highlight:hover .comment-tooltip {
            opacity: 1;
        }

        .question {
            margin-bottom: 40px;
        }
        .question p {
            margin-bottom: 10px;
        }
        .question ul, .question .people-table {
            margin-top: 0;
        }
        .question-prompt {
            margin-bottom: 20px;
        }
        .question ul {
            list-style: none;
            padding-left: 0;
        }
        .question ul li {
            margin-bottom: 5px;
        }
        .answer-input {
            border: 1px solid #888;
            border-radius: 4px;
            background-color: #fff;
            padding: 2px 5px;
            font-size: 16px;
            text-align: center;
            margin-right: 4px;
            margin-left: 4px;
            transition: border-color 0.3s, box-shadow 0.3s;
            height: 28px; /* Standard height */
            width: 150px; /* Standard width */
        }
        .answer-input.active-input {
            border-color: #4a90e2;
            box-shadow: 0 0 3px 1px rgba(74, 144, 226, 0.5);
        }
        .answer-input::placeholder {
            color: #999;
            font-weight: bold;
            text-align: center;
        }
        .answer-input.correct {
            border-color: #28a745;
            background-color: #e9f7ef;
        }
        .answer-input.incorrect {
            border-color: #dc3545;
            background-color: #f8d7da;
            color: #721c24;
        }
        .answer-input {
    z-index: 10;
    position: relative;
    pointer-events: auto;
}
        .summary-text .answer-input {
            width: 120px;
            height: 24px;
            font-size: 14px;
            margin: 0 4px;
        }
        
        /* Minimalistic dropdown styling */
        .answer-select {
            border: 1px solid #313131;
            border-radius: 6px;
            background-color: #ffffff;
            padding: 2px 6px;
            font-size: 14px;
            font-family: inherit;
            color: #333;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 80px;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12"><path d="M6 8.825L1.175 4 2.238 2.938 6 6.7l3.763-3.762L10.825 4z" fill="%23666"/></svg>');
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 12px;
            padding-right: 28px;
        }
        
        .answer-select:hover {
            border-color: #4a90e2;
            box-shadow: 0 2px 4px rgba(74, 144, 226, 0.1);
        }
        
        .answer-select:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }
        
        .answer-select option {
            padding: 8px 12px;
            background-color: #ffffff;
            color: #333;
        }
        
        .answer-select option:hover {
            background-color: #f8f9fa;
        }
        
        /* Drag and Drop Styling for Questions 19-21 */
        .drag-drop-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }
        
        
        .recommendations-box h4 {
            margin-bottom: 10px;
            color: #333;
            font-size: 14px;
            font-weight: 600;
        }
        
        .drag-item {
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 8px 12px;
            margin-bottom: 8px;
            cursor: grab;
            font-size: 14px;
            transition: all 0.2s ease;
            user-select: none;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .drag-item:hover {
            background: #f0f8ff;
            border-color: #4a90e2;
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }
        
        .drag-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }
        
        .drag-item.used {
            opacity: 0.3;
            cursor: not-allowed;
            background: #f5f5f5;
        }
        
        .drag-item[data-dnd-group="summary-19-21"] {
            display: block;
            transition: all 0.2s ease;
        }
        
        .drag-item[data-dnd-group="summary-19-21"].used {
            display: none;
        }
        
        .drag-item[data-dnd-group="summary-27-32"].used {
            display: none;
        }
        
        .drag-item[data-dnd-group="summary-19-21"].dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }
        
        .drop-zones-container {
            flex: 1;
        }
        
        .question-drop-zone {
            margin-bottom: 15px;
        }
        
        .question-drop-zone p {
            margin: 0;
            line-height: 1.6;
        }
        
        .drop-zone {
            display: inline-block;
            min-width: 120px;
            min-height: 32px;
            border: 2px dashed #ccc;
            border-radius: 6px;
            padding: 4px 8px;
            margin: 0 4px;
            background: #fafafa;
            color: #999;
            font-size: 14px;
            text-align: center;
            vertical-align: middle;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .drop-zone:hover {
            border-color: #4a90e2;
            background: #f0f8ff;
            color: #4a90e2;
        }
        
        .drop-zone.filled {
            border-style: solid;
            border-color: #4a90e2;
            background: #e3f2fd;
            color: #333;
            cursor: default;
        }
        
        .drop-zone.filled::after {
            content: "×";
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
        }
        .answer-inputs {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        .answer-inputs .answer-input {
            width: 200px;
            height: 30px;
            font-size: 16px;
        }
        .drag-drop-container {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }
        .recommendations-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-height: 200px;
        }
        .drag-item {
            background: white;
            border: 1px solid #9c9c9c;
            font-weight: 600;
            padding: 0px 5px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            transition: all 0.2s;
            user-select: none;
        }
        .drag-item:hover {
            background: #e9ecef;
        }
        .drag-item.dragging {
            opacity: 0.5;
        }
        .drag-item.selected {
            border-color: #4a90e2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.5);
        }
        .drop-zone {
            border: 2px dashed #aaa;
            border-radius: 4px;
            width: 50%;
            margin-top: 19px;
            margin-bottom: 5px;
            transition: background-color 0.2s, border-color 0.2s;
            padding: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .drop-zone.drag-over {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }
        .drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }
        .drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }
        .drop-zone.disabled {
            pointer-events: none;
        }
        .drop-zone .drag-item {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 15px;
            padding: 2px;
        }
        .drag-options-container {
            margin-top: 10px;
        }
        .drag-options-container .drag-item {
            display: block;
            width: fit-content;
            font-size: 15px;
            padding: 0.5px 10px;
            margin-bottom: 5px;
        }
        .drag-options-container .drag-item:last-child {
            margin-bottom: 0;
        }
        .q-number {
            color: #888;
            font-size: 14px;
            font-weight: bold;
        }
        .questions-container {
            width: 100%;
        }
        audio {
            width: 100%;
            margin-bottom: 20px;
        }
        .part-header {
            background-color: #f1f2ec;
            padding: 15px 20px;
            border: 1px solid #e0e0e0;
            text-align: left;
            margin: 10px 20px;
            border-radius: 5px;
        }
        .part-header p {
            margin: 0;
        }
        .part-header p:first-child {
            margin-bottom: 5px;
        }

        .question li.correct {
            color: #155724;
            font-weight: bold;
        }
        .question li.incorrect {
            color: #721c24;
        }
        .question li.correct::before {
            content: '✔ ';
            color: #28a745;
        }
        .question li.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }

        .example-box {
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .timer-container {
            display: flex;
            position: relative;
            cursor: default;
            color: #333;
            font-size: 16px;
            font-weight: 500;
            align-items: center;
        }
        .timer-container .timer-tooltip {
            display: none;
        }

        .timer-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 15px;
        }

        .timer-controls button {
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 50%;
            padding: 0;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }
        .timer-controls button:hover {
            background: #e0e0e0;
        }

        .timer-controls button svg {
            width: 20px;
            height: 20px;
            fill: #333;
        }

        .audio-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(40, 40, 40, 0.9);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }
        .audio-modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 500px;
            padding: 20px;
        }
        .audio-modal-content p {
            font-size: 16px;
            line-height: 1.5;
            color: #eee;
        }
        .audio-modal-icon {
            margin-bottom: 20px;
        }
        .modal-play-btn {
            background-color: #000;
            color: white;
            border: 1px solid white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }
        .modal-play-btn:hover {
            background-color: #333;
        }
        #goto-widget {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        #goto-input {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        #goto-btn {
            padding: 4px 10px;
            border: 1px solid #ccc;
            background-color: #f0f0f0;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Styles for TRUE/FALSE/NOT GIVEN questions */
        .tf-question {
            margin-bottom: 25px;
            padding: 10px 0px;
            border-radius: 4px;
            transition: border-color 0.3s, background-color 0.3s;
        }
        .tf-question-line {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 5px 0px;
            border-radius: 4px;
        }
        .tf-question-number, .question-number-box {
            border: 2px solid #ccc;
            padding: 2px 8px;
            margin-right: 10px;
            border-radius: 3px;
            font-weight: bold;
            transition: border-color 0.3s;
            display: inline-block;
        }
        .tf-question-text {
            padding-top: 3px;
        }
        .tf-options {
            padding-left: 5px;
        }
        .tf-option {
            display: block;
            margin-bottom: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        .tf-option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        .tf-question.correct .tf-question-line {
            background-color: #e9f7ef;
        }
        .tf-question.incorrect .tf-question-line {
            background-color: #f8d7da;
        }
        .matching-question-container {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        .matching-options-bank {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .matching-questions {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .matching-question-item {
            display: flex;
            align-items: center;
            gap: 15px;

            border: 2px solid transparent;
            border-radius: 4px;
            transition: border-color 0.3s;
        }
        .matching-question-item > span {
            flex: 1;
        }
        .matching-question-item.correct {
            background-color: #e9f7ef;
            border-color: #28a745 !important;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone {
            width: 200px;
            flex-shrink: 0;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #aaa;
        }
        .matching-options-bank .drag-item {
            font-size: 15px;
            text-align: center;
            border: 1px solid #ccc;
            background: #f9f9f9;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px; /* Minimum width */
            border-left: 1px solid #e0e0e0;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .summary-completion-container {
            margin-top: 20px;
        }
        .summary-text p {
            line-height: 2.5;
            font-size: 16px;
        }
        .summary-drop-zone {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            min-width:200px;
            height: 25px;
            border: 2px dashed #999;
            border-radius: 4px;
            margin: 0 5px;
            padding: 0 5px;
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
            color: #aaa;
            font-weight: bold;
        }
        .summary-drop-zone.filled {
            border-color: #4a90e2;
            background-color: #e3f2fd;
            color: #333;
            font-weight: bold;
            cursor: pointer;
        }
        
        .summary-drop-zone:hover {
            border-color: #4a90e2;
            background-color: #f0f8ff;
        }
        .summary-drop-zone.active-input {
             border-color: #4a90e2;
             box-shadow: none;
        }
        .summary-drop-zone .drag-item {
            font-size: 15px;
            font-weight: bold;
            background-color: transparent;
            border: none;
            padding: 0;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .summary-drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }
        
        .summary-drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }
        .summary-options-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .summary-options-bank .drag-item {
            flex-grow: 1;
            min-width: 100px;
            text-align: center;
        }
        .multi-choice-question {
            margin-bottom: 20px;
            border-radius: 4px;
            border: 3px solid transparent;
            transition: border-color 0.3s, background-color 0.3s;
        }
        .multi-choice-option {
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .multi-choice-option label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 16px;
        }
        .multi-choice-option input[type="checkbox"],
        .multi-choice-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.3);
            accent-color: #4a90e2;
        }
        .multi-choice-option.correct {
            background-color: #e9f7ef;
        }
        .multi-choice-option.incorrect {
            background-color: #f8d7da;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone.filled {
            border-color: #4a90e2;
        }
        .matching-question-item .drop-zone {
            width: 200px;
            height: 40px;
        }
        .paragraph-matching-question {
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 12px;
        }
        .paragraph-matching-question .answer-input {
            width: 80px;
            flex-shrink: 0;
        }

        .matching-form-container {
            margin-top: 20px;
        }
        .matching-form-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        .matching-form-label {
            flex-shrink: 0;
        }

        /* Results Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.hidden {
            display: none;
        }
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #888;
        }
        .modal-content h2 {
            text-align: center;
            margin-bottom: 15px;
            color: #333;
        }
        .results-summary {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        .results-details-container {
            overflow-y: auto;
            padding-right: 10px; /* For scrollbar */
        }
        .result-row {
            display: grid;
            grid-template-columns: 40px 1fr 1fr;
            gap: 15px;
            padding: 8px 5px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 15px;
        }
        .result-row.incorrect {
            background-color: #f8d7da;
        }
        .result-row .q-num {
            font-weight: bold;
        }
        .result-row .user-ans {
            color: #555;
        }
        .result-row .correct-ans {
            color: #155724;
            font-weight: 500;
        }
        .correct-answer-display {
            font-weight: bold;
            color: #28a745;
            margin-left: 10px;
            font-size: 14px;
        }
        .correct-answer-highlight, .tf-option.correct-answer-highlight, .multi-choice-option.correct-answer-highlight {
            background-color: #d4edda !important;
            border: 1px solid #c3e6cb !important;
            border-radius: 4px;
            padding: 4px;
        }
        .correct-answer-highlight {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
        }
        .centered-title {
    text-align: center;
    font-size: 50px;
    font-weight: bold;
    margin-bottom: 15px;
}

        .matching-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        
        .matching-table th {
            background-color: #007bff;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }
        
        .matching-table td {
            padding: 12px;
            border: 1px solid #ddd;
            vertical-align: top;
        }
        
        .matching-table .statement {
            text-align: left;
            width: 60%;
        }
        
        .matching-table .table-radio {
            margin: 0;
            transform: scale(1.2);
        }
        
        .matching-table td:not(.statement) {
            text-align: center;
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table th:not(:first-child) {
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table td:not(.statement):has(input:checked) {
            background-color: #e3f2fd;
        }
        
        .matching-table input[type="radio"]:checked {
            accent-color: #007bff;
        }
        
        .matching-table td.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table td.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .options-row {
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        .matching-table .options-row td {
            font-weight: 500;
            text-align: center;
            padding: 8px 12px;
            font-size: 13px;
        }
        
        .matching-table .options-row td:first-child {
            text-align: left;
            font-weight: normal;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell {
            cursor: pointer;
            transition: background-color 0.2s ease;
            min-height: 40px;
            border: 1px solid #ddd;
            position: relative;
        }
        
        .matching-table .clickable-cell:hover {
            background-color: #f0f8ff;
            border-color: #007bff;
        }
        
        .matching-table .clickable-cell.selected {
            background-color: #e3f2fd;
        }
        
        .matching-table .clickable-cell.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table .clickable-cell::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: transparent;
            transition: background-color 0.2s ease;
        }
        
        .matching-table .clickable-cell.selected::after {
        }
        
        /* Explanation Section Styles */
        .explanation-section {
            margin-top: 40px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .explanation-section h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
        }
        
        .explanation-content p {
            margin-bottom: 15px;
            line-height: 1.6;
            font-size: 16px;
        }
        
        .explanation-content strong {
            color: #4a90e2;
            font-weight: 600;
        }
        
        #show-explanation-btn {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        #show-explanation-btn:hover {
            background-color: #357abd;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="timer-container">
            <span class="timer-display">60:00</span>
            <div class="timer-controls">
                <button id="timer-toggle-btn" title="Pause/Resume Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>
                </button>
                <button id="timer-reset-btn" title="Reset Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/></svg>
                </button>
            </div>
        </div>
        <a href="https://t.me/mindless_writer" target="_blank" class="telegram-link">
            MINDLESS_WRITER
        </a>
    </div>

    <div class="main-container" id="main-container">
        <div id="passage-header-container">
            <div id="part-header-1" class="part-header">
                <p><strong>Part 1</strong></p>
                <p>Read the text and answer questions 1-13.</p>
            </div>
            <div id="part-header-2" class="part-header hidden">
                <p><strong>Part 2</strong></p>
                <p>Read the text and answer questions 14-26.</p>
            </div>
            <div id="part-header-3" class="part-header hidden">
                <p><strong>Part 3</strong></p>
                <p>Read the text and answer questions 27-40.</p>
            </div>
        </div>
        <div class="panels-container">
            <div class="passage-panel" id="passage-panel">
                <div id="passage-text-1" class="reading-passage">
                    <h4 class="text-center">Natural Pesticide in India</h4>
                    <p><strong>A</strong>&nbsp;&nbsp;A dramatic story about cotton farmers in India shows how destructive pesticides can be for people and the environment; and why today's agriculture is so dependent on pesticides. This story also shows that it's possible to stop using chemical pesticides without losing a crop to ravaging insects, and it explains how to do it.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;The story began about 30 years ago, a handful of families migrated from the Guntur district of Andhra Pradesh, southeast India, into Punukula, a community of around 900 people farming plots of between two and 10 acres. The outsiders from Guntur brought cotton-culture with them. Cotton wooed farmers by promising to bring in more hard cash than the mixed crops they were already growing to eat and sell: millet, sorghum, groundnuts, pigeon peas, mung beans, chili and rice. But raising cotton meant using pesticides and fertilizers – until then a mystery to the mostly illiterate farmers of the community. When cotton production started spreading through Andhra Pradesh state. The high value of cotton made it an exceptionally attractive crop, but growing cotton required chemical fertilizers and pesticides. As most of the farmers were poor, illiterate, and without previous experience using agricultural chemicals, they were forced to rely on local, small-scale agricultural dealers for advice. The dealers sold them seeds, fertilizers, and pesticides on credit and also guaranteed the purchase of their crop. The dealers themselves had little technical knowledge about pesticides. They merely passed on promotional information from multinational chemical companies that supplied their products.</p>
                    <p><strong>C</strong>&nbsp;&nbsp;At first, cotton yields were high, and expenses for pesticides were low because cotton pests had not yet moved in. The farmers had never earned so much! But within a few years, cotton pests like bollworms and aphids plagued the fields, and the farmers saw how rapid insect evolution can be. Repeated spraying killed off the weaker pests, but left the ones most resistant to pesticides to multiply. As pesticide resistance mounted, the farmers had to apply more and more of the pesticides to get the same results. At the same time, the pesticides killed off birds, wasps, beetles, spiders, and other predators that had once provided natural control of pest insects. Without these predators, the pests could destroy the entire crop if pesticides were not used. Eventually, farmers were mixing sometimes having to spray their cotton as frequently as two times a week. They were really hooked!</p>
                    <p><strong>D</strong>&nbsp;&nbsp;The villagers were hesitant, but one of Punukula's village elders decided to risk trying the natural methods instead of pesticides. His son had collapsed with acute pesticide poisoning and survived but the hospital bill was staggering. SECURE's staff coached this villager on how to protect his cotton crop by using a toolkit of natural methods chat India's Center for Sustainable Agriculture put together in collaboration with scientists at Andhra Pradesh's state university. They called the toolkit "Non-Pesticide Management" – or "NPM."</p>
                    <p><strong>E</strong>&nbsp;&nbsp;The most important resource in the NPM toolkit was the neem tree (Azadirachta indica) which is common throughout much of India. Neem tree is a broad-leaved evergreen tree related to mahogany. It protects itself against insects by producing a multitude of natural pesticides that work in a variety of ways: with an arsenal of chemical defenses that repel egg-laying, interfere with insect growth, and most important, disrupt the ability of crop-eating insects to sense their food.</p>
                    <p><strong>F</strong>&nbsp;&nbsp;In fact, neem has been used traditionally in India to protect stored grains from insects and to produce soaps, skin lotions, and other health products. To protect crops from insects, neem seeds are simply ground into a powder that is soaked overnight in water. The solution is then sprayed onto the crop. Another preparation, neem cake, can be mixed into the soil to kill pests and diseases in the soil, and it doubles as an organic fertilizer high in nitrogen. Neem trees grow locally, so the only "cost" is the labor to prepare neem for application to fields.</p>
                    <p><strong>G</strong>&nbsp;&nbsp;The first farmer's trial with NPM was a complete success! His harvest was as good as the harvests of farmers that were using pesticides, and he earned much more because he did not spend a single rupee on pesticides. Inspired by this success, 20 farmers tried NPM the next year. SECURE posted two well-trained staff in Punukula to teach and help everyone in the village, and the village women put pressure on their husbands to stop using toxic chemicals. Families that were no longer exposing themselves to pesticides began to feel much better, and the rapid improvement in income, health, and general wellbeing quickly sold everyone on the value of NPM. By 2000, all the farmers in Punukula were using NPM, not only for cotton but for their other crops as well.</p>
                    <p><strong>H</strong>&nbsp;&nbsp;The suicide epidemic came to an end. And with the cash, health, and energy that returned when they stopped poisoning themselves with pesticides, the villagers were inspired to start more community and business projects. The women of Punukula created a new source of income by collecting, grinding, and selling neem seeds for NPM in other villages. The villagers rescued their indentured children and gave them special six-month "catch-up," courses to return to school.</p>
                    <p><strong>I</strong>&nbsp;&nbsp;Fighting against pesticides, and winning, increased village solidarity, self-confidence, and optimism about the future. When dealers tried to punish NPM users by paying less for NPM cotton, the farmers united to form a marketing cooperative that found fairer prices elsewhere. The leadership and collaboration skills that the citizens of Punukula developed in the NPM struggle have helped them to take on other challenges, like water purification, building a cotton gin to add value to the cotton before they sell it, and convincing the state government to support NPM over the objection of multi-national pesticide corporations.</p>
                </div>
                <div id="passage-text-2" class="reading-passage hidden">
                    <h4 class="text-center">Mammoth Kill</h4>
                    <p style="text-align: center; font-style: italic;">Mammoth is any species of the extinct genus Mammuthus, proboscideans commonly equipped with long, curved tusks and, in northern species, a covering of long hair. They lived from the Pliocene epoch from around 5 million years ago, into the Holocene at about 4,500 years ago and were members of the family Elephantidae, which contains, along with mammoths, the two genera of modern elephants and their ancestors.</p>
                    <p>Like their modern relatives, mammoths were quite large. The largest known species reached heights in the region of 4 m at the shoulder and weighs up to 8 tonnes, while exceptionally large males may have exceeded 12 tonnes. However, most species of mammoth were only about as large as a modern Asian elephant. Both sexes bore tusks. A first, small set appeared at about the age of six months and these were replaced at about 18 months by the permanent set. Growth of the permanent set was at a rate of about 1 to 6 inches per year. Based on studies of their close relatives, the modern elephants, mammoths probably had a gestation period of 22 months, resulting in a single calf being born. Their social structure was probably the same as that of African and Asian elephants, with females living in herds headed by a matriarch, whilst bulls lived solitary lives or formed loose groups after sexual maturity.</p>
                    <p>MEXICO CITY – Although it's hard to imagine in this age of urban sprawl and automobiles, North America once belonged to mammoths, camels, ground sloths as large as cows, bear-sized beavers and other formidable beasts. Some 11,000 years ago, however, these large-bodied mammals and others – about 70 species in all – disappeared. Their demise coincided roughly with the arrival of humans in the New World and dramatic climatic change – factors that have inspired several theories about the die-off. Yet despite decades of scientific investigation, the exact cause remains a mystery. Now new findings offer support to one of these controversial hypotheses: that human hunting drove this megafaunal menagerie to extinction. The overkill model emerged in the 1960s when it was put forth by Paul S. Martin of the University of Arizona. Since then, critics have charged that no evidence exists to support the idea that the first Americans hunted to the extent necessary to cause these extinctions. But at the annual meeting of the Society of Vertebrate Paleontology in Mexico City last October, paleoecologist John Alroy of the University of California at Santa Barbara argued that, in fact, hunting-driven extinction is not only plausible, but it was only unavoidable. He has determined, using a computer simulation, that even a very modest amount of hunting would have wiped these animals out.</p>
                    <p>Assuming an initial human population of 100 people that grew no more than 2 percent annually, Alroy determined that if each band of, say, 50 people killed 15 to 20 large mammals a year, humans could have eliminated the animal populations within 1,000 years. Large mammals, in particular, would have been vulnerable to the pressure because they have longer gestation periods than smaller mammals and they're young require extended care.</p>
                    <p>Not everyone agrees with Alroy's assessment. For one, the results depend in part on population-size estimates for the extinct animals – figures that are not necessarily reliable. But a more specific criticism comes from mammalogist Ross D. E. MacPhee of the American Museum of Natural History in New York City, who points out that the relevant archaeological record contains barely a dozen examples of stone points embedded in mammoth bones (and none, it should be noted, are known from other megafaunal remains) – hardly what one might expect if hunting drove these animals to extinction. Furthermore, some of these species had huge ranges – the giant Jefferson's ground sloth, for example, lived as far north as the Yukon and as far south as Mexico – which would have made slaughtering them in numbers sufficient to cause their extinction rather implausible, he says.</p>
                    <p>Macphee agrees that humans most likely brought about these extinctions (as well as others around the world that coincided with human arrival), but not directly. Rather he suggests that people may have introduced hyper lethal disease, perhaps through their dogs or hitchhiking vermin, which then spread wildly among the immunologically naive species of the New World. As in the overkill model, populations of large mammals would have a harder time recovering. Repeated outbreaks of a hyper disease could thus quickly drive them to the point of no return. So far MacPhee does not have empirical evidence for the hyper disease hypotheses, and it won't be easy to come by hyper lethal disease would kill far too quickly to leave its signature on the bones themselves. But he hopes that analyses of tissue and DNA from the last mammoths to perish will eventually reveal murderous microbes.</p>
                    <p>The third explanation for what brought on this North American extinction does not involve human beings. Instead, its proponents blame the loss on the water. The Pleistocene epoch witnessed considerable climatic instability, explains palaeontologist Russell W. Graham of the Denver Museum of Nature and Science. As a result, certain habitats disappeared, and species that had once formed communities split apart. For some animals, this change brought opportunity. For much of the megafauna, however, the increasingly homogeneous environment left them with shrinking geographical ranges – a death sentence for large animals, which need large ranges. Although these creatures managed to maintain viable populations through most of the Pleistocene, the final major fluctuation – the so-called Younger Dryas event – pushed them over the edge, Graham says. For his part, Alroy is convinced that human hunters demolished the titans of the Ice Age. The overkill model explains everything the disease and climate scenarios explain, he asserts, and makes accurate predictions about which species would eventually go extinct. "Personally, I'm a vegetarian," he remarks, "and I find all of this kind of gross – but believable."</p>
                </div>
                <div id="passage-text-3" class="reading-passage hidden">
                    <h4 class="text-center">Language Strategy in Multinational Company</h4>
                    <p><strong>A</strong>&nbsp;&nbsp;The importance of language management in multinational companies has never been greater than today. Multinationals are becoming ever more conscious of the importance of global coordination as a source of competitive advantage and language remains the ultimate barrier to aspirations of international harmonization. Before attempting to consider language management strategies, companies will have to evaluate the magnitude of the language barrier confronting them and in doing so they will need to examine it in three dimensions: the Language Diversity, the Language Penetration and the Language Sophistication. Companies next need to turn their attention to how they should best manage language. There is a range of options from which MNCs can formulate their language strategy.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;Lingua Franca: The simplest answer, though realistic only for English speaking companies, is to rely on one's native tongue. As recently as 1991 a survey of British exporting companies found that over a third used English exclusively in dealings with foreign customers. This attitude that "one language fits all" has also been carried through into the Internet age. A survey of the web sites of top American companies confirmed that over half made no provision for foreign language access, and another found that less than 10% of leading companies were able to respond adequately to emails other than in the company's language. Widespread though it is, however, reliance on a single language is a strategy that is fatally flawed. It makes no allowance for the growing trend in Linguistic Nationalism whereby buyers in Asia, South America and the Middle East, in particular, are asserting their right to "work in the language of the customer". It also fails to recognize the increasing vitality of languages such as Spanish, Arabic and Chinese that over time are likely to challenge the dominance of English as a lingua franca. In the IT arena, it ignores the rapid globalization of the Internet where the number of English-language e-commerce transactions, emails and web sites, is rapidly diminishing as a percentage of the total. Finally, the total reliance on a single language puts the English speaker at risk in negotiations. Contracts, rules and legislation are invariably written in the local language, and a company unable to operate in that language is vulnerable.</p>
                    <p><strong>C</strong>&nbsp;&nbsp;Functional Multilingualism: Another improvised approach to Language is to rely on what has been termed "Functional Multilingualism". Essentially what this means is to muddle through, relying on a mix of languages, pidgins and gestures to communicate by whatever means the parties have at their disposal. In a social context, such a shared effort to make one another understand might be considered an aid to the bonding process with the frustration of communication being regularly punctuated by moments of absurdity and humor. However, as the basis for business negotiations, it appears very hit-and-nuts. And yet Hagen's recent study suggests that 16% of an international business transaction; is conducted in a "cocktail of languages." Functional Multilingualism shares the same defects as reliance on a lingua franca and increases the probability of cognitive divergence between the parties engaged in the communication.</p>
                    <p><strong>D</strong>&nbsp;&nbsp;External Language Resources: A more rational and obvious response to the language barrier is to employ external resources such as translators and interpreters, and certainly there are many excellent companies specialized in these fields. However, such a response is by no means an end to the language barrier. For a start these services can be very expensive with a top Simultaneous Interpreter, commanding daily rates as high as a partner in an international consulting company. Secondly, any good translator or interpreter will insist that to be fully effective they must understand the context of the subject matter. This is not always possible. In some cases, it is prohibited by the complexity or specialization of the topic. Sometimes by lack of preparation time but most often the obstacle is the reluctance of the parties to explain the wider context to an 'outsider'. Another problem is that unless there has been considerable pre-explaining between the interpreter and his clients it is likely that there will be ambiguity and cultural overtones in the source messages the interpreter has to work with. They will, of course, endeavor to provide a hi-fidelity translation but in this circumstance, the interpreter has to use initiative and guesswork. This clearly injects a potential source of misunderstanding into the proceedings. Finally, while a good interpreter will attempt to convey not only the meaning but also the spirit of any communication, there can be no doubt that there is a loss of rhetorical power when communications go through a third party. So in situations requiring negotiation, persuasion, humor etc. the use of an interpreter is a poor substitute for direct communication.</p>
                    <p><strong>E</strong>&nbsp;&nbsp;Training: The immediate and understandable reaction to any skills-shortage in business is to consider personnel development and certainly the language training industry is well developed. Offering programs at almost every level and in numerous languages. However, without doubt, the value of language training no company should be deluded into believing this to be assured of success. Training in most companies is geared to the economic cycle. When times are good, money is invested in training. When belts get tightened training is one of the first "luxuries" to be pared down. In a study conducted across four European countries, nearly twice as many companies said they needed language training in coming years as had conducted training in past years. This disparity between "good intentions" and "actual delivery", underlines the problems of relying upon training for language skills. Unless the company is totally committed to sustaining the strategy even though bad times, it will fail.</p>
                    <p><strong>F</strong>&nbsp;&nbsp;One notable and committed leader in the field of language training has been the Volkswagen Group. They have developed a language strategy over many years and in many respects can be regarded as a model of how to manage language professionally. However, the Volkswagen approach underlines that language training has to be considered a strategic rather than a tactical solution. In their system to progress from "basics" to "communications competence" in a language requires the completion of 6 languages stages each one demanding approximately 90 hours of a refresher course, supported by many more hours of self-study, spread over a 6-9 months period. The completion of each stage is marked by a post-stage achievement test, which is a pre-requisite for continued training. So even this professionally managed program expects a minimum of three years of fairly intensive study to produce an accountant. Engineer, buyer or salesperson capable of working effectively in a foreign language. Clearly, companies intending to pursue this route need to do so with realistic expectations and with the intention of sustaining the program over many years. Except in terms of "brush-up" courses for people who were previously fluent in a foreign language, training cannot be considered a quick fix.</p>
                </div>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="questions-panel" id="questions-panel">
                <div id="questions-1" class="question-set">
                    <div class="questions-container">
                        <div class="question" data-q-start="1" data-q-end="4">
                            <div class="question-prompt">
                                <p><strong>Questions 1-4</strong><br>
                                Do the following statements agree with the information given in Reading Passage 1?</p>
                                <p>In boxes 1-4 on your answer sheet, write</p>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><strong>TRUE</strong> if the statement agrees with the information</li>
                                    <li><strong>FALSE</strong> if the statement contradicts the information</li>
                                    <li><strong>NOT GIVEN</strong> if there is no information on this</li>
                                </ul>
                            </div>
                            <div class="tf-question" data-q-start="1" data-q-end="1">
                                <div class="tf-question-line"><span class="tf-question-number">1</span><span class="tf-question-text">Cotton in Andhra Pradesh state could really bring more income to the local farmers than traditional farming.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q1" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q1" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q1" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="2" data-q-end="2">
                                <div class="tf-question-line"><span class="tf-question-number">2</span><span class="tf-question-text">The majority of farmers had used agricultural pesticides before 30 years ago.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q2" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q2" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q2" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="3" data-q-end="3">
                                <div class="tf-question-line"><span class="tf-question-number">3</span><span class="tf-question-text">The yield of cotton is relatively lower than that of other agricultural crops.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q3" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q3" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q3" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="4" data-q-end="4">
                                <div class="tf-question-line"><span class="tf-question-number">4</span><span class="tf-question-text">The farmers didn't realize the spread of the pests was so fast.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q4" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q4" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q4" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                                </div>
                        <div class="question" data-q-start="5" data-q-end="11">
                            <div class="question-prompt">
                                <p><strong>Questions 5-11</strong><br>Complete the summary below</p>
                                <p>Choose <strong>NO MORE THAN TWO WORDS</strong> from the passage for each answer</p>
                                <p>Write your answers in boxes 5-11 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p><strong>The Making of pesticide protecting crops against insects</strong></p>
                                <p>The broad-leaved neem tree was chosen. It is a fast-growing and <input type="text" class="answer-input" id="q5" placeholder="5"> tree and produces an amount of <input type="text" class="answer-input" id="q6" placeholder="6"> for itself that can be effective like insects repellent. Firstly, neem seeds need to be crushed into <input type="text" class="answer-input" id="q7" placeholder="7"> form, which is left behind <input type="text" class="answer-input" id="q8" placeholder="8"> in water. Then we need to spray the solution onto the crop. A special <input type="text" class="answer-input" id="q9" placeholder="9"> is used when mixing with soil in order to eliminate bugs and bacteria, and its effect <input type="text" class="answer-input" id="q10" placeholder="10"> when it adds the level of <input type="text" class="answer-input" id="q11" placeholder="11"> in this organic fertilizer meanwhile.</p>
                            </div>
                        </div>
                        <div class="question" data-q-start="12" data-q-end="13">
                            <div class="question-prompt">
                                <p><strong>Questions 12-13</strong><br>Answer the questions below</p>
                                <p>Choose <strong>NO MORE THAN TWO WORDS AND/OR A NUMBER</strong> from the passage for each answer.</p>
                                <p>Write your answers in boxes 12-13 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p><strong>12</strong>&nbsp;&nbsp;In which year did all the farmers use NPM for their crops in Punukula? <input type="text" class="answer-input" id="q12" placeholder="12"></p>
                                <p><strong>13</strong>&nbsp;&nbsp;What gave the women of Punukula a business opportunity to NPMs? <input type="text" class="answer-input" id="q13" placeholder="13"></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Explanation Button for Part 1 -->
                    
                    
                    <!-- Part 1 Explanation Section -->
                    <div id="part-1-explanation" class="explanation-section hidden" style="margin-top: 40px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                        <h3 style="color: #333; margin-bottom: 20px; text-align: center;">Part 1 Explanation</h3>
                        <div class="explanation-content">
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 1:</strong> The passage mentions that cotton promised to bring more hard cash than mixed crops, but it doesn't specifically state that cotton "could really bring more income" - it only mentions the promise. Since the actual outcome is not clearly stated, the answer is NOT GIVEN.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 2:</strong> "But raising cotton meant using pesticides and fertilizers – until then a mystery to the mostly illiterate farmers of the community." This shows that the majority of farmers had NOT used agricultural pesticides before 30 years ago, making the answer FALSE.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 3:</strong> The passage mentions that cotton yields were high initially, but it doesn't provide a direct comparison between cotton yield and other agricultural crops. The statement about cotton yield being "relatively lower" is not addressed in the passage, making the answer NOT GIVEN.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 4:</strong> "But within a few years, cotton pests like bollworms and aphids plagued the fields, and the farmers saw how rapid insect evolution can be." This shows that the farmers did realize the spread of the pests was fast, making the answer TRUE.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 5:</strong> "Neem tree is a broad-leaved evergreen tree related to mahogany." The answer is "evergreen".
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 6:</strong> "It protects itself against insects by producing a multitude of natural pesticides that work in a variety of ways." The answer is "natural pesticides".
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 7:</strong> "To protect crops from insects, neem seeds are simply ground into a powder that is soaked overnight in water." The answer is "powder".
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 8:</strong> "To protect crops from insects, neem seeds are simply ground into a powder that is soaked overnight in water." The answer is "overnight".
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 9:</strong> "Another preparation, neem cake, can be mixed into the soil to kill pests and diseases in the soil." The answer is "neem cake".
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 10:</strong> "and it doubles as an organic fertilizer high in nitrogen." The answer is "doubles".
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 11:</strong> "and it doubles as an organic fertilizer high in nitrogen." The answer is "nitrogen".
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 12:</strong> "By 2000, all the farmers in Punukula were using NPM, not only for cotton but for their other crops as well." The answer is "2000".
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 13:</strong> "The women of Punukula created a new source of income by collecting, grinding, and selling neem seeds for NPM in other villages." The answer is "neem seeds".
                            </p>
                        </div>
                    </div>
                </div>
                <div id="questions-2" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="14" data-q-end="20">
                            <div class="question-prompt">
                                <p><strong>Questions 14-20</strong><br>Summary</p>
                                <p>Complete the following summary of the paragraphs of Reading Passage</p>
                                <p>Using <strong>NO MORE THAN THREE WORDS</strong> from the Reading Passage for each answer.</p>
                                <p>Write your answers in boxes 14-20 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p>The reason why big size mammals become extinct 11,000 years ago is under hot debate. The first explanation is that <input type="text" class="answer-input" id="q14" placeholder="14"> of human-made it happen. This so-called <input type="text" class="answer-input" id="q15" placeholder="15"> began from the 1960s suggested by an expert, who however received criticism of lack of further information. Another assumption promoted by MacPhee is that deadly <input type="text" class="answer-input" id="q16" placeholder="16"> from human causes their demises. However, his hypothesis required more <input type="text" class="answer-input" id="q17" placeholder="17"> to testify its validity. Graham proposed a third hypothesis that <input type="text" class="answer-input" id="q18" placeholder="18"> in Pleistocene epoch drove some species disappear, reduced <input type="text" class="answer-input" id="q19" placeholder="19"> posed a dangerous signal to these giants, and <input type="text" class="answer-input" id="q20" placeholder="20"> finally wiped them out.</p>
                            </div>
                        </div>
                        <div class="question" data-q-start="21" data-q-end="26">
                            <div class="question-prompt">
                                <p><strong>Questions 21-26</strong><br>Use the information in the passage to match each statement with the person who made it from A, B or C.</p>
                                <p>Write the appropriate letters A-C in boxes 21-26 on your answer sheet.</p>
                                <p><strong>NB</strong> You may use any letter more than once.</p>
                                <p><strong>A</strong> John Alroy<br>
                                <strong>B</strong> Ross D. E. MacPhee<br>
                                <strong>C</strong> Russell W. Graham</p>
                            </div>
                            <div class="table-container">
                                <table class="matching-table">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>A</th>
                                            <th>B</th>
                                            <th>C</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="statement">21. Human hunting well explained which species would finally disappear.</td>
                                            <td class="clickable-cell" data-question="21" data-value="A" onclick="selectCell(this, 21, 'A')"></td>
                                            <td class="clickable-cell" data-question="21" data-value="B" onclick="selectCell(this, 21, 'B')"></td>
                                            <td class="clickable-cell" data-question="21" data-value="C" onclick="selectCell(this, 21, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">22. Further grounded proof needed to explain human's indirect impact on mammals.</td>
                                            <td class="clickable-cell" data-question="22" data-value="A" onclick="selectCell(this, 22, 'A')"></td>
                                            <td class="clickable-cell" data-question="22" data-value="B" onclick="selectCell(this, 22, 'B')"></td>
                                            <td class="clickable-cell" data-question="22" data-value="C" onclick="selectCell(this, 22, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">23. Overhunting situation has caused die-out of large mammals.</td>
                                            <td class="clickable-cell" data-question="23" data-value="A" onclick="selectCell(this, 23, 'A')"></td>
                                            <td class="clickable-cell" data-question="23" data-value="B" onclick="selectCell(this, 23, 'B')"></td>
                                            <td class="clickable-cell" data-question="23" data-value="C" onclick="selectCell(this, 23, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">24. Illness rather than hunting caused extensive extinction.</td>
                                            <td class="clickable-cell" data-question="24" data-value="A" onclick="selectCell(this, 24, 'A')"></td>
                                            <td class="clickable-cell" data-question="24" data-value="B" onclick="selectCell(this, 24, 'B')"></td>
                                            <td class="clickable-cell" data-question="24" data-value="C" onclick="selectCell(this, 24, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">25. Doubt raised through the study of several fossil records.</td>
                                            <td class="clickable-cell" data-question="25" data-value="A" onclick="selectCell(this, 25, 'A')"></td>
                                            <td class="clickable-cell" data-question="25" data-value="B" onclick="selectCell(this, 25, 'B')"></td>
                                            <td class="clickable-cell" data-question="25" data-value="C" onclick="selectCell(this, 25, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">26. Climate shift is the main reason for extinction.</td>
                                            <td class="clickable-cell" data-question="26" data-value="A" onclick="selectCell(this, 26, 'A')"></td>
                                            <td class="clickable-cell" data-question="26" data-value="B" onclick="selectCell(this, 26, 'B')"></td>
                                            <td class="clickable-cell" data-question="26" data-value="C" onclick="selectCell(this, 26, 'C')"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="questions-3" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="27" data-q-end="32">
                            <div class="question-prompt">
                                <p><strong>Questions 27-32</strong><br>Summary</p>
                                <p>Complete the following summary of the Whole Paragraphs of Reading Passage, choosing A-L words from the following options.</p>
                                <p>Write your answers in boxes 27-32 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p>MNCs often encounter a language barrier in their daily, strategy, then they seek several approaches to solve such problems. First, native language gives them a realistic base in a different language speaking country, but the problem turned up when they deal with oversea <span class="summary-drop-zone" data-q-start="27" data-dnd-group="summary-27-32">27</span>. For example, operation on the translation of some key <span class="summary-drop-zone" data-q-start="28" data-dnd-group="summary-27-32">28</span>, it is inevitable to generate differences by rules from different countries. Another way is to rely on a combination of spoken language and <span class="summary-drop-zone" data-q-start="29" data-dnd-group="summary-27-32">29</span>, yet a report written that over one-tenth business <span class="summary-drop-zone" data-q-start="30" data-dnd-group="summary-27-32">30</span> processed in a party language setting. Third way: hire translators. However, firstly it is <span class="summary-drop-zone" data-q-start="31" data-dnd-group="summary-27-32">31</span>, besides if they are not well-prepared, they have to resort to his/her own <span class="summary-drop-zone" data-q-start="32" data-dnd-group="summary-27-32">32</span> work.</p>
                            </div>
                            <div class="summary-options-bank">
                                <div class="drag-item" draggable="true" data-value="A" data-dnd-group="summary-27-32">gestures</div>
                                <div class="drag-item" draggable="true" data-value="B" data-dnd-group="summary-27-32">clients</div>
                                <div class="drag-item" draggable="true" data-value="C" data-dnd-group="summary-27-32">transaction</div>
                                <div class="drag-item" draggable="true" data-value="D" data-dnd-group="summary-27-32">understanding and assumption</div>
                                <div class="drag-item" draggable="true" data-value="E" data-dnd-group="summary-27-32">accurate</div>
                                <div class="drag-item" draggable="true" data-value="F" data-dnd-group="summary-27-32">documents</div>
                                <div class="drag-item" draggable="true" data-value="G" data-dnd-group="summary-27-32">managers</div>
                                <div class="drag-item" draggable="true" data-value="H" data-dnd-group="summary-27-32">body language</div>
                                <div class="drag-item" draggable="true" data-value="I" data-dnd-group="summary-27-32">long-term</div>
                                <div class="drag-item" draggable="true" data-value="J" data-dnd-group="summary-27-32">effective</div>
                                <div class="drag-item" draggable="true" data-value="K" data-dnd-group="summary-27-32">rivals</div>
                                <div class="drag-item" draggable="true" data-value="L" data-dnd-group="summary-27-32">costly</div>
                        </div>
                        </div>
                        <div class="question" data-q-start="33" data-q-end="39">
                            <div class="question-prompt">
                                <p><strong>Questions 33-39</strong><br>Answer the questions below.</p>
                                <p>Choose <strong>NO MORE THAN THREE WORDS AND/OR A NUMBER</strong> from the passage for each answer.</p>
                                <p>Write your answers in boxes 33-39 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p><strong>33</strong>&nbsp;&nbsp;What understandable reactions does Training pay attention to according to the author? <input type="text" class="answer-input" id="q33" placeholder="33"></p>
                                <p><strong>34</strong>&nbsp;&nbsp;In what term does the writer describe training during the economic depression? <input type="text" class="answer-input" id="q34" placeholder="34"></p>
                                <p><strong>35</strong>&nbsp;&nbsp;What contribution does the Volkswagen Group set up for multinational companies? <input type="text" class="answer-input" id="q35" placeholder="35"></p>
                                <p><strong>36</strong>&nbsp;&nbsp;What does Volkswagen Group consider language training as in their company? <input type="text" class="answer-input" id="q36" placeholder="36"></p>
                                <p><strong>37</strong>&nbsp;&nbsp;How many stages are needed from a basic course to advanced in training? <input type="text" class="answer-input" id="q37" placeholder="37"></p>
                                <p><strong>38</strong>&nbsp;&nbsp;How long does a refresher course (single-stage) need normally? <input type="text" class="answer-input" id="q38" placeholder="38"></p>
                                <p><strong>39</strong>&nbsp;&nbsp;At least how long is needed for a specific professional to acquire a foreign language? <input type="text" class="answer-input" id="q39" placeholder="39"></p>
                            </div>
                        </div>

                        <div class="question" data-q-start="40" data-q-end="40">
                            <div class="question-prompt">
                                <p><strong>Question 40</strong><br>Choose the correct answer.</p>
                                <p>Write your answer in box 40 on your answer sheet.</p>
                            </div>
                            <div class="multi-choice-question" data-q-start="40" data-q-end="40">
                                <p><strong>40</strong>&nbsp;&nbsp;What is the main function of this passage?</p>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q40" value="A"> to reveal all kinds of language problems that companies may encounter</label>
                            </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q40" value="B"> to exhibits some well-known companies successfully dealing with language difficulties</label>
                        </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q40" value="C"> to evaluate various approaches for language barrier in multinational companies</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q40" value="D"> to testify that training is an only feasible approach to solve the language problem</label>
                                </div>
                            </div>
                        </div>
                                            </div>
                    </div>
                    
                    <!-- Explanation Button -->
                    
                    
                    <!-- Part 2 Explanation Section -->
                <div id="part-2-explanation" class="explanation-section" style="margin-top: 40px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h3 style="color: #333; margin-bottom: 20px; text-align: center;">Part 2 Explanation</h3>
                    <div class="explanation-content">
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 14:</strong> "hunting drove this megafaunal menagerie to extinction" - The first explanation is that hunting of human-made it happen. The answer is "hunting".
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 15:</strong> "The overkill model emerged in the 1960s when it was put forth by Paul S. Martin of the University of Arizona" - This so-called overkill model began from the 1960s suggested by an expert. The answer is "overkill model".
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 16:</strong> "people may have introduced hyper lethal disease, perhaps through their dogs or hitchhiking vermin" - Another assumption promoted by MacPhee is that deadly disease from human causes their demises. The answer is "disease".
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 17:</strong> "So far MacPhee does not have empirical evidence for the hyper disease hypotheses, and it won't be easy to come by" - However, his hypothesis required more empirical evidence to testify its validity. The answer is "empirical evidence".
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 18:</strong> "The Pleistocene epoch witnessed considerable climatic instability" - Graham proposed a third hypothesis that climatic instability in Pleistocene epoch drove some species disappear. The answer is "climatic instability".
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 19:</strong> "the increasingly homogeneous environment left them with shrinking geographical ranges" - Reduced geographical ranges posed a dangerous signal to these giants. The answer is "geographical ranges".
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 20:</strong> "the final major fluctuation – the so-called Younger Dryas event – pushed them over the edge" - The Younger Dryas event finally wiped them out. The answer is "Younger Dryas event".
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 21:</strong> "The overkill model explains everything the disease and climate scenarios explain, he asserts, and makes accurate predictions about which species would eventually go extinct" - This statement matches John Alroy (A), who supports the overkill model and explains which species would disappear.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 22:</strong> "So far MacPhee does not have empirical evidence for the hyper disease hypotheses, and it won't be easy to come by" - This statement matches Ross D. E. MacPhee (B), who needs further grounded proof to explain human's indirect impact on mammals.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 23:</strong> "hunting-driven extinction is not only plausible, but it was only unavoidable. He has determined, using a computer simulation, that even a very modest amount of hunting would have wiped these animals out" - This statement matches John Alroy (A), who argues that overhunting situation has caused die-out of large mammals.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 24:</strong> "Rather he suggests that people may have introduced hyper lethal disease, perhaps through their dogs or hitchhiking vermin, which then spread wildly among the immunologically naive species of the New World" - This statement matches Ross D. E. MacPhee (B), who argues that illness rather than hunting caused extensive extinction.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 25:</strong> "the relevant archaeological record contains barely a dozen examples of stone points embedded in mammoth bones (and none, it should be noted, are known from other megafaunal remains) – hardly what one might expect if hunting drove these animals to extinction" - This statement matches Ross D. E. MacPhee (B), who raises doubt through the study of several fossil records.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 26:</strong> "The Pleistocene epoch witnessed considerable climatic instability, explains palaeontologist Russell W. Graham of the Denver Museum of Nature and Science. As a result, certain habitats disappeared, and species that had once formed communities split apart" - This statement matches Russell W. Graham (C), who argues that climate shift is the main reason for extinction.
                        </p>
                    </div>
                    
                    <!-- Explanation Button for Part 2 -->
                    <div style="text-align: center; margin-top: 30px;">
                        <button id="show-explanation-btn" onclick="toggleExplanation()" style="background-color: #dc3545; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer; transition: background-color 0.2s;">
                            Hide Explanation
                        </button>
                    </div>
                    
                    
                    
                    <!-- Part 3 Explanation Section -->
                    <div id="part-3-explanation" class="explanation-section hidden" style="margin-top: 40px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                        <h3 style="color: #333; margin-bottom: 20px; text-align: center;">Part 3 Explanation</h3>
                        <div class="explanation-content">
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 27:</strong> "Contracts, rules and legislation are invariably written in the local language, and a company unable to operate in that language is vulnerable." This passage mentions that companies deal with overseas clients, which corresponds to answer B (clients).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 28:</strong> "Contracts, rules and legislation are invariably written in the local language..." This passage mentions key documents like contracts and rules, which corresponds to answer F (documents).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 29:</strong> "Essentially what this means is to muddle through, relying on a mix of languages, pidgins and gestures to communicate..." This passage mentions gestures as part of communication, which corresponds to answer A (gestures).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 30:</strong> "Hagen's recent study suggests that 16% of an international business transaction; is conducted in a 'cocktail of languages.'" This passage mentions business transactions, which corresponds to answer C (transaction).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 31:</strong> "For a start these services can be very expensive with a top Simultaneous Interpreter, commanding daily rates as high as a partner in an international consulting company." This passage mentions that translation services are costly, which corresponds to answer L (costly).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 32:</strong> "This clearly injects a potential source of misunderstanding into the proceedings." This passage mentions that interpreters have to use understanding and assumption, which corresponds to answer D (understanding and assumption).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 33:</strong> "The immediate and understandable reaction to any skills-shortage in business is to consider personnel development..." This passage mentions that training pays attention to personnel development.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 34:</strong> "When belts get tightened training is one of the first 'luxuries' to be pared down." This passage describes training as the first luxury during economic depression.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 35:</strong> "One notable and committed leader in the field of language training has been the Volkswagen Group. They have developed a language strategy over many years..." This passage mentions that Volkswagen Group developed/set up a language strategy for multinational companies.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 36:</strong> "However, the Volkswagen approach underlines that language training has to be considered a strategic rather than a tactical solution." This passage mentions that Volkswagen Group considers language training as a strategic solution.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 37:</strong> "In their system to progress from 'basics' to 'communications competence' in a language requires the completion of 6 languages stages..." This passage mentions that 6 stages are needed from basic to advanced training.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 38:</strong> "...each one demanding approximately 90 hours of a refresher course..." This passage mentions that a single-stage refresher course needs 90 hours.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 39:</strong> "So even this professionally managed program expects a minimum of three years of fairly intensive study to produce an accountant. Engineer, buyer or salesperson capable of working effectively in a foreign language." This passage mentions that at least three years are needed for a specific professional to acquire a foreign language.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 40:</strong> The main function of this passage is to evaluate various approaches for language barrier in multinational companies, as it discusses different strategies like lingua franca, functional multilingualism, external resources, and training. This corresponds to answer C.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Arrows -->
    <div class="nav-arrows">
        <button class="nav-arrow" onclick="previousQuestion()" id="prevBtn">‹</button>
        <button class="nav-arrow" onclick="nextQuestion()" id="nextBtn">›</button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-row perScorableItem" aria-label="Questions">
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(1)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">1</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(1)"><span class="sr-only">Question 1</span><span aria-hidden="true">1</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(2)"><span class="sr-only">Question 2</span><span aria-hidden="true">2</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(3)"><span class="sr-only">Question 3</span><span aria-hidden="true">3</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(4)"><span class="sr-only">Question 4</span><span aria-hidden="true">4</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(5)"><span class="sr-only">Question 5</span><span aria-hidden="true">5</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(6)"><span class="sr-only">Question 6</span><span aria-hidden="true">6</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(7)"><span class="sr-only">Question 7</span><span aria-hidden="true">7</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(8)"><span class="sr-only">Question 8</span><span aria-hidden="true">8</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(9)"><span class="sr-only">Question 9</span><span aria-hidden="true">9</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(10)"><span class="sr-only">Question 10</span><span aria-hidden="true">10</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(11)"><span class="sr-only">Question 11</span><span aria-hidden="true">11</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(12)"><span class="sr-only">Question 12</span><span aria-hidden="true">12</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(13)"><span class="sr-only">Question 13</span><span aria-hidden="true">13</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 selected multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(2)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">2</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(14)"><span class="sr-only">Question 14</span><span aria-hidden="true">14</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(15)"><span class="sr-only">Question 15</span><span aria-hidden="true">15</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(16)"><span class="sr-only">Question 16</span><span aria-hidden="true">16</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(17)"><span class="sr-only">Question 17</span><span aria-hidden="true">17</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(18)"><span class="sr-only">Question 18</span><span aria-hidden="true">18</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(19)"><span class="sr-only">Question 19</span><span aria-hidden="true">19</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(20)"><span class="sr-only">Question 20</span><span aria-hidden="true">20</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(21)"><span class="sr-only">Question 21</span><span aria-hidden="true">21</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(22)"><span class="sr-only">Question 22</span><span aria-hidden="true">22</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(23)"><span class="sr-only">Question 23</span><span aria-hidden="true">23</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(24)"><span class="sr-only">Question 24</span><span aria-hidden="true">24</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(25)"><span class="sr-only">Question 25</span><span aria-hidden="true">25</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(26)"><span class="sr-only">Question 26</span><span aria-hidden="true">26</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(3)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">3</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 14</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(27)"><span class="sr-only">Question 27</span><span aria-hidden="true">27</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(28)"><span class="sr-only">Question 28</span><span aria-hidden="true">28</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(29)"><span class="sr-only">Question 29</span><span aria-hidden="true">29</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(30)"><span class="sr-only">Question 30</span><span aria-hidden="true">30</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(31)"><span class="sr-only">Question 31</span><span aria-hidden="true">31</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(32)"><span class="sr-only">Question 32</span><span aria-hidden="true">32</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(33)"><span class="sr-only">Question 33</span><span aria-hidden="true">33</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(34)"><span class="sr-only">Question 34</span><span aria-hidden="true">34</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(35)"><span class="sr-only">Question 35</span><span aria-hidden="true">35</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(36)"><span class="sr-only">Question 36</span><span aria-hidden="true">36</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(37)"><span class="sr-only">Question 37</span><span aria-hidden="true">37</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(38)"><span class="sr-only">Question 38</span><span aria-hidden="true">38</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(39)"><span class="sr-only">Question 39</span><span aria-hidden="true">39</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(40)"><span class="sr-only">Question 40</span><span aria-hidden="true">40</span></button>
            </div>
        </div>
        
        <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton___3FM07">
            <i class="fa fa fa-check" aria-hidden="true"></i>
            <span>Check Answers</span>
        </button>
    </nav>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div id="menu-highlight" class="context-menu-item" onclick="highlightText()">
            Highlight
        </div>
        <div id="menu-note" class="context-menu-item" onclick="addNote()">
            Note
        </div>
        <div id="menu-clear" class="context-menu-item" onclick="clearHighlight()">
            Clear
        </div>
        <div id="menu-clear-all" class="context-menu-item" onclick="clearAllHighlights()">
            Clear All
        </div>
    </div>

    <div id="results-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closeResultsModal()">&times;</button>
            <h2>Results</h2>
            <div class="results-summary">
                <p>Score: <span id="results-score"></span> / 40</p>
                <p>IELTS Band: <span id="results-band"></span></p>
            </div>
            <div id="results-details" class="results-details-container">
                <!-- Results for each question will be injected here -->
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- STATE VARIABLES ---
        let currentPassage = 1;
        let currentQuestion = 1;
        let selectedRange = null;
        let timeInSeconds = 3600;
        let timerInterval;
        let draggedItem = null;
        let activeQuestionElement = null;
        let selectedDragItem = null;

        // --- GLOBAL FUNCTIONS ---
        function getFirstQuestionOfPart(part) {
            switch(part) {
                case 1: return 1;
                case 2: return 14;
                case 3: return 27;
                default: return 1;
            }
        }

        // --- DOM ELEMENTS ---
        const timerDisplay = document.querySelector('.timer-display');
        const timerToggleButton = document.getElementById('timer-toggle-btn');
        const timerResetButton = document.getElementById('timer-reset-btn');
        const deliverButton = document.getElementById('deliver-button');
        const resizer = document.getElementById('resizer');
        const passagePanel = document.getElementById('passage-panel');
        const questionsPanel = document.getElementById('questions-panel');
        const contextMenu = document.getElementById('contextMenu');

        // --- ICON SVGs ---
        const playIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>';
        const pauseIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';

        // --- ANSWERS ---
        const correctAnswers = {
            '1': 'NOT GIVEN', '2': 'FALSE', '3': 'NOT GIVEN', '4': 'TRUE', '5': 'evergreen',
            '6': 'natural pesticides', '7': 'powder', '8': 'overnight', '9': 'neem cake',
            '10': 'doubles', '11': 'nitrogen', '12': ['In 2000', '2000'], '13': 'Neem seeds',
            '14': 'hunting', '15': 'overkill model', '16': ['disease', 'hyper disease'], '17': 'empirical evidence', '18': 'climatic instability',
            '19': 'geographical ranges', '20': 'Younger Dryas event', '21': 'A',
            '22': 'B', '23': 'A', '24': 'B', '25': 'B', '26': 'C',
            '27': 'B', '28': 'F', '29': 'A', '30': 'C', '31': 'L', '32': 'D',
            '33': ['personnel development'], '34': ['the first luxury', 'first luxury', 'luxury'], '35': ['developed', 'set'], '36': ['strategic solution'], '37': ['6 stages', 'six stages'],
            '38': ['90 hours', 'ninety hours'], '39': ['three years', '3 years'],
            '40': 'C'
        };

        // --- INITIALIZATION ---
        function initialize() {
            console.log(`🚀 Initializing application...`);
            startTimer();
            initializeDragAndDrop();
            setupCheckboxLimits();
            setupExampleHeading();
            console.log(`📋 Setting up initial state - switching to part 1`);
            switchToPart(1); // Also calls goToQuestion(1) and updateNavigation
            
            document.body.addEventListener('input', updateAllIndicators);
            document.body.addEventListener('change', updateAllIndicators);
            deliverButton.addEventListener('click', checkAnswers);
            timerToggleButton.addEventListener('click', toggleTimer);
            timerResetButton.addEventListener('click', resetTimer);

            // Add click listeners to question containers for navigation
            document.querySelectorAll('[data-q-start]').forEach(el => {
                el.addEventListener('click', (event) => {
                    // Stop event propagation to prevent parent container clicks
                    event.stopPropagation();
                    
                    const qNum = parseInt(el.dataset.qStart, 10);
                    const qEnd = parseInt(el.dataset.qEnd, 10);
                    
                    console.log(`🖱️ Question container clicked - qNum: ${qNum}, qEnd: ${qEnd}, currentQuestion: ${currentQuestion}, element:`, el);
                    
                    // Handle cases where qNum is NaN
                    if (isNaN(qNum)) {
                        console.log(`ℹ️ Container without valid question number, ignoring navigation`);
                        return;
                    }
                    
                    // Only navigate if this is a single question (qStart === qEnd) or if we're clicking on a specific question within a group
                    if (qNum === qEnd || el.classList.contains('tf-question')) {
                        if (currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum}`);
                            goToQuestion(qNum);
                        } else {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed`);
                        }
                    } else {
                        console.log(`ℹ️ Ignoring click on group container (${qNum}-${qEnd})`);
                    }
                });
            });
            
            // Add specific click listeners for individual question elements to prevent parent container interference
            document.querySelectorAll('.tf-question, .summary-text').forEach(el => {
                el.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const qNum = parseInt(el.dataset.qStart, 10);
                    console.log(`🎯 Individual question element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, element:`, el);
                    
                    // Handle cases where qNum is NaN (like .summary-text containers)
                    if (isNaN(qNum)) {
                        console.log(`ℹ️ Container without specific question number, ignoring navigation`);
                        return;
                    }
                    
                    if (currentQuestion !== qNum) {
                        console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (individual element)`);
                        goToQuestion(qNum);
                    } else {
                        console.log(`ℹ️ Already on question ${qNum}, no navigation needed (individual element)`);
                    }
                });
            });
            
            // Add specific click listeners for individual input elements in questions 33-36
            document.querySelectorAll('.answer-input[id^="q3"]').forEach(input => {
                input.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const qNum = parseInt(input.id.replace('q', ''), 10);
                    console.log(`📝 Input element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, input:`, input);
                    
                    if (currentQuestion !== qNum) {
                        console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (input element)`);
                        goToQuestion(qNum);
                    } else {
                        console.log(`ℹ️ Already on question ${qNum}, no navigation needed (input element)`);
                    }
                });
            });
            
            // Add click listeners for the paragraph elements containing questions 33-36
            document.querySelectorAll('.summary-text p').forEach(p => {
                p.addEventListener('click', (event) => {
                    event.stopPropagation();
                    // Extract question number from the paragraph text (e.g., "33" from "<strong>33</strong>")
                    const strongElement = p.querySelector('strong');
                    if (strongElement) {
                        const qNum = parseInt(strongElement.textContent, 10);
                        console.log(`📄 Summary paragraph clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, paragraph:`, p);
                        
                        if (!isNaN(qNum) && currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (summary paragraph)`);
                            goToQuestion(qNum);
                        } else if (!isNaN(qNum)) {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed (summary paragraph)`);
                        }
                    }
                });
            });

            resizer.addEventListener('mousedown', initResize, false);
            initializeContextMenu();
        }

        // --- CORE TEST LOGIC ---

        function checkAnswers() {
            // Determine current part based on visible question set
            let currentPart = 1;
            if (!document.getElementById('questions-2').classList.contains('hidden')) {
                currentPart = 2;
            } else if (!document.getElementById('questions-3').classList.contains('hidden')) {
                currentPart = 3;
            }
            
            // Disable all inputs to prevent changes
            const allInputs = document.querySelectorAll('input, select, textarea');
            allInputs.forEach(input => {
                input.disabled = true;
            });

            // Disable all drag and drop functionality
            document.querySelectorAll('.drag-item').forEach(item => {
                item.setAttribute('draggable', 'false');
                item.style.cursor = 'not-allowed';
                item.style.pointerEvents = 'none';
            });

            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.style.pointerEvents = 'none';
                zone.classList.add('disabled');
            });

            // Disable submit button
            deliverButton.disabled = true;
            deliverButton.style.cursor = 'not-allowed';
            
            clearInterval(timerInterval);
            let score = 0;
            const totalQuestions = 40;
            const resultsDetailsContainer = document.getElementById('results-details');
            resultsDetailsContainer.innerHTML = '';

            document.querySelectorAll('.correct, .incorrect, .correct-answer-highlight').forEach(el => {
                el.classList.remove('correct', 'incorrect', 'correct-answer-highlight');
            });
            document.querySelectorAll('.correct-answer-display').forEach(el => el.remove());

            for (let i = 1; i <= totalQuestions; i++) {
                const questionKey = String(i);
                const correctAnswer = correctAnswers[questionKey];
                let userAnswer = '';
                let isCorrect = false;
                
                let userAnswerDisplay = 'Not Answered';
                // Convert single correct answer to array for consistent processing
                let correctAnswerValues = Array.isArray(correctAnswer) ? correctAnswer : [correctAnswer];
                let correctAnswerText = correctAnswerValues.join(' / ');

                // Special handling for summary questions (27-32) to display full text from drag items
                if (i >= 27 && i <= 32) {
                    const texts = correctAnswerValues.map(val => {
                        const byValue = document.querySelector(`.drag-item[data-value="${val}"][data-dnd-group="summary-27-32"]`);
                        if (byValue) return byValue.textContent;
                        // Fallback to searching by text content if value doesn't match directly
                        const allItems = Array.from(document.querySelectorAll('.drag-item[data-dnd-group="summary-27-32"]'));
                        const byText = allItems.find(el => el.textContent.trim().toLowerCase() === String(val).trim().toLowerCase());
                        return byText ? byText.textContent : String(val);
                    });
                    correctAnswerText = texts.join(' / ');
                }


                const textInput = document.getElementById(`q${i}`);
                const radioGroup = document.querySelectorAll(`input[name="q${i}"][type="radio"]`);
                
                // Handle Text and Select Inputs
                if (textInput && (textInput.tagName === 'INPUT' || textInput.tagName === 'SELECT')) {
                    const element = textInput.closest('.matching-form-row') || textInput;
                    userAnswer = textInput.value.trim();
                    userAnswerDisplay = userAnswer || 'Not Answered';

                    isCorrect = correctAnswerValues.some(ans => userAnswer.toLowerCase() === String(ans).toLowerCase());
                    
                    if (isCorrect) {
                        score++;
                        element.classList.add('correct');
                    } else {
                        element.classList.add('incorrect');
                        const correctAnswerSpan = document.createElement('span');
                        correctAnswerSpan.className = 'correct-answer-display';
                        correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`;
                        textInput.parentNode.insertBefore(correctAnswerSpan, textInput.nextSibling);
                    }
                }
                // Handle summary completion questions (19-21) - Part 2 only
                else if ((i >= 19 && i <= 21) && document.querySelector(`.summary-drop-zone[data-q-start="${i}"]`)) {
                    console.log(`🔍 Checking summary completion question ${i}`);
                    const dropZone = document.querySelector(`.summary-drop-zone[data-q-start="${i}"]`);
                    
                    console.log(`📍 Drop zone for question ${i}:`, dropZone);
                    console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                    
                    if (dropZone && dropZone.classList.contains('filled')) {
                        userAnswer = dropZone.dataset.answer;
                        userAnswerDisplay = userAnswer;
                        isCorrect = correctAnswerValues.some(ans => userAnswer.toLowerCase() === String(ans).toLowerCase());
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        // Mark the drop zone as correct or incorrect
                        dropZone.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                        
                        // Show correct answer if wrong
                        if (!isCorrect && correctAnswer && dropZone) {
                            const correctAnswerSpan = document.createElement('span');
                            correctAnswerSpan.className = 'correct-answer-display';
                            // Find the correct drag item to get the full text
                            const correctDragItem = document.querySelector(`.drag-item[data-value="${correctAnswer}"][data-dnd-group="summary-19-21"]`);
                            const displayTxt = correctDragItem ? correctDragItem.textContent : correctAnswer;
                            correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${displayTxt}</span>`;
                            dropZone.appendChild(correctAnswerSpan);
                        }
                    } else {
                        // No answer provided - mark as incorrect
                        console.log(`⚠️ No answer provided for question ${i}`);
                        if (dropZone) {
                            dropZone.classList.add('incorrect');
                        }
                        if (correctAnswer && dropZone) {
                            const correctAnswerSpan = document.createElement('span');
                            correctAnswerSpan.className = 'correct-answer-display';
                            // Find the correct drag item to get the full text
                            const correctDragItem = document.querySelector(`.drag-item[data-value="${correctAnswer}"][data-dnd-group="summary-19-21"]`);
                            const displayTxt = correctDragItem ? correctDragItem.textContent : correctAnswer;
                            correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${displayTxt}</span>`;
                            dropZone.appendChild(correctAnswerSpan);
                        }
                    }
                }
                // Handle summary completion questions (27-32) - Part 3 only
                else if (i >= 27 && i <= 32) {
                    console.log(`🔍 Checking summary completion question ${i}`);
                    const dropZone = document.querySelector(`.summary-drop-zone[data-q-start="${i}"][data-dnd-group="summary-27-32"]`);
                    
                    console.log(`📍 Drop zone for question ${i}:`, dropZone);
                    console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                    
                    if (dropZone && dropZone.classList.contains('filled')) {
                        userAnswer = dropZone.dataset.answer;
                        // For questions 27-32, show the full text instead of just the letter
                        const userDragItem = document.querySelector(`.drag-item[data-value="${userAnswer}"][data-dnd-group="summary-27-32"]`);
                        userAnswerDisplay = userDragItem ? userDragItem.textContent : userAnswer;
                        
                        const userLetter = (userAnswer || '').toString().trim().toLowerCase();
                        const userText = (userAnswerDisplay || '').toString().trim().toLowerCase();
                        isCorrect = correctAnswerValues.some(ans => {
                            const target = String(ans).trim().toLowerCase();
                            return target === userLetter || target === userText;
                        });
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        // Mark the drop zone as correct or incorrect
                        dropZone.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                        
                        // Show correct answer if wrong
                        if (!isCorrect && correctAnswer && dropZone) {
                            const correctAnswerSpan = document.createElement('span');
                            correctAnswerSpan.className = 'correct-answer-display';
                            // Use correctAnswerText which already handles multiple values for display
                            correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`;
                            dropZone.appendChild(correctAnswerSpan);
                        }
                    } else {
                        // No answer provided - mark as incorrect
                        console.log(`⚠️ No answer provided for question ${i}`);
                        if (dropZone) {
                            dropZone.classList.add('incorrect');
                        }
                        if (correctAnswer && dropZone) {
                            const correctAnswerSpan = document.createElement('span');
                            correctAnswerSpan.className = 'correct-answer-display';
                            // Use correctAnswerText which already handles multiple values for display
                            correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`;
                            dropZone.appendChild(correctAnswerSpan);
                        }
                    }
                }
                // Handle Radio Button Inputs (T/F, MCQs)
                else if (radioGroup.length > 0) {
                    const questionContainer = radioGroup[0]?.closest('.tf-question') || radioGroup[0]?.closest('.multi-choice-question');
                    const checkedRadio = document.querySelector(`input[name="q${i}"]:checked`);

                    if (checkedRadio) {
                        userAnswer = checkedRadio.value;
                        userAnswerDisplay = userAnswer;
                        isCorrect = correctAnswerValues.includes(userAnswer);

                        const userLabel = checkedRadio.closest('.tf-option, .multi-choice-option');
                        if (userLabel) {
                            userLabel.classList.add(isCorrect ? 'correct' : 'incorrect');
                        }
                        
                        // Handle table radio buttons
                        if (checkedRadio.classList.contains('table-radio')) {
                            const tableCell = checkedRadio.closest('td');
                            if (tableCell) {
                                tableCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                            }
                        }
                    }

                    if (isCorrect) {
                        score++;
                    } else {
                        if (questionContainer){
                            correctAnswerValues.forEach(val => {
                                const el = questionContainer.querySelector(`input[value="${val}"]`);
                                el?.closest('.tf-option, .multi-choice-option')?.classList.add('correct-answer-highlight');
                            });
                        }
                    }
                }
                // Handle clickable cells for questions 21-26 - Part 2 only
                else if (i >= 21 && i <= 26) {
                    console.log(`🔍 Checking clickable cell question ${i}`);
                    const selectedCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-selected="true"]`);
                    console.log(`📍 Selected cell for question ${i}:`, selectedCell);
                    console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                    
                    if (selectedCell) {
                        userAnswer = selectedCell.dataset.answer;
                        userAnswerDisplay = userAnswer;
                        isCorrect = correctAnswerValues.includes(userAnswer);
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        selectedCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                    } else {
                        console.log(`⚠️ No answer provided for question ${i}`);
                        userAnswerDisplay = 'Not Answered';
                    }
                    
                    // Handle highlighting correct answers for incorrect responses
                    if (!isCorrect) {
                        correctAnswerValues.forEach(val => {
                            const cell = document.querySelector(`.clickable-cell[data-question="${i}"][data-value="${val}"]`);
                            if (cell) {
                                cell.classList.add('correct-answer-highlight');
                                console.log(`✅ Highlighted correct answer for question ${i}:`, cell);
                            }
                        });
                    }
                }
                // Handle Checkbox Inputs (Multiple choice questions like 24-26) - Part 2 only
                else if (i >= 24 && i <= 26 && currentPart === 2) {
                    const checkedCheckboxes = document.querySelectorAll(`input[name="q24-26"]:checked`);
                    const userAnswers = Array.from(checkedCheckboxes).map(cb => cb.value).sort();
                    const correctAnswersArr = Array.isArray(correctAnswer) ? correctAnswer : [correctAnswer];
                    const correctAnswersSorted = correctAnswersArr.sort();
                    
                    userAnswerDisplay = userAnswers.length > 0 ? userAnswers.join(', ') : 'Not Answered';
                    isCorrect = userAnswers.length === correctAnswersSorted.length && 
                               userAnswers.every((ans, index) => ans === correctAnswersSorted[index]);

                    if (isCorrect) {
                        score++;
                        checkedCheckboxes.forEach(cb => {
                            cb.closest('.multi-choice-option')?.classList.add('correct');
                        });
                    } else {
                        checkedCheckboxes.forEach(cb => {
                            cb.closest('.multi-choice-option')?.classList.add('incorrect');
                        });
                        // Highlight correct answers
                        correctAnswersArr.forEach(ansValue => {
                            const correctCheckbox = document.querySelector(`input[name="q24-26"][value="${ansValue}"]`);
                            if (correctCheckbox) {
                                correctCheckbox.closest('.multi-choice-option')?.classList.add('correct-answer-highlight');
                            }
                        });
                    }
                }
                 
                // For showing results in the modal
                 const resultRow = `
                    <div class="result-row ${isCorrect ? '' : 'incorrect'}">
                        <span class="q-num">${i}</span>
                        <span class="user-ans">${userAnswerDisplay}</span>
                        <span class="correct-ans">${correctAnswerText}</span>
                    </div>`;
                resultsDetailsContainer.innerHTML += resultRow;
                
                // Update nav button color
                const navButton = document.querySelector(`.subQuestion[onclick="goToQuestion(${i})"]`);
                if (navButton) {
                    navButton.classList.remove('answered', 'active');
                    navButton.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
            }

            document.getElementById('results-score').textContent = score;
            document.getElementById('results-band').textContent = calculateBandScore(score);
            document.getElementById('results-modal').classList.remove('hidden');
            
            // Change button to "My Result" with green styling
            deliverButton.innerHTML = `<span>My Result</span>`;
            deliverButton.style.backgroundColor = '#4CAF50';
            deliverButton.style.color = 'white';
            deliverButton.style.borderColor = '#4CAF50';
            deliverButton.disabled = false;
            deliverButton.style.cursor = 'pointer';
            deliverButton.removeEventListener('click', checkAnswers);
            deliverButton.addEventListener('click', showResultsModal);
            
            // Highlight correct answers in the passage
            highlightCorrectAnswersInPassage();
            
            // Show explanations with highlighting
            showExplanationsWithHighlighting();
        }

        function calculateBandScore(score) {
            if (score >= 39) return '9.0';
            const mapping = {
                40: 9.0, 39: 9.0, 38: 8.5, 37: 8.5, 36: 8.0, 35: 8.0, 34: 7.5,
                33: 7.5, 32: 7.0, 31: 7.0, 30: 7.0, 29: 6.5, 28: 6.5, 27: 6.5,
                26: 6.0, 25: 6.0, 24: 6.0, 23: 5.5, 22: 5.5, 21: 5.5, 20: 5.5,
                19: 5.0, 18: 5.0, 17: 5.0, 16: 5.0, 15: 5.0, 14: 4.5, 13: 4.5,
                12: 4.0, 11: 4.0, 10: 4.0, 9: 3.5, 8: 3.5, 7: 3.0, 6: 3.0,
                5: 2.5, 4: 2.5
            };
            if (score <= 0) return 0.0;
            if (score === 1) return 1.0;
            if (score <= 3) return 2.0;
            if (score <= 5) return 2.5;
            return mapping[score] || 0.0;
        }

        function highlightCorrectAnswersInPassage() {
            // Define the text passages and their corresponding question numbers for Part 1
            const part1Highlights = [
                {
                    question: 1,
                    text: "Cotton wooed farmers by promising to bring in more hard cash than the mixed crops they were already growing to eat and sell: millet, sorghum, groundnuts, pigeon peas, mung beans, chili and rice",
                    answer: "NOT GIVEN"
                },
                {
                    question: 2,
                    text: "But raising cotton meant using pesticides and fertilizers – until then a mystery to the mostly illiterate farmers of the community",
                    answer: "FALSE"
                },
                {
                    question: 3,
                    text: "At first, cotton yields were high, and expenses for pesticides were low because cotton pests had not yet moved in. The farmers had never earned so much!",
                    answer: "NOT GIVEN"
                },
                {
                    question: 4,
                    text: "But within a few years, cotton pests like bollworms and aphids plagued the fields, and the farmers saw how rapid insect evolution can be",
                    answer: "TRUE"
                },
                {
                    question: 5,
                    text: "Neem tree is a broad-leaved evergreen tree related to mahogany",
                    answer: "evergreen"
                },
                {
                    question: 6,
                    text: "It protects itself against insects by producing a multitude of natural pesticides that work in a variety of ways",
                    answer: "natural pesticides"
                },
                {
                    question: 7,
                    text: "To protect crops from insects, neem seeds are simply ground into a powder that is soaked overnight in water",
                    answer: "powder"
                },
                {
                    question: 8,
                    text: "To protect crops from insects, neem seeds are simply ground into a powder that is soaked overnight in water",
                    answer: "overnight"
                },
                {
                    question: 9,
                    text: "Another preparation, neem cake, can be mixed into the soil to kill pests and diseases in the soil",
                    answer: "neem cake"
                },
                {
                    question: 10,
                    text: "and it doubles as an organic fertilizer high in nitrogen",
                    answer: "doubles"
                },
                {
                    question: 11,
                    text: "and it doubles as an organic fertilizer high in nitrogen",
                    answer: "nitrogen"
                },
                {
                    question: 12,
                    text: "By 2000, all the farmers in Punukula were using NPM, not only for cotton but for their other crops as well",
                    answer: "2000"
                },
                {
                    question: 13,
                    text: "The women of Punukula created a new source of income by collecting, grinding, and selling neem seeds for NPM in other villages",
                    answer: "neem seeds"
                }
            ];

            // Define the text passages and their corresponding question numbers for Part 2
            const part2Highlights = [
                {
                    question: 14,
                    text: "hunting drove this megafaunal menagerie to extinction",
                    answer: "hunting"
                },
                {
                    question: 15,
                    text: "The overkill model emerged in the 1960s when it was put forth by Paul S. Martin of the University of Arizona",
                    answer: "overkill model"
                },
                {
                    question: 16,
                    text: "people may have introduced hyper lethal disease, perhaps through their dogs or hitchhiking vermin",
                    answer: "disease"
                },
                {
                    question: 17,
                    text: "So far MacPhee does not have empirical evidence for the hyper disease hypotheses, and it won't be easy to come by",
                    answer: "empirical evidence"
                },
                {
                    question: 18,
                    text: "The Pleistocene epoch witnessed considerable climatic instability",
                    answer: "climatic instability"
                },
                {
                    question: 19,
                    text: "the increasingly homogeneous environment left them with shrinking geographical ranges",
                    answer: "geographical ranges"
                },
                {
                    question: 20,
                    text: "the final major fluctuation – the so-called Younger Dryas event – pushed them over the edge",
                    answer: "Younger Dryas event"
                },
                {
                    question: 21,
                    text: "The overkill model explains everything the disease and climate scenarios explain, he asserts, and makes accurate predictions about which species would eventually go extinct",
                    answer: "A"
                },
                {
                    question: 22,
                    text: "So far MacPhee does not have empirical evidence for the hyper disease hypotheses, and it won't be easy to come by",
                    answer: "B"
                },
                {
                    question: 23,
                    text: "hunting-driven extinction is not only plausible, but it was only unavoidable. He has determined, using a computer simulation, that even a very modest amount of hunting would have wiped these animals out",
                    answer: "A"
                },
                {
                    question: 24,
                    text: "Rather he suggests that people may have introduced hyper lethal disease, perhaps through their dogs or hitchhiking vermin, which then spread wildly among the immunologically naive species of the New World",
                    answer: "B"
                },
                {
                    question: 25,
                    text: "the relevant archaeological record contains barely a dozen examples of stone points embedded in mammoth bones (and none, it should be noted, are known from other megafaunal remains) – hardly what one might expect if hunting drove these animals to extinction",
                    answer: "B"
                },
                {
                    question: 26,
                    text: "The Pleistocene epoch witnessed considerable climatic instability, explains palaeontologist Russell W. Graham of the Denver Museum of Nature and Science. As a result, certain habitats disappeared, and species that had once formed communities split apart",
                    answer: "C"
                }
            ];

            // Define the text passages and their corresponding question numbers for Part 3
            const part3Highlights = [
                {
                    question: 27,
                    text: "Contracts, rules and legislation are invariably written in the local language, and a company unable to operate in that language is vulnerable",
                    answer: "B"
                },
                {
                    question: 28,
                    text: "Contracts, rules and legislation are invariably written in the local language",
                    answer: "F"
                },
                {
                    question: 29,
                    text: "Essentially what this means is to muddle through, relying on a mix of languages, pidgins and gestures to communicate",
                    answer: "A"
                },
                {
                    question: 30,
                    text: "Hagen's recent study suggests that 16% of an international business transaction; is conducted in a 'cocktail of languages.'",
                    answer: "C"
                },
                {
                    question: 31,
                    text: "For a start these services can be very expensive with a top Simultaneous Interpreter, commanding daily rates as high as a partner in an international consulting company",
                    answer: "L"
                },
                {
                    question: 32,
                    text: "This clearly injects a potential source of misunderstanding into the proceedings",
                    answer: "D"
                },
                {
                    question: 33,
                    text: "The immediate and understandable reaction to any skills-shortage in business is to consider personnel development",
                    answer: "personnel development"
                },
                {
                    question: 34,
                    text: "When belts get tightened training is one of the first 'luxuries' to be pared down",
                    answer: "luxury"
                },
                {
                    question: 35,
                    text: "One notable and committed leader in the field of language training has been the Volkswagen Group. They have developed a language strategy over many years",
                    answer: "developed"
                },
                {
                    question: 36,
                    text: "However, the Volkswagen approach underlines that language training has to be considered a strategic rather than a tactical solution",
                    answer: "strategic solution"
                },
                {
                    question: 37,
                    text: "In their system to progress from 'basics' to 'communications competence' in a language requires the completion of 6 languages stages",
                    answer: "6 stages"
                },
                {
                    question: 38,
                    text: "each one demanding approximately 90 hours of a refresher course",
                    answer: "90 hours"
                },
                {
                    question: 39,
                    text: "So even this professionally managed program expects a minimum of three years of fairly intensive study to produce an accountant. Engineer, buyer or salesperson capable of working effectively in a foreign language",
                    answer: "three years"
                },
                {
                    question: 40,
                    text: "The importance of language management in multinational companies has never been greater than today",
                    answer: "C"
                }
            ];

            // Function to apply highlights to a passage
            function applyHighlights(passageElement, highlights) {
                if (!passageElement) return;

                // Clear any existing highlights
                passageElement.querySelectorAll('.answer-highlight').forEach(el => {
                    const parent = el.parentNode;
                    parent.replaceChild(document.createTextNode(el.textContent), el);
                    parent.normalize();
                });

                // Add highlights for each answer
                highlights.forEach(item => {
                    const paragraphs = passageElement.querySelectorAll('p');
                    paragraphs.forEach(paragraph => {
                        const text = paragraph.textContent;
                        // Use a regex to find all occurrences and replace
                        const regex = new RegExp(item.text.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi'); // Escape special chars for regex
                        if (regex.test(text)) {
                            const highlightedText = text.replace(
                                regex,
                                `<span class="answer-highlight" data-question="${item.question}" style="
                                    background-color: #ffeb3b;
                                    padding: 2px 4px;
                                    border-radius: 3px;
                                    font-weight: bold;
                                    position: relative;
                                ">$&<span style="
                                    position: absolute;
                                    top: -8px;
                                    right: -8px;
                                    background-color: #2196f3;
                                    color: white;
                                    border-radius: 50%;
                                    width: 20px;
                                    height: 20px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 12px;
                                    font-weight: bold;
                                ">${item.question}</span></span>`
                            );
                            paragraph.innerHTML = highlightedText;
                        }
                    });
                });
            }

            // Apply highlights to Part 1 (Bondi Beach)
            const passageText1 = document.getElementById('passage-text-1');
            applyHighlights(passageText1, part1Highlights);

            // Apply highlights to Part 2 (Reclaiming the Night)
            const passageText2 = document.getElementById('passage-text-2');
            applyHighlights(passageText2, part2Highlights);

            // Apply highlights to Part 3 (Language Strategy)
            const passageText3 = document.getElementById('passage-text-3');
            applyHighlights(passageText3, part3Highlights);
        }

        function getUserAnswer(qNum) {
            const textInput = document.getElementById(`q${qNum}`);
            const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
            const dropZone = document.querySelector(`.drop-zone[data-q-start="${qNum}"]`);
            const summaryDropZone = document.querySelector(`.summary-drop-zone[data-q-start="${qNum}"]`);

            if (textInput) { // Handles <input type="text"> and <select>
                return { value: textInput.value, text: textInput.value || 'N/A' };
            }
            if (radioInput) {
                return { value: radioInput.value, text: radioInput.value };
            }
            if (dropZone) {
                const droppedItem = dropZone.querySelector('.drag-item');
                return { 
                    value: droppedItem ? droppedItem.dataset.value : null, 
                    text: droppedItem ? droppedItem.textContent.trim() : 'N/A' 
                };
            }
            if (summaryDropZone) {
                if (summaryDropZone.classList.contains('filled')) {
                    return { 
                        value: summaryDropZone.dataset.answer, 
                        text: summaryDropZone.textContent.trim() 
                    };
                } else {
                    return { 
                        value: null, 
                        text: 'N/A' 
                    };
                }
            }
            // Handle clickable cells for questions 23-26 and 27-32
            if (qNum >= 21 && qNum <= 26) { // This condition is problematic if 21-22 are clickable cells too. It should be 21-26.
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return { value: selectedCell.dataset.answer, text: selectedCell.dataset.answer };
                }
            }
            if (qNum >= 27 && qNum <= 32) {
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return { value: selectedCell.dataset.value, text: selectedCell.dataset.value };
                }
            }
            return { value: null, text: 'N/A' };
        }

        function displayCorrectAnswer(qNum, correctAnswer) {
            // Handle summary completion questions (19-21)
            if (qNum >= 19 && qNum <= 21 && document.querySelector(`.summary-drop-zone[data-q-start="${qNum}"]`)) {
                const dropZone = document.querySelector(`.summary-drop-zone[data-q-start="${qNum}"]`);
                if (dropZone) {
                    const displaySpan = document.createElement('span');
                    displaySpan.className = 'correct-answer-display';
                    // Find the correct drag item to get the full text
                    const correctDragItem = document.querySelector(`.drag-item[data-value="${correctAnswer}"][data-dnd-group="summary-19-21"]`);
                    const correctAnswerText = correctDragItem ? correctDragItem.textContent : correctAnswer;
                    displaySpan.textContent = ` ✓ ${correctAnswerText}`;
                    dropZone.appendChild(displaySpan);
                }
                return;
            }
            
            // Handle table matching questions (27-32)
            if (qNum >= 27 && qNum <= 32) {
                const correctValues = Array.isArray(correctAnswer) ? correctAnswer : [correctAnswer];
                correctValues.forEach(val => {
                    const correctCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-value="${val}"]`);
                    if (correctCell) {
                        correctCell.classList.add('correct-answer-highlight');
                    }
                });
                return;
            }
            
            // Handle multi-choice group questions (e.g., 24-26, 38-40)
            if ((qNum >= 24 && qNum <= 26) || (qNum >= 38 && qNum <= 40)) { // This range for 24-26 is only for checkboxes in Part 2.
                const groupName = (qNum >= 24 && qNum <= 26) ? 'q24-26' : 'q38-40';
                const correctAnswersArr = Array.isArray(correctAnswer) ? correctAnswer : [correctAnswer];
                correctAnswersArr.forEach(ansValue => {
                    const correctInput = document.querySelector(`input[name="${groupName}"][value="${ansValue}"]`);
                    correctInput?.closest('.multi-choice-option')?.classList.add('correct-answer-highlight');
                });
                return;
            }

            // Handle radio button questions by highlighting the correct label
            const correctRadioInput = document.querySelector(`input[name="q${qNum}"][value="${correctAnswer}"]`);
            if (correctRadioInput) {
                const parentOption = correctRadioInput.closest('.tf-option, .multi-choice-option');
                if (parentOption) {
                    parentOption.classList.add('correct-answer-highlight');
                    return;
                }
            }

            // Handle text inputs, select dropdowns, and others by showing the answer next to them
            const inputEl = document.getElementById(`q${qNum}`);
            if (inputEl) {
                const displaySpan = document.createElement('span');
                displaySpan.className = 'correct-answer-display';
                const displayText = Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : correctAnswer;
                displaySpan.textContent = ` ✓ ${displayText}`;
                inputEl.insertAdjacentElement('afterend', displaySpan);
                return; // Done
            }
            
            // Fallback for questions identified by a container (e.g., some T/F/NG questions)
            const element = findQuestionElement(qNum);
            if (element) {
                const displaySpan = document.createElement('span');
                displaySpan.className = 'correct-answer-display';
                const displayText = Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : correctAnswer;
                displaySpan.textContent = ` ✓ ${displayText}`;
                const itemContainer = element.querySelector('.tf-question-text');
                if (itemContainer) {
                     itemContainer.appendChild(displaySpan);
                } else {
                     element.appendChild(displaySpan);
                }
            }
        }
        
        function findQuestionElement(qNum) {
             return document.querySelector(`[data-q-start="${qNum}"]`);
        }

        function addResultToModal(qNum, userAnswer, correctAnswer, isCorrect) {
            const resultsDetails = document.getElementById('results-details');
            const row = document.createElement('div');
            row.className = 'result-row';
            if (!isCorrect) {
                row.classList.add('incorrect');
            }
            // Ensure correctAnswer is displayed correctly if it's an array
            const displayCorrectAnswerText = Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : correctAnswer;
            row.innerHTML = `
                <span class="q-num">${qNum}</span>
                <span class="user-ans">${userAnswer}</span>
                <span class="correct-ans">${displayCorrectAnswerText}</span>
            `;
            resultsDetails.appendChild(row);
        }

        function showResultsModal() {
            document.getElementById('results-modal').classList.remove('hidden');
        }

        window.closeResultsModal = function() {
            document.getElementById('results-modal').classList.add('hidden');
        }
        
        function disableInputs() {
            deliverButton.innerHTML = `<span>Checked! View Results.</span>`;
            deliverButton.removeEventListener('click', checkAnswers);
            deliverButton.onclick = showResultsModal;

            document.querySelectorAll('input, select').forEach(el => {
                el.disabled = true;
                 if (el.matches('input[type=radio], input[type=checkbox]')) {
                     el.style.cursor = 'not-allowed';
                     el.parentElement.style.cursor = 'not-allowed';
                 }
            });
            document.querySelectorAll('.drag-item').forEach(el => {
                el.setAttribute('draggable', 'false');
                el.style.cursor = 'default';
            });
            document.querySelectorAll('.drop-zone').forEach(el => {
                el.classList.add('disabled');
            });
        }

        // This function is no longer strictly needed as logic is moved into checkAnswers, but keeping it for completeness if other parts of the code use it.
        function checkValue(userValue, correctValue) {
            if (userValue === null || userValue === undefined) return false;
            const formattedUserValue = userValue.trim().toLowerCase();
            if (Array.isArray(correctValue)) {
                return correctValue.map(v => String(v).toLowerCase()).includes(formattedUserValue);
            } else {
                return formattedUserValue === String(correctValue).toLowerCase();
            }
        }

        function markQuestion(qNum, isCorrect) {
            const subQuestionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
            subQuestionBtn?.classList.add(isCorrect ? 'correct' : 'incorrect');

            const elementsToMark = [
                document.querySelector(`.tf-question[data-q-start="${qNum}"]`),
                document.querySelector(`.multi-choice-question[data-q-start="${qNum}"]`),
                document.querySelector(`.matching-question-item[data-q-start="${qNum}"]`),
                document.querySelector(`.drop-zone[data-q-start="${qNum}"]`),
                document.getElementById(`q${qNum}`),
                document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.tf-option'),
                document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.multi-choice-option')
            ];
            
            elementsToMark.forEach(el => {
                if (el) el.classList.add(isCorrect ? 'correct' : 'incorrect');
            });

             if (qNum === 14 || qNum === 15) { // This seems to be a specific case. Review if still needed.
                const multiChoiceContainer = document.querySelector('.multi-choice-question[data-q-start="14"]');
                if (multiChoiceContainer) multiChoiceContainer.classList.add(isCorrect ? 'correct' : 'incorrect');
             } else if (qNum >= 1 && qNum <= 5) { // This seems to be a specific case for text inputs
                const pMatchInput = document.getElementById(`q${qNum}`);
                if (pMatchInput) pMatchInput.classList.add(isCorrect ? 'correct' : 'incorrect');
             } else if (qNum >= 38 && qNum <= 40) { // This seems to be for another MCQ group
                // For this group, individual options are marked, not the container.
             }
        }

        function switchToPart(partNumber) {
            console.log(`🔀 switchToPart called with partNumber: ${partNumber}, currentPassage: ${currentPassage}`);
            
            currentPassage = partNumber;

            // Hide all passages and questions
            document.querySelectorAll('.reading-passage, .question-set, .part-header').forEach(el => {
                el.classList.add('hidden');
            });

            // Show the correct passage, questions, and header
            document.getElementById(`passage-text-${partNumber}`).classList.remove('hidden');
            document.getElementById(`questions-${partNumber}`).classList.remove('hidden');
            document.getElementById(`part-header-${partNumber}`).classList.remove('hidden');

            // Update bottom navigation 'selected' state
            document.querySelectorAll('.footer__questionWrapper___1tZ46').forEach((wrapper, index) => {
                wrapper.classList.toggle('selected', (index + 1) === partNumber);
            });

            // Show/hide explanation buttons based on part
            const explanationButton = document.getElementById('show-explanation-btn');
            const explanationButtonPart3 = document.getElementById('show-explanation-btn-part3');
            
            if (explanationButton) {
                if (partNumber === 2) {
                    explanationButton.style.display = 'block';
                } else {
                    explanationButton.style.display = 'none';
                    // Hide explanation section when switching away from part 2
                    const explanationSection = document.getElementById('part-2-explanation');
                    if (explanationSection) {
                        explanationSection.classList.add('hidden');
                        explanationButton.textContent = 'Show Explanation';
                        explanationButton.style.backgroundColor = '#4a90e2';
                    }
                }
            }
            
            if (explanationButtonPart3) {
                if (partNumber === 3) {
                    explanationButtonPart3.style.display = 'block';
                } else {
                    explanationButtonPart3.style.display = 'none';
                    // Hide explanation section when switching away from part 3
                    const explanationSection = document.getElementById('part-3-explanation');
                    if (explanationSection) {
                        explanationSection.classList.add('hidden');
                        explanationButtonPart3.textContent = 'Show Explanation';
                        explanationButtonPart3.style.backgroundColor = '#4a90e2';
                    }
                }
            }

            console.log(`✅ switchToPart completed - switched to part ${partNumber}`);
            
            // Only go to first question when switching parts, not when staying in same part
            // This allows goToQuestion to work properly for specific question navigation
            // const firstQuestionOfPart = {1: 1, 2: 14, 3: 27}[partNumber];
            // goToQuestion(firstQuestionOfPart);
        }
        
        function goToQuestion(questionNumber) {
            console.log(`🎯 goToQuestion called with questionNumber: ${questionNumber}, currentQuestion: ${currentQuestion}, currentPassage: ${currentPassage}`);
            
            currentQuestion = questionNumber;

            let passageNumber = 1;
            if (questionNumber >= 14 && questionNumber <= 26) passageNumber = 2;
            else if (questionNumber >= 27) passageNumber = 3;
            
            console.log(`📍 Calculated passageNumber: ${passageNumber} for question ${questionNumber}`);
            
            if (currentPassage !== passageNumber) {
                console.log(`🔄 Switching from part ${currentPassage} to part ${passageNumber} for question ${questionNumber}`);
                switchToPart(passageNumber);
                return; 
            }

            console.log(`✅ Staying in same part (${currentPassage}) for question ${questionNumber}`);

            if (activeQuestionElement) {
                activeQuestionElement.classList.remove('active-question', 'active-input');
            }

            // First, try to find the specific input element for questions 33-36
            let targetEl = document.getElementById(`q${questionNumber}`);
            if (targetEl) {
                activeQuestionElement = targetEl;
                console.log(`✅ Found specific input element:`, targetEl);
                targetEl.classList.add('active-input');
                scrollIntoViewIfNeeded(targetEl);
            } else {
                // Fall back to looking for question containers
                targetEl = document.querySelector(`[data-q-start="${questionNumber}"]`);
                console.log(`🔍 Looking for target element with data-q-start="${questionNumber}":`, targetEl);

                if (targetEl) {
                    activeQuestionElement = targetEl;
                    console.log(`✅ Found target element:`, targetEl);
                    
                    if (targetEl.matches('input[type="text"]') || targetEl.matches('select')) {
                        targetEl.classList.add('active-input');
                        console.log(`📝 Added active-input class to input/select element`);
                    } else {
                        targetEl.classList.add('active-question');
                        console.log(`📋 Added active-question class to question element`);
                    }
                    scrollIntoViewIfNeeded(targetEl);
                } else {
                    console.log(`⚠️ Target element not found, looking for paragraph matching question`);
                    const pMatch = document.querySelector(`.paragraph-matching-question select[id="q${questionNumber}"]`);
                    if(pMatch) {
                        activeQuestionElement = pMatch;
                        pMatch.classList.add('active-input');
                        scrollIntoViewIfNeeded(pMatch);
                        console.log(`✅ Found paragraph matching question:`, pMatch);
                    } else {
                        console.log(`❌ No target element found for question ${questionNumber}`);
                    }
                }
            }

            updateNavigation();
            console.log(`✅ goToQuestion completed for question ${questionNumber}`);
        }
        
        // --- UI & NAVIGATION ---

        function updateNavigation() {
            console.log(`🔄 updateNavigation called for currentQuestion: ${currentQuestion}`);
            
            const navButtons = document.querySelectorAll('.subQuestion');
            navButtons.forEach(btn => btn.classList.remove('active'));
            const activeNav = document.querySelector(`.subQuestion[onclick="goToQuestion(${currentQuestion})"]`);
            if (activeNav) {
                activeNav.classList.add('active');
                console.log(`✅ Updated navigation - active nav button:`, activeNav);
            } else {
                console.log(`⚠️ No active navigation button found for question ${currentQuestion}`);
            }

            const inputs = document.querySelectorAll('.answer-input, .drop-zone.filled, .summary-drop-zone.filled');
            inputs.forEach(input => input.classList.remove('active-input'));
            
            const activeInput = document.getElementById(`q${currentQuestion}`);
            if (activeInput) {
                activeInput.classList.add('active-input');
                if (typeof activeInput.focus === 'function') {
                    activeInput.focus();
                }
                console.log(`✅ Focused on input element:`, activeInput);
            } else {
                console.log(`⚠️ No direct input found for question ${currentQuestion}, looking in question block`);
                const activeQuestionBlock = document.querySelector(`[data-q-start="${currentQuestion}"]`);
                if (activeQuestionBlock) {
                    const firstInput = activeQuestionBlock.querySelector('input, select');
                    if(firstInput) {
                        firstInput.classList.add('active-input');
                         if (typeof firstInput.focus === 'function') {
                            firstInput.focus();
                        }
                        console.log(`✅ Focused on input in question block:`, firstInput);
                    } else {
                        console.log(`⚠️ No input found in question block for question ${currentQuestion}`);
                    }
                } else {
                    console.log(`❌ No question block found for question ${currentQuestion}`);
                }
            }
            
            console.log(`✅ updateNavigation completed`);
        }
        
        function selectDragItem(item) {
            if (selectedDragItem) {
                selectedDragItem.classList.remove('selected');
            }
            selectedDragItem = item;
            if (selectedDragItem) {
                selectedDragItem.classList.add('selected');
            }
        }
        
        window.nextQuestion = () => currentQuestion < 40 && goToQuestion(currentQuestion + 1);
        window.previousQuestion = () => currentQuestion > 1 && goToQuestion(currentQuestion - 1);

        function updateAllIndicators() {
            updateAttemptedCount(1, 1, 13);
            updateAttemptedCount(2, 14, 26);
            updateAttemptedCount(3, 27, 40);
            updateAnsweredNav();
        }
        
        function updateAnswer(questionId, value) {
            // This function updates the answer tracking for a specific question
            // The actual answer tracking is handled by the UI elements themselves
            console.log(`📝 Updating answer for question ${questionId}: ${value}`);
            updateAllIndicators();
        }

        function updateAnsweredNav() {
            const navButtons = document.querySelectorAll('.subQuestion');
            navButtons.forEach(btn => {
                const qNum = parseInt(btn.textContent, 10);
                if (isQuestionAnswered(qNum)) {
                    btn.classList.add('answered');
                } else {
                    btn.classList.remove('answered');
                }
            });
        }
        
        function isQuestionAnswered(qNum) {
            const textInput = document.getElementById(`q${qNum}`);
            if (textInput && (textInput.value.trim() !== '' || (textInput.classList.contains('drop-zone') && textInput.children.length > 0))) {
                return true;
            }
            const radio = document.querySelector(`input[name="q${qNum}"]:checked`);
            if (radio) {
                return true;
            }
            const checkbox = document.querySelector(`input[name="q${qNum}"]:checked`);
            if (checkbox) {
                return true;
            }
            // Handle summary drop zones for questions 19-21
            const summaryDropZone = document.querySelector(`.summary-drop-zone[data-q-start="${qNum}"]`);
            if (summaryDropZone && summaryDropZone.classList.contains('filled')) {
                return true;
            }
            // Handle summary drop zones for questions 27-32
            const summaryDropZone2732 = document.querySelector(`.summary-drop-zone[data-q-start="${qNum}"][data-dnd-group="summary-27-32"]`);
            if (summaryDropZone2732 && summaryDropZone2732.classList.contains('filled')) {
                return true;
            }
            // Handle clickable cells for questions 23-26 and 27-32
            if (qNum >= 21 && qNum <= 26) {
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return true;
                }
            }
            if (qNum >= 27 && qNum <= 32) {
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return true;
                }
            }
            return false;
        }

        function scrollIntoViewIfNeeded(element) {
            const panel = element.closest('.questions-panel, .passage-panel');
            const panelRect = panel.getBoundingClientRect();
            const elementRect = element.getBoundingClientRect();
            if (elementRect.top < panelRect.top || elementRect.bottom > panelRect.bottom) {
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        // --- DRAG AND DROP ---
        
        function initializeDragAndDrop() {
            // Initialize general drag and drop for other questions
            document.querySelectorAll('.drag-item:not([data-dnd-group="summary-19-21"])').forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('click', () => selectDragItem(item));
            });
            document.querySelectorAll('.drop-zone, .drag-options-container').forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });
            
            // Initialize drag and drop for Questions 19-21
            initializeQuestions1921DragDrop();
            
            // Initialize drag and drop for Questions 27-32
            initializeQuestions2732DragDrop();
        }
        
        function initializeQuestions1921DragDrop() {
            const dragItems = document.querySelectorAll('.drag-item[data-dnd-group="summary-19-21"]');
            const dropZones = document.querySelectorAll('.summary-drop-zone[data-dnd-group="summary-19-21"]');
            
            console.log('Initializing drag and drop for questions 19-21');
            console.log('Drag items found:', dragItems.length);
            console.log('Drop zones found:', dropZones.length);
            
            dragItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    console.log('Drag start:', item.dataset.value);
                    e.dataTransfer.setData('text/plain', item.dataset.value);
                    item.classList.add('dragging');
                });
                
                item.addEventListener('dragend', (e) => {
                    console.log('Drag end');
                    item.classList.remove('dragging');
                });
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.style.borderColor = '#4a90e2';
                    zone.style.background = '#f0f8ff';
                });
                
                zone.addEventListener('dragleave', (e) => {
                    if (!zone.contains(e.relatedTarget)) {
                        zone.style.borderColor = '#999';
                        zone.style.background = '#fafafa';
                    }
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    console.log('Drop event triggered');
                    const value = e.dataTransfer.getData('text/plain');
                    console.log('Dropped value:', value);
                    
                    // Find the drag item
                    const dragItem = document.querySelector(`.drag-item[data-value="${value}"][data-dnd-group="summary-19-21"]`);
                    console.log('Found drag item:', dragItem);
                    
                    if (dragItem) {
                        // If the drop zone is already filled, return the previous item to the options
                        if (zone.classList.contains('filled')) {
                            const previousValue = zone.dataset.answer;
                            const previousItem = document.querySelector(`.drag-item[data-value="${previousValue}"][data-dnd-group="summary-19-21"]`);
                            if (previousItem) {
                                previousItem.style.display = 'block';
                                previousItem.classList.remove('used');
                            }
                        }
                        
                        // Hide the dragged item from the options list
                        dragItem.style.display = 'none';
                        dragItem.classList.add('used');
                        
                        // Add to new drop zone
                        zone.textContent = dragItem.textContent;
                        zone.dataset.answer = value;
                        zone.classList.add('filled');
                        
                        // Update answer tracking
                        const questionId = zone.dataset.qStart;
                        console.log('Updating answer for question:', questionId, 'with value:', value);
                        updateAnswer(questionId, value);
                    }
                    
                    zone.style.borderColor = '#999';
                    zone.style.background = '#fafafa';
                });
                
                // Add click to remove functionality
                zone.addEventListener('click', (e) => {
                    if (zone.classList.contains('filled')) {
                        const value = zone.dataset.answer;
                        const dragItem = document.querySelector(`.drag-item[data-value="${value}"][data-dnd-group="summary-19-21"]`);
                        
                        if (dragItem) {
                            // Show the item back in the options list
                            dragItem.style.display = 'block';
                            dragItem.classList.remove('used');
                        }
                        
                        // Clear the drop zone
                        zone.textContent = zone.dataset.qStart;
                        zone.classList.remove('filled');
                        zone.dataset.answer = '';
                        
                        const questionId = zone.dataset.qStart;
                        updateAnswer(questionId, '');
                    }
                });
            });
        }
        
        function initializeQuestions2732DragDrop() {
            const dragItems = document.querySelectorAll('.drag-item[data-dnd-group="summary-27-32"]');
            const dropZones = document.querySelectorAll('.summary-drop-zone[data-dnd-group="summary-27-32"]');
            
            console.log('Initializing drag and drop for questions 27-32');
            console.log('Drag items found:', dragItems.length);
            console.log('Drop zones found:', dropZones.length);
            
            dragItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    console.log('Drag start:', item.dataset.value);
                    e.dataTransfer.setData('text/plain', item.dataset.value);
                    item.classList.add('dragging');
                });
                
                item.addEventListener('dragend', (e) => {
                    console.log('Drag end');
                    item.classList.remove('dragging');
                });
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.style.borderColor = '#4a90e2';
                    zone.style.background = '#f0f8ff';
                });
                
                zone.addEventListener('dragleave', (e) => {
                    if (!zone.contains(e.relatedTarget)) {
                        zone.style.borderColor = '#999';
                        zone.style.background = '#fafafa';
                    }
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    console.log('Drop event triggered');
                    const value = e.dataTransfer.getData('text/plain');
                    console.log('Dropped value:', value);
                    
                    // Find the drag item
                    const dragItem = document.querySelector(`.drag-item[data-value="${value}"][data-dnd-group="summary-27-32"]`);
                    console.log('Found drag item:', dragItem);
                    
                    if (dragItem) {
                        // If the drop zone is already filled, return the previous item to the options
                        if (zone.classList.contains('filled')) {
                            const previousValue = zone.dataset.answer;
                            const previousItem = document.querySelector(`.drag-item[data-value="${previousValue}"][data-dnd-group="summary-27-32"]`);
                            if (previousItem) {
                                previousItem.classList.remove('used');
                            }
                        }
                        
                        // Hide the dragged item from the options list but keep the space
                        dragItem.classList.add('used');
                        
                        // Add to new drop zone
                        zone.textContent = dragItem.textContent;
                        zone.dataset.answer = value;
                        zone.classList.add('filled');
                        
                        // Update answer tracking
                        const questionId = zone.dataset.qStart;
                        console.log('Updating answer for question:', questionId, 'with value:', value);
                        updateAnswer(questionId, value);
                        updateAllIndicators();
                    }
                    
                    zone.style.borderColor = '#999';
                    zone.style.background = '#fafafa';
                });
                
                // Add click to remove functionality - but allow replacement by dragging another item
                zone.addEventListener('click', (e) => {
                    // Only remove if no drag operation is in progress
                    if (zone.classList.contains('filled') && !draggedItem) {
                        const value = zone.dataset.answer;
                        const dragItem = document.querySelector(`.drag-item[data-value="${value}"][data-dnd-group="summary-27-32"]`);
                        
                        if (dragItem) {
                            // Show the item back in the options list
                            dragItem.classList.remove('used');
                        }
                        
                        // Clear the drop zone
                        zone.textContent = zone.dataset.qStart;
                        zone.classList.remove('filled');
                        zone.dataset.answer = '';
                        
                        const questionId = zone.dataset.qStart;
                        updateAnswer(questionId, '');
                        updateAllIndicators();
                    }
                });
            });
        }


        function handleDragStart(e) {
            draggedItem = e.target;
            setTimeout(() => e.target.classList.add('dragging'), 0);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedItem = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            const targetZone = e.currentTarget;
            if (draggedItem && draggedItem.dataset.dndGroup === targetZone.dataset.dndGroup) {
                targetZone.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const targetZone = e.currentTarget;
            targetZone.classList.remove('drag-over');

            if (!draggedItem || draggedItem.dataset.dndGroup !== targetZone.dataset.dndGroup) {
                return;
            }

            const sourceZone = draggedItem.parentElement;
            if (sourceZone === targetZone) return; // Prevent dropping on itself

            const existingItemInTarget = targetZone.classList.contains('drop-zone') 
                ? targetZone.querySelector('.drag-item') 
                : null;

            // First, clear the target drop-zone of any text (like question numbers) before adding the new item.
            if (targetZone.classList.contains('drop-zone')) {
                Array.from(targetZone.childNodes).forEach(node => {
                    if (node.nodeType === Node.TEXT_NODE) {
                        node.remove();
                    }
                });
            }

            // Move the item that was in the target (if any) to the source zone.
            if (existingItemInTarget) {
                sourceZone.appendChild(existingItemInTarget);
            }
            
            // Finally, move the dragged item to the target zone.
            targetZone.appendChild(draggedItem);
            targetZone.classList.add('filled');

            // After the move, clean up the source zone if it's a drop-zone and is now empty.
            if (sourceZone.classList.contains('drop-zone') && !sourceZone.querySelector('.drag-item')) {
                 sourceZone.classList.remove('filled');
                 const qNum = sourceZone.dataset.qStart;
                 sourceZone.innerText = qNum; // Restore the question number
            }
            
            // Handle summary drop zones specifically
            if (targetZone.classList.contains('summary-drop-zone')) {
                const questionId = targetZone.dataset.qStart;
                const value = draggedItem.dataset.value;
                updateAnswer(questionId, value);
            }
            
            updateAllIndicators();
        }
        
        // --- MISC HELPERS ---
        
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval); // Ensure no multiple intervals
            timerInterval = setInterval(() => {
                timeInSeconds--;
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                if (timeInSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "Time's up!";
                    // checkAnswers(); // Disabled to prevent modal from opening automatically.
                }
            }, 1000);
            timerToggleButton.innerHTML = pauseIcon;
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            timerToggleButton.innerHTML = playIcon;
        }

        function toggleTimer() {
            // Check based on the icon currently displayed
            if (timerToggleButton.innerHTML.includes('M6 19h4V5H6v14z')) { // Check for pause icon shape
                pauseTimer();
            } else {
                startTimer();
            }
        }

        function resetTimer() {
            timeInSeconds = 3600;
            const minutes = Math.floor(timeInSeconds / 60);
            const seconds = timeInSeconds % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            startTimer();
            timerToggleButton.innerHTML = pauseIcon;
        }
        
        function setupCheckboxLimits() {
            const checkboxGroups = [
                { name: 'q38-40', limit: 3 }
            ];
            checkboxGroups.forEach(group => {
                const checkboxes = document.querySelectorAll(`input[name="${group.name}"]`);
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        const checkedCount = document.querySelectorAll(`input[name="${group.name}"]:checked`).length;
                        if (checkedCount > group.limit) checkbox.checked = false;
                        updateAllIndicators();
                    });
                });
            });
        }

        function setupExampleHeading() {
            const exampleBox = document.querySelector('.example-box');
            if(exampleBox){
                const title = document.createElement('p');
                title.style.fontWeight = 'bold';
                title.textContent = 'List of Statements';
                // exampleBox.insertBefore(title, exampleBox.firstChild);
            }
        }
        
        function initResize(e) {
            e.preventDefault();
            const startX = e.clientX;
            const startWidth = passagePanel.offsetWidth;
            
            const doDrag = (e) => {
                const newWidth = startWidth + e.clientX - startX;
                if (newWidth > 200 && (document.body.clientWidth - newWidth - resizer.offsetWidth) > 200) {
                    passagePanel.style.flex = `0 0 ${newWidth}px`;
                }
            };
            const stopDrag = () => {
                window.removeEventListener('mousemove', doDrag, false);
                window.removeEventListener('mouseup', stopDrag, false);
            };
            
            window.addEventListener('mousemove', doDrag, false);
            window.addEventListener('mouseup', stopDrag, false);
        }
        
        // --- CONTEXT MENU (Highlighting) ---
        
        function initializeContextMenu() {
            const panels = [passagePanel, questionsPanel];
            let targetElementForClear = null;

            // This listener simply tracks the last valid text selection in either panel.
            document.addEventListener('selectionchange', () => {
                const selection = window.getSelection();
                if (selection && !selection.isCollapsed && selection.toString().trim().length > 0) {
                    const range = selection.getRangeAt(0);
                    if (panels.some(panel => panel.contains(range.commonAncestorContainer))) {
                        selectedRange = range;
                        targetElementForClear = null; // New selection overrides clearing a specific element
                    }
                }
            });

            const showContextMenu = (e) => {
                const target = e.target;
                const isClickOnHighlight = target.closest('.highlight, .comment-highlight');
                const isSelectionActive = selectedRange && selectedRange.toString().trim().length > 0;
                
                let showMenu = false;

                if (isClickOnHighlight) {
                    document.getElementById('menu-highlight').style.display = 'none';
                    document.getElementById('menu-note').style.display = 'none';
                    document.getElementById('menu-clear').style.display = 'block';
                    document.getElementById('menu-clear-all').style.display = 'block';
                    contextMenu.targetElementForClear = isClickOnHighlight;
                    showMenu = true;
                } else if (isSelectionActive && panels.some(panel => panel.contains(selectedRange.commonAncestorContainer))) {
                    document.getElementById('menu-highlight').style.display = 'flex';
                    document.getElementById('menu-note').style.display = 'flex';
                    document.getElementById('menu-clear').style.display = 'none';
                    document.getElementById('menu-clear-all').style.display = 'block'; // Always show clear all
                    showMenu = true;
                }

                if (showMenu) {
                    e.preventDefault();
                    contextMenu.style.display = 'block';
                    const menuHeight = contextMenu.offsetHeight;
                    const menuWidth = contextMenu.offsetWidth;
                    let left = e.pageX;
                    let top = e.pageY;
                    if (left + menuWidth > window.innerWidth) left = window.innerWidth - menuWidth - 5;
                    if (top + menuHeight > window.innerHeight) top = e.pageY - menuHeight - 5;
                    else top = e.pageY - menuHeight - 5;
                    
                    contextMenu.style.left = `${left}px`;
                    contextMenu.style.top = `${top}px`;
                }
            };

            panels.forEach(panel => {
                panel.addEventListener('contextmenu', showContextMenu);
            });

            document.addEventListener('click', (e) => {
                if (contextMenu.style.display === 'block' && !contextMenu.contains(e.target)) {
                    closeContextMenu();
                }
            });
        }

        function closeContextMenu() {
            contextMenu.style.display = 'none';
            selectedRange = null; // Clear range after menu closes
        }

        function unwrapElement(element) {
            const parent = element.parentNode;
            if (!parent) return;
            while (element.firstChild) {
                parent.insertBefore(element.firstChild, element);
            }
            parent.removeChild(element);
            parent.normalize();
        }

        window.highlightText = () => {
            if (selectedRange && !selectedRange.collapsed) {
                const span = document.createElement('span');
                span.className = 'highlight';
                span.appendChild(selectedRange.extractContents());
                selectedRange.insertNode(span);
            }
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        window.addNote = () => {
            const note = prompt('Enter your note:');
            if (note && selectedRange && !selectedRange.collapsed) {
                const span = document.createElement('span');
                span.className = 'comment-highlight';
                const tooltip = document.createElement('span');
                tooltip.className = 'comment-tooltip';
                tooltip.textContent = note;
                span.appendChild(selectedRange.extractContents());
                span.appendChild(tooltip);
                selectedRange.insertNode(span);
            }
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        window.clearHighlight = () => {
             const elementToClear = contextMenu.targetElementForClear;
             if (elementToClear) {
                 unwrapElement(elementToClear);
             }
             closeContextMenu();
             window.getSelection().removeAllRanges();
        };
        
        window.clearAllHighlights = () => {
            document.querySelectorAll('.highlight, .comment-highlight').forEach(unwrapElement);
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        function updateAttemptedCount(part, startQ, endQ) {
            let answeredCount = 0;
            for (let i = startQ; i <= endQ; i++) {
                if (isQuestionAnswered(i)) {
                    answeredCount++;
                }
            }
            const partHeader = document.querySelector(`.footer__questionNo___3WNct[onclick="switchToPart(${part})"]`);
            if (partHeader) {
                const countSpan = partHeader.querySelector('.attemptedCount');
                if (countSpan) {
                     countSpan.textContent = `${answeredCount} of ${endQ - startQ + 1}`;
                }
            }
        }

        // --- GLOBAL FUNCTION EXPOSURE ---
        window.nextQuestion = nextQuestion;
        window.previousQuestion = previousQuestion;
        window.goToQuestion = goToQuestion;
        window.switchToPart = switchToPart;
        window.closeResultsModal = closeResultsModal;
        window.highlightText = highlightText;
        window.addNote = addNote;
        window.clearHighlight = clearHighlight;
        window.clearAllHighlights = clearAllHighlights;
        
        // Explanation toggle function for Part 1
        window.toggleExplanationPart1 = function() {
            const explanationSection = document.getElementById('part-1-explanation');
            const button = document.getElementById('show-explanation-btn-part1');
            
            if (explanationSection.classList.contains('hidden')) {
                explanationSection.classList.remove('hidden');
                button.textContent = 'Hide Explanation';
                button.style.backgroundColor = '#dc3545';
            } else {
                explanationSection.classList.add('hidden');
                button.textContent = 'Show Explanation';
                button.style.backgroundColor = '#4a90e2';
            }
        };
        
        // Explanation toggle function for Part 2
        window.toggleExplanation = function() {
            const explanationSection = document.getElementById('part-2-explanation');
            const button = document.getElementById('show-explanation-btn');
            
            if (explanationSection.classList.contains('hidden')) {
                explanationSection.classList.remove('hidden');
                button.textContent = 'Hide Explanation';
                button.style.backgroundColor = '#dc3545';
            } else {
                explanationSection.classList.add('hidden');
                button.textContent = 'Show Explanation';
                button.style.backgroundColor = '#4a90e2';
            }
        };
        
        // Explanation toggle function for Part 3
        window.toggleExplanationPart3 = function() {
            const explanationSection = document.getElementById('part-3-explanation');
            const button = document.getElementById('show-explanation-btn-part3');
            
            if (explanationSection.classList.contains('hidden')) {
                explanationSection.classList.remove('hidden');
                button.textContent = 'Hide Explanation';
                button.style.backgroundColor = '#dc3545';
            } else {
                explanationSection.classList.add('hidden');
                button.textContent = 'Show Explanation';
                button.style.backgroundColor = '#4a90e2';
            }
        };

        // --- START THE APP ---
        initialize();

        // Add event listeners for table radio buttons
        document.addEventListener('DOMContentLoaded', function() {
            const tableRadios = document.querySelectorAll('.table-radio');
            tableRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Remove background color from all cells in the same row
                    const row = this.closest('tr');
                    const cells = row.querySelectorAll('td:not(.statement)');
                    cells.forEach(cell => {
                        cell.style.backgroundColor = '';
                    });
                    
                    // Add background color to the selected cell
                    if (this.checked) {
                        this.closest('td').style.backgroundColor = '#e3f2fd';
                    }
                    
                    updateAllIndicators();
                });
            });
            

        });

        // Global function for selecting cells
        window.selectCell = function(cell, questionNum, value) {
            console.log('selectCell called:', questionNum, value);
            
            // Remove selected class from all cells in the same row
            const row = cell.closest('tr');
            const cellsInRow = row.querySelectorAll('.clickable-cell');
            cellsInRow.forEach(c => {
                c.classList.remove('selected');
                c.removeAttribute('data-selected');
                c.removeAttribute('data-answer');
            });
            
            // Add selected class to clicked cell
            cell.classList.add('selected');
            cell.setAttribute('data-selected', 'true');
            cell.setAttribute('data-answer', value);
            
            console.log('Cell selected:', questionNum, value);
            updateAllIndicators();
        };



        // Note: switchToPart function is defined earlier in the code
        // This duplicate function has been removed to prevent conflicts
    });
    </script>
</body>
</html>