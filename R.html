<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Full Reading Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            line-height: 1.4;
            font-size: 16px;
        }

        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
        }

        .ielts-logo {
            display: none;
        }

        .test-info {
            display: flex;  
            align-items: center;
            gap: 30px;
            font-size: 14px;
            color: #333;
        }

        .audio-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .audio-icon {
            width: 16px;
            height: 16px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>') no-repeat center;
        }

        .header-icons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .telegram-link {
            color: #3e3e3e;
            text-decoration: none;
            font-weight: 700;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border: 2px solid #3e3e3e;
            border-radius: 9999px;
            background-color: #ffffff;
            line-height: 1;
        }
        
        .telegram-link:hover {
            text-decoration: underline;
        }

        .telegram-link::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: currentColor;
            -webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }

        #volume-slider {
            -webkit-appearance: none;
            width: 80px;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
        }

        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
        }

        #volume-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            border: none;
        }

        .icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0.7;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .icon:hover {
            opacity: 1;
        }
        
        #play-pause-btn {
            background: none;
            border: none;
            padding: 0;
        }

        .main-container {
            margin-top: 60px;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            height: calc(100vh - 60px);
            position: relative;
        }

        /* Page watermark */
        body::after {
            content: "@ielts_material_full";
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) rotate(-20deg);
            font-size: 72px;
            font-weight: 800;
            letter-spacing: 2px;
            color: #000000;
            opacity: 0.04;
            pointer-events: none;
            z-index: 0;
            white-space: nowrap;
        }

        .panels-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .passage-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .passage-panel::-webkit-scrollbar {
            width: 8px;
            background: transparent;
        }
        
        .passage-panel::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .passage-panel::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .passage-panel:hover::-webkit-scrollbar-thumb {
            opacity: 1;
        }

        /* Passage Content */
        .text-center {
            text-align: center;
        }
        .reading-passage h4 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
       
        .reading-passage p {
            margin-bottom: 1.2em;
        }

        .question ul li label {
            display: block;
            margin-top: 8px;
            cursor: pointer;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
            border-left: 1px solid #e0e0e0;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .questions-panel::-webkit-scrollbar {
            width: 8px;
            background: transparent;
        }
        
        .questions-panel::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .questions-panel::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .questions-panel:hover::-webkit-scrollbar-thumb {
            opacity: 1;
        }

        .resizer {
            position: relative;
            background: transparent;
            cursor: col-resize;
            flex-shrink: 0;
            flex-grow: 0;
            z-index: 5;
            width: 16px;
            touch-action: none;
            -webkit-user-select: none;
            user-select: none;
        }
        .resizer::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 3px;
            transform: translateX(-50%);
            background-color: #3e3e3e;
        }
        .resizer::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 36px;
            height: 36px;
            background-color: #ffffff;
            border: 2px solid #3e3e3e;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="%233e3e3e" fill="%233e3e3e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 8l-4 4 4 4"/><path d="M16 8l4 4-4 4"/><line x1="4" y1="12" x2="20" y2="12"/></svg>');
            background-repeat: no-repeat;
            background-size: 60% 60%;
            background-position: center;
            pointer-events: none;
        }

        /* Left Panel */
        .left-panel {
            width: 100%;
            padding: 20px;
        }

        /* Right Panel */
        .right-panel {
            display: none;
            width: 50%;
            padding: 20px;
            position: relative;
        }

        .help-button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        .help-button:hover {
            background: #357abd;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .people-section {
            margin-bottom: 30px;
        }

        .people-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
        }

        .people-table th {
            text-align: left;
            padding: 10px;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .people-table td {
            padding: 8px 10px;
            border: 1px solid #ddd;
        }

        .person-name {
            font-size: 16px;
        }

        .question-number {
            background: white;
            border: 1px solid #4a90e2;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 14px;
            color: #4a90e2;
            min-width: 30px;
            text-align: center;
        }

        .assigned-responsibility {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 14px;
            border: 1px solid #ddd;
        }

        .responsibilities-section {
            margin-bottom: 30px;
        }

        .responsibility-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .responsibility-item {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .responsibility-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .responsibility-item.dragging {
            opacity: 0.5;
        }

        .questions-section {
            margin-bottom: 20px;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .instruction {
            margin-bottom: 20px;
            font-size: 16px;
            color: #666;
        }

        /* Navigation Arrows */
        .nav-arrows {
            position: fixed;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 6px;
            z-index: 101;
        }

        .nav-arrow {
            width: 48px;
            height: 48px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: 700;
            color: #fff;
            transition: transform 0.1s ease, background-color 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.25);
            outline: none;
        }
        .nav-arrow.prev { background-color: #4b5563; }
        .nav-arrow.next { background-color: #000000; }

        .nav-arrow:hover { transform: translateY(-1px); }
        .nav-arrow:active { transform: translateY(0); }
        .nav-arrow:focus-visible { box-shadow: 0 0 0 3px rgba(59,130,246,0.4); }

        .nav-arrow:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Bottom Navigation - Exact Match */
        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;
            padding: 0;
            display: flex;
            align-items: center;
            height: 80px;
            z-index: 100;
        }

        .footer__questionWrapper___1tZ46 {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }

        .footer__questionNo___3WNct {
            background: none;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .footer__questionNo___3WNct:hover {
            background-color: #f8f9fa;
        }

        .section-prefix {
            font-size: 16px;
        }

        .sectionNr {
            font-size: 16px;
            font-weight: bold;
        }

        .attemptedCount {
            font-size: 14px;
            color: #666;
            margin-left: 5px;
            font-weight: 400;
        }

        @media (max-width: 768px) {
            .attemptedCount {
                display: none;
            }
            
            .resizer {
                width: 20px;
            }
            
            .resizer::after {
                width: 44px;
                height: 44px;
            }
            
            .header {
                padding: 10px 15px;
                height: 70px;
            }
            
            .timer-container {
                font-size: 18px;
            }
            
            .telegram-link {
                padding: 8px 16px;
                font-size: 14px;
            }
            
            .question {
                margin-bottom: 25px;
            }
            
            .question-prompt {
                margin-bottom: 20px;
            }
            
            .question-prompt p {
                font-size: 16px;
                line-height: 1.5;
            }
        }
        
        @media (max-width: 480px) {
            .main-container {
                flex-direction: column;
            }
            
            .passage-panel, .questions-panel {
                width: 100%;
                min-width: auto;
            }
            
            .resizer {
                display: none;
            }
            
            .footer__questionWrapper___1tZ46 {
                margin-right: 5px;
            }
            
            .footer__questionNo___3WNct {
                padding: 10px 12px;
                font-size: 16px;
            }
        }

        .footer__questionWrapper___1tZ46.selected .attemptedCount {
            display: none;
        }

        .footer__subquestionWrapper___9GgoP {
            display: none;
            gap: 2px;
            margin-left: 10px;
        }

        .footer__questionWrapper___1tZ46.selected .footer__subquestionWrapper___9GgoP {
            display: flex;
        }

        .subQuestion {
            width: 32px;
            height: 32px;
            border: 1px solid #ccc;
            background: white;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-radius: 2px;
        }

        .subQuestion.answered {
            background-color: #e9ecef;
            border-color: #ddd;
        }
        .subQuestion.correct {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }
        .subQuestion.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .subQuestion:hover {
            background-color: #f0f0f0;
            border-color: #999;
        }

        .subQuestion.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .subQuestion.completed {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .footer__deliverButton___3FM07 {
            margin-left: auto;
            margin-right: 20px;
            background-color: #f3f4f6;
            color: #111827;
            border: 1px solid #d1d5db;
            padding: 10px 16px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: transform 0.08s ease, background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            min-width: 160px;
            justify-content: center;
        }

        .footer__deliverButton___3FM07:hover {
            background-color: #ebedf0;
            border-color: #c7ccd4;
        }

        .footer__deliverButton___3FM07:active {
            transform: translateY(1px);
        }

        .footer__deliverButton___3FM07:focus-visible {
            box-shadow: 0 0 0 3px rgba(59,130,246,0.35);
            outline: none;
        }

        .footer__deliverButton___3FM07:disabled {
            background: #eef0f3;
            color: #9ca3af;
            cursor: not-allowed;
            border-color: #e5e7eb;
            box-shadow: none;
        }

        .hidden {
            display: none !important;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
            min-width: 140px;
        }

        .context-menu-item {
            padding: 12px 16px;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .context-menu-item:hover {
            background-color: #f8f9fa;
        }

        .context-menu-item:last-child {
            border-bottom: none;
        }

        .highlight {
            background-color: #ffff00;
        }

        .comment-highlight {
            background-color: #90EE90;
            position: relative;
            cursor: help;
        }

        .comment-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .comment-highlight:hover .comment-tooltip {
            opacity: 1;
        }

        .question {
            margin-bottom: 40px;
        }
        .question p {
            margin-bottom: 10px;
        }
        .question ul, .question .people-table {
            margin-top: 0;
        }
        .question-prompt {
            margin-bottom: 20px;
        }
        .question ul {
            list-style: none;
            padding-left: 0;
        }
        .question ul li {
            margin-bottom: 5px;
        }
        .answer-input {
            border: 1px solid #bfbfbf;
            border-radius: 4px;
            background-color: #fff;
            padding: 2px 8px;
            font-size: 16px;
            text-align: left;
            font-weight: 700;
            margin-right: 6px;
            margin-left: 6px;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            height: 28px;
            min-width: 150px;
            -webkit-autocomplete: none;
            -moz-autocomplete: none;
            autocomplete: none;
        }
        
        input[type="text"], input[type="email"], input[type="password"], input[type="search"], input[type="url"], input[type="tel"], input[type="number"] {
            -webkit-autocomplete: none;
            -moz-autocomplete: none;
            autocomplete: none;
        }
        
        * {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        *::-webkit-scrollbar {
            width: 8px;
            background: transparent;
        }
        
        *::-webkit-scrollbar-track {
            background: transparent;
        }
        
        *::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        *:hover::-webkit-scrollbar-thumb {
            opacity: 1;
        }
        .answer-input.active-input,
        .answer-input:focus {
            border-color: #3581d8;
            border-width: 2px;
            outline: none;
        }
        .answer-input::placeholder {
            color: #666;
            font-weight: 700;
            text-align: center;
        }
        .answer-input.correct {
            border-color: #28a745;
            background-color: #e9f7ef;
        }
        .answer-input.incorrect {
            border-color: #dc3545;
            background-color: #f8d7da;
            color: #721c24;
        }
        .answer-input {
            z-index: 10;
            position: relative;
            pointer-events: auto;
        }
        .summary-text .answer-input {
            width: 120px;
            height: 24px;
            font-size: 14px;
            margin: 0 4px;
        }
        .answer-inputs {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        .answer-inputs .answer-input {
            width: 200px;
            height: 30px;
            font-size: 16px;
        }
        .drag-drop-container {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }
        .recommendations-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-height: 200px;
        }
        .drag-item {
            background: white;
            border: 1px solid #9c9c9c;
            font-weight: 600;
            padding: 0px 5px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            transition: all 0.2s;
            user-select: none;
        }
        .drag-item:hover {
            background: #e9ecef;
        }
        .drag-item.dragging {
            opacity: 0.5;
        }
        .drag-item.selected {
            border-color: #4a90e2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.5);
        }
        .drop-zone {
            border: 2px dashed #aaa;
            border-radius: 4px;
            width: 50%;
            margin-top: 19px;
            margin-bottom: 5px;
            transition: background-color 0.2s, border-color 0.2s;
            padding: 0.5px;
            display: flex;
            align-items: center;
            position: relative;
            color: #afafaf;
            font-weight: 600;
            height: 27px;
        }
        .drop-zone.drag-over {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }
        .drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }
        .drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }
        .drop-zone.disabled {
            pointer-events: none;
        }
        .drop-zone .drag-item {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 15px;
            padding: 2px;
        }
        .drag-options-container {
            margin-top: 10px;
        }
        .drag-options-container .drag-item {
            display: block;
            width: fit-content;
            font-size: 15px;
            padding: 0.5px 10px;
            margin-bottom: 5px;
        }
        .drag-options-container .drag-item:last-child {
            margin-bottom: 0;
        }
        .q-number {
            color: #888;
            font-size: 14px;
            font-weight: bold;
        }
        .questions-container {
            width: 100%;
        }
        audio {
            width: 100%;
            margin-bottom: 20px;
        }
        .part-header {
            background-color: #f1f2ec;
            padding: 15px 20px;
            border: 1px solid #e0e0e0;
            text-align: left;
            margin: 10px 20px;
            border-radius: 5px;
        }
        .part-header p {
            margin: 0;
        }
        .part-header p:first-child {
            margin-bottom: 5px;
        }

        .question li.correct {
            color: #155724;
            font-weight: bold;
        }
        .question li.incorrect {
            color: #721c24;
        }
        .question li.correct::before {
            content: '✔ ';
            color: #28a745;
        }
        .question li.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }

        .example-box {
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .timer-container {
            display: flex;
            position: relative;
            cursor: default;
            color: #333;
            font-size: 16px;
            font-weight: 500;
            align-items: center;
        }
        .timer-container .timer-tooltip {
            display: none;
        }

        .timer-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 15px;
        }

        .timer-controls button {
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 50%;
            padding: 0;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }
        .timer-controls button:hover {
            background: #e0e0e0;
        }

        .timer-controls button svg {
            width: 20px;
            height: 20px;
            fill: #333;
        }

        .audio-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(40, 40, 40, 0.9);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }
        .audio-modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 500px;
            padding: 20px;
        }
        .audio-modal-content p {
            font-size: 16px;
            line-height: 1.5;
            color: #eee;
        }
        .audio-modal-icon {
            margin-bottom: 20px;
        }
        .modal-play-btn {
            background-color: #000;
            color: white;
            border: 1px solid white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }
        .modal-play-btn:hover {
            background-color: #333;
        }
        #goto-widget {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        #goto-input {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        #goto-btn {
            padding: 4px 10px;
            border: 1px solid #ccc;
            background-color: #f0f0f0;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Styles for TRUE/FALSE/NOT GIVEN questions */
        .tf-question {
            margin-bottom: 25px;
            padding: 10px 0px;
            border-radius: 4px;
            transition: border-color 0.3s, background-color 0.3s;
        }
        .tf-question-line {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 5px 0px;
            border-radius: 4px;
        }
        .tf-question-number, .question-number-box {
            border: 2px solid #ccc;
            padding: 2px 8px;
            margin-right: 10px;
            border-radius: 3px;
            font-weight: bold;
            transition: border-color 0.3s;
            display: inline-block;
        }
        .tf-question.active-question .tf-question-number {
            border-color: #4a90e2;
        }
        .tf-question-text {
            padding-top: 3px;
        }
        .tf-options {
            padding-left: 5px;
        }
        .tf-option {
            display: block;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 10px 12px;
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            background-color: #fff;
        }
        .tf-option:hover {
            background-color: #f1f7ff;
            border-color: #c6dcfb;
        }
        .tf-option:has(input[type="radio"]:checked) {
            background-color: #cfe3f9;
            border-color: #7db3f5;
        }
        .tf-option.correct {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            border-width: 1px;
        }
        .tf-option.incorrect {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            border-width: 1px;
        }
        body.results-mode .tf-option:has(input[type="radio"]:checked) {
            box-shadow: none;
        }
        .tf-option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .answer-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
            font-size: 14px;
            min-width: 120px;
            cursor: pointer;
        }

        .answer-select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }
        .tf-question.correct .tf-question-line {
            background-color: #e9f7ef;
        }
        .tf-question.incorrect .tf-question-line {
            background-color: #f8d7da;
        }
        .matching-question-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 15px;
        }
        .matching-options-bank {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .matching-questions {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .matching-question-item {
            display: flex;
            align-items: center;
            gap: 15px;
            border: 2px solid transparent;
            border-radius: 4px;
            transition: border-color 0.3s;
        }
        .matching-question-item > span {
            flex: 1;
        }
        .matching-question-item.correct {
            background-color: #e9f7ef;
            border-color: #28a745 !important;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone {
            width: auto;
            min-width: 200px;
            flex-shrink: 0;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            font-weight: bold;
            color: #aaa;
        }
        .matching-options-bank .drag-item {
            font-size: 15px;
            border: 1px solid #ccc;
            background: #f9f9f9;
            max-width: 700px;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
            border-left: 1px solid #e0e0e0;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .summary-completion-container {
            margin-top: 20px;
        }
        .summary-text p {
            line-height: 3.0;
            font-size: 16px;
            margin-bottom: 12px;
        }
        .summary-text li {
            line-height: 2.2;
            margin-bottom: 10px;
        }
        .summary-drop-zone {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            min-width:200px;
            height: 25px;
            border: 2px dashed #999;
            border-radius: 4px;
            margin: 0 5px;
            padding: 0 5px;
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
            color: #aaa;
            font-weight: bold;
            text-align: center;
        }
        .summary-drop-zone.filled {
            border-color: #4a90e2;
        }
        .summary-drop-zone.active-input {
             border-color: #4a90e2;
             box-shadow: none;
        }
        .summary-drop-zone .drag-item {
            font-size: 15px;
            font-weight: bold;
            background-color: transparent;
            border: none;
            padding: 0;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .summary-options-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .summary-options-bank .drag-item {
            flex-grow: 1;
            min-width: 100px;
            text-align: center;
        }

        .drop-zone.filled {
            background-color: transparent;
            border: none !important;
            outline: none !important;
            box-shadow: none !important;
            padding: 0;
        }
        .drop-zone.filled .drag-item {
            width: auto;
            height: auto;
            display: inline-block;
            border: 2px solid #4a90e2;
            border-radius: 10px;
            padding: 4px 10px;
            font-weight: 700;
            background: #fff;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.15);
            cursor: default;
            white-space: nowrap;
        }
        .multi-choice-question {
            margin-bottom: 20px;
            padding: 10px;
            border-radius: 4px;
            border: 3px solid transparent;
            transition: border-color 0.3s, background-color 0.3s;
        }
        .multi-choice-question .question-prompt p > strong:first-child {
            border: 2px solid #ccc;
            padding: 2px 8px;
            margin-right: 10px;
            border-radius: 3px;
            font-weight: bold;
            transition: border-color 0.3s;
            display: inline-block;
        }
        .multi-choice-question.active-question .question-prompt p > strong:first-child {
            border-color: #4a90e2;
            border-width: 2px;
        }
        .multi-choice-option {
            padding: 10px 12px;
            background-color: #fff;
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
        }
        .multi-choice-option:hover {
            background-color: #f1f7ff;
            border-color: #c6dcfb;
        }
        .multi-choice-option:has(input:checked) {
            background-color: #cfe3f9;
            border-color: #7db3f5;
        }
        .multi-choice-option.correct {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            box-shadow: inset 0 0 0 2px rgba(40, 167, 69, 0.25) !important;
            border-width: 1px;
            border-radius: 6px;
        }
        .multi-choice-option.incorrect {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            box-shadow: inset 0 0 0 2px rgba(220, 53, 69, 0.25) !important;
            border-width: 1px;
            border-radius: 6px;
        }
        .tf-option.correct-answer-highlight,
        .multi-choice-option.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
        }
        body.results-mode .multi-choice-option:has(input:checked) { box-shadow: none; }
        .multi-choice-option label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 16px;
        }
        .multi-choice-option input[type="checkbox"],
        .multi-choice-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.3);
            accent-color: #4a90e2;
        }
        .multi-choice-option.correct {
            background-color: #e9f7ef;
        }
        .multi-choice-option.incorrect {
            background-color: #f8d7da;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone.filled {
            border-color: #4a90e2;
        }
        .matching-question-item .drop-zone {
            width: 200px;
            height: 40px;
        }
        .paragraph-matching-question {
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 12px;
        }
        .paragraph-matching-question .answer-input {
            width: 80px;
            flex-shrink: 0;
        }

        .matching-form-container {
            margin-top: 20px;
        }
        .matching-form-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        .matching-form-label {
            flex-shrink: 0;
        }

        /* Results Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(17, 24, 39, 0.6);
            backdrop-filter: blur(3px);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.hidden {
            display: none;
        }
        .modal-content {
            background: #ffffff;
            padding: 24px;
            border-radius: 14px;
            width: 92%;
            max-width: 780px;
            max-height: 86vh;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 1px solid #e5e7eb;
            box-shadow: 0 20px 60px rgba(0,0,0,0.25);
        }
        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #666;
        }
        .modal-content h2 {
            text-align: center;
            margin-bottom: 18px;
            color: #111827;
        }
        .results-summary {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 16px;
            text-align: center;
            border-bottom: 1px solid #eef2f7;
            padding-bottom: 12px;
        }
        .results-summary p {
            margin: 0;
            font-size: 14px;
            color: #374151;
        }
        .results-summary p span {
            display: inline-block;
            padding: 4px 10px;
            margin-left: 6px;
            border-radius: 999px;
            background: #f3f4f6;
            font-weight: 700;
            color: #111827;
        }
        .results-details-container {
            overflow-y: auto;
            padding-right: 10px;
            border-radius: 8px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .results-details-container::-webkit-scrollbar {
            width: 8px;
            background: transparent;
        }
        
        .results-details-container::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .results-details-container::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .results-details-container:hover::-webkit-scrollbar-thumb {
            opacity: 1;
        }
        .result-row {
            display: grid;
            grid-template-columns: 56px 1fr 1fr;
            gap: 12px;
            padding: 10px 8px;
            border-bottom: 1px solid #eef2f7;
            font-size: 15px;
            align-items: center;
        }
        .result-row.correct {
            background-color: #f3faf5;
        }
        .result-row.incorrect {
            background-color: #fff5f5;
        }
        .result-row .q-num {
            font-weight: 700;
            color: #111827;
            background: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            width: 42px;
            height: 30px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .result-row .user-ans {
            color: #374151;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            padding: 4px 8px;
            border-radius: 6px;
        }
        .result-row .correct-ans {
            color: #065f46;
            font-weight: 600;
            background: #ecfdf5;
            border: 1px solid #a7f3d0;
            padding: 4px 8px;
            border-radius: 6px;
        }
        .correct-answer-display {
            font-weight: bold;
            color: #28a745;
            margin-left: 10px;
            font-size: 14px;
        }
        
        .centered-title {
            text-align: center;
            font-size: 50px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .matching-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        
        .matching-table th {
            background-color: #007bff;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }
        
        .matching-table td {
            padding: 12px;
            border: 1px solid #ddd;
            vertical-align: top;
        }
        
        .matching-table .statement {
            text-align: left;
            width: 60%;
            font-size: 15px;
        }
        
        .matching-table .table-radio {
            margin: 0;
            transform: scale(1.2);
        }
        
        .matching-table td:not(.statement) {
            text-align: center;
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table th:not(:first-child) {
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table td:not(.statement):has(input:checked) {
            background-color: #e3f2fd;
        }
        
        .matching-table input[type="radio"]:checked {
            accent-color: #007bff;
        }
        
        .matching-table td.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table td.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .options-row {
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        .matching-table .options-row td {
            font-weight: 500;
            text-align: center;
            padding: 8px 12px;
            font-size: 13px;
        }
        
        .matching-table .options-row td:first-child {
            text-align: left;
            font-weight: normal;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell {
            cursor: pointer;
            transition: background-color 0.2s ease;
            min-height: 40px;
            border: 1px solid #ddd;
            position: relative;
        }
        
        .matching-table .clickable-cell:hover {
            background-color: #f0f8ff;
            border-color: #007bff;
        }
        
        .matching-table .clickable-cell.selected {
            background-color: #e3f2fd;
        }
        
        .matching-table .clickable-cell.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table .clickable-cell::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: transparent;
            transition: background-color 0.2s ease;
        }
        
        .matching-table .clickable-cell.selected::after {
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="timer-container">
            <span class="timer-display">60:00</span>
            <div class="timer-controls">
                <button id="timer-toggle-btn" title="Pause/Resume Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>
                </button>
                <button id="timer-reset-btn" title="Reset Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/></svg>
                </button>
            </div>
        </div>
        <a href="https://t.me/ielts_material_full" target="_blank" class="telegram-link">
           Full Exam Materials
        </a>
    </div>

    <div class="main-container" id="main-container">
        <div id="passage-header-container">
            <div id="part-header-1" class="part-header">
                <p><strong>Part 1</strong></p>
                <p>Read the text and answer questions 1-13.</p>
            </div>
            <div id="part-header-2" class="part-header hidden">
                <p><strong>Part 2</strong></p>
                <p>Read the text and answer questions 14-26.</p>
            </div>
            <div id="part-header-3" class="part-header hidden">
                <p><strong>Part 3</strong></p>
                <p>Read the text and answer questions 27-40.</p>
            </div>
        </div>
        <div class="panels-container">
            <div class="passage-panel" id="passage-panel">
                <div id="passage-text-1" class="reading-passage">
                    <h4 class="text-center">THE PLIGHT OF RICE</h4>
                    <p>Rice is a tall grass with a drooping panicle that contains numerous edible grains and has been cultivated in China for more than 6,000 years. A staple throughout Asia and large parts of Africa, it is now grown in ﬂooded paddy fields from sea level to high mountains and harvested three times a year. According to the Food and Health Organisation of the United Nations, around four billion people currently receive a fifth of their calories from rice.</p>
                    <p>Recently, Japan, South Korea, and Taiwan have slightly reduced rice consumption due to the adoption of more western diets, but almost all other countries have raised their consumption due to population increase. Yet, since 1984, there have been diminishing rice yields around the world.</p>
                    <p>From the 1950s to the early 1960s, rice production was also suﬀering: India was on the brink of famine, and China was already experiencing one. In the late 1950s, Norman Borlaug, an American plant pathologist, began advising Punjab State in northwestern India to grow a new semi-dwarf variety of wheat. This was so successful that, in 1962, a semi-dwarf variety of rice, called IR8, developed by the Philippine International Rice Research Institute (IRRI), was planted throughout Southeast Asia and India. This semi-dwarf variety heralded the Green Revolution, which saved the lives of millions of people by almost doubling rice yields: from 1.9 metric tons per hectare in 1950-64, to 3.5 metric tons in 1985-98.</p>
                    <p>IR8 survived because, as a semi-dwarf, it only grows to a moderate height, and it does not thin out, keel over, and drown like traditional varieties. Furthermore, its short thick stem is able to absorb chemical fertilisers, but, as stem growth is limited, the plant expends energy on producing a large panicle of heavy seeds, ensuring a greater crop.</p>
                    <p>However, even with a massive increase in rice production, semi-dwarf varieties managed to keep up with population growth for only ten years. In Africa, where rice consumption is rising by 20% annually, and where one-third of the population now depends on the cereal, this is disturbing. At the current rate, within the next 20 years, rice will surpass maize as the major source of calories on that continent. Meantime, even in ideal circumstances, paddies worldwide are not producing what they once did, for reasons largely unknown to science. An average 0.8% fall in yields has been noted in rich rice-growing regions; in less ideal ones, flood, drought and salinity have meant yields have fallen drastically, sometimes up to 40%.</p>
                    <p>The sequencing of the rice genome took place in 2005, after which the IRRI developed genetically modified flood-resistant varieties of rice, called Sub 1, which produce up to four times more edible grain than non-modified strains. In 2010, a handful of farmers worldwide were planting IRRI Sub 1 rice; now, over five million are doing so. Currently, drought- and salt-resistant varieties are being trialled since most rice is grown in the great river basins of the Brahmaputra, the Irrawaddy, and the Mekong that are all drying up or becoming far saltier.</p>
                    <p>With global warming, many rice-growing regions are hotter than 20 years ago. Nearly all varieties of rice; including IR8, flower in the afternoon, but the anthers – little sacs that contain male pollen – wither and die in soaring temperatures. IRRI scientists have identified one variety of rice, known as Odisha, that flowers in the early morning and they are in the process of genetically modifying IR8 so it contains Odisha-ﬂowering genes, although it may be some time before this is released.</p>
                    <p>While there is a clear need for more rice, many states and countries seem less keen to influence agricultural policy directly than they were in the past. Some believe rice demand will dip in wealthier places, as occurred in Japan, South Korea, and Taiwan; others consider it more prudent to devote resources to tackling obesity or to limiting intensive farming that is environmentally destructive.</p>
                    <p>Some experts say where there is state intervention it should take the form of reducing subsidies to rice farmers to stimulate production; others propose that small landholdings should be consolidated into more economically viable ones. There is no denying that land reform is pressing, but many governments shy away from it, faring losses at the ballot box, all the while knowing that rural populations are heading for the city in droves anyway. And, as they do so, cities expand, eating up fertile land for food production.</p>
                    <p>One can only hope that the IRRI and other research institutions will spearhead half a dozen mini green revolutions, independently of uncommitted states.</p>
                </div>
                <div id="passage-text-2" class="reading-passage hidden">
                    <h4 class="text-center">A New Perspective on Bacteria</h4>
                    <p><strong>A</strong> Microbes are organisms too small to be seen by the naked eye, including bacteria, blue-green algae, yeasts, fungi, viruses, and viroids. A large, diverse group, almost all bacteria are between one and ten µ1 (larger ones reach 0.5 mm). Generally single-celled, with a distinctive cellular structure lacking a true nucleus, most bacterial genetic information is carried on a DNA loop in the cytoplasm2 with the membrane possessing some nuclear properties. There are three main kinds of bacteria – spherical, rod-like, and spiral – known by their Latin names of coccus, bacillus, and spirillum. Bacteria occur alone, in pairs, clusters, chains, or more complex configurations. Some live where oxygen is present; others, where it is absent. The relationship between bacteria and their hosts is symbiotic, benefitting both organisms, or the hosts may be destroyed by parasitic or disease-causing bacteria.</p>
                    <p><strong>B</strong> In general, humans view bacteria suspiciously, yet it is now thought they partly owe their existence to microbes living long, long ago. During photosynthesis, plants produce oxygen that humans need to fuel blood cells. Most geologists believe the early atmosphere on Earth contained very little oxygen until around 2½ billion years ago when microbes bloomed. Ancestral forms of cyanobacteria, for example, evolved into chloroplasts – the cells that carry out photosynthesis. Once plants inhabited the oceans, oxygen levels rose dramatically, so complex life forms could eventually be sustained. The air humans breathe today is oxygen-rich, and the majority of airborne microbes are harmless, but the air does contain industrial pollutants, allergens, and infectious microbes or pathogens that cause illness.</p>
                    <p><strong>C</strong> The fact is that scientists barely understand microbes. Bacteria have been proven to exist only in the past 350 years; viruses were discovered just over 100 years ago, but in the past three decades, the ubiquity of microbes has been established with bacteria found kilometres below the Earth's crust and in the upper atmosphere. Surprisingly, they survive in dry deserts and the frozen reaches of Antarctica; they dwell in rain and snow clouds, as well as inside every living creature. Air samples taken in 2006 from two cities in Texas contained at least 1,800 distinct species of bacteria, making the air as rich as the soil. These species originated both in Texas and as far away as western China. It now seems that the number of microbe species far exceeds the number of stars.</p>
                    <p><strong>D</strong> Inside every human being, there are trillions of bacteria with their weight estimated at 1.36 kg in an average adult, or about as heavy as the brain. Although tiny, 90% of cells in a human are bacterial. With around eight million genes, these bacteria outnumber genes in human cells by 300 times. The large intestine contains the most bacteria – almost 34,000 species – but the crook of the elbow harbours over 2,000 species. Many bacteria are helpful: digesting food; aiding the immune system; creating moisturiser; and, manufacturing vitamins. Some have highly specialised functions, like Bacteroides thetaiotaomicron, which breaks down plant starch, so an infant can make the transition from mother's milk to a more varied diet. Undeniably, some bacteria are life-threatening. One, known as golden staph, Staphylococcus aureus, plagues hospitals, where it infects instruments and devours human tissue until patients die from toxic shock. Worse, it is still resistant to antibiotics.</p>
                    <p><strong>E</strong> Antibiotics themselves are bacteria. In 1928, Alexander Fleming discovered that a mould in his laboratory produced a chemical he named penicillin. In 1951, William Bouw collected soil from the jungles of Borneo that eventually became vancomycin. Pharmaceutical companies still hunt for beneficial bacteria, but Michael Fischbach from the University of California believes that the human body itself is a ready supply.</p>
                    <p><strong>F</strong> Scientific ignorance about bacteria is largely due to an inability to cultivate many of them in a laboratory, but recent DNA sequencing has meant populations can be analysed by a computer program without having to grow them. Fischbach and his team have created and trained a computer program to identify gene clusters in microbial DNA sequences that might produce useful molecules. Having collected microbial DNA from 242 healthy human volunteers, the scientists sequenced the genomes of 2,340 diﬀerent species of microbes, most of which were completely new discoveries. In searching the gene clusters, Fischbach et al fund 3,118 common ones that could be used in pharmaceuticals, for example, a gene cluster from the bacterium Lactobacillus gasseri, successfully reared in the lab, produced a molecule they named lactocillin. Later, they discovered the structure of this was very similar to an antibiotic, LFF571, undergoing clinical trials by a major pharmaceutical company. To date, lactocillin has killed harmful bacteria, so it may also be a reliable antibiotic.</p>
                    <p><strong>G</strong> Naturally, the path to patenting medicine is strewn with failures, but, since bacteria have been living inside humans for millions of years, they are probably safe to reintroduce in new combinations and in large amounts. Undoubtedly, the fight against pathogens, like golden staph, must continue, but as scientists learn more about microbes, respect and excitement for them grow, and their positive applications become ever more probable.</p>
                    <p><sup>1</sup>A micron= 10<sup>-6</sup> m</p>
                    <p><sup>2</sup>Material inside a cell</p>
                </div>
                <div id="passage-text-3" class="reading-passage hidden">
                    <h4 class="text-center">In the last century, Vikings have been perceived in numerous different ways</h4>
                    <p>In the last century, Vikings have been perceived in numerous diﬀerent ways – vilified as conquerors and romanticised as adventurers. How Vikings have been employed in nation-building is a topic of some interest.</p>
                    <p>In English, Vikings are also known as Norse or Norsemen. Their language greatly inﬂuenced English, with the nouns, 'Hell', 'husband', 'law', and 'window', and the verbs, 'blunder', 'snub', 'take', and 'want', all coming from Old Norse. However, the origins of the word 'Viking', itself, are obscure: it may mean 'a Scandinavian pirate', or it may refer to 'an inlet', or a place called Vik, in modem-day Norway, from where the pirates came. These various names – Vikings, Norse, or Norsemen, and doubts about the very word 'Viking' suggest historical confusion.</p>
                    <p>Loosely speaking, the Viking Age endured from the late eighth to the mid-eleventh centuries. Vikings sailed to England in AD 793 to storm coastal monasteries, and subsequently, large swathes of England fell under Viking rule – indeed several Viking kings sat on the English throne. It is generally agreed that the Battle of Hastings, in 1066, when the Norman French invaded, marks the end of the English Viking Age, but the Irish Viking age ended earlier, while Viking colonies in Iceland and Greenland did not dissolve until around AD 1500.</p>
                    <p>How much territory Vikings controlled is also in dispute – Scandinavia and Western Europe certainly, but their reach east and south is uncertain. They plundered and settled down the Volga and Dnieper rivers, and traded with modem-day Istanbul, but the archaeological record has yet to verify that Vikings raided as far away as Northwest Africa, as some writers claim.</p>
                    <p>The issue of control and extent is complex because many Vikings did not return to Scandinavia after raiding but assimilated into local populations, often becoming Christian. To some degree, the Viking Age is defined by religion. Initially, Vikings were polytheists, believing in many gods, but by the end of the age, they had permanently accepted a new monotheistic religious system – Christianity.</p>
                    <p>This transition from so-called pagan plunderers to civilised Christians is significant and is the view promulgated throughout much of recent history. In the UK, in the 1970s for example, schoolchildren were taught that until the Vikings accepted Christianity they were nasty heathens who rampaged throughout Britain. By contrast, today's children can visit museums where Vikings are celebrated as merchants, pastoralists, and artists with a unique worldview as well as conquerors.</p>
                    <p>What are some other interpretations of Vikings? In the nineteenth century, historians in Denmark, Norway, and Sweden constructed their own Viking ages for nationalistic reasons. At that time, all three countries were in crisis. Denmark had been beaten in war and ceded territory to what is now Germany. Norway had become independent from Sweden in 1905 but was economically vulnerable, so Norwegians sought to create a separate identity for themselves in the past as well as the present. The Norwegian historian, Gustav Storm, was adamant it was his forebears and not the Swedes' or Danes' who had colonised Iceland, Greenland, and Vinland, in what is now Canada. Sweden, meanwhile, had relinquished Norway to the Norwegians and Finland to the Russians; thus, in the late nineteenth century, Sweden was keen to boost its image with rich archaeological finds to show the glory of its Viking past.</p>
                    <p>In addition to augmenting nationalism, nineteenth-century thinkers were influenced by an Englishman, Herbert Spencer, who described peoples and cultures in evolutionary terms similar to those of Charles Darwin. Spencer coined the phrase 'survival of the fittest', which includes the notion that, over time, there is not only technological but also moral progress. Therefore, Viking heathens' adoption of Christianity was considered an advantageous move. These days, historians do not compare cultures in the same way, especially since, in this case, the archaeological record seems to show that heathen Vikings and Christian Europeans were equally brutal.</p>
                    <p>Views of Vikings change according to not only to forces aﬀecting historians at the time of their research but also according to the materials they read. Since much knowledge of Vikings comes from literature composed up to 300 years after the events they chronicle, some Danish historians cal1 these sources 'mere legends'.</p>
                    <p>Vikings did have a written language carved on large stones, but as few of these survive today, the most reliable contemporary sources on Vikings come from writers from other cultures, like the ninth-century Persian geographer, Ibn Khordadbeh.</p>
                    <p>In the last four decades, there have been wildly varying interpretations of the Viking inﬂuence in Russia. Most non-Russian scholars believe the Vikings created a kingdom in western Russia and modern-day Ukraine led by a man called Rurik. After AD 862, Rurik's descendants continued to rule. There is considerable evidence of this colonisation: in Sweden, carved stones, still standing, describe the conquerors' journeys; both Russian and Ukrainian have loan words from Old Norse; and, Scandinavian first names, like Igor and Olga, are still popular. However, during the Soviet period, there was an emphasis on the Slavic origins of most Russians. (Appearing in the historical record around the sixth century AD, the Slavs are thought to have originated in Eastern Europe.) This Slavic identity was promoted to contrast with that of the neighbouring Viking Swedes, who were enemies during the Cold War.</p>
                    <p>These days, many Russians consider themselves hybrids. Indeed recent genetic studies support a Norse-colonisation theory: western Russian DNA is consistent with that of the inhabitants of a region north of Stockholm in Sweden.</p>
                    <p>The tools available to modern historians are many and varied, and their findings may seem less open to debate. There are linguistics, numismatics, dendrochronology, archaeozoology, palaeobotany, ice crystallography, climate and DNA analysis to add to the translation of runes and the raising of mighty warships. Despite these, historians remain children of their times.</p>
                </div>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="questions-panel" id="questions-panel">
                <div id="questions-1" class="question-set">
                    <div class="questions-container">
                        <div class="question" data-q-start="1" data-q-end="5">
                            <div class="question-prompt">
                                <p><strong>Questions 1–5</strong></p>
                                <p>Do the following statements agree with the information given in Reading Passage 1?</p>
                                <p>In boxes 1-5 on your answer sheet, write:</p>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><strong>TRUE</strong> if the statement agrees with the information.</li>
                                    <li><strong>FALSE</strong> if the statement contradicts the information.</li>
                                    <li><strong>NOT GIVEN</strong> if there is no information on this.</li>
                                </ul>
                            </div>
                            <div class="tf-question" data-q-start="1" data-q-end="1">
                                <div class="tf-question-line"><span class="tf-question-number">1</span><span class="tf-question-text">Rice is only grown at a low elevation.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q1" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q1" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q1" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="2" data-q-end="2">
                                <div class="tf-question-line"><span class="tf-question-number">2</span><span class="tf-question-text">Rice has been cultivated in Africa for 3,000 years.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q2" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q2" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q2" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="3" data-q-end="3">
                                <div class="tf-question-line"><span class="tf-question-number">3</span><span class="tf-question-text">Since 1984, rice yields have decreased due to infestations of pests.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q3" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q3" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q3" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="4" data-q-end="4">
                                <div class="tf-question-line"><span class="tf-question-number">4</span><span class="tf-question-text">Norman Borlaug believed Punjabi farmers should grow semi-dwarf rice.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q4" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q4" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q4" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="5" data-q-end="5">
                                <div class="tf-question-line"><span class="tf-question-number">5</span><span class="tf-question-text">The Green Revolution increased rice yields by around 100%.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q5" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q5" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q5" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                        </div>

                        <div class="question" data-q-start="6" data-q-end="11">
                            <div class="question-prompt">
                                <p><strong>Questions 6–11</strong></p>
                                <p>Complete the notes below.</p>
                                <p>Choose <strong>ONE WORD AND / OR A NUMBER</strong> from the passage for each answer.</p>
                                <p>Write your answers in boxes 6-11 on your answer sheet.</p>
                            </div>
                            <div class="summary-text" style="border: 1px solid #000; padding: 10px;">
                                <p><strong>Traditional varieties of rice</strong></p>
                                <p>• Grow tall and <input type="text" class="answer-input" id="q6" placeholder="6" autocomplete="off">, leading to collapse</p>
                                <p><strong>IR8 variety</strong></p>
                                <p>• Absorbs fertiliser in its short <input type="text" class="answer-input" id="q7" placeholder="7" autocomplete="off"></p>
                                <p>• With a large panicle of heavy seeds, it produces a bigger <input type="text" class="answer-input" id="q8" placeholder="8" autocomplete="off"></p>
                                <p><strong>Sub 1 varieties</strong></p>
                                <p>• Are ﬂood-resistant</p>
                                <p>• Produce up to <input type="text" class="answer-input" id="q9" placeholder="9" autocomplete="off"> times the amount of grain than non-modified varieties</p>
                                <p>• Now grown by over <input type="text" class="answer-input" id="q10" placeholder="10" autocomplete="off"> farmers</p>
                                <p><strong>Odisha variety</strong></p>
                                <p>• Flowers in the early <input type="text" class="answer-input" id="q11" placeholder="11" autocomplete="off">, so its anthers remain intact and pollination can occur</p>
                            </div>
                        </div>

                        <div class="question" data-q-start="12" data-q-end="13">
                            <div class="question-prompt">
                                <p><strong>Questions 12–13</strong></p>
                                <p>Choose the correct letter A, B, C, or D.</p>
                                <p>Write the correct letter in boxes 12-13 on your answer sheet.</p>
                            </div>
                            <div class="multi-choice-question" data-q-start="12" data-q-end="12">
                                <div class="question-prompt">
                                    <p><strong>12.</strong> States are more interested in.........than stimulating rice production.</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q12" value="A"> increasing wheat production</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q12" value="B"> reducing farm subsidies</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q12" value="C"> confronting obesity</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q12" value="D"> consolidating land holdings</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="13" data-q-end="13">
                                <div class="question-prompt">
                                    <p><strong>13.</strong> .........disappearing as urbanisation speeds up.</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q13" value="A"> Intensive farming is</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q13" value="B"> Fertile land is</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q13" value="C"> Clean water is</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q13" value="D"> Agricultural institutes are</label></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="questions-2" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="14" data-q-end="18">
                            <div class="question-prompt">
                                <p><strong>Questions 14–18</strong></p>
                                <p>Passage 2 has seven sections, A-G.</p>
                                <p>Which section contains the following information?</p>
                                <p>Write the correct letter A-G, in boxes 14-18 on your answer sheet.</p>
                                <p><strong>NB:</strong> Any section can be chosen more than once.</p>
                            </div>
                            <div class="tf-question" data-q-start="14" data-q-end="14">
                                <div class="tf-question-line"><span class="tf-question-number">14</span><span class="tf-question-text">examples of bacteria as a patented medicine</span></div>
                                <div class="tf-options">
                                    <select name="q14" class="answer-select">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                        <option value="G">G</option>
                                    </select>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="15" data-q-end="15">
                                <div class="tf-question-line"><span class="tf-question-number">15</span><span class="tf-question-text">a description of bacteria</span></div>
                                <div class="tf-options">
                                    <select name="q15" class="answer-select">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                        <option value="G">G</option>
                                    </select>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="16" data-q-end="16">
                                <div class="tf-question-line"><span class="tf-question-number">16</span><span class="tf-question-text">gene cluster detection and culture</span></div>
                                <div class="tf-options">
                                    <select name="q16" class="answer-select">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                        <option value="G">G</option>
                                    </select>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="17" data-q-end="17">
                                <div class="tf-question-line"><span class="tf-question-number">17</span><span class="tf-question-text">humans are teeming with bacteria</span></div>
                                <div class="tf-options">
                                    <select name="q17" class="answer-select">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                        <option value="G">G</option>
                                    </select>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="18" data-q-end="18">
                                <div class="tf-question-line"><span class="tf-question-number">18</span><span class="tf-question-text">Fischbach's hypothesis</span></div>
                                <div class="tf-options">
                                    <select name="q18" class="answer-select">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                        <option value="G">G</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="question" data-q-start="19" data-q-end="22">
                            <div class="question-prompt">
                                <p><strong>Questions 19–22</strong></p>
                                <p>Choose the correct letter A, B, C, or D.</p>
                                <p>Write the correct letter in boxes 19-22 on your answer sheet.</p>
                            </div>
                            <div class="multi-choice-question" data-q-start="19" data-q-end="19">
                                <div class="question-prompt">
                                    <p><strong>19.</strong> What do almost all bacteria share?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q19" value="A"> Their simple configurations</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q19" value="B"> Their cellular organisation</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q19" value="C"> Their survival without oxygen</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q19" value="D"> Their parasitic nature</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="20" data-q-end="20">
                                <div class="question-prompt">
                                    <p><strong>20.</strong> From the suffix '-bacillus', what shape would you expect the bacterium Paenibacillus to be?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q20" value="A"> spherical</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q20" value="B"> rod-like</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q20" value="C"> spiral</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q20" value="D"> amorphous</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="21" data-q-end="21">
                                <div class="question-prompt">
                                    <p><strong>21.</strong> Why were ancient bacteria invaluable to humans?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q21" value="A"> They contributed to higher levels of oxygen.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q21" value="B"> They reduced widespread industrial pollution.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q21" value="C"> They protected humans from intestinal ailments.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q21" value="D"> They provided scientists with antibiotics.</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="22" data-q-end="22">
                                <div class="question-prompt">
                                    <p><strong>22.</strong> How prevalent are microbes?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q22" value="A"> Not at all</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q22" value="B"> Somewhat</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q22" value="C"> Very</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q22" value="D"> Extremely</label></div>
                            </div>
                        </div>

                        <div class="question" data-q-start="23" data-q-end="26">
                            <div class="question-prompt">
                                <p><strong>Questions 23–26</strong></p>
                                <p>Answer the questions below.</p>
                                <p>Choose <strong>NO MORE THAN THREE WORDS OR A NUMBER</strong> from the passage for each answer</p>
                                <p>Write your answers in boxes 23-26 on your answer sheet.</p>
                            </div>
                            <div class="summary-text" style="border: 1px solid #000; padding: 10px;">
                                <p><strong>23.</strong> Which organ does the total weight of bacteria in a human body equal? <input type="text" class="answer-input" id="q23" placeholder="23" autocomplete="off"></p>
                                <p><strong>24.</strong> Roughly how many bacterial species live in a human's large intestine? <input type="text" class="answer-input" id="q24" placeholder="24" autocomplete="off"></p>
                                <p><strong>25.</strong> In Fischbach's view, where might useful bacteria come from in the future? <input type="text" class="answer-input" id="q25" placeholder="25" autocomplete="off"></p>
                                <p><strong>26.</strong> What do some scientists now feel towards microbes? <input type="text" class="answer-input" id="q26" placeholder="26" autocomplete="off"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="questions-3" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="27" data-q-end="31">
                            <div class="question-prompt">
                                <p><strong>Questions 27–31</strong></p>
                                <p>Complete the notes below.</p>
                                <p>Write <strong>NO MORE THAN TWO WORDS OR A NUMBER</strong> for each answer</p>
                                <p>Write your answers in boxes 27-31 on your answer sheet.</p>
                            </div>
                            <div class="summary-text" style="border: 1px solid #000; padding: 10px;">
                                <p><strong>Origins:</strong></p>
                                <p>• Word 'Viking' is <input type="text" class="answer-input" id="q27" placeholder="27" autocomplete="off"></p>
                                <p>• Vikings came from Scandinavia.</p>
                                <p><strong>Dates of the Viking Age</strong></p>
                                <p>• In Britain: AD <input type="text" class="answer-input" id="q28" placeholder="28" autocomplete="off">-1066</p>
                                <p>• Length varies elsewhere</p>
                                <p><strong>Territorial extent:</strong></p>
                                <p>• In doubt – but most of Europe</p>
                                <p>• Possibly raided as far away as <input type="text" class="answer-input" id="q29" placeholder="29" autocomplete="off"></p>
                                <p><strong>End of the Viking Age:</strong></p>
                                <p>• Vikings had assimilated into <input type="text" class="answer-input" id="q30" placeholder="30" autocomplete="off">, & adopted a new <input type="text" class="answer-input" id="q31" placeholder="31" autocomplete="off"> system.</p>
                            </div>
                        </div>

                        <div class="question" data-q-start="32" data-q-end="39">
                            <div class="question-prompt">
                                <p><strong>Questions 32–39</strong></p>
                                <p>Look at the following statements and the list of times and places below.</p>
                                <p>Match each statement with the correct place or time: A-H.</p>
                                <p>Write the correct letter, A-H, in boxes 32-39 on your answer sheet.</p>
                            </div>
                            <div class="table-container">
                                <table class="matching-table">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>A</th>
                                            <th>B</th>
                                            <th>C</th>
                                            <th>D</th>
                                            <th>E</th>
                                            <th>F</th>
                                            <th>G</th>
                                            <th>H</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="statement"><strong>32</strong> A geographer documents Viking culture as it happens.</td>
                                            <td class="clickable-cell" data-question="32" data-value="A" onclick="selectCell(this, 32, 'A')"></td>
                                            <td class="clickable-cell" data-question="32" data-value="B" onclick="selectCell(this, 32, 'B')"></td>
                                            <td class="clickable-cell" data-question="32" data-value="C" onclick="selectCell(this, 32, 'C')"></td>
                                            <td class="clickable-cell" data-question="32" data-value="D" onclick="selectCell(this, 32, 'D')"></td>
                                            <td class="clickable-cell" data-question="32" data-value="E" onclick="selectCell(this, 32, 'E')"></td>
                                            <td class="clickable-cell" data-question="32" data-value="F" onclick="selectCell(this, 32, 'F')"></td>
                                            <td class="clickable-cell" data-question="32" data-value="G" onclick="selectCell(this, 32, 'G')"></td>
                                            <td class="clickable-cell" data-question="32" data-value="H" onclick="selectCell(this, 32, 'H')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement"><strong>33</strong> A philosopher classifies cultures hierarchically.</td>
                                            <td class="clickable-cell" data-question="33" data-value="A" onclick="selectCell(this, 33, 'A')"></td>
                                            <td class="clickable-cell" data-question="33" data-value="B" onclick="selectCell(this, 33, 'B')"></td>
                                            <td class="clickable-cell" data-question="33" data-value="C" onclick="selectCell(this, 33, 'C')"></td>
                                            <td class="clickable-cell" data-question="33" data-value="D" onclick="selectCell(this, 33, 'D')"></td>
                                            <td class="clickable-cell" data-question="33" data-value="E" onclick="selectCell(this, 33, 'E')"></td>
                                            <td class="clickable-cell" data-question="33" data-value="F" onclick="selectCell(this, 33, 'F')"></td>
                                            <td class="clickable-cell" data-question="33" data-value="G" onclick="selectCell(this, 33, 'G')"></td>
                                            <td class="clickable-cell" data-question="33" data-value="H" onclick="selectCell(this, 33, 'H')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement"><strong>34</strong> Historians assert that Viking history is based more on legends than facts.</td>
                                            <td class="clickable-cell" data-question="34" data-value="A" onclick="selectCell(this, 34, 'A')"></td>
                                            <td class="clickable-cell" data-question="34" data-value="B" onclick="selectCell(this, 34, 'B')"></td>
                                            <td class="clickable-cell" data-question="34" data-value="C" onclick="selectCell(this, 34, 'C')"></td>
                                            <td class="clickable-cell" data-question="34" data-value="D" onclick="selectCell(this, 34, 'D')"></td>
                                            <td class="clickable-cell" data-question="34" data-value="E" onclick="selectCell(this, 34, 'E')"></td>
                                            <td class="clickable-cell" data-question="34" data-value="F" onclick="selectCell(this, 34, 'F')"></td>
                                            <td class="clickable-cell" data-question="34" data-value="G" onclick="selectCell(this, 34, 'G')"></td>
                                            <td class="clickable-cell" data-question="34" data-value="H" onclick="selectCell(this, 34, 'H')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement"><strong>35</strong> Young people learn about Viking cultural and economic activities.</td>
                                            <td class="clickable-cell" data-question="35" data-value="A" onclick="selectCell(this, 35, 'A')"></td>
                                            <td class="clickable-cell" data-question="35" data-value="B" onclick="selectCell(this, 35, 'B')"></td>
                                            <td class="clickable-cell" data-question="35" data-value="C" onclick="selectCell(this, 35, 'C')"></td>
                                            <td class="clickable-cell" data-question="35" data-value="D" onclick="selectCell(this, 35, 'D')"></td>
                                            <td class="clickable-cell" data-question="35" data-value="E" onclick="selectCell(this, 35, 'E')"></td>
                                            <td class="clickable-cell" data-question="35" data-value="F" onclick="selectCell(this, 35, 'F')"></td>
                                            <td class="clickable-cell" data-question="35" data-value="G" onclick="selectCell(this, 35, 'G')"></td>
                                            <td class="clickable-cell" data-question="35" data-value="H" onclick="selectCell(this, 35, 'H')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement"><strong>36</strong> People see themselves as unrelated to Vikings.</td>
                                            <td class="clickable-cell" data-question="36" data-value="A" onclick="selectCell(this, 36, 'A')"></td>
                                            <td class="clickable-cell" data-question="36" data-value="B" onclick="selectCell(this, 36, 'B')"></td>
                                            <td class="clickable-cell" data-question="36" data-value="C" onclick="selectCell(this, 36, 'C')"></td>
                                            <td class="clickable-cell" data-question="36" data-value="D" onclick="selectCell(this, 36, 'D')"></td>
                                            <td class="clickable-cell" data-question="36" data-value="E" onclick="selectCell(this, 36, 'E')"></td>
                                            <td class="clickable-cell" data-question="36" data-value="F" onclick="selectCell(this, 36, 'F')"></td>
                                            <td class="clickable-cell" data-question="36" data-value="G" onclick="selectCell(this, 36, 'G')"></td>
                                            <td class="clickable-cell" data-question="36" data-value="H" onclick="selectCell(this, 36, 'H')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement"><strong>37</strong> An historian claims Viking colonists to modem-day Canada came from his land.</td>
                                            <td class="clickable-cell" data-question="37" data-value="A" onclick="selectCell(this, 37, 'A')"></td>
                                            <td class="clickable-cell" data-question="37" data-value="B" onclick="selectCell(this, 37, 'B')"></td>
                                            <td class="clickable-cell" data-question="37" data-value="C" onclick="selectCell(this, 37, 'C')"></td>
                                            <td class="clickable-cell" data-question="37" data-value="D" onclick="selectCell(this, 37, 'D')"></td>
                                            <td class="clickable-cell" data-question="37" data-value="E" onclick="selectCell(this, 37, 'E')"></td>
                                            <td class="clickable-cell" data-question="37" data-value="F" onclick="selectCell(this, 37, 'F')"></td>
                                            <td class="clickable-cell" data-question="37" data-value="G" onclick="selectCell(this, 37, 'G')"></td>
                                            <td class="clickable-cell" data-question="37" data-value="H" onclick="selectCell(this, 37, 'H')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement"><strong>38</strong> Viking conquests are exaggerated to bolster the country's ego after a territorial loss.</td>
                                            <td class="clickable-cell" data-question="38" data-value="A" onclick="selectCell(this, 38, 'A')"></td>
                                            <td class="clickable-cell" data-question="38" data-value="B" onclick="selectCell(this, 38, 'B')"></td>
                                            <td class="clickable-cell" data-question="38" data-value="C" onclick="selectCell(this, 38, 'C')"></td>
                                            <td class="clickable-cell" data-question="38" data-value="D" onclick="selectCell(this, 38, 'D')"></td>
                                            <td class="clickable-cell" data-question="38" data-value="E" onclick="selectCell(this, 38, 'E')"></td>
                                            <td class="clickable-cell" data-question="38" data-value="F" onclick="selectCell(this, 38, 'F')"></td>
                                            <td class="clickable-cell" data-question="38" data-value="G" onclick="selectCell(this, 38, 'G')"></td>
                                            <td class="clickable-cell" data-question="38" data-value="H" onclick="selectCell(this, 38, 'H')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement"><strong>39</strong> DNA tests show locals are closely related to Swedes.</td>
                                            <td class="clickable-cell" data-question="39" data-value="A" onclick="selectCell(this, 39, 'A')"></td>
                                            <td class="clickable-cell" data-question="39" data-value="B" onclick="selectCell(this, 39, 'B')"></td>
                                            <td class="clickable-cell" data-question="39" data-value="C" onclick="selectCell(this, 39, 'C')"></td>
                                            <td class="clickable-cell" data-question="39" data-value="D" onclick="selectCell(this, 39, 'D')"></td>
                                            <td class="clickable-cell" data-question="39" data-value="E" onclick="selectCell(this, 39, 'E')"></td>
                                            <td class="clickable-cell" data-question="39" data-value="F" onclick="selectCell(this, 39, 'F')"></td>
                                            <td class="clickable-cell" data-question="39" data-value="G" onclick="selectCell(this, 39, 'G')"></td>
                                            <td class="clickable-cell" data-question="39" data-value="H" onclick="selectCell(this, 39, 'H')"></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <p><strong>List of times & places</strong></p>
                                <p><strong>A</strong> In the UK today<br>
                                <strong>B</strong> In 19th-century Norway<br>
                                <strong>C</strong> In 19th-century Sweden<br>
                                <strong>D</strong> In 19th-century England<br>
                                <strong>E</strong> In Denmark today<br>
                                <strong>F</strong> In 9th-century Persia<br>
                                <strong>G</strong> In mid-20th century Soviet Union<br>
                                <strong>H</strong> In Russia today</p>
                            </div>
                        </div>

                        <div class="question" data-q-start="40" data-q-end="40">
                            <div class="question-prompt">
                                <p><strong>Question 40</strong></p>
                                <p>Which might be a suitable title for passage 3?</p>
                                <p>Choose the correct letter A-E.</p>
                                <p>Write the correct letter in box 40 on your answer sheet.</p>
                            </div>
                            <div class="multi-choice-question" data-q-start="40" data-q-end="40">
                                <div class="multi-choice-option"><label><input type="radio" name="q40" value="A"> A brief history of Vikings</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q40" value="B"> Recent Viking discoveries</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q40" value="C"> A modem fascination with Vikings</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q40" value="D"> Interpretations of Viking history</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q40" value="E"> Viking history and nationalism</label></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Arrows -->
    <div class="nav-arrows">
        <button class="nav-arrow prev" onclick="previousQuestion()" id="prevBtn" aria-label="Previous question">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
        <button class="nav-arrow next" onclick="nextQuestion()" id="nextBtn" aria-label="Next question">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-row perScorableItem" aria-label="Questions">
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(1)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">1</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <!-- Subquestions for Part 1 (1-13) -->
                <button class="subQuestion scorable-item" onclick="goToQuestion(1)"><span class="sr-only">Question 1</span><span aria-hidden="true">1</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(2)"><span class="sr-only">Question 2</span><span aria-hidden="true">2</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(3)"><span class="sr-only">Question 3</span><span aria-hidden="true">3</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(4)"><span class="sr-only">Question 4</span><span aria-hidden="true">4</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(5)"><span class="sr-only">Question 5</span><span aria-hidden="true">5</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(6)"><span class="sr-only">Question 6</span><span aria-hidden="true">6</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(7)"><span class="sr-only">Question 7</span><span aria-hidden="true">7</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(8)"><span class="sr-only">Question 8</span><span aria-hidden="true">8</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(9)"><span class="sr-only">Question 9</span><span aria-hidden="true">9</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(10)"><span class="sr-only">Question 10</span><span aria-hidden="true">10</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(11)"><span class="sr-only">Question 11</span><span aria-hidden="true">11</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(12)"><span class="sr-only">Question 12</span><span aria-hidden="true">12</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(13)"><span class="sr-only">Question 13</span><span aria-hidden="true">13</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 selected multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(2)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">2</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <!-- Subquestions for Part 2 (14-26) -->
                <button class="subQuestion scorable-item" onclick="goToQuestion(14)"><span class="sr-only">Question 14</span><span aria-hidden="true">14</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(15)"><span class="sr-only">Question 15</span><span aria-hidden="true">15</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(16)"><span class="sr-only">Question 16</span><span aria-hidden="true">16</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(17)"><span class="sr-only">Question 17</span><span aria-hidden="true">17</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(18)"><span class="sr-only">Question 18</span><span aria-hidden="true">18</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(19)"><span class="sr-only">Question 19</span><span aria-hidden="true">19</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(20)"><span class="sr-only">Question 20</span><span aria-hidden="true">20</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(21)"><span class="sr-only">Question 21</span><span aria-hidden="true">21</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(22)"><span class="sr-only">Question 22</span><span aria-hidden="true">22</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(23)"><span class="sr-only">Question 23</span><span aria-hidden="true">23</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(24)"><span class="sr-only">Question 24</span><span aria-hidden="true">24</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(25)"><span class="sr-only">Question 25</span><span aria-hidden="true">25</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(26)"><span class="sr-only">Question 26</span><span aria-hidden="true">26</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(3)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">3</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 14</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <!-- Subquestions for Part 3 (27-40) -->
                <button class="subQuestion scorable-item" onclick="goToQuestion(27)"><span class="sr-only">Question 27</span><span aria-hidden="true">27</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(28)"><span class="sr-only">Question 28</span><span aria-hidden="true">28</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(29)"><span class="sr-only">Question 29</span><span aria-hidden="true">29</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(30)"><span class="sr-only">Question 30</span><span aria-hidden="true">30</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(31)"><span class="sr-only">Question 31</span><span aria-hidden="true">31</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(32)"><span class="sr-only">Question 32</span><span aria-hidden="true">32</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(33)"><span class="sr-only">Question 33</span><span aria-hidden="true">33</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(34)"><span class="sr-only">Question 34</span><span aria-hidden="true">34</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(35)"><span class="sr-only">Question 35</span><span aria-hidden="true">35</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(36)"><span class="sr-only">Question 36</span><span aria-hidden="true">36</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(37)"><span class="sr-only">Question 37</span><span aria-hidden="true">37</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(38)"><span class="sr-only">Question 38</span><span aria-hidden="true">38</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(39)"><span class="sr-only">Question 39</span><span aria-hidden="true">39</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(40)"><span class="sr-only">Question 40</span><span aria-hidden="true">40</span></button>
            </div>
        </div>
        
        <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton___3FM07">
            <i class="fa fa fa-check" aria-hidden="true"></i>
            <span>Check Answers</span>
        </button>
    </nav>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div id="menu-highlight" class="context-menu-item" onclick="highlightText()">
            Highlight
        </div>
        <div id="menu-note" class="context-menu-item" onclick="addNote()">
            Note
        </div>
        <div id="menu-clear" class="context-menu-item" onclick="clearHighlight()">
            Clear
        </div>
        <div id="menu-clear-all" class="context-menu-item" onclick="clearAllHighlights()">
            Clear All
        </div>
    </div>

    <div id="results-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closeResultsModal()">&times;</button>
            <h2>Results</h2>
            <div class="results-summary">
                <p>Score: <span id="results-score"></span> / 40</p>
                <p>IELTS Band: <span id="results-band"></span></p>
            </div>
            <div id="results-details" class="results-details-container">
                <!-- Results for each question will be injected here -->
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- STATE VARIABLES ---
        let currentPassage = 1;
        let currentQuestion = 1;
        let selectedRange = null;
        let timeInSeconds = 3600;
        let timerInterval;
        let draggedItem = null;
        let activeQuestionElement = null;
        let selectedDragItem = null;

        // --- GLOBAL FUNCTIONS ---
        function getFirstQuestionOfPart(part) {
            switch(part) {
                case 1: return 1;
                case 2: return 14;
                case 3: return 27;
                default: return 1;
            }
        }

        // --- DOM ELEMENTS ---
        const timerDisplay = document.querySelector('.timer-display');
        const timerToggleButton = document.getElementById('timer-toggle-btn');
        const timerResetButton = document.getElementById('timer-reset-btn');
        const deliverButton = document.getElementById('deliver-button');
        const resizer = document.getElementById('resizer');
        const passagePanel = document.getElementById('passage-panel');
        const questionsPanel = document.getElementById('questions-panel');
        const contextMenu = document.getElementById('contextMenu');

        // --- ICON SVGs ---
        const playIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>';
        const pauseIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';

        // --- ANSWERS ---
        const correctAnswers = {
            // Part 1 (1-13) - The Plight of Rice
            '1': 'FALSE',          // Rice is only grown at a low elevation
            '2': 'NOT GIVEN',      // Rice has been cultivated in Africa for 3,000 years
            '3': 'FALSE',          // Since 1984, rice yields have decreased due to infestations of pests
            '4': 'FALSE',          // Norman Borlaug believed Punjabi farmers should grow semi-dwarf rice
            '5': 'TRUE',           // The Green Revolution increased rice yields by around 100%
            '6': 'thin',           // Traditional varieties: Grow tall and thin, leading to collapse
            '7': 'stem',           // IR8 variety: Absorbs fertiliser in its short stem
            '8': 'crop',           // IR8 variety: With a large panicle of heavy seeds, it produces a bigger crop
            '9': '4',              // Sub 1 varieties: Produce up to 4 times the amount of grain
            '10': 'five million',  // Sub 1 varieties: Now grown by over five million farmers
            '11': 'morning',       // Odisha variety: Flowers in the early morning
            '12': 'C',             // States are more interested in confronting obesity than stimulating rice production
            '13': 'B',             // Fertile land is disappearing as urbanisation speeds up
            // Part 2 (14-26) - A New Perspective on Bacteria
            '14': 'F',             // examples of bacteria as a patented medicine
            '15': 'A',             // a description of bacteria
            '16': 'F',             // gene cluster detection and culture
            '17': 'D',             // humans are teeming with bacteria
            '18': 'E',             // Fischbach's hypothesis
            '19': 'B',             // What do almost all bacteria share? - Their cellular organisation
            '20': 'B',             // From the suffix '-bacillus', what shape would you expect the bacterium Paenibacillus to be? - rod-like
            '21': 'A',             // Why were ancient bacteria invaluable to humans? - They contributed to higher levels of oxygen
            '22': 'D',             // How prevalent are microbes? - Extremely
            '23': 'brain',         // Which organ does the total weight of bacteria in a human body equal?
            '24': '34000',         // Roughly how many bacterial species live in a human's large intestine?
            '25': 'human body',    // In Fischbach's view, where might useful bacteria come from in the future?
            '26': 'respect',       // What do some scientists now feel towards microbes?
            // Part 3 (27-40) - Vikings
            '27': 'obscure',       // Word 'Viking' is obscure
            '28': '793',           // In Britain: AD 793-1066
            '29': 'Northwest Africa', // Possibly raided as far away as Northwest Africa
            '30': 'local populations', // Vikings had assimilated into local populations
            '31': 'religious',     // & adopted a new religious system
            '32': 'F',             // A geographer documents Viking culture as it happens - In 9th-century Persia
            '33': 'D',             // A philosopher classifies cultures hierarchically - In 19th-century England
            '34': 'E',             // Historians assert that Viking history is based more on legends than facts - In Denmark today
            '35': 'A',             // Young people learn about Viking cultural and economic activities - In the UK today
            '36': 'G',             // People see themselves as unrelated to Vikings - In mid-20th century Soviet Union
            '37': 'B',             // An historian claims Viking colonists to modem-day Canada came from his land - In 19th-century Norway
            '38': 'C',             // Viking conquests are exaggerated to bolster the country's ego after a territorial loss - In 19th-century Sweden
            '39': 'H',             // DNA tests show locals are closely related to Swedes - In Russia today
            '40': 'D'              // Which might be a suitable title for passage 3? - Interpretations of Viking history
        };

        // --- INITIALIZATION ---
        function initialize() {
            console.log(`🚀 Initializing application...`);
            startTimer();
            initializeDragAndDrop();
            setupCheckboxLimits();
            setupExampleHeading();
            console.log(`📋 Setting up initial state - switching to part 1`);
            switchToPart(1); // Also calls goToQuestion(1) and updateNavigation
            
            document.body.addEventListener('input', updateAllIndicators);
            document.body.addEventListener('change', updateAllIndicators);
            deliverButton.addEventListener('click', checkAnswers);
            timerToggleButton.addEventListener('click', toggleTimer);
            timerResetButton.addEventListener('click', resetTimer);

            // Auto-close dropdowns for Questions 14-18 on selection
            ['q14','q15','q16','q17','q18'].forEach(id => {
                const sel = document.getElementById(id);
                if (sel) {
                    sel.addEventListener('change', () => sel.blur());
                }
            });

            // Add click listeners to question containers for navigation
            document.querySelectorAll('[data-q-start]').forEach(el => {
                el.addEventListener('click', (event) => {
                    // Stop event propagation to prevent parent container clicks
                    event.stopPropagation();
                    
                    const qNum = parseInt(el.dataset.qStart, 10);
                    const qEnd = parseInt(el.dataset.qEnd, 10);
                    
                    console.log(`🖱️ Question container clicked - qNum: ${qNum}, qEnd: ${qEnd}, currentQuestion: ${currentQuestion}, element:`, el);
                    
                    // Handle cases where qNum is NaN
                    if (isNaN(qNum)) {
                        console.log(`ℹ️ Container without valid question number, ignoring navigation`);
                        return;
                    }
                    
                    // Only navigate if this is a single question (qStart === qEnd) or if we're clicking on a specific question within a group
                    if (qNum === qEnd || el.classList.contains('tf-question')) {
                        if (currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum}`);
                            goToQuestion(qNum);
                        } else {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed`);
                        }
                    } else {
                        console.log(`ℹ️ Ignoring click on group container (${qNum}-${qEnd})`);
                    }
                });
            });
            
            // Add specific click listeners for individual question elements to prevent parent container interference
            document.querySelectorAll('.tf-question, .summary-text').forEach(el => {
                el.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const qNum = parseInt(el.dataset.qStart, 10);
                    console.log(`🎯 Individual question element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, element:`, el);
                    
                    // Handle cases where qNum is NaN (like .summary-text containers)
                    if (isNaN(qNum)) {
                        console.log(`ℹ️ Container without specific question number, ignoring navigation`);
                        return;
                    }
                    
                    if (currentQuestion !== qNum) {
                        console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (individual element)`);
                        goToQuestion(qNum);
                    } else {
                        console.log(`ℹ️ Already on question ${qNum}, no navigation needed (individual element)`);
                    }
                });
            });
            
            // Add specific click listeners for individual input elements
            document.querySelectorAll('.answer-input').forEach(input => {
                input.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const qNum = parseInt(input.id.replace('q', ''), 10);
                    console.log(`📝 Input element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, input:`, input);
                    
                    if (currentQuestion !== qNum) {
                        console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (input element)`);
                        goToQuestion(qNum);
                    } else {
                        console.log(`ℹ️ Already on question ${qNum}, no navigation needed (input element)`);
                    }
                });
            });

            // Add click listeners for select elements
            document.querySelectorAll('.answer-select').forEach(select => {
                select.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const qNum = parseInt(select.name.replace('q', ''), 10);
                    console.log(`📝 Select element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, select:`, select);
                    
                    if (currentQuestion !== qNum) {
                        console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (select element)`);
                        goToQuestion(qNum);
                    } else {
                        console.log(`ℹ️ Already on question ${qNum}, no navigation needed (select element)`);
                    }
                });
            });

            resizer.addEventListener('mousedown', initResize, false);
            initializeContextMenu();
        }

        // --- CORE TEST LOGIC ---

        function checkAnswers() {
            // Disable all inputs to prevent changes
            const allInputs = document.querySelectorAll('input, select, textarea');
            allInputs.forEach(input => {
                input.disabled = true;
            });

            // Disable all drag and drop functionality
            document.querySelectorAll('.drag-item').forEach(item => {
                item.setAttribute('draggable', 'false');
                item.style.cursor = 'not-allowed';
                item.style.pointerEvents = 'none';
            });

            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.style.pointerEvents = 'none';
                zone.classList.add('disabled');
            });

            // Disable submit button
            deliverButton.disabled = true;
            deliverButton.style.cursor = 'not-allowed';
            
            clearInterval(timerInterval);
            let score = 0;
            const totalQuestions = 40;
            const resultsDetailsContainer = document.getElementById('results-details');
            resultsDetailsContainer.innerHTML = '';

            document.querySelectorAll('.correct, .incorrect, .correct-answer-highlight').forEach(el => {
                el.classList.remove('correct', 'incorrect', 'correct-answer-highlight');
            });
            document.querySelectorAll('.correct-answer-display').forEach(el => el.remove());

            for (let i = 1; i <= totalQuestions; i++) {
                const questionKey = String(i);
                const correctAnswer = correctAnswers[questionKey];
                let userAnswer = '';
                let isCorrect = false;
                
                let userAnswerDisplay = 'Not Answered';
                const correctAnswerText = Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : correctAnswer;

                const textInput = document.getElementById(`q${i}`);
                const selectInput = document.querySelector(`select[name="q${i}"]`);
                const radioGroup = document.querySelectorAll(`input[name="q${i}"][type="radio"]`);
                
                // Handle Text and Select Inputs
                if ((textInput && textInput.tagName === 'INPUT') || (selectInput && selectInput.tagName === 'SELECT')) {
                    const inputElement = textInput || selectInput;
                    const element = inputElement.closest('.matching-form-row') || inputElement.closest('.tf-question') || inputElement;
                    userAnswer = inputElement.value.trim();
                    userAnswerDisplay = userAnswer || 'Not Answered';

                    const normalize = (s) => (s || '')
                        .toString()
                        .toLowerCase()
                        .replace(/[^a-z0-9\s]/g, '')
                        .replace(/\s+/g, ' ')
                        .trim();

                    if (inputElement.tagName === 'SELECT') {
                        isCorrect = userAnswer === correctAnswer;
                        console.log(`🔍 Select validation for Q${i}: userAnswer="${userAnswer}", correctAnswer="${correctAnswer}", isCorrect=${isCorrect}`);
                    } else {
                        const normUser = normalize(userAnswer);
                        if (Array.isArray(correctAnswer)) {
                            isCorrect = correctAnswer.some(ans => normalize(ans) === normUser);
                        } else {
                            isCorrect = normalize(correctAnswer) === normUser;
                        }
                    }
                    
                    if (isCorrect) {
                        score++;
                        element.classList.add('correct');
                        console.log(`✅ Question ${i} is correct! Score: ${score}`);
                    } else {
                        element.classList.add('incorrect');
                        const correctAnswerSpan = document.createElement('span');
                        correctAnswerSpan.className = 'correct-answer-display';
                        correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`;
                        inputElement.parentNode.insertBefore(correctAnswerSpan, inputElement.nextSibling);
                        console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                    }
                }
                // Handle Radio Button Inputs (T/F, MCQs)
                else if (radioGroup.length > 0) {
                    const questionContainer = radioGroup[0]?.closest('.tf-question') || radioGroup[0]?.closest('.multi-choice-question');
                    const checkedRadio = document.querySelector(`input[name="q${i}"]:checked`);

                    if (checkedRadio) {
                        userAnswer = checkedRadio.value;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;

                        const userLabel = checkedRadio.closest('.tf-option, .multi-choice-option');
                        if (userLabel) {
                            userLabel.classList.add(isCorrect ? 'correct' : 'incorrect');
                        }
                        
                        // Handle table radio buttons
                        if (checkedRadio.classList.contains('table-radio')) {
                            const tableCell = checkedRadio.closest('td');
                            if (tableCell) {
                                tableCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                            }
                        }
                    }

                    if (isCorrect) {
                        score++;
                    } else {
                        if (questionContainer){
                            const correctOptionEl = questionContainer.querySelector(`input[name="q${i}"][value="${correctAnswerText}"]`);
                            if (correctOptionEl) {
                                const correctLabel = correctOptionEl.closest('.tf-option, .multi-choice-option');
                                if (correctLabel) {
                                    correctLabel.classList.add('correct-answer-highlight');
                                }
                            }
                        }
                    }
                }
                // Handle clickable-cell matrix questions (generic for any i that has clickable cells)
                else if (document.querySelector(`.clickable-cell[data-question="${i}"]`)) {
                    console.log(`🔍 Checking clickable cell question ${i}`);
                    const selectedCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-selected="true"]`);
                    console.log(`📍 Selected cell for question ${i}:`, selectedCell);
                    console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                    
                    if (selectedCell) {
                        userAnswer = selectedCell.dataset.answer;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        selectedCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                    } else {
                        console.log(`⚠️ No answer provided for question ${i}`);
                        userAnswerDisplay = 'Not Answered';
                    }
                    
                    // Handle highlighting correct answers for incorrect responses
                    if (!isCorrect) {
                        const correctCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-value="${correctAnswerText}"]`);
                        if (correctCell) {
                            correctCell.classList.add('correct-answer-highlight');
                            console.log(`✅ Highlighted correct answer for question ${i}:`, correctCell);
                        } else {
                            console.log(`⚠️ Could not find correct cell for question ${i} with value "${correctAnswerText}"`);
                        }
                    }
                }

                // For showing results in the modal
                 const resultRow = `
                    <div class="result-row ${isCorrect ? '' : 'incorrect'}">
                        <span class="q-num">${i}</span>
                        <span class="user-ans">${userAnswerDisplay}</span>
                        <span class="correct-ans">${correctAnswerText}</span>
                    </div>`;
                resultsDetailsContainer.innerHTML += resultRow;
                
                // Update nav button color
                const navButton = document.querySelector(`.subQuestion[onclick="goToQuestion(${i})"]`);
                if (navButton) {
                    navButton.classList.remove('answered', 'active');
                    navButton.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
            }

            document.getElementById('results-score').textContent = score;
            document.getElementById('results-band').textContent = calculateBandScore(score);
            document.body.classList.add('results-mode');
            document.getElementById('results-modal').classList.remove('hidden');
            
            // Change button to "My Result" with green styling
            deliverButton.innerHTML = `<span>My Result</span>`;
            deliverButton.style.backgroundColor = '#4CAF50';
            deliverButton.style.color = 'white';
            deliverButton.style.borderColor = '#4CAF50';
            deliverButton.disabled = false;
            deliverButton.style.cursor = 'pointer';
            deliverButton.removeEventListener('click', checkAnswers);
            deliverButton.addEventListener('click', showResultsModal);
            
            // Highlight correct answers in the passage
            highlightCorrectAnswersInPassage();
        }

        function calculateBandScore(score) {
            if (score >= 39) return '9.0';
            const mapping = {
                40: 9.0, 39: 9.0, 38: 8.5, 37: 8.5, 36: 8.0, 35: 8.0, 34: 7.5,
                33: 7.5, 32: 7.0, 31: 7.0, 30: 7.0, 29: 6.5, 28: 6.5, 27: 6.5,
                26: 6.0, 25: 6.0, 24: 6.0, 23: 5.5, 22: 5.5, 21: 5.5, 20: 5.5,
                19: 5.0, 18: 5.0, 17: 5.0, 16: 5.0, 15: 5.0, 14: 4.5, 13: 4.5,
                12: 4.0, 11: 4.0, 10: 4.0, 9: 3.5, 8: 3.5, 7: 3.0, 6: 3.0,
                5: 2.5, 4: 2.5
            };
            if (score <= 0) return 0.0;
            if (score === 1) return 1.0;
            if (score <= 3) return 2.0;
            if (score <= 5) return 2.5;
            return mapping[score] || 0.0;
        }

        function highlightCorrectAnswersInPassage() {
            // Define the text passages and their corresponding question numbers for Part 1 (The Plight of Rice)
            const part1Highlights = [
                { question: 1, text: "grown in ﬂooded paddy fields from sea level to high mountains", answer: "FALSE" },
                { question: 2, text: "Rice has been cultivated in Africa for 3,000 years", answer: "NOT GIVEN" },
                { question: 3, text: "diminishing rice yields around the world", answer: "FALSE" },
                { question: 4, text: "Norman Borlaug", answer: "FALSE" },
                { question: 5, text: "almost doubling rice yields", answer: "TRUE" },
                { question: 6, text: "thin out, keel over, and drown", answer: "thin" },
                { question: 7, text: "short thick stem", answer: "stem" },
                { question: 8, text: "ensuring a greater crop", answer: "crop" },
                { question: 9, text: "four times more edible grain", answer: "4" },
                { question: 10, text: "over five million", answer: "five million" },
                { question: 11, text: "flowers in the early morning", answer: "morning" },
                { question: 12, text: "tackling obesity", answer: "C" },
                { question: 13, text: "eating up fertile land", answer: "B" }
            ];

            // Define the text passages and their corresponding question numbers for Part 2 (A New Perspective on Bacteria)
            const part2Highlights = [
                { question: 14, text: "lactocillin", answer: "F" },
                { question: 15, text: "Microbes are organisms too small", answer: "A" },
                { question: 16, text: "DNA sequencing", answer: "F" },
                { question: 17, text: "Inside every human being, there are trillions of bacteria", answer: "D" },
                { question: 18, text: "Michael Fischbach", answer: "E" },
                { question: 19, text: "distinctive cellular structure", answer: "B" },
                { question: 20, text: "bacillus", answer: "B" },
                { question: 21, text: "oxygen levels rose dramatically", answer: "A" },
                { question: 22, text: "ubiquity of microbes", answer: "D" },
                { question: 23, text: "as heavy as the brain", answer: "brain" },
                { question: 24, text: "almost 34,000 species", answer: "34000" },
                { question: 25, text: "human body itself is a ready supply", answer: "human body" },
                { question: 26, text: "respect and excitement", answer: "respect" }
            ];

            // Define the text passages and their corresponding question numbers for Part 3 (Vikings)
            const part3Highlights = [
                { question: 27, text: "origins of the word 'Viking', itself, are obscure", answer: "obscure" },
                { question: 28, text: "Vikings sailed to England in AD 793", answer: "793" },
                { question: 29, text: "Vikings raided as far away as Northwest Africa", answer: "Northwest Africa" },
                { question: 30, text: "assimilated into local populations", answer: "local populations" },
                { question: 31, text: "monotheistic religious system – Christianity", answer: "religious" },
                { question: 32, text: "ninth-century Persian geographer, Ibn Khordadbeh", answer: "F" },
                { question: 33, text: "Herbert Spencer", answer: "D" },
                { question: 34, text: "some Danish historians cal1 these sources 'mere legends'", answer: "E" },
                { question: 35, text: "today's children can visit museums where Vikings are celebrated", answer: "A" },
                { question: 36, text: "during the Soviet period, there was an emphasis on the Slavic origins", answer: "G" },
                { question: 37, text: "Gustav Storm", answer: "B" },
                { question: 38, text: "Sweden was keen to boost its image", answer: "C" },
                { question: 39, text: "western Russian DNA is consistent with that of the inhabitants of a region north of Stockholm", answer: "H" },
                { question: 40, text: "Interpretations of Viking history", answer: "D" }
            ];

            // Function to apply highlights to a passage
            function applyHighlights(passageElement, highlights) {
                if (!passageElement) return;

                // Clear any existing highlights
                passageElement.querySelectorAll('.answer-highlight').forEach(el => {
                    const parent = el.parentNode;
                    parent.replaceChild(document.createTextNode(el.textContent), el);
                    parent.normalize();
                });

                // Add highlights for each answer
                highlights.forEach(item => {
                    const paragraphs = passageElement.querySelectorAll('p');
                    paragraphs.forEach(paragraph => {
                        const html = paragraph.innerHTML;
                        if (!html || typeof html !== 'string') return;
                        if (html.includes(item.text)) {
                            const escapeRegExp = s => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                            const re = new RegExp(escapeRegExp(item.text));
                            const replaced = html.replace(
                                re,
                                `<span class="answer-highlight" data-question="${item.question}" style="
                                    background-color: #ffeb3b;
                                    padding: 2px 4px;
                                    border-radius: 3px;
                                    font-weight: bold;
                                    position: relative;
                                ">${item.text}<span style="
                                    position: absolute;
                                    top: -8px;
                                    right: -8px;
                                    background-color: #2196f3;
                                    color: white;
                                    border-radius: 50%;
                                    width: 20px;
                                    height: 20px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 12px;
                                    font-weight: bold;
                                ">${item.question}</span></span>`
                            );
                            paragraph.innerHTML = replaced;
                        }
                    });
                });
            }

            // Apply highlights to Part 1 (The Plight of Rice)
            const passageText1 = document.getElementById('passage-text-1');
            applyHighlights(passageText1, part1Highlights);

            // Apply highlights to Part 2 (A New Perspective on Bacteria)
            const passageText2 = document.getElementById('passage-text-2');
            applyHighlights(passageText2, part2Highlights);

            // Apply highlights to Part 3 (Vikings)
            const passageText3 = document.getElementById('passage-text-3');
            applyHighlights(passageText3, part3Highlights);
        }

        function getUserAnswer(qNum) {
            const textInput = document.getElementById(`q${qNum}`);
            const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
            const selectInput = document.querySelector(`select[name="q${qNum}"]`);

            if (textInput) { // Handles <input type="text">
                return { value: textInput.value, text: textInput.value || 'N/A' };
            }
            if (selectInput) { // Handles <select>
                return { value: selectInput.value, text: selectInput.value || 'N/A' };
            }
            if (radioInput) {
                return { value: radioInput.value, text: radioInput.value };
            }
            // Handle clickable cells for questions 32-39
            if (qNum >= 32 && qNum <= 39) {
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return { value: selectedCell.dataset.answer, text: selectedCell.dataset.answer };
                }
            }
            return { value: null, text: 'N/A' };
        }

        function displayCorrectAnswer(qNum, correctAnswer) {
            // Handle radio button questions by highlighting the correct label
            const correctRadioInput = document.querySelector(`input[name="q${qNum}"][value="${correctAnswer}"]`);
            if (correctRadioInput) {
                const parentOption = correctRadioInput.closest('.tf-option, .multi-choice-option');
                if (parentOption) {
                    parentOption.classList.add('correct-answer-highlight');
                    return;
                }
            }

            // Handle text inputs, select dropdowns, and others by showing the answer next to them
            const inputEl = document.getElementById(`q${qNum}`);
            if (inputEl) {
                const displaySpan = document.createElement('span');
                displaySpan.className = 'correct-answer-display';
                displaySpan.textContent = ` ✓ ${correctAnswer}`;
                inputEl.insertAdjacentElement('afterend', displaySpan);
                return; // Done
            }
            
            // Fallback for questions identified by a container (e.g., some T/F/NG questions)
            const element = findQuestionElement(qNum);
            if (element) {
                const displaySpan = document.createElement('span');
                displaySpan.className = 'correct-answer-display';
                displaySpan.textContent = ` ✓ ${correctAnswer}`;
                const itemContainer = element.querySelector('.tf-question-text');
                if (itemContainer) {
                     itemContainer.appendChild(displaySpan);
                } else {
                     element.appendChild(displaySpan);
                }
            }
        }
        
        function findQuestionElement(qNum) {
             return document.querySelector(`[data-q-start="${qNum}"]`);
        }

        function addResultToModal(qNum, userAnswer, correctAnswer, isCorrect) {
            const resultsDetails = document.getElementById('results-details');
            const row = document.createElement('div');
            row.className = 'result-row';
            if (!isCorrect) {
                row.classList.add('incorrect');
            }
            row.innerHTML = `
                <span class="q-num">${qNum}</span>
                <span class="user-ans">${userAnswer}</span>
                <span class="correct-ans">${correctAnswer}</span>
            `;
            resultsDetails.appendChild(row);
        }

        function showResultsModal() {
            document.getElementById('results-modal').classList.remove('hidden');
        }

        window.closeResultsModal = function() {
            document.getElementById('results-modal').classList.add('hidden');
            document.body.classList.remove('results-mode');
        }
        
        function disableInputs() {
            deliverButton.innerHTML = `<span>Checked! View Results.</span>`;
            deliverButton.removeEventListener('click', checkAnswers);
            deliverButton.onclick = showResultsModal;

            document.querySelectorAll('input, select').forEach(el => {
                el.disabled = true;
                 if (el.matches('input[type=radio], input[type=checkbox]')) {
                     el.style.cursor = 'not-allowed';
                     el.parentElement.style.cursor = 'not-allowed';
                 }
            });
            document.querySelectorAll('.drag-item').forEach(el => {
                el.setAttribute('draggable', 'false');
                el.style.cursor = 'default';
            });
            document.querySelectorAll('.drop-zone').forEach(el => {
                el.classList.add('disabled');
            });
        }

        function checkValue(userValue, correctValue) {
            if (userValue === null || userValue === undefined) return false;
            const formattedUserValue = userValue.trim().toLowerCase();
            if (Array.isArray(correctValue)) {
                return correctValue.map(v => v.toLowerCase()).includes(formattedUserValue);
            } else {
                return formattedUserValue === String(correctValue).toLowerCase();
            }
        }

        function markQuestion(qNum, isCorrect) {
            const subQuestionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
            subQuestionBtn?.classList.add(isCorrect ? 'correct' : 'incorrect');

            const elementsToMark = [
                document.querySelector(`.tf-question[data-q-start="${qNum}"]`),
                document.querySelector(`.multi-choice-question[data-q-start="${qNum}"]`),
                document.querySelector(`.matching-question-item[data-q-start="${qNum}"]`),
                document.querySelector(`.drop-zone[data-q-start="${qNum}"]`),
                document.getElementById(`q${qNum}`),
                document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.tf-option'),
                document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.multi-choice-option')
            ];
            
            elementsToMark.forEach(el => {
                if (el) el.classList.add(isCorrect ? 'correct' : 'incorrect');
            });

             if (qNum === 14 || qNum === 15) {
                const multiChoiceContainer = document.querySelector('.multi-choice-question[data-q-start="14"]');
                if (multiChoiceContainer) multiChoiceContainer.classList.add(isCorrect ? 'correct' : 'incorrect');
             } else if (qNum >= 1 && qNum <= 5) {
                const pMatchInput = document.getElementById(`q${qNum}`);
                const tfQuestionContainer = document.querySelector(`.tf-question[data-q-start="${qNum}"]`);
                if (pMatchInput) pMatchInput.classList.add(isCorrect ? 'correct' : 'incorrect');
                if (tfQuestionContainer) tfQuestionContainer.classList.add(isCorrect ? 'correct' : 'incorrect');
            }
        }

        function switchToPart(partNumber) {
            console.log(`🔀 switchToPart called with partNumber: ${partNumber}, currentPassage: ${currentPassage}`);
            
            currentPassage = partNumber;

            // Hide all passages and questions
            document.querySelectorAll('.reading-passage, .question-set, .part-header').forEach(el => {
                el.classList.add('hidden');
            });

            // Show the correct passage, questions, and header
            document.getElementById(`passage-text-${partNumber}`).classList.remove('hidden');
            document.getElementById(`questions-${partNumber}`).classList.remove('hidden');
            document.getElementById(`part-header-${partNumber}`).classList.remove('hidden');

            // Update bottom navigation 'selected' state
            document.querySelectorAll('.footer__questionWrapper___1tZ46').forEach((wrapper, index) => {
                wrapper.classList.toggle('selected', (index + 1) === partNumber);
            });

            console.log(`✅ switchToPart completed - switched to part ${partNumber}`);
            
            // Only go to first question when switching parts, not when staying in same part
            // This allows goToQuestion to work properly for specific question navigation
            // const firstQuestionOfPart = {1: 1, 2: 14, 3: 27}[partNumber];
            // goToQuestion(firstQuestionOfPart);
        }
        
        function goToQuestion(questionNumber) {
            console.log(`🎯 goToQuestion called with questionNumber: ${questionNumber}, currentQuestion: ${currentQuestion}, currentPassage: ${currentPassage}`);
            
            currentQuestion = questionNumber;

            let passageNumber = 1;
            if (questionNumber >= 14 && questionNumber <= 26) passageNumber = 2;
            else if (questionNumber >= 27) passageNumber = 3;
            
            console.log(`📍 Calculated passageNumber: ${passageNumber} for question ${questionNumber}`);
            
            if (currentPassage !== passageNumber) {
                console.log(`🔄 Switching from part ${currentPassage} to part ${passageNumber} for question ${questionNumber}`);
                switchToPart(passageNumber);
                return; 
            }

            console.log(`✅ Staying in same part (${currentPassage}) for question ${questionNumber}`);

            if (activeQuestionElement) {
                // Remove active style from previous block
                activeQuestionElement.classList.remove('active-question', 'active-input');
                // Also remove from the container block if we previously set it
                const prevBlock = activeQuestionElement.closest('[data-q-start]');
                if (prevBlock) prevBlock.classList.remove('active-question');
            }

            // First, try to find the specific input element
            let targetEl = document.getElementById(`q${questionNumber}`);
            if (targetEl) {
                activeQuestionElement = targetEl;
                console.log(`✅ Found specific input element:`, targetEl);
                targetEl.classList.add('active-input');
                scrollIntoViewIfNeeded(targetEl);
            } else {
                // Fall back to looking for question containers
                targetEl = document.querySelector(`[data-q-start="${questionNumber}"]`);
                console.log(`🔍 Looking for target element with data-q-start="${questionNumber}":`, targetEl);

                if (targetEl) {
                    activeQuestionElement = targetEl;
                    console.log(`✅ Found target element:`, targetEl);
                    
                    if (targetEl.matches('input[type="text"]') || targetEl.matches('select')) {
                        targetEl.classList.add('active-input');
                        console.log(`📝 Added active-input class to input/select element`);
                    } else {
                        targetEl.classList.add('active-question');
                        console.log(`📋 Added active-question class to question element`);
                    }
                    scrollIntoViewIfNeeded(targetEl);
                } else {
                    console.log(`⚠️ Target element not found, looking for paragraph matching question`);
                    const pMatch = document.querySelector(`.paragraph-matching-question select[id="q${questionNumber}"]`);
                    if(pMatch) {
                        activeQuestionElement = pMatch;
                        pMatch.classList.add('active-input');
                        scrollIntoViewIfNeeded(pMatch);
                        console.log(`✅ Found paragraph matching question:`, pMatch);
                    } else {
                        console.log(`❌ No target element found for question ${questionNumber}`);
                    }
                }
            }

            updateNavigation();
            console.log(`✅ goToQuestion completed for question ${questionNumber}`);
        }
        
        // --- UI & NAVIGATION ---

        function updateNavigation() {
            console.log(`🔄 updateNavigation called for currentQuestion: ${currentQuestion}`);
            
            const navButtons = document.querySelectorAll('.subQuestion');
            navButtons.forEach(btn => btn.classList.remove('active'));
            const activeNav = document.querySelector(`.subQuestion[onclick="goToQuestion(${currentQuestion})"]`);
            if (activeNav) {
                activeNav.classList.add('active');
                console.log(`✅ Updated navigation - active nav button:`, activeNav);
            } else {
                console.log(`⚠️ No active navigation button found for question ${currentQuestion}`);
            }

            const inputs = document.querySelectorAll('.answer-input, .drop-zone.filled, .summary-drop-zone.filled');
            inputs.forEach(input => input.classList.remove('active-input'));
            
            const activeInput = document.getElementById(`q${currentQuestion}`);
            if (activeInput) {
                activeInput.classList.add('active-input');
                if (typeof activeInput.focus === 'function') {
                    activeInput.focus();
                }
                console.log(`✅ Focused on input element:`, activeInput);
            } else {
                console.log(`⚠️ No direct input found for question ${currentQuestion}, looking in question block`);
                // Prefer the specific question element for styling (TF/MCQ), fallback to any data-q-start container
                let activeQuestionBlock = document.querySelector(`.tf-question[data-q-start="${currentQuestion}"]`) 
                    || document.querySelector(`.multi-choice-question[data-q-start="${currentQuestion}"]`) 
                    || document.querySelector(`[data-q-start="${currentQuestion}"]`);
                if (activeQuestionBlock) {
                    // Add active-question class to style number badge
                    activeQuestionBlock.classList.add('active-question');
                    const firstInput = activeQuestionBlock.querySelector('input, select');
                    if(firstInput) {
                        firstInput.classList.add('active-input');
                         if (typeof firstInput.focus === 'function') {
                            firstInput.focus();
                        }
                        console.log(`✅ Focused on input in question block:`, firstInput);
                    } else {
                        console.log(`⚠️ No input found in question block for question ${currentQuestion}`);
                    }
                } else {
                    console.log(`❌ No question block found for question ${currentQuestion}`);
                }
            }
            
            console.log(`✅ updateNavigation completed`);
        }
        
        function selectDragItem(item) {
            if (selectedDragItem) {
                selectedDragItem.classList.remove('selected');
            }
            selectedDragItem = item;
            if (selectedDragItem) {
                selectedDragItem.classList.add('selected');
            }
        }
        
        window.nextQuestion = () => currentQuestion < 40 && goToQuestion(currentQuestion + 1);
        window.previousQuestion = () => currentQuestion > 1 && goToQuestion(currentQuestion - 1);

        function updateAllIndicators() {
            updateAttemptedCount(1, 1, 13);
            updateAttemptedCount(2, 14, 26);
            updateAttemptedCount(3, 27, 40);
            updateAnsweredNav();
        }
        
            function updateAnsweredNav() {
            const navButtons = document.querySelectorAll('.subQuestion');
            navButtons.forEach(btn => {
                const qNum = parseInt(btn.textContent, 10);
                if (isQuestionAnswered(qNum)) {
                    btn.classList.add('answered');
                } else {
                    btn.classList.remove('answered');
                }
            });
        }
        
            function isQuestionAnswered(qNum) {
            const textInput = document.getElementById(`q${qNum}`);
            if (textInput && textInput.value.trim() !== '') {
                return true;
            }
            // Check for select elements (questions 14-18)
            const selectInput = document.querySelector(`select[name="q${qNum}"]`);
            if (selectInput && selectInput.value.trim() !== '') {
                return true;
            }
            const radio = document.querySelector(`input[name="q${qNum}"]:checked`);
            if (radio) {
                return true;
            }
            // Handle clickable-cell matrix questions (questions 32-39)
            const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
            if (selectedCell) {
                return true;
            }
            return false;
        }

        function scrollIntoViewIfNeeded(element) {
            const panel = element.closest('.questions-panel, .passage-panel');
            const panelRect = panel.getBoundingClientRect();
            const elementRect = element.getBoundingClientRect();
            if (elementRect.top < panelRect.top || elementRect.bottom > panelRect.bottom) {
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        // --- DRAG AND DROP ---
        
        function initializeDragAndDrop() {
            document.querySelectorAll('.drag-item').forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('click', () => selectDragItem(item));
            });
            document.querySelectorAll('.drop-zone, .drag-options-container, .summary-drop-zone').forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });
        }

        function handleDragStart(e) {
            draggedItem = e.target;
            setTimeout(() => e.target.classList.add('dragging'), 0);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedItem = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            const targetZone = e.currentTarget;
            if (draggedItem && draggedItem.dataset.dndGroup === targetZone.dataset.dndGroup) {
                targetZone.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const targetZone = e.currentTarget;
            targetZone.classList.remove('drag-over');

            if (!draggedItem || draggedItem.dataset.dndGroup !== targetZone.dataset.dndGroup) {
                return;
            }

            const sourceZone = draggedItem.parentElement;
            if (sourceZone === targetZone) return; // Prevent dropping on itself

            const existingItemInTarget = (targetZone.classList.contains('drop-zone') || targetZone.classList.contains('summary-drop-zone')) 
                ? targetZone.querySelector('.drag-item') 
                : null;

            // First, clear the target drop-zone of any text (like question numbers) before adding the new item.
            if (targetZone.classList.contains('drop-zone') || targetZone.classList.contains('summary-drop-zone')) {
                Array.from(targetZone.childNodes).forEach(node => {
                    if (node.nodeType === Node.TEXT_NODE) {
                        node.remove();
                    }
                });
            }

            // Move the item that was in the target (if any) to the source zone.
            if (existingItemInTarget) {
                sourceZone.appendChild(existingItemInTarget);
            }
            
            // Finally, move the dragged item to the target zone.
            targetZone.appendChild(draggedItem);
            targetZone.classList.add('filled');
            // Lock the pill-like appearance for items dropped into zones
            if (draggedItem) {
                draggedItem.style.cursor = 'default';
            }
            // Hide placeholder text (question number) once filled
            if (targetZone.textContent && /^\d+$/.test(targetZone.textContent.trim())) {
                targetZone.textContent = '';
            }

            // After the move, clean up the source zone if it's a drop-zone and is now empty.
            if ((sourceZone.classList.contains('drop-zone') || sourceZone.classList.contains('summary-drop-zone')) && !sourceZone.querySelector('.drag-item')) {
                 sourceZone.classList.remove('filled');
                 const qNum = sourceZone.dataset.qStart;
                 if (sourceZone.classList.contains('drop-zone')) {
                     sourceZone.innerText = qNum; // Restore the question number
                 }
            }
            
            updateAllIndicators();
        }
        
        // --- MISC HELPERS ---
        
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval); // Ensure no multiple intervals
            timerInterval = setInterval(() => {
                timeInSeconds--;
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                if (timeInSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "Time's up!";
                    // checkAnswers(); // Disabled to prevent modal from opening automatically.
                }
            }, 1000);
            timerToggleButton.innerHTML = pauseIcon;
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            timerToggleButton.innerHTML = playIcon;
        }

        function toggleTimer() {
            // Check based on the icon currently displayed
            if (timerToggleButton.innerHTML.includes('M6 19h4V5H6v14z')) { // Check for pause icon shape
                pauseTimer();
            } else {
                startTimer();
            }
        }

        function resetTimer() {
            timeInSeconds = 3600;
            const minutes = Math.floor(timeInSeconds / 60);
            const seconds = timeInSeconds % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            startTimer();
            timerToggleButton.innerHTML = pauseIcon;
        }
        
        function setupCheckboxLimits() {
            // No checkbox groups in this test
        }

        function setupExampleHeading() {
            // No example box in this test
        }
        
        function initResize(e) {
            e.preventDefault();
            const startX = e.clientX;
            const startWidth = passagePanel.offsetWidth;
            
            const doDrag = (e) => {
                const newWidth = startWidth + e.clientX - startX;
                if (newWidth > 200 && (document.body.clientWidth - newWidth - resizer.offsetWidth) > 200) {
                    passagePanel.style.flex = `0 0 ${newWidth}px`;
                }
            };
            const stopDrag = () => {
                window.removeEventListener('mousemove', doDrag, false);
                window.removeEventListener('mouseup', stopDrag, false);
            };
            
            window.addEventListener('mousemove', doDrag, false);
            window.addEventListener('mouseup', stopDrag, false);
        }
        
        // --- CONTEXT MENU (Highlighting) ---
        
        function initializeContextMenu() {
            const panels = [passagePanel, questionsPanel];
            let targetElementForClear = null;

            // This listener simply tracks the last valid text selection in either panel.
            document.addEventListener('selectionchange', () => {
                const selection = window.getSelection();
                if (selection && !selection.isCollapsed && selection.toString().trim().length > 0) {
                    const range = selection.getRangeAt(0);
                    if (panels.some(panel => panel.contains(range.commonAncestorContainer))) {
                        selectedRange = range;
                        targetElementForClear = null; // New selection overrides clearing a specific element
                    }
                }
            });

            const showContextMenu = (e) => {
                const target = e.target;
                const isClickOnHighlight = target.closest('.highlight, .comment-highlight');
                const isSelectionActive = selectedRange && selectedRange.toString().trim().length > 0;
                
                let showMenu = false;

                if (isClickOnHighlight) {
                    document.getElementById('menu-highlight').style.display = 'none';
                    document.getElementById('menu-note').style.display = 'none';
                    document.getElementById('menu-clear').style.display = 'block';
                    document.getElementById('menu-clear-all').style.display = 'block';
                    contextMenu.targetElementForClear = isClickOnHighlight;
                    showMenu = true;
                } else if (isSelectionActive && panels.some(panel => panel.contains(selectedRange.commonAncestorContainer))) {
                    document.getElementById('menu-highlight').style.display = 'flex';
                    document.getElementById('menu-note').style.display = 'flex';
                    document.getElementById('menu-clear').style.display = 'none';
                    document.getElementById('menu-clear-all').style.display = 'block'; // Always show clear all
                    showMenu = true;
                }

                if (showMenu) {
                    e.preventDefault();
                    contextMenu.style.display = 'block';
                    const menuHeight = contextMenu.offsetHeight;
                    const menuWidth = contextMenu.offsetWidth;
                    let left = e.pageX;
                    let top = e.pageY;
                    if (left + menuWidth > window.innerWidth) left = window.innerWidth - menuWidth - 5;
                    if (top + menuHeight > window.innerHeight) top = e.pageY - menuHeight - 5;
                    else top = e.pageY - menuHeight - 5;
                    
                    contextMenu.style.left = `${left}px`;
                    contextMenu.style.top = `${top}px`;
                }
            };

            panels.forEach(panel => {
                panel.addEventListener('contextmenu', showContextMenu);
            });

            document.addEventListener('click', (e) => {
                if (contextMenu.style.display === 'block' && !contextMenu.contains(e.target)) {
                    closeContextMenu();
                }
            });
        }

        function closeContextMenu() {
            contextMenu.style.display = 'none';
            selectedRange = null; // Clear range after menu closes
        }

        function unwrapElement(element) {
            const parent = element.parentNode;
            if (!parent) return;
            while (element.firstChild) {
                parent.insertBefore(element.firstChild, element);
            }
            parent.removeChild(element);
            parent.normalize();
        }

        window.highlightText = () => {
            if (selectedRange && !selectedRange.collapsed) {
                const span = document.createElement('span');
                span.className = 'highlight';
                span.appendChild(selectedRange.extractContents());
                selectedRange.insertNode(span);
            }
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        window.addNote = () => {
            const note = prompt('Enter your note:');
            if (note && selectedRange && !selectedRange.collapsed) {
                const span = document.createElement('span');
                span.className = 'comment-highlight';
                const tooltip = document.createElement('span');
                tooltip.className = 'comment-tooltip';
                tooltip.textContent = note;
                span.appendChild(selectedRange.extractContents());
                span.appendChild(tooltip);
                selectedRange.insertNode(span);
            }
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        window.clearHighlight = () => {
             const elementToClear = contextMenu.targetElementForClear;
             if (elementToClear) {
                 unwrapElement(elementToClear);
             }
             closeContextMenu();
             window.getSelection().removeAllRanges();
        };
        
        window.clearAllHighlights = () => {
            document.querySelectorAll('.highlight, .comment-highlight').forEach(unwrapElement);
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        function updateAttemptedCount(part, startQ, endQ) {
            let answeredCount = 0;
            for (let i = startQ; i <= endQ; i++) {
                if (isQuestionAnswered(i)) {
                    answeredCount++;
                }
            }
            const partHeader = document.querySelector(`.footer__questionNo___3WNct[onclick="switchToPart(${part})"]`);
            if (partHeader) {
                const countSpan = partHeader.querySelector('.attemptedCount');
                if (countSpan) {
                     countSpan.textContent = `${answeredCount} of ${endQ - startQ + 1}`;
                }
            }
        }

        // --- GLOBAL FUNCTION EXPOSURE ---
        window.nextQuestion = nextQuestion;
        window.previousQuestion = previousQuestion;
        window.goToQuestion = goToQuestion;
        window.switchToPart = switchToPart;
        window.closeResultsModal = closeResultsModal;
        window.highlightText = highlightText;
        window.addNote = addNote;
        window.clearHighlight = clearHighlight;
        window.clearAllHighlights = clearAllHighlights;
        
        // Global function for selecting cells
        window.selectCell = function(cell, questionNum, value) {
            console.log('selectCell called:', questionNum, value);
            
            // Remove selected class from all cells in the same row
            const row = cell.closest('tr');
            const cellsInRow = row.querySelectorAll('.clickable-cell');
            cellsInRow.forEach(c => {
                c.classList.remove('selected');
                c.removeAttribute('data-selected');
                c.removeAttribute('data-answer');
            });
            
            // Add selected class to clicked cell
            cell.classList.add('selected');
            cell.setAttribute('data-selected', 'true');
            cell.setAttribute('data-answer', value);
            
            console.log('Cell selected:', questionNum, value);
            updateAllIndicators();
        };

        // --- START THE APP ---
        initialize();

        // Add event listeners for table radio buttons
        document.addEventListener('DOMContentLoaded', function() {
            const tableRadios = document.querySelectorAll('.table-radio');
            tableRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Remove background color from all cells in the same row
                    const row = this.closest('tr');
                    const cells = row.querySelectorAll('td:not(.statement)');
                    cells.forEach(cell => {
                        cell.style.backgroundColor = '';
                    });
                    
                    // Add background color to the selected cell
                    if (this.checked) {
                        this.closest('td').style.backgroundColor = '#e3f2fd';
                    }
                    
                    updateAllIndicators();
                });
            });
            
            // Initialize mobile features
            initializeMobileFeatures();
        });
        
        // Mobile-specific improvements
        function initializeMobileFeatures() {
            // Add touch event listeners for mobile
            if ('ontouchstart' in window) {
                console.log('📱 Mobile device detected, initializing touch features');
                
                // Improve touch handling for question navigation
                document.querySelectorAll('.subQuestion').forEach(btn => {
                    btn.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(0.95)';
                    }, { passive: false });
                    
                    btn.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(1)';
                    }, { passive: false });
                });
                
                // Improve touch handling for part navigation
                document.querySelectorAll('.footer__questionNo___3WNct').forEach(btn => {
                    btn.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(0.95)';
                    }, { passive: false });
                    
                    btn.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(1)';
                    }, { passive: false });
                });
                
                // Improve touch handling for radio buttons
                document.querySelectorAll('.tf-option, .multi-choice-option').forEach(option => {
                    option.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(0.98)';
                    }, { passive: false });
                    
                    option.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(1)';
                        // Trigger radio button selection
                        const radio = this.querySelector('input[type="radio"]');
                        if (radio) {
                            radio.checked = true;
                            radio.dispatchEvent(new Event('change'));
                        }
                    }, { passive: false });
                });
                
                // Improve touch handling for text inputs
                document.querySelectorAll('input[type="text"], select').forEach(input => {
                    input.addEventListener('touchstart', function(e) {
                        // Prevent zoom on iOS
                        this.style.fontSize = '16px';
                    });
                });
                
                // Improve touch handling for navigation arrows
                document.querySelectorAll('.nav-arrow').forEach(arrow => {
                    arrow.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(0.9)';
                    }, { passive: false });
                    
                    arrow.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(1)';
                    }, { passive: false });
                });
                
                // Improve touch handling for check answers button
                const deliverButton = document.getElementById('deliver-button');
                if (deliverButton) {
                    deliverButton.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(0.95)';
                    }, { passive: false });
                    
                    deliverButton.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        this.style.transform = 'scale(1)';
                    }, { passive: false });
                }
            }
            
            // Add mobile-specific scroll improvements
            if (window.innerWidth <= 768) {
                // Smooth scrolling for mobile
                document.documentElement.style.scrollBehavior = 'smooth';
                
                // Improve scroll performance on mobile
                document.addEventListener('scroll', function() {
                    // Throttle scroll events for better performance
                    if (!window.scrollTimeout) {
                        window.scrollTimeout = setTimeout(function() {
                            window.scrollTimeout = null;
                        }, 16); // ~60fps
                    }
                });
            }
        }

        // Note: switchToPart function is defined earlier in the code
        // This duplicate function has been removed to prevent conflicts
    });
    </script>
</body>
</html>