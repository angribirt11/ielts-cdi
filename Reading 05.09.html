<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Full Reading Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            line-height: 1.4;
            font-size: 16px;
        }



        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
        }

        .ielts-logo {
            display: none;
        }

        .test-info {
            display: flex;
            align-items: center;
            gap: 30px;
            font-size: 14px;
            color: #333;
        }

        .audio-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .audio-icon {
            width: 16px;
            height: 16px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>') no-repeat center;
        }

        .header-icons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .telegram-link {
            color: #0088cc;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .telegram-link:hover {
            text-decoration: underline;
        }

        .telegram-link::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: currentColor;
            -webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }

        #volume-slider {
            -webkit-appearance: none;
            width: 80px;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
        }

        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
        }

        #volume-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            border: none;
        }

        .icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0.7;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon:hover {
            opacity: 1;
        }

        #play-pause-btn {
            background: none;
            border: none;
            padding: 0;
        }

        .main-container {
            margin-top: 60px;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            height: calc(100vh - 60px);
            /* Full height minus header */
            position: relative;
        }

        /* Page watermark */
        body::after {
            content: "@Avazbeks_media";
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) rotate(-20deg);
            font-size: 72px;
            font-weight: 800;
            letter-spacing: 2px;
            color: #000000;
            opacity: 0.04;
            /* subtle */
            pointer-events: none;
            z-index: 0;
            white-space: nowrap;
        }

        .panels-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .passage-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
            /* Minimum width */
        }

        /* Passage Content */
        .text-center {
            text-align: center;
        }

        .reading-passage h4 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .reading-passage p {
            margin-bottom: 1.2em;
        }

        .question ul li label {
            display: block;
            margin-top: 8px;
            cursor: pointer;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
            /* Minimum width */
            border-left: 1px solid #e0e0e0;
        }

        .resizer {
            width: 10px;
            cursor: col-resize;
            background-color: #f0f0f0;
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="30" viewBox="0 0 10 30"><path d="M4 11h2v2H4zM4 15h2v2H4zM4 19h2v2H4z" fill="%23888"/></svg>');
            background-repeat: no-repeat;
            background-position: center;
            flex-shrink: 0;
            flex-grow: 0;
        }

        /* Left Panel */
        .left-panel {
            width: 100%;
            padding: 20px;
        }

        /* Right Panel */
        .right-panel {
            display: none;
            width: 50%;
            padding: 20px;
            position: relative;
        }

        .help-button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        .help-button:hover {
            background: #357abd;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .people-section {
            margin-bottom: 30px;
        }

        .people-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
        }

        .people-table th {
            text-align: left;
            padding: 10px;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .people-table td {
            padding: 8px 10px;
            border: 1px solid #ddd;
        }

        .person-name {
            font-size: 16px;
        }

        .question-number {
            background: white;
            border: 1px solid #4a90e2;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 14px;
            color: #4a90e2;
            min-width: 30px;
            text-align: center;
        }

        .assigned-responsibility {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 14px;
            border: 1px solid #ddd;
        }

        .responsibilities-section {
            margin-bottom: 30px;
        }

        .responsibility-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .responsibility-item {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .responsibility-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .responsibility-item.dragging {
            opacity: 0.5;
        }

        .questions-section {
            margin-bottom: 20px;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .instruction {
            margin-bottom: 20px;
            font-size: 16px;
            color: #666;
        }

        /* Map Styles */
        .map-container {
            position: relative;
            margin: 20px 0;
            display: flex;
            justify-content: center;
        }

        .map-svg {
            border: 2px solid #333;
            background: white;
        }

        .map-room {
            fill: #f9f9f9;
            stroke: #333;
            stroke-width: 1;
        }

        .map-text {
            font-family: Arial, sans-serif;
            font-size: 13px;
            text-anchor: middle;
            fill: #333;
        }

        .map-number {
            font-family: Arial, sans-serif;
            font-size: 16px;
            font-weight: bold;
            text-anchor: middle;
            fill: #333;
        }

        .room-labels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .room-label {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .room-label:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .room-label.dragging {
            opacity: 0.5;
        }

        /* Navigation Arrows */
        .nav-arrows {
            position: fixed;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 6px;
            z-index: 101;
        }

        .nav-arrow {
            width: 48px;
            height: 48px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: 700;
            color: #fff;
            transition: transform 0.1s ease, background-color 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
            outline: none;
        }

        .nav-arrow.prev {
            background-color: #4b5563;
        }

        .nav-arrow.next {
            background-color: #000000;
        }

        .nav-arrow:hover {
            transform: translateY(-1px);
        }

        .nav-arrow:active {
            transform: translateY(0);
        }

        .nav-arrow:focus-visible {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.4);
        }

        .nav-arrow:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Bottom Navigation - Exact Match */
        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;

            padding: 0;
            display: flex;
            align-items: center;
            height: 80px;
            z-index: 100;
        }

        .footer__questionWrapper___1tZ46 {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }


        .footer__questionNo___3WNct {
            background: none;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .footer__questionNo___3WNct:hover {
            background-color: #f8f9fa;
        }

        .section-prefix {
            font-size: 16px;
        }

        .sectionNr {
            font-size: 16px;
            font-weight: bold;
        }

        .attemptedCount {
            font-size: 14px;
            color: #666;
            margin-left: 5px;
            font-weight: 400;
            /* Normal weight */
        }

        @media (max-width: 768px) {
            .attemptedCount {
                display: none;
            }
        }

        .footer__questionWrapper___1tZ46.selected .attemptedCount {
            display: none;
        }

        .footer__subquestionWrapper___9GgoP {
            display: none;
            gap: 2px;
            margin-left: 10px;
        }

        .footer__questionWrapper___1tZ46.selected .footer__subquestionWrapper___9GgoP {
            display: flex;
        }

        .subQuestion {
            width: 32px;
            height: 32px;
            border: 1px solid #ccc;
            background: white;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-radius: 2px;
        }

        .subQuestion.answered {
            background-color: #e9ecef;
            border-color: #ddd;
        }

        .subQuestion.correct {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .subQuestion.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .subQuestion:hover {
            background-color: #f0f0f0;
            border-color: #999;
        }

        .subQuestion.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .subQuestion.completed {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .footer__deliverButton___3FM07 {
            margin-left: auto;
            margin-right: 20px;
            background-color: #f3f4f6;
            color: #111827;
            border: 1px solid #d1d5db;
            padding: 10px 16px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: transform 0.08s ease, background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            min-width: 160px;
            justify-content: center;
        }

        .footer__deliverButton___3FM07:hover {
            background-color: #ebedf0;
            border-color: #c7ccd4;
        }

        .footer__deliverButton___3FM07:active {
            transform: translateY(1px);
        }

        .footer__deliverButton___3FM07:focus-visible {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.35);
            outline: none;
        }

        .footer__deliverButton___3FM07:disabled {
            background: #eef0f3;
            color: #9ca3af;
            cursor: not-allowed;
            border-color: #e5e7eb;
            box-shadow: none;
        }



        .hidden {
            display: none !important;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: none;
            min-width: 140px;
        }

        .context-menu-item {
            padding: 12px 16px;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .context-menu-item:hover {
            background-color: #f8f9fa;
        }

        .context-menu-item:last-child {
            border-bottom: none;
        }

        .highlight {
            background-color: #ffff00;
        }

        .comment-highlight {
            background-color: #90EE90;
            position: relative;
            cursor: help;
        }

        .comment-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .comment-highlight:hover .comment-tooltip {
            opacity: 1;
        }

        .question {
            margin-bottom: 40px;
        }

        .question p {
            margin-bottom: 10px;
        }

        .question ul,
        .question .people-table {
            margin-top: 0;
        }

        .question-prompt {
            margin-bottom: 20px;
        }

        .question ul {
            list-style: none;
            padding-left: 0;
        }

        .question ul li {
            margin-bottom: 5px;
        }

        .answer-input {
            border: 1px solid #bfbfbf;
            border-radius: 4px;
            background-color: #fff;
            padding: 2px 8px;
            font-size: 16px;
            text-align: left;
            font-weight: 700;
            margin-right: 6px;
            margin-left: 6px;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            height: 28px;
            min-width: 150px;
        }

        .answer-input.active-input,
        .answer-input:focus {
            border-color: #3581d8;
            border-width: 2px;
            outline: none;
        }

        .answer-input::placeholder {
            color: #666;
            font-weight: 700;
            text-align: center;
        }

        .answer-input.correct {
            border-color: #28a745;
            background-color: #e9f7ef;
        }

        .answer-input.incorrect {
            border-color: #dc3545;
            background-color: #f8d7da;
            color: #721c24;
        }

        .answer-input {
            z-index: 10;
            position: relative;
            pointer-events: auto;
        }

        .summary-text .answer-input {
            width: 120px;
            height: 24px;
            font-size: 14px;
            margin: 0 4px;
        }

        .completion-table .answer-input {
            width: 120px;
            height: 24px;
            font-size: 14px;
            margin: 0 4px;
        }

        .answer-inputs {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .answer-inputs .answer-input {
            width: 200px;
            height: 30px;
            font-size: 16px;
        }

        .drag-drop-container {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }

        .recommendations-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-height: 200px;
        }

        .drag-item {
            background: white;
            border: 1px solid #9c9c9c;
            font-weight: 600;
            padding: 0px 5px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            transition: all 0.2s;
            user-select: none;
        }

        .drag-item:hover {
            background: #e9ecef;
        }

        .drag-item.dragging {
            opacity: 0.5;
        }

        .drag-item.selected {
            border-color: #4a90e2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.5);
        }

        .drop-zone {
            border: 2px dashed #aaa;
            border-radius: 4px;
            width: 50%;
            margin-top: 19px;
            margin-bottom: 5px;
            transition: background-color 0.2s, border-color 0.2s;
            padding: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .drop-zone.drag-over {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }

        .drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }

        .drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }

        .drop-zone.disabled {
            pointer-events: none;
        }

        .drop-zone .drag-item {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 15px;
            padding: 2px;
        }

        .drag-options-container {
            margin-top: 10px;
        }

        .drag-options-container .drag-item {
            display: block;
            width: fit-content;
            font-size: 15px;
            padding: 0.5px 10px;
            margin-bottom: 5px;
        }

        .drag-options-container .drag-item:last-child {
            margin-bottom: 0;
        }

        .q-number {
            color: #888;
            font-size: 14px;
            font-weight: bold;
        }

        .questions-container {
            width: 100%;
        }

        audio {
            width: 100%;
            margin-bottom: 20px;
        }

        .part-header {
            background-color: #f1f2ec;
            padding: 15px 20px;
            border: 1px solid #e0e0e0;
            text-align: left;
            margin: 10px 20px;
            border-radius: 5px;
        }

        .part-header p {
            margin: 0;
        }

        .part-header p:first-child {
            margin-bottom: 5px;
        }

        .question li.correct {
            color: #155724;
            font-weight: bold;
        }

        .question li.incorrect {
            color: #721c24;
        }

        .question li.correct::before {
            content: '✔ ';
            color: #28a745;
        }

        .question li.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }

        .example-box {
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .timer-container {
            display: flex;
            position: relative;
            cursor: default;
            color: #333;
            font-size: 16px;
            font-weight: 500;
            align-items: center;
        }

        .timer-container .timer-tooltip {
            display: none;
        }

        .timer-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 15px;
        }

        .timer-controls button {
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 50%;
            padding: 0;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .timer-controls button:hover {
            background: #e0e0e0;
        }

        .timer-controls button svg {
            width: 20px;
            height: 20px;
            fill: #333;
        }

        .audio-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(40, 40, 40, 0.9);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }

        .audio-modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 500px;
            padding: 20px;
        }

        .audio-modal-content p {
            font-size: 16px;
            line-height: 1.5;
            color: #eee;
        }

        .audio-modal-icon {
            margin-bottom: 20px;
        }

        .modal-play-btn {
            background-color: #000;
            color: white;
            border: 1px solid white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }

        .modal-play-btn:hover {
            background-color: #333;
        }

        #goto-widget {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        #goto-input {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        #goto-btn {
            padding: 4px 10px;
            border: 1px solid #ccc;
            background-color: #f0f0f0;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Styles for TRUE/FALSE/NOT GIVEN questions */
        .tf-question {
            margin-bottom: 25px;
            padding: 10px 0px;
            border-radius: 4px;
            transition: border-color 0.3s, background-color 0.3s;
        }

        .tf-question-line {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 5px 0px;
            border-radius: 4px;
        }

        .tf-question-number,
        .question-number-box {
            border: 2px solid #ccc;
            padding: 2px 8px;
            margin-right: 10px;
            border-radius: 3px;
            font-weight: bold;
            transition: border-color 0.3s;
            display: inline-block;
        }

        /* Active question blue outline for TF (clears when navigating away) */
        .tf-question.active-question .tf-question-number {
            border-color: #4a90e2;
        }

        .tf-question-text {
            padding-top: 3px;
        }

        .tf-options {
            padding-left: 5px;
        }

        .tf-option {
            display: block;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 10px 12px;
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            background-color: #fff;
        }

        .tf-option:hover {
            background-color: #f1f7ff;
            border-color: #c6dcfb;
        }

        .tf-option:has(input[type="radio"]:checked) {
            background-color: #cfe3f9;
            border-color: #7db3f5;
        }

        /* Answer checking states for TF/NG */
        .tf-option.correct {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            border-width: 1px;
        }

        .tf-option.incorrect {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            border-width: 1px;
        }

        /* Ensure selected-blue visuals don't conflict once results are shown */
        body.results-mode .tf-option:has(input[type="radio"]:checked) {
            box-shadow: none;
        }

        .tf-option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .tf-question.correct .tf-question-line {
            background-color: #e9f7ef;
        }

        .tf-question.incorrect .tf-question-line {
            background-color: #f8d7da;
        }

        .matching-question-container {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }

        .matching-options-bank {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .matching-questions {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .matching-question-item {
            display: flex;
            align-items: center;
            gap: 15px;

            border: 2px solid transparent;
            border-radius: 4px;
            transition: border-color 0.3s;
        }

        .matching-question-item>span {
            flex: 1;
        }

        .matching-question-item.correct {
            background-color: #e9f7ef;
            border-color: #28a745 !important;
        }

        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }

        .matching-question-item .drop-zone {
            width: auto;
            min-width: 200px;
            flex-shrink: 0;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            font-weight: bold;
            color: #aaa;
        }

        .matching-options-bank .drag-item {
            font-size: 15px;
            text-align: center;
            border: 1px solid #ccc;
            background: #f9f9f9;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
            /* Minimum width */
            border-left: 1px solid #e0e0e0;
        }

        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }

        .summary-completion-container {
            margin-top: 20px;
        }

        .summary-text p {
            line-height: 3.0;
            font-size: 16px;
            margin-bottom: 12px;
        }

        .summary-text li {
            line-height: 2.2;
            margin-bottom: 10px;
        }

        .summary-drop-zone {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            max-width: 200px;
            height: 25px;
            border: 2px dashed #999;
            border-radius: 4px;
            margin: 0 5px;
            padding: 0 5px;
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
            color: #aaa;
            font-weight: bold;
        }

        .summary-drop-zone.filled {
            border-color: #4a90e2;
        }

        .summary-drop-zone.active-input {
            border-color: #4a90e2;
            box-shadow: none;
        }

        .summary-drop-zone .drag-item {
            font-size: 15px;
            font-weight: bold;
            background-color: transparent;
            border: none;
            padding: 0;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .summary-options-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .summary-options-bank .drag-item {
            flex-grow: 1;
            min-width: 100px;
            text-align: center;
        }

        /* Filled drop-zone pill styling */
        .drop-zone.filled {
            background-color: transparent;
            border: none !important;
            outline: none !important;
            box-shadow: none !important;
            padding: 0;
        }

        .drop-zone.filled .drag-item {
            width: auto;
            height: auto;
            display: inline-block;
            border: 2px solid #4a90e2;
            border-radius: 10px;
            padding: 4px 10px;
            font-weight: 700;
            background: #fff;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.15);
            cursor: default;
            white-space: nowrap;
        }

        .multi-choice-question {
            margin-bottom: 20px;
            padding: 10px;
            border-radius: 4px;
            border: 3px solid transparent;
            transition: border-color 0.3s, background-color 0.3s;
        }

        /* MCQ number badge: style first strong within prompt */
        .multi-choice-question .question-prompt p>strong:first-child {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
            padding: 2px 6px;
            margin-right: 8px;
            border: 1px solid #d0d7e2;
            border-radius: 6px;
            background: #fff;
        }

        /* Active question blue outline for MCQ (clears when navigating away) */
        .multi-choice-question.active-question .question-prompt p>strong:first-child {
            border-color: #4a90e2;
            border-width: 2px;
        }

        .multi-choice-option {
            padding: 10px 12px;
            background-color: #fff;
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .multi-choice-option:hover {
            background-color: #f1f7ff;
            border-color: #c6dcfb;
        }

        .multi-choice-option:has(input:checked) {
            background-color: #cfe3f9;
            border-color: #7db3f5;
        }

        /* Answer checking states for MCQ */
        .multi-choice-option.correct {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            box-shadow: inset 0 0 0 2px rgba(40, 167, 69, 0.25) !important;
            border-width: 1px;
            border-radius: 6px;
        }

        .multi-choice-option.incorrect {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            box-shadow: inset 0 0 0 2px rgba(220, 53, 69, 0.25) !important;
            border-width: 1px;
            border-radius: 6px;
        }

        /* Correct answer reveal for unselected option after checking */
        .tf-option.correct-answer-highlight,
        .multi-choice-option.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
        }

        body.results-mode .multi-choice-option:has(input:checked) {
            box-shadow: none;
        }

        .multi-choice-option label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 16px;
        }

        .multi-choice-option input[type="checkbox"],
        .multi-choice-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.3);
            accent-color: #4a90e2;
        }

        .multi-choice-option.correct {
            background-color: #e9f7ef;
        }

        .multi-choice-option.incorrect {
            background-color: #f8d7da;
        }

        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }

        .matching-question-item .drop-zone.filled {
            border-color: #4a90e2;
        }

        .matching-question-item .drop-zone {
            width: 200px;
            height: 40px;
        }

        .paragraph-matching-question {
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 12px;
        }

        .paragraph-matching-question .answer-input {
            width: 80px;
            flex-shrink: 0;
        }

        .matching-form-container {
            margin-top: 20px;
        }

        .matching-form-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .matching-form-label {
            flex-shrink: 0;
        }

        /* Results Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(17, 24, 39, 0.6);
            backdrop-filter: blur(3px);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.hidden {
            display: none;
        }

        .modal-content {
            background: #ffffff;
            padding: 24px;
            border-radius: 14px;
            width: 92%;
            max-width: 780px;
            max-height: 86vh;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 1px solid #e5e7eb;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
        }

        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #666;
        }

        .modal-content h2 {
            text-align: center;
            margin-bottom: 18px;
            color: #111827;
        }

        .results-summary {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 16px;
            text-align: center;
            border-bottom: 1px solid #eef2f7;
            padding-bottom: 12px;
        }

        .results-summary p {
            margin: 0;
            font-size: 14px;
            color: #374151;
        }

        .results-summary p span {
            display: inline-block;
            padding: 4px 10px;
            margin-left: 6px;
            border-radius: 999px;
            background: #f3f4f6;
            font-weight: 700;
            color: #111827;
        }

        .results-details-container {
            overflow-y: auto;
            padding-right: 10px;
            /* For scrollbar */
            border-radius: 8px;
        }

        .result-row {
            display: grid;
            grid-template-columns: 56px 1fr 1fr;
            gap: 12px;
            padding: 10px 8px;
            border-bottom: 1px solid #eef2f7;
            font-size: 15px;
            align-items: center;
        }

        .result-row.correct {
            background-color: #f3faf5;
        }

        .result-row.incorrect {
            background-color: #fff5f5;
        }

        .result-row .q-num {
            font-weight: 700;
            color: #111827;
            background: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            width: 42px;
            height: 30px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .result-row .user-ans {
            color: #374151;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .result-row .correct-ans {
            color: #065f46;
            font-weight: 600;
            background: #ecfdf5;
            border: 1px solid #a7f3d0;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .correct-answer-display {
            font-weight: bold;
            color: #28a745;
            margin-left: 10px;
            font-size: 14px;
        }


        .centered-title {
            text-align: center;
            font-size: 50px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .matching-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }

        .matching-table th {
            background-color: #007bff;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .matching-table td {
            padding: 12px;
            border: 1px solid #ddd;
            vertical-align: top;
        }

        .matching-table .statement {
            text-align: left;
            width: 60%;
        }

        .matching-table .table-radio {
            margin: 0;
            transform: scale(1.2);
        }

        .matching-table td:not(.statement) {
            text-align: center;
            width: 6.67%;
            min-width: 60px;
        }

        .matching-table th:not(:first-child) {
            width: 6.67%;
            min-width: 60px;
        }

        .matching-table td:not(.statement):has(input:checked) {
            background-color: #e3f2fd;
        }

        .matching-table input[type="radio"]:checked {
            accent-color: #007bff;
        }

        .matching-table td.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }

        .matching-table td.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }

        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }

        .matching-table .options-row {
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }

        .matching-table .options-row td {
            font-weight: 500;
            text-align: center;
            padding: 8px 12px;
            font-size: 13px;
        }

        .matching-table .options-row td:first-child {
            text-align: left;
            font-weight: normal;
        }

        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }

        .matching-table .clickable-cell {
            cursor: pointer;
            transition: background-color 0.2s ease;
            min-height: 40px;
            border: 1px solid #ddd;
            position: relative;
        }

        .matching-table .clickable-cell:hover {
            background-color: #f0f8ff;
            border-color: #007bff;
        }

        .matching-table .clickable-cell.selected {
            background-color: #e3f2fd;
        }

        .matching-table .clickable-cell.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }

        .matching-table .clickable-cell.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }

        .matching-table .clickable-cell::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: transparent;
            transition: background-color 0.2s ease;
        }

        .matching-table .clickable-cell.selected::after {}

        /* Explanation Section Styles */
        .explanation-section {
            margin-top: 40px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .explanation-section h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
        }

        .explanation-content p {
            margin-bottom: 15px;
            line-height: 1.6;
            font-size: 16px;
        }

        .explanation-content strong {
            color: #4a90e2;
            font-weight: 600;
        }

        #show-explanation-btn {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        #show-explanation-btn:hover {
            background-color: #357abd;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="timer-container">
            <span class="timer-display">60:00</span>
            <div class="timer-controls">
                <button id="timer-toggle-btn" title="Pause/Resume Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px">
                        <path d="M0 0h24v24H0V0z" fill="none" />
                        <path d="M8 5v14l11-7L8 5z" />
                    </svg>
                </button>
                <button id="timer-reset-btn" title="Reset Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px">
                        <path d="M0 0h24v24H0V0z" fill="none" />
                        <path
                            d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z" />
                    </svg>
                </button>
            </div>
        </div>
        <a href="https://t.me/Avazbeks_Media" target="_blank" class="telegram-link">
            Avazbeks_Media
        </a>
    </div>

    <div class="main-container" id="main-container">
        <div id="passage-header-container">
            <div id="part-header-1" class="part-header">
                <p><strong>Part 1</strong></p>
                <p>Read the text and answer questions 1-13.</p>
            </div>
            <div id="part-header-2" class="part-header hidden">
                <p><strong>Part 2</strong></p>
                <p>Read the text and answer questions 14-26.</p>
            </div>
            <div id="part-header-3" class="part-header hidden">
                <p><strong>Part 3</strong></p>
                <p>Read the text and answer questions 27-40.</p>
            </div>
        </div>
        <div class="panels-container">
            <div class="passage-panel" id="passage-panel">
                <div id="passage-text-1" class="reading-passage">
                    <h4 class="text-center">Museums and family visitors in Australia</h4>
                    <p>Museums in Australia have recognised the need to become more responsive to their audiences,
                        especially families who visit museums in large numbers. Research has consistently found that
                        positive early family visits to museums have a significant impact on later visiting habits. What
                        is more, researchers have identified the importance of learning in family visits and the
                        different roles that various family members play before, during and after their visit.</p>
                    <p>For many years museums in Australia have acknowledged the importance of families as visitors,
                        with several establishing separate spaces for these groups, especially those with very young
                        children. Major museums have developed dedicated spaces specifically designed for children and
                        families. For example, the Melbourne Museum's Children's Gallery is aimed at three- to
                        eight-year-olds and has a mandate to encourage children to discover and explore within a range
                        of science issues. The goal is to provide an interactive, hands-on and playful space that
                        engages all the senses through continually updated exhibitions. The National Museum of Australia
                        in Canberra developed Kspace, an interactive space where children 'design their own future with
                        the help of technology. This museum also designed Our Place, a series of cosy play spaces where
                        children can explore the museum's themes in their own ways.</p>
                    <p>Other museums have also considered the entire family when designing their dedicated spaces. The
                        Australian National Maritime Museum in Sydney, when developing Pirates, its below-the-deck
                        pirate ship experience, realised that exhibitions aimed at children, particularly school-aged
                        children, also needed more sophisticated exhibits to occupy their accompanying parents. The
                        Powerhouse Museum in Sydney, while catering to varying tastes within families through its many
                        temporary exhibitions and programs, recognised the value of a dedicated space for children who
                        were visiting with their parents. The museum's installation, Zoe's House, caters specifically
                        for children aged three to five years, to facilitate cooperation in children through play.</p>
                    <p>Family visits to museums in Australia share a number of characteristics. Generally, visitors take
                        time for orientation, enter with a sense of curiosity, link what they see to their own prior
                        experiences and are most attracted to interactive displays. Their common viewing behaviour
                        involves looking very closely at each display in the first gallery and then skimming and moving
                        randomly in subsequent galleries. Their visiting behaviour is modified by increased experience
                        with the setting: they like to revisit favourite displays, share their viewing and learning in a
                        social context and interact with people from the museum. They respond to physical needs by using
                        the comfortable chairs provided or having a break after a little more than an hour, and
                        generally stay for two hours at most.</p>
                    <p>Research has found that adult members of family groups play three roles which are particularly
                        relevant to the family group during the visit, visit manager by directing and organising; museum
                        expert through explaining clarifying and correcting; and learning- facilitator in questioning
                        and reminiscing. These roles occur simultaneously, are closely linked to the process of learning
                        and are dependent on both the social context of the visit and the group composition,
                        particularly the ages of any accompanying children.</p>
                    <p>Parents consider museum visits to be valuable in creating and strengthening relationships with
                        their children and in enabling them to tune into what fascinates their children. Parents make
                        use of learning facilities such as open access libraries and activity kits if they know the
                        resources are there and understand their role. Family members each take notice of different
                        aspects of an exhibit and construct a shared meaning together. Museums are seen as a good clay
                        out, something the whole family can enjoy as a different form of education and are generally
                        considered good value for money.</p>
                    <p>In this increasingly complex world, where the real and virtual are blurring, and where changes in
                        society can seem overwhelming, museums are able to provide spaces for families to be together as
                        well as learn together. Parents value museum visits because they provide children with
                        opportunities to learn in different ways through bringing concepts to life and enhancing school
                        learning experiences. Museums stimulate visitors of all ages and open their minds to new ideas,
                        the world around them, history and other cultures. Children enjoy museums as places where they
                        can fantasise, explore and learn in ways that are more engaging than they experience in more
                        formal settings, such as school. Museums need to identify the elements that families value, the
                        ways families interact with museums, and how museums operate as extremely effective learning
                        units. The challenge is for museums to then apply these principles, not only to the development
                        of future exhibitions and programs, but also to the ways they plan for all visitors.</p>
                </div>
                <div id="passage-text-2" class="reading-passage hidden">
                    <h4 class="text-center">Boring buildings</h4>
                    <p>There could be more than an economic or nostalgic price to impersonal retail and high- rise
                        construction; boring architecture may take an emotional toll on the people forced to live with
                        it</p>
                    <p><strong>A</strong> A growing body of research in cognitive science illuminates the physical and
                        mental toll bland cityscapes take on residents. Generally, these researchers argue that humans
                        are healthier when they live surrounded by variety or work in well- designed, unique spaces,
                        rather than unattractive, generic ones. Urban policy professor Justin Hollander and architect
                        Ann Sussman review scientific data to help architects and urban planners understand how,
                        exactly, people respond to their built surroundings, particularly at work. People, they argue,
                        function best in intricate settings, not 'big, blank, boxy offices'</p>
                    <p><strong>B</strong> Indeed, that's what Colin Ellard, a neuroscientist at the University of
                        Waterloo in Canada, has found in his work. Five years ago, Ellard became interested in a certain
                        building - the gigantic Whole Foods Market 'plopped into' a notoriously textured part of lower
                        Manhattan in New York. Ellard partnered with the Guggenheim Museum to analyze what happens when
                        someone walks out of a tiny neighborhood restaurant and encounters a full city block with
                        nothing but 'the long, blank facade of the Whole Foods Market' building.</p>
                    <p>In 2011, Ellard led small groups on Lower East Side walks to measure the effect of the urban
                        environment on them. Participants recorded their response to questions at each stopping point
                        and wore sensors that measured skin conductance, a response to emotional excitement. Passing the
                        monolithic Whole Foods Market, people's state of arousal plummeted. Physiologically, Ellard
                        explained, they were bored. To describe this place, they used words like 'bland' and
                        'passionless'. In contrast, one block east at the other test site - a 'lively sea of restaurants
                        with lots of open doors and windows' - people measured high levels of excitement, and they
                        listed words like 'lively', and 'socializing'. Ellard explains that the main objective of urban
                        design should be to produce some kind of novelty or change every few seconds; otherwise, we
                        become cognitively disengaged.</p>
                    <p><strong>C</strong> The trick, it seems, is to design a world that excites but doesn't overload
                        our faculties with a constant barrage of information. 'We are, as animals, programmed to respond
                        to thrill,' said professor Brendan Walker. In Walker's 'thrill laboratory' at the University of
                        Nottingham in the UK, devices measure heart rate and skin conductance to see how people respond
                        to adrenaline-producing experiences such as a roller-coaster ride. A thrilling encounter moves
                        us quickly from a state of equilibrium to a desirable 'disorientation'. 'Humans want a certain
                        element of turmoil or confusion,' he said. 'Complexity is thrilling whether in an amusement park
                        or architecture.'</p>
                    <p><strong>D</strong> Psychologists have found that awe-inspiring moments can potentially improve
                        our well-being. One study conducted by Melanie Rudd, Kathleen Vohs and Jennifer Aaker of
                        Stanford University in the US showed that the feeling of 'awe' can make people more patient and
                        less materialistic. In an experiment, the researchers showed students 60- second clips of
                        waterfalls, whales, or astronauts in space. After only a minute of virtual images, those who
                        said they were awed also felt less pressed for time. And in another variation, people made
                        hypothetical choices between physical and experiential goods of equal monetary value. Those who
                        had just 'felt awe' were more likely to choose an experience over a possession, a choice that is
                        linked with greater satisfaction in the long run. In other words, a visual buzz - whether
                        architectural or natural - might have the ability to change our frame of mind, making modern-day
                        life more satisfying and interactive.</p>
                    <p><strong>E</strong> It's important to note, however, that architectural boredom isn't about how
                        pristine a street is. People often confuse successful architecture with whether an area looks
                        pleasant. On the contrary, when it comes to city buildings, people often focus too narrowly on
                        aesthetics, said Charles Montgomery, author of Happy City: Transforming Our Lives Through Urban
                        Design. Some of the happiest blocks in New York City, he argues, are 'kind of ugly and messy'.
                    </p>
                    <p>In 2014, Montgomery's Happy City lab conducted an experiment in which he found a strong
                        correlation between messier blocks and pro-social behavior. Montgomery sent researchers, posing
                        as lost tourists, to places he coded as either 'active' or 'inactive' facades. He concluded that
                        the former had a high level of interest, that is they were messy, while the latter had no
                        special features such as long warehouse blocks.</p>
                    <p>Pedestrians at active sites were nearly five times more likely to offer assistance than at
                        inactive ones. Of those who assisted, seven times as many at the active site offered use of
                        their phone.</p>
                    <p><strong>F</strong> Fortunately, it's not necessarily a dichotomy - new architecture can achieve
                        the optimal level of cacophony and beauty. Take the 2006 Hearst Tower in midtown Manhattan.
                        Designed by architect Norman Foster, Hearst Tower is a glass-and-steel skyscraper, 40 stories of
                        which are designed in a triangular pattern, differing in style from the 1920s Art Deco base.
                        From the outside, the facade jolts city dwellers from their daily commutes, while energizing
                        employees who enter it each morning. For many who walk by, Hearst Tower's design may not be the
                        easiest to understand; it's both sleek and old. The top looks like it traveled from the future.
                        Inside, workers travel upon diagonal escalators, up a three-story water sculpture, through the
                        tower's historic atrium, flooded with light. Few New Yorkers who pass by would find this
                        building boring. And they're likely to be happier - maybe even nicer to each other - because of
                        it.</p>
                </div>
                <div id="passage-text-3" class="reading-passage hidden">
                    <h4 class="text-center">Thinking for themselves</h4>
                    <p style="font-style: italic; text-align: center;">Some insights into animal intelligence</p>
                    <p>In 1977 Irene Pepperberg brought Alex, a one-yew-old African gray parrot, into her lab at Harvard
                        University to teach him to reproduce the sounds of English. At that time most scientists
                        considered animals mere machines, lacking the ability to think in a rational way or feel
                        emotions as humans do. 'I wasn't trying to see if Alex could learn a human language,' said
                        Pepperberg. 'My plan always was to use his imitative skills to get a better understanding of
                        avian cognition.' Given that Alex's brain was the size of a walnut, most researchers thought
                        Pepperberg's study would be futile.</p>
                    <p>But by the time Alex died in 2007, he knew 150 words, could count, do simple arithmetic, and
                        distinguish between objects according to shape, color, and material. Many of Alex's skills, such
                        as his ability to understand the concepts of 'same' and 'different', are generally ascribed only
                        to higher mammals. But parrots, like higher apes (and humans), live in complex societies, and
                        need to monitor changing relationships and environments.</p>
                    <p>They need to distinguish colors to know when a fruit is ripe or unripe,' Pepperberg noted. They
                        need to categorize things - what's edible, what isn't - and to know the shapes of predators. And
                        it helps to have a concept of numbers if you need to keep track of your flock. For a long-lived
                        bird, you can't do all of this with instinct; cognition must be involved.'</p>
                    <p>Just how easily mental skills can be acquired is perhaps best illustrated by dogs. For abstract
                        thinking, humans employ symbols, letting one thing stand for another. And Juliane Kaminski, of
                        the Max Planck Institute for Evolutionary Anthropology in Leipzig, believes that dogs can do
                        this too. In 2008, Kaminski and her colleague Sebastian Tempelmann conducted an experiment with
                        a border collie. The dog successfully selected and brought her owner toys which she had never
                        seen before, prompted only by a picture of each toy.</p>
                    <p>Creativity is another skill which seems to have evolved in humans and animals alike. 'People were
                        initially surprised to discover that chimpanzees make tools,' says behavioral ecologist Alex
                        Kacelnik. 'But then people thought, "Well, they share our ancestry - of course they're smart."
                        Now we're finding these kinds of exceptional behaviors in some species of birds.' New Caledonian
                        crows, for example, use their beaks and claws to fashion tools to poke out grubs from palm
                        trees. 'But the problem is we don't have a recently shared ancestry with birds - our last common
                        ancestor was a reptile living over 300 million years ago.'</p>
                    <p>Kacelnik and his researchers at Oxford University were particularly impressed with the ingenuity
                        of one of the crows - Betty, a wild-caught female. In one experiment, Betty successfully
                        selected a hook-shaped wire to get a piece of meat from a glass tube.</p>
                    <p>Then, when another bird unexpectedly stole the hook, Betty took a straight piece of wire, shaped
                        it into a hook, and retrieved the food. This was the first time Betty had seen a piece of wire
                        like this, Kacelnik says, 'is a major kind of cognitive sophistication.'</p>
                    <p>We are clearly not alone in our ability to invent or plan - or even to plot and lie. Studies show
                        that western scrub jays can guess another bird's intentions and act on that knowledge. A jay
                        knows that if another jay watches it hide a nut, there's a chance it will be stolen. So the
                        first jay will return to move the nut when the other jay is gone. 'It's some of the best
                        evidence so far of experience projection in another species,' says Nicky Clayton of Cambridge
                        University. What's more, the jays seem to know how long ago they hid a particular kind of food,
                        and they manage to retrieve it before it spoils.</p>
                    <p>Human cognitive psychologists call this ability 'episodic memory' and argue that it only exists
                        in species that can mentally travel back in time. They believe that animals cannot distinguish
                        among past, present, and future the way humans do. Such skepticism is a challenge for Clayton.
                        'We have good evidence that jays remember specific hiding events, which is the original
                        definition of episodic memory. But now the goalposts have moved. Whenever we find a mental skill
                        in a species that is reminiscent of human ability, the human cognition scientists change the
                        definition.'</p>
                    <p>Cognitive psychologist Louis Herman has spent decades studying bottlenose dolphins. These
                        intelligent mammals are highly interactive, social and cosmopolitan, living in subpolar to
                        tropical environments worldwide. Among the many skills exhibited by Herman's dolphins is the
                        ability to imitate the motor behaviors of instructors. If a trainer bent backward and lifted a
                        leg, the dolphin would turn on its back and lift its tail in the air. This requires the imitator
                        to form a mental image of the other individual's body, then adjust its own body accordingly -
                        actions that imply an awareness of one's self, an ability once seen as the sole preserve of
                        humans.</p>
                    <p>What Herman finds fascinating is that these aquatic creatures diverged from primates millions of
                        years ago. That kind of cognitive convergence suggests there must be some similar pressures
                        selecting for intellect. We don't share their biology or ecology, but do share the need to
                        establish life-long bonds and alliances. This appears to be the likely common driving force.'
                    </p>
                </div>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="questions-panel" id="questions-panel">
                <div id="questions-1" class="question-set">
                    <div class="questions-container">
                        <div class="question" data-q-start="1" data-q-end="5">
                            <div class="question-prompt">
                                <p><strong>Questions 1-5</strong></p>
                                <p>Complete the table below</p>
                                <p>Choose <strong>ONE WORD ONLY</strong> from the passage for each answer</p>
                                <p>Write your answer in boxes 1-5 on your answer sheet</p>
                            </div>
                            <div class="table-container" style="margin: 20px 0;">
                                <table class="completion-table"
                                    style="width: 100%; border-collapse: collapse; border: 1px solid #000;">
                                    <thead>
                                        <tr style="background-color: #f0f0f0;">
                                            <th style="border: 1px solid #000; padding: 8px; text-align: left;">Museums
                                            </th>
                                            <th style="border: 1px solid #000; padding: 8px; text-align: left;">
                                                Dedicated spaces</th>
                                            <th style="border: 1px solid #000; padding: 8px; text-align: left;">Target
                                                users</th>
                                            <th style="border: 1px solid #000; padding: 8px; text-align: left;">Aim of
                                                dedicated spaces</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="border: 1px solid #000; padding: 8px;">Melbourne Museum</td>
                                            <td style="border: 1px solid #000; padding: 8px;">Children's Gallery</td>
                                            <td style="border: 1px solid #000; padding: 8px;">3-8 year olds</td>
                                            <td style="border: 1px solid #000; padding: 8px;">- present <input
                                                    type="text" class="answer-input" id="q1" placeholder="1"> topics in
                                                interesting ways<br>- stimulate children's senses</td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #000; padding: 8px;">National Museum of
                                                Australia</td>
                                            <td style="border: 1px solid #000; padding: 8px;">Kspace Our Place</td>
                                            <td style="border: 1px solid #000; padding: 8px;">Children</td>
                                            <td style="border: 1px solid #000; padding: 8px;">Use <input type="text"
                                                    class="answer-input" id="q2" placeholder="2"> to imagine the future
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #000; padding: 8px;">Australian National
                                                Maritime Museum</td>
                                            <td style="border: 1px solid #000; padding: 8px;">Pirates</td>
                                            <td style="border: 1px solid #000; padding: 8px;">Children of school age
                                                <input type="text" class="answer-input" id="q3" placeholder="3"></td>
                                            <td style="border: 1px solid #000; padding: 8px;">Stimulate the life of a
                                                pirate</td>
                                        </tr>
                                        <tr>
                                            <td style="border: 1px solid #000; padding: 8px;"><input type="text"
                                                    class="answer-input" id="q4" placeholder="4"> Museum</td>
                                            <td style="border: 1px solid #000; padding: 8px;">Zoe's House</td>
                                            <td style="border: 1px solid #000; padding: 8px;">Pre-schoolers</td>
                                            <td style="border: 1px solid #000; padding: 8px;">Use play to encourage
                                                <input type="text" class="answer-input" id="q5" placeholder="5"> between
                                                children</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="question" data-q-start="6" data-q-end="9">
                            <div class="question-prompt">
                                <p><strong>Questions 6-9</strong></p>
                                <p>Complete the notes below</p>
                                <p>Choose <strong>NO MORE THAN TWO WORDS AND/OR A NUMBER</strong> for each answer</p>
                                <p>Write your answers in boxes 6-9 on your answer sheet</p>
                            </div>
                            <div class="summary-text" style="border: 1px solid #000; padding: 10px; ">
                                <p><strong>Family visits to museums</strong></p>
                                <p>When families visit museums, they usually:</p>
                                <ul style="padding-left: 20px;">
                                    <li>&bull;&nbsp;&nbsp;determine the location of exhibits</li>
                                    <li>&bull;&nbsp;&nbsp;prefer exhibits that are <input type="text"
                                            class="answer-input" id="q6" placeholder="6">.</li>
                                    <li>&bull;&nbsp;&nbsp;move slowly through the first gallery</li>
                                    <li>&bull;&nbsp;&nbsp;move without planning through the remaining galleries</li>
                                    <li>&bull;&nbsp;&nbsp;enjoy seeing their <input type="text" class="answer-input"
                                            id="q7" placeholder="7"> a second time</li>
                                    <li>&bull;&nbsp;&nbsp;speak to staff</li>
                                    <li>&bull;&nbsp;&nbsp;sit or take a <input type="text" class="answer-input" id="q8"
                                            placeholder="8">.</li>
                                    <li>&bull;&nbsp;&nbsp;stay for a maximum of <input type="text" class="answer-input"
                                            id="q9" placeholder="9">.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="question" data-q-start="10" data-q-end="13">
                            <div class="question-prompt">
                                <p><strong>Questions 10-13</strong></p>
                                <p>Do the following statements agree with the information given in Reading Passage 1?
                                </p>
                                <p>In boxes 10-13 on your answer sheet, write</p>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><strong>TRUE</strong> if the statement agrees with the information</li>
                                    <li><strong>FALSE</strong> if the statement contradicts the information</li>
                                    <li><strong>NOT GIVEN</strong> if there is no information on this</li>
                                </ul>
                            </div>
                            <div class="tf-question" data-q-start="10" data-q-end="10">
                                <div class="tf-question-line"><span class="tf-question-number">10</span><span
                                        class="tf-question-text">Some adult visitors behave like a museum specialist
                                        when guiding younger visitors.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q10" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q10" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q10" value="NOT GIVEN"> NOT
                                        GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="11" data-q-end="11">
                                <div class="tf-question-line"><span class="tf-question-number">11</span><span
                                        class="tf-question-text">It is more enjoyable to visit a museum with a group of
                                        children who are all the same age.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q11" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q11" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q11" value="NOT GIVEN"> NOT
                                        GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="12" data-q-end="12">
                                <div class="tf-question-line"><span class="tf-question-number">12</span><span
                                        class="tf-question-text">Parents think that the cost of visiting museums is too
                                        high.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q12" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q12" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q12" value="NOT GIVEN"> NOT
                                        GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="13" data-q-end="13">
                                <div class="tf-question-line"><span class="tf-question-number">13</span><span
                                        class="tf-question-text">Children want to visit museums after they learn about a
                                        topic at school.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q13" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q13" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q13" value="NOT GIVEN"> NOT
                                        GIVEN</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="questions-2" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="14" data-q-end="18">
                            <div class="question-prompt">
                                <p><strong>Questions 14-18</strong></p>
                                <p>Reading Passage 2 has six sections, A-F.</p>
                                <p>Which section contains the following information?</p>
                                <p>Write the correct letter, <strong>A-F</strong>, in boxes 14-18 on your answer sheet.
                                </p>
                            </div>
                            <div class="matching-form-container">
                                <div class="matching-form-row">
                                    <span class="matching-form-label"><strong>14.</strong> a description of a building
                                        that has a positive effect</span>
                                    <select class="answer-input" id="q14">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </div>
                                <div class="matching-form-row">
                                    <span class="matching-form-label"><strong>15.</strong> a reference to architecture
                                        affecting people's performance in their jobs</span>
                                    <select class="answer-input" id="q15">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </div>
                                <div class="matching-form-row">
                                    <span class="matching-form-label"><strong>16.</strong> examples of the intensity of
                                        people's reactions in two urban settings</span>
                                    <select class="answer-input" id="q16">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </div>
                                <div class="matching-form-row">
                                    <span class="matching-form-label"><strong>17.</strong> details of a study where
                                        seeing certain pictures reduced people's stress</span>
                                    <select class="answer-input" id="q17">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </div>
                                <div class="matching-form-row">
                                    <span class="matching-form-label"><strong>18.</strong> a claim about feelings
                                        experienced in response to both architecture and leisure settings</span>
                                    <select class="answer-input" id="q18">
                                        <option value="">Select</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="question" data-q-start="19" data-q-end="23">
                            <div class="question-prompt">
                                <p><strong>Questions 19-23</strong></p>
                                <p>Use the information in the passage to match the statements (listed below) with the
                                    researchers.</p>
                                <p>Write the appropriate letters <strong>A–D</strong> in boxes 19–23 on your answer
                                    sheet.</p>
                                <div style="margin-top: 8px;">
                                    <p><strong>A</strong> Colin Ellard</p>
                                    <p><strong>B</strong> Brendan Walker</p>
                                    <p><strong>C</strong> Rudd, Vohs and Aaker</p>
                                    <p><strong>D</strong> Charles Montgomery</p>
                                </div>
                            </div>
                            <div class="table-container">
                                <table class="matching-table">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>A</th>
                                            <th>B</th>
                                            <th>C</th>
                                            <th>D</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="statement">19. The aim of good city planning is to provide
                                                variety in architecture.</td>
                                            <td class="clickable-cell" data-question="19" data-value="A"
                                                onclick="selectCell(this, 19, 'A')"></td>
                                            <td class="clickable-cell" data-question="19" data-value="B"
                                                onclick="selectCell(this, 19, 'B')"></td>
                                            <td class="clickable-cell" data-question="19" data-value="C"
                                                onclick="selectCell(this, 19, 'C')"></td>
                                            <td class="clickable-cell" data-question="19" data-value="D"
                                                onclick="selectCell(this, 19, 'D')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">20. People in untidy areas were more helpful.</td>
                                            <td class="clickable-cell" data-question="20" data-value="A"
                                                onclick="selectCell(this, 20, 'A')"></td>
                                            <td class="clickable-cell" data-question="20" data-value="B"
                                                onclick="selectCell(this, 20, 'B')"></td>
                                            <td class="clickable-cell" data-question="20" data-value="C"
                                                onclick="selectCell(this, 20, 'C')"></td>
                                            <td class="clickable-cell" data-question="20" data-value="D"
                                                onclick="selectCell(this, 20, 'D')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">21. People who had recently felt amazed, placed less
                                                importance on material goods.</td>
                                            <td class="clickable-cell" data-question="21" data-value="A"
                                                onclick="selectCell(this, 21, 'A')"></td>
                                            <td class="clickable-cell" data-question="21" data-value="B"
                                                onclick="selectCell(this, 21, 'B')"></td>
                                            <td class="clickable-cell" data-question="21" data-value="C"
                                                onclick="selectCell(this, 21, 'C')"></td>
                                            <td class="clickable-cell" data-question="21" data-value="D"
                                                onclick="selectCell(this, 21, 'D')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">22. 'Attractive' places are not necessarily the most
                                                enjoyable places to be.</td>
                                            <td class="clickable-cell" data-question="22" data-value="A"
                                                onclick="selectCell(this, 22, 'A')"></td>
                                            <td class="clickable-cell" data-question="22" data-value="B"
                                                onclick="selectCell(this, 22, 'B')"></td>
                                            <td class="clickable-cell" data-question="22" data-value="C"
                                                onclick="selectCell(this, 22, 'C')"></td>
                                            <td class="clickable-cell" data-question="22" data-value="D"
                                                onclick="selectCell(this, 22, 'D')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">23. One particular building failed to provide visual
                                                stimulation.</td>
                                            <td class="clickable-cell" data-question="23" data-value="A"
                                                onclick="selectCell(this, 23, 'A')"></td>
                                            <td class="clickable-cell" data-question="23" data-value="B"
                                                onclick="selectCell(this, 23, 'B')"></td>
                                            <td class="clickable-cell" data-question="23" data-value="C"
                                                onclick="selectCell(this, 23, 'C')"></td>
                                            <td class="clickable-cell" data-question="23" data-value="D"
                                                onclick="selectCell(this, 23, 'D')"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="question" data-q-start="24" data-q-end="26">
                            <div class="question-prompt">
                                <p><strong>Questions 24-26</strong></p>
                                <p>Complete the summary below.</p>
                                <p>Choose <strong>ONE WORD ONLY</strong> from the passage for each answer.</p>
                                <p>Write your answers in boxes 24-26 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p><strong>Hearst Tower</strong></p>
                                <p>Norman Foster's Hearst Tower was built in 2006. The 40-storey modern
                                    triangular-patterned building is made of glass and steel, contrasting with the base
                                    which is in the style of the 1920s. The sight of the building's <input type="text"
                                        class="answer-input" id="q24" placeholder="24"> has a striking impact on
                                    commuters and employees. Some passers-by may find the building's design confusing,
                                    as it mixes old and new elements. Inside the tower <input type="text"
                                        class="answer-input" id="q25" placeholder="25"> carry employees up past a large
                                    water sculpture in the light-filled <input type="text" class="answer-input" id="q26"
                                        placeholder="26">.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="questions-3" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="27" data-q-end="30">
                            <div class="question-prompt">
                                <p><strong>Questions 27-30</strong></p>
                                <p>Complete each sentence with the correct ending, A-G, below.</p>
                                <p>Write the correct letter, <strong>A-G</strong>, in boxes 27-30 on your answer sheet.
                                </p>
                            </div>
                            <div class="drag-drop-container" style="flex-direction: column; gap: 16px;">
                                <div class="matching-questions">
                                    <div class="matching-question-item" data-q-start="27">
                                        <span><strong>27.</strong> Irene Pepperberg has shown that parrots can</span>
                                        <div class="drop-zone" data-dnd-group="p3-27-30" data-q-start="27"></div>
                                    </div>
                                    <div class="matching-question-item" data-q-start="28">
                                        <span><strong>28.</strong> Experiments have indicated that dogs know how
                                            to</span>
                                        <div class="drop-zone" data-dnd-group="p3-27-30" data-q-start="28"></div>
                                    </div>
                                    <div class="matching-question-item" data-q-start="29">
                                        <span><strong>29.</strong> Research has revealed that scrub jays are able
                                            to</span>
                                        <div class="drop-zone" data-dnd-group="p3-27-30" data-q-start="29"></div>
                                    </div>
                                    <div class="matching-question-item" data-q-start="30">
                                        <span><strong>30.</strong> Captive dolphins have been seen to</span>
                                        <div class="drop-zone" data-dnd-group="p3-27-30" data-q-start="30"></div>
                                    </div>
                                </div>
                                <div class="drag-options-container" data-dnd-group="p3-27-30">
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-27-30" data-value="A">
                                        <strong>A</strong> – make their own tools.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-27-30" data-value="B">
                                        <strong>B</strong> – copy a human's posture.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-27-30" data-value="C">
                                        <strong>C</strong> – recognise their own images.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-27-30" data-value="D">
                                        <strong>D</strong> – interpret visual representations of objects.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-27-30" data-value="E">
                                        <strong>E</strong> – use language creatively.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-27-30" data-value="F">
                                        <strong>F</strong> – predict another individual's actions.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-27-30" data-value="G">
                                        <strong>G</strong> – learn basic number skills.</div>
                                </div>
                            </div>
                        </div>

                        <div class="question" data-q-start="31" data-q-end="35">
                            <div class="question-prompt">
                                <p><strong>Questions 31-35</strong></p>
                                <p>Choose the correct letter, A, B, C or D.</p>
                                <p>Write the correct letter in boxes 31-35 on your answer sheet.</p>
                            </div>
                            <div class="multi-choice-question" data-q-start="31" data-q-end="31">
                                <div class="question-prompt">
                                    <p><strong>31</strong> What is Pepperberg doing in the third paragraph?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q31" value="A">
                                        justifying her belief in birds' cognitive skills</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q31" value="B">
                                        explaining how cognition-based skills can be tested</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q31" value="C">
                                        detailing the process by which birds acquire cognitive skills</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q31" value="D">
                                        describing the differences between instinct- and cognition-based skills</label>
                                </div>
                            </div>
                            <div class="multi-choice-question" data-q-start="32" data-q-end="32">
                                <div class="question-prompt">
                                    <p><strong>32</strong> According to Kacelnik, people doubt birds' tool-making
                                        abilities because of the birds'</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q32" value="A"> brain
                                        size.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q32" value="B">
                                        physical limitations.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q32" value="C">
                                        evolutionary history.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q32" value="D">
                                        feeding requirements.</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="33" data-q-end="33">
                                <div class="question-prompt">
                                    <p><strong>33</strong> What does Kacelnik say is most significant about Betty the
                                        crow's behaviour?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q33" value="A"> her
                                        ability to visualise the finished tool</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q33" value="B"> her
                                        physical dexterity at crafting the tool</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q33" value="C"> her
                                        speed in solving a variety of problems</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q33" value="D"> her
                                        understanding of the flexible properties of the wire</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="34" data-q-end="34">
                                <div class="question-prompt">
                                    <p><strong>34</strong> What is Clayton's complaint about human cognition scientists?
                                    </p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q34" value="A"> They
                                        use different criteria to judge human and animal study findings.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q34" value="B"> They
                                        alter the meanings of the terms of reference they use.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q34" value="C"> They
                                        fail to understand the purpose of her investigations.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q34" value="D"> They
                                        claim that there are flaws in her research methods.</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="35" data-q-end="35">
                                <div class="question-prompt">
                                    <p><strong>35</strong> According to Herman, what is an important factor in the
                                        development of cognitive skills in both humans and dolphins?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q35" value="A">
                                        communicative ability</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q35" value="B"> brain
                                        capacity</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q35" value="C"> range
                                        of habitat</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q35" value="D"> social
                                        relationships</label></div>
                            </div>
                        </div>

                        <div class="question" data-q-start="36" data-q-end="40">
                            <div class="question-prompt">
                                <p><strong>Questions 36-40</strong></p>
                                <p>Do the following statements agree with the claims of the writer in Reading Passage 3?
                                </p>
                                <p>In boxes 36-40 on your answer sheet, write</p>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><strong>YES</strong> if the statement agrees with the claims of the writer</li>
                                    <li><strong>NO</strong> if the statement contradicts the claims of the writer</li>
                                    <li><strong>NOT GIVEN</strong> if it is impossible to say what the writer thinks
                                        about this</li>
                                </ul>
                            </div>
                            <div class="tf-question" data-q-start="36" data-q-end="36">
                                <div class="tf-question-line"><span class="tf-question-number">36</span><span
                                        class="tf-question-text">In 1977 only a few scientists believed that birds were
                                        capable of logical thought.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q36" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q36" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q36" value="NOT GIVEN"> NOT
                                        GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="37" data-q-end="37">
                                <div class="tf-question-line"><span class="tf-question-number">37</span><span
                                        class="tf-question-text">Pepperberg wanted to see if Alex could be trained to
                                        speak English fluently.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q37" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q37" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q37" value="NOT GIVEN"> NOT
                                        GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="38" data-q-end="38">
                                <div class="tf-question-line"><span class="tf-question-number">38</span><span
                                        class="tf-question-text">Higher apes such as chimpanzees show an awareness of
                                        others' intentions.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q38" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q38" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q38" value="NOT GIVEN"> NOT
                                        GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="39" data-q-end="39">
                                <div class="tf-question-line"><span class="tf-question-number">39</span><span
                                        class="tf-question-text">Betty was the only crow in Kacelnik's study who made a
                                        tool out of wire.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q39" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q39" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q39" value="NOT GIVEN"> NOT
                                        GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="40" data-q-end="40">
                                <div class="tf-question-line"><span class="tf-question-number">40</span><span
                                        class="tf-question-text">It is now widely accepted that animals understand about
                                        past events.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q40" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q40" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q40" value="NOT GIVEN"> NOT
                                        GIVEN</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Arrows -->
    <div class="nav-arrows">
        <button class="nav-arrow prev" onclick="previousQuestion()" id="prevBtn" aria-label="Previous question">
            <!-- Left arrow icon -->
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
        </button>
        <button class="nav-arrow next" onclick="nextQuestion()" id="nextBtn" aria-label="Next question">
            <!-- Right arrow icon -->
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
        </button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-row perScorableItem" aria-label="Questions">
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(1)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">1</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(1)"><span class="sr-only">Question
                        1</span><span aria-hidden="true">1</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(2)"><span class="sr-only">Question
                        2</span><span aria-hidden="true">2</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(3)"><span class="sr-only">Question
                        3</span><span aria-hidden="true">3</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(4)"><span class="sr-only">Question
                        4</span><span aria-hidden="true">4</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(5)"><span class="sr-only">Question
                        5</span><span aria-hidden="true">5</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(6)"><span class="sr-only">Question
                        6</span><span aria-hidden="true">6</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(7)"><span class="sr-only">Question
                        7</span><span aria-hidden="true">7</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(8)"><span class="sr-only">Question
                        8</span><span aria-hidden="true">8</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(9)"><span class="sr-only">Question
                        9</span><span aria-hidden="true">9</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(10)"><span class="sr-only">Question
                        10</span><span aria-hidden="true">10</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(11)"><span class="sr-only">Question
                        11</span><span aria-hidden="true">11</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(12)"><span class="sr-only">Question
                        12</span><span aria-hidden="true">12</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(13)"><span class="sr-only">Question
                        13</span><span aria-hidden="true">13</span></button>
            </div>
        </div>

        <div class="footer__questionWrapper___1tZ46 selected multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(2)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">2</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(14)"><span class="sr-only">Question
                        14</span><span aria-hidden="true">14</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(15)"><span class="sr-only">Question
                        15</span><span aria-hidden="true">15</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(16)"><span class="sr-only">Question
                        16</span><span aria-hidden="true">16</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(17)"><span class="sr-only">Question
                        17</span><span aria-hidden="true">17</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(18)"><span class="sr-only">Question
                        18</span><span aria-hidden="true">18</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(19)"><span class="sr-only">Question
                        19</span><span aria-hidden="true">19</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(20)"><span class="sr-only">Question
                        20</span><span aria-hidden="true">20</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(21)"><span class="sr-only">Question
                        21</span><span aria-hidden="true">21</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(22)"><span class="sr-only">Question
                        22</span><span aria-hidden="true">22</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(23)"><span class="sr-only">Question
                        23</span><span aria-hidden="true">23</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(24)"><span class="sr-only">Question
                        24</span><span aria-hidden="true">24</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(25)"><span class="sr-only">Question
                        25</span><span aria-hidden="true">25</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(26)"><span class="sr-only">Question
                        26</span><span aria-hidden="true">26</span></button>
            </div>
        </div>

        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(3)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">3</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 14</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(27)"><span class="sr-only">Question
                        27</span><span aria-hidden="true">27</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(28)"><span class="sr-only">Question
                        28</span><span aria-hidden="true">28</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(29)"><span class="sr-only">Question
                        29</span><span aria-hidden="true">29</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(30)"><span class="sr-only">Question
                        30</span><span aria-hidden="true">30</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(31)"><span class="sr-only">Question
                        31</span><span aria-hidden="true">31</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(32)"><span class="sr-only">Question
                        32</span><span aria-hidden="true">32</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(33)"><span class="sr-only">Question
                        33</span><span aria-hidden="true">33</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(34)"><span class="sr-only">Question
                        34</span><span aria-hidden="true">34</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(35)"><span class="sr-only">Question
                        35</span><span aria-hidden="true">35</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(36)"><span class="sr-only">Question
                        36</span><span aria-hidden="true">36</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(37)"><span class="sr-only">Question
                        37</span><span aria-hidden="true">37</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(38)"><span class="sr-only">Question
                        38</span><span aria-hidden="true">38</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(39)"><span class="sr-only">Question
                        39</span><span aria-hidden="true">39</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(40)"><span class="sr-only">Question
                        40</span><span aria-hidden="true">40</span></button>
            </div>
        </div>

        <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton___3FM07">
            <i class="fa fa fa-check" aria-hidden="true"></i>
            <span>Check Answers</span>
        </button>
    </nav>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div id="menu-highlight" class="context-menu-item" onclick="highlightText()">
            Highlight
        </div>
        <div id="menu-note" class="context-menu-item" onclick="addNote()">
            Note
        </div>
        <div id="menu-clear" class="context-menu-item" onclick="clearHighlight()">
            Clear
        </div>
        <div id="menu-clear-all" class="context-menu-item" onclick="clearAllHighlights()">
            Clear All
        </div>
    </div>

    <div id="results-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closeResultsModal()">&times;</button>
            <h2>Results</h2>
            <div class="results-summary">
                <p>Score: <span id="results-score"></span> / 40</p>
                <p>IELTS Band: <span id="results-band"></span></p>
            </div>
            <div id="results-details" class="results-details-container">
                <!-- Results for each question will be injected here -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- STATE VARIABLES ---
            let currentPassage = 1;
            let currentQuestion = 1;
            let selectedRange = null;
            let timeInSeconds = 3600;
            let timerInterval;
            let draggedItem = null;
            let activeQuestionElement = null;
            let selectedDragItem = null;

            // --- GLOBAL FUNCTIONS ---
            function getFirstQuestionOfPart(part) {
                switch (part) {
                    case 1: return 1;
                    case 2: return 14;
                    case 3: return 27;
                    default: return 1;
                }
            }

            // --- DOM ELEMENTS ---
            const timerDisplay = document.querySelector('.timer-display');
            const timerToggleButton = document.getElementById('timer-toggle-btn');
            const timerResetButton = document.getElementById('timer-reset-btn');
            const deliverButton = document.getElementById('deliver-button');
            const resizer = document.getElementById('resizer');
            const passagePanel = document.getElementById('passage-panel');
            const questionsPanel = document.getElementById('questions-panel');
            const contextMenu = document.getElementById('contextMenu');

            // --- ICON SVGs ---
            const playIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>';
            const pauseIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';

            // --- ANSWERS ---
            const correctAnswers = {
                // Part 1 (1-13) - Museums and family visitors in Australia
                '1': 'science',
                '2': 'technology',
                '3': 'parents',
                '4': 'Powerhouse',
                '5': 'cooperation',
                '6': 'interactive',
                '7': 'favorite displays',
                '8': 'break',
                '9': 'two hours',
                '10': 'TRUE',
                '11': 'NOT GIVEN',
                '12': 'FALSE',
                '13': 'NOT GIVEN',
                // Part 2 (14-26) - Boring buildings
                '14': 'F',
                '15': 'A',
                '16': 'B',
                '17': 'D',
                '18': 'D',
                '19': 'A',
                '20': 'D',
                '21': 'C',
                '22': 'D',
                '23': 'A',
                '24': 'facade',
                '25': 'escalators',
                '26': 'atrium',
                // Part 3 (27-40) - Thinking for themselves
                '27': 'G',
                '28': 'D',
                '29': 'F',
                '30': 'B',
                '31': 'A',
                '32': 'C',
                '33': 'D',
                '34': 'B',
                '35': 'B',
                '36': 'YES',
                '37': 'NO',
                '38': 'NOT GIVEN',
                '39': 'YES',
                '40': 'NO'
            };

            // --- INITIALIZATION ---
            function initialize() {
                console.log(`🚀 Initializing application...`);
                startTimer();
                initializeDragAndDrop();
                setupCheckboxLimits();
                setupExampleHeading();
                console.log(`📋 Setting up initial state - switching to part 1`);
                switchToPart(1); // Also calls goToQuestion(1) and updateNavigation

                document.body.addEventListener('input', updateAllIndicators);
                document.body.addEventListener('change', updateAllIndicators);
                deliverButton.addEventListener('click', checkAnswers);
                timerToggleButton.addEventListener('click', toggleTimer);
                timerResetButton.addEventListener('click', resetTimer);

                // Auto-close dropdowns for Questions 14-17 on selection
                ['q14', 'q15', 'q16', 'q17'].forEach(id => {
                    const sel = document.getElementById(id);
                    if (sel) {
                        sel.addEventListener('change', () => sel.blur());
                    }
                });

                // Add click listeners to question containers for navigation
                document.querySelectorAll('[data-q-start]').forEach(el => {
                    el.addEventListener('click', (event) => {
                        // Stop event propagation to prevent parent container clicks
                        event.stopPropagation();

                        const qNum = parseInt(el.dataset.qStart, 10);
                        const qEnd = parseInt(el.dataset.qEnd, 10);

                        console.log(`🖱️ Question container clicked - qNum: ${qNum}, qEnd: ${qEnd}, currentQuestion: ${currentQuestion}, element:`, el);

                        // Handle cases where qNum is NaN
                        if (isNaN(qNum)) {
                            console.log(`ℹ️ Container without valid question number, ignoring navigation`);
                            return;
                        }

                        // Only navigate if this is a single question (qStart === qEnd) or if we're clicking on a specific question within a group
                        if (qNum === qEnd || el.classList.contains('tf-question')) {
                            if (currentQuestion !== qNum) {
                                console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum}`);
                                goToQuestion(qNum);
                            } else {
                                console.log(`ℹ️ Already on question ${qNum}, no navigation needed`);
                            }
                        } else {
                            console.log(`ℹ️ Ignoring click on group container (${qNum}-${qEnd})`);
                        }
                    });
                });

                // Add specific click listeners for individual question elements to prevent parent container interference
                document.querySelectorAll('.tf-question, .summary-text').forEach(el => {
                    el.addEventListener('click', (event) => {
                        event.stopPropagation();
                        const qNum = parseInt(el.dataset.qStart, 10);
                        console.log(`🎯 Individual question element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, element:`, el);

                        // Handle cases where qNum is NaN (like .summary-text containers)
                        if (isNaN(qNum)) {
                            console.log(`ℹ️ Container without specific question number, ignoring navigation`);
                            return;
                        }

                        if (currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (individual element)`);
                            goToQuestion(qNum);
                        } else {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed (individual element)`);
                        }
                    });
                });

                // Add specific click listeners for individual input elements in questions 33-36
                document.querySelectorAll('.answer-input[id^="q3"]').forEach(input => {
                    input.addEventListener('click', (event) => {
                        event.stopPropagation();
                        const qNum = parseInt(input.id.replace('q', ''), 10);
                        console.log(`📝 Input element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, input:`, input);

                        if (currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (input element)`);
                            goToQuestion(qNum);
                        } else {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed (input element)`);
                        }
                    });
                });

                // Add click listeners for the paragraph elements containing questions 33-36
                document.querySelectorAll('.summary-text p').forEach(p => {
                    p.addEventListener('click', (event) => {
                        event.stopPropagation();
                        // Extract question number from the paragraph text (e.g., "33" from "<strong>33</strong>")
                        const strongElement = p.querySelector('strong');
                        if (strongElement) {
                            const qNum = parseInt(strongElement.textContent, 10);
                            console.log(`📄 Summary paragraph clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, paragraph:`, p);

                            if (!isNaN(qNum) && currentQuestion !== qNum) {
                                console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (summary paragraph)`);
                                goToQuestion(qNum);
                            } else if (!isNaN(qNum)) {
                                console.log(`ℹ️ Already on question ${qNum}, no navigation needed (summary paragraph)`);
                            }
                        }
                    });
                });

                resizer.addEventListener('mousedown', initResize, false);
                initializeContextMenu();
            }

            // --- CORE TEST LOGIC ---

            function checkAnswers() {
                // Disable all inputs to prevent changes
                const allInputs = document.querySelectorAll('input, select, textarea');
                allInputs.forEach(input => {
                    input.disabled = true;
                });

                // Disable all drag and drop functionality
                document.querySelectorAll('.drag-item').forEach(item => {
                    item.setAttribute('draggable', 'false');
                    item.style.cursor = 'not-allowed';
                    item.style.pointerEvents = 'none';
                });

                document.querySelectorAll('.drop-zone').forEach(zone => {
                    zone.style.pointerEvents = 'none';
                    zone.classList.add('disabled');
                });

                // Disable submit button
                deliverButton.disabled = true;
                deliverButton.style.cursor = 'not-allowed';

                clearInterval(timerInterval);
                let score = 0;
                const totalQuestions = 40;
                const resultsDetailsContainer = document.getElementById('results-details');
                resultsDetailsContainer.innerHTML = '';

                document.querySelectorAll('.correct, .incorrect, .correct-answer-highlight').forEach(el => {
                    el.classList.remove('correct', 'incorrect', 'correct-answer-highlight');
                });
                document.querySelectorAll('.correct-answer-display').forEach(el => el.remove());

                for (let i = 1; i <= totalQuestions; i++) {
                    const questionKey = String(i);
                    const correctAnswer = correctAnswers[questionKey];
                    let userAnswer = '';
                    let isCorrect = false;

                    let userAnswerDisplay = 'Not Answered';
                    const correctAnswerText = Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : correctAnswer;

                    const textInput = document.getElementById(`q${i}`);
                    const radioGroup = document.querySelectorAll(`input[name="q${i}"][type="radio"]`);

                    // Handle Text and Select Inputs
                    if (textInput && (textInput.tagName === 'INPUT' || textInput.tagName === 'SELECT')) {
                        const element = textInput.closest('.matching-form-row') || textInput;
                        userAnswer = textInput.value.trim();
                        userAnswerDisplay = userAnswer || 'Not Answered';

                        const normalize = (s) => (s || '')
                            .toString()
                            .toLowerCase()
                            .replace(/[^a-z0-9\s]/g, '')
                            .replace(/\s+/g, ' ')
                            .trim();

                        if (textInput.tagName === 'SELECT') {
                            isCorrect = userAnswer === correctAnswer;
                        } else {
                            const normUser = normalize(userAnswer);
                            if (Array.isArray(correctAnswer)) {
                                isCorrect = correctAnswer.some(ans => normalize(ans) === normUser);
                            } else {
                                isCorrect = normalize(correctAnswer) === normUser;
                            }
                        }

                        if (isCorrect) {
                            score++;
                            element.classList.add('correct');
                        } else {
                            element.classList.add('incorrect');
                            const correctAnswerSpan = document.createElement('span');
                            correctAnswerSpan.className = 'correct-answer-display';
                            correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`;
                            textInput.parentNode.insertBefore(correctAnswerSpan, textInput.nextSibling);
                        }
                    }
                    // Handle drag and drop questions (any with a drop-zone for this question)
                    else if (document.querySelector(`.drop-zone[data-q-start="${i}"]`)) {
                        console.log(`🔍 Checking drag-and-drop question ${i}`);
                        const dropZone = document.querySelector(`.drop-zone[data-q-start="${i}"]`);
                        const droppedItem = dropZone ? dropZone.querySelector('.drag-item') : null;

                        console.log(`📍 Drop zone for question ${i}:`, dropZone);
                        console.log(`📍 Dropped item for question ${i}:`, droppedItem);
                        console.log(`📍 Correct answer for question ${i}:`, correctAnswer);

                        if (droppedItem) {
                            userAnswer = droppedItem.dataset.value;
                            userAnswerDisplay = userAnswer;
                            isCorrect = userAnswer === correctAnswer;

                            console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);

                            // Mark the drop zone as correct or incorrect
                            dropZone.classList.add(isCorrect ? 'correct' : 'incorrect');

                            if (isCorrect) {
                                score++;
                                console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                            } else {
                                console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                            }

                            // Show correct answer if wrong
                            if (!isCorrect && correctAnswer) {
                                const correctAnswerSpan = document.createElement('span');
                                correctAnswerSpan.className = 'correct-answer-display';
                                correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswer}</span>`;
                                dropZone.appendChild(correctAnswerSpan);
                            }
                        } else {
                            // No answer provided - mark as incorrect
                            console.log(`⚠️ No answer provided for question ${i}`);
                            if (dropZone) {
                                dropZone.classList.add('incorrect');
                            }
                            if (correctAnswer) {
                                const correctAnswerSpan = document.createElement('span');
                                correctAnswerSpan.className = 'correct-answer-display';
                                correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswer}</span>`;
                                dropZone.appendChild(correctAnswerSpan);
                            }
                        }
                    }
                    // Handle Radio Button Inputs (T/F, MCQs)
                    else if (radioGroup.length > 0) {
                        const questionContainer = radioGroup[0]?.closest('.tf-question') || radioGroup[0]?.closest('.multi-choice-question');
                        const checkedRadio = document.querySelector(`input[name="q${i}"]:checked`);

                        if (checkedRadio) {
                            userAnswer = checkedRadio.value;
                            userAnswerDisplay = userAnswer;
                            isCorrect = userAnswer === correctAnswer;

                            const userLabel = checkedRadio.closest('.tf-option, .multi-choice-option');
                            if (userLabel) {
                                userLabel.classList.add(isCorrect ? 'correct' : 'incorrect');
                            }

                            // Handle table radio buttons
                            if (checkedRadio.classList.contains('table-radio')) {
                                const tableCell = checkedRadio.closest('td');
                                if (tableCell) {
                                    tableCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                                }
                            }
                        }

                        if (isCorrect) {
                            score++;
                        } else {
                            if (questionContainer) {
                                const correctOptionEl = questionContainer.querySelector(`input[name="q${i}"][value="${correctAnswerText}"]`);
                                if (correctOptionEl) {
                                    const correctLabel = correctOptionEl.closest('.tf-option, .multi-choice-option');
                                    if (correctLabel) {
                                        correctLabel.classList.add('correct-answer-highlight');
                                    }
                                }
                            }
                        }
                    }
                    // Handle clickable-cell matrix questions (generic for any i that has clickable cells)
                    else if (document.querySelector(`.clickable-cell[data-question="${i}"]`)) {
                        console.log(`🔍 Checking clickable cell question ${i}`);
                        const selectedCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-selected="true"]`);
                        console.log(`📍 Selected cell for question ${i}:`, selectedCell);
                        console.log(`📍 Correct answer for question ${i}:`, correctAnswer);

                        if (selectedCell) {
                            userAnswer = selectedCell.dataset.answer;
                            userAnswerDisplay = userAnswer;
                            isCorrect = userAnswer === correctAnswer;

                            console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);

                            selectedCell.classList.add(isCorrect ? 'correct' : 'incorrect');

                            if (isCorrect) {
                                score++;
                                console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                            } else {
                                console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                            }
                        } else {
                            console.log(`⚠️ No answer provided for question ${i}`);
                            userAnswerDisplay = 'Not Answered';
                        }

                        // Handle highlighting correct answers for incorrect responses
                        if (!isCorrect) {
                            const correctCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-value="${correctAnswerText}"]`);
                            if (correctCell) {
                                correctCell.classList.add('correct-answer-highlight');
                                console.log(`✅ Highlighted correct answer for question ${i}:`, correctCell);
                            } else {
                                console.log(`⚠️ Could not find correct cell for question ${i} with value "${correctAnswerText}"`);
                            }
                        }
                    }
                    // Handle text input questions (33-39)
                    else if (i >= 33 && i <= 39) {
                        console.log(`🔍 Checking text input question ${i}`);
                        const textInput = document.getElementById(`q${i}`);

                        if (textInput) {
                            userAnswer = textInput.value.trim().toLowerCase();
                            userAnswerDisplay = userAnswer || 'Not Answered';

                            // Handle special case for question 33 which has two answers
                            if (i === 33) {
                                const answers = userAnswer.split('&').map(ans => ans.trim());
                                isCorrect = answers.includes('breathing') && answers.includes('eating');
                            } else {
                                isCorrect = userAnswer === correctAnswer.toLowerCase();
                            }

                            console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);

                            if (isCorrect) {
                                score++;
                                textInput.classList.add('correct');
                                console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                            } else {
                                textInput.classList.add('incorrect');
                                console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                            }
                        } else {
                            console.log(`⚠️ No answer provided for question ${i}`);
                            userAnswerDisplay = 'Not Answered';
                        }
                    }
                    // Handle question 40 (multiple choice)
                    else if (i === 40) {
                        console.log(`🔍 Checking multiple choice question ${i}`);
                        const checkedRadio = document.querySelector(`input[name="q${i}"]:checked`);

                        if (checkedRadio) {
                            userAnswer = checkedRadio.value;
                            userAnswerDisplay = userAnswer;
                            isCorrect = userAnswer === correctAnswer;

                            console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);

                            const userLabel = checkedRadio.closest('.multi-choice-option');
                            if (userLabel) {
                                userLabel.classList.add(isCorrect ? 'correct' : 'incorrect');
                            }

                            if (isCorrect) {
                                score++;
                                console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                            } else {
                                console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);

                                // Highlight correct answer
                                const correctOptionEl = document.querySelector(`input[name="q${i}"][value="${correctAnswer}"]`);
                                if (correctOptionEl) {
                                    const correctLabel = correctOptionEl.closest('.multi-choice-option');
                                    if (correctLabel) {
                                        correctLabel.classList.add('correct-answer-highlight');
                                    }
                                }
                            }
                        } else {
                            console.log(`⚠️ No answer provided for question ${i}`);
                            userAnswerDisplay = 'Not Answered';
                        }
                    }
                    // Handle Checkbox Inputs (Multiple choice questions like 24-26)


                    // For showing results in the modal
                    const resultRow = `
                    <div class="result-row ${isCorrect ? '' : 'incorrect'}">
                        <span class="q-num">${i}</span>
                        <span class="user-ans">${userAnswerDisplay}</span>
                        <span class="correct-ans">${correctAnswerText}</span>
                    </div>`;
                    resultsDetailsContainer.innerHTML += resultRow;

                    // Update nav button color
                    const navButton = document.querySelector(`.subQuestion[onclick="goToQuestion(${i})"]`);
                    if (navButton) {
                        navButton.classList.remove('answered', 'active');
                        navButton.classList.add(isCorrect ? 'correct' : 'incorrect');
                    }
                }

                document.getElementById('results-score').textContent = score;
                document.getElementById('results-band').textContent = calculateBandScore(score);
                document.body.classList.add('results-mode');
                document.getElementById('results-modal').classList.remove('hidden');

                // Change button to "My Result" with green styling
                deliverButton.innerHTML = `<span>My Result</span>`;
                deliverButton.style.backgroundColor = '#4CAF50';
                deliverButton.style.color = 'white';
                deliverButton.style.borderColor = '#4CAF50';
                deliverButton.disabled = false;
                deliverButton.style.cursor = 'pointer';
                deliverButton.removeEventListener('click', checkAnswers);
                deliverButton.addEventListener('click', showResultsModal);

                // Highlight correct answers in the passage
                highlightCorrectAnswersInPassage();
            }

            function calculateBandScore(score) {
                if (score >= 39) return '9.0';
                const mapping = {
                    40: 9.0, 39: 9.0, 38: 8.5, 37: 8.5, 36: 8.0, 35: 8.0, 34: 7.5,
                    33: 7.5, 32: 7.0, 31: 7.0, 30: 7.0, 29: 6.5, 28: 6.5, 27: 6.5,
                    26: 6.0, 25: 6.0, 24: 6.0, 23: 5.5, 22: 5.5, 21: 5.5, 20: 5.5,
                    19: 5.0, 18: 5.0, 17: 5.0, 16: 5.0, 15: 5.0, 14: 4.5, 13: 4.5,
                    12: 4.0, 11: 4.0, 10: 4.0, 9: 3.5, 8: 3.5, 7: 3.0, 6: 3.0,
                    5: 2.5, 4: 2.5
                };
                if (score <= 0) return 0.0;
                if (score === 1) return 1.0;
                if (score <= 3) return 2.0;
                if (score <= 5) return 2.5;
                return mapping[score] || 0.0;
            }

            function highlightCorrectAnswersInPassage() {
                // Define the text passages and their corresponding question numbers for Part 1
                const part1Highlights = [
                    { question: 1, text: "have become extinct elsewhere", answer: "TRUE" },
                    { question: 2, text: "were historically self-sufficient", answer: "FALSE" },
                    { question: 3, text: "irregular flights began touching down", answer: "NOT GIVEN" },
                    { question: 4, text: "a modern terminal was added to the airport", answer: "NOT GIVEN" },
                    { question: 5, text: "having the greatest impact on the islanders", answer: "FALSE" },
                    { question: 6, text: "travelling for several days on a boat", answer: "boat" },
                    { question: 7, text: "By 1999, a runway had been constructed", answer: "1999" },
                    { question: 8, text: "a modern terminal was added to the airport", answer: "terminal" },
                    { question: 9, text: "have food, and bricks and timber", answer: "food" },
                    { question: 10, text: "with a donkey", answer: "donkey" },
                    { question: 11, text: "maintain certain traditions", answer: "traditions" },
                    { question: 12, text: "plants only found in a limited number of locations", answer: "plants" },
                    { question: 13, text: "subject to a report assessing its environmental impact", answer: "report" }
                ];

                // Define the text passages and their corresponding question numbers for Part 2
                const part2Highlights = [
                    { question: 14, text: "Campbell Swinton wrote about the possibility of a television system in a scientific journal, Nature, in 1911. However, at that time it could not be built, as the components were not available.", answer: "B" },
                    { question: 15, text: "Transmissions began on frequencies available when normal radio programs had finished for the day.", answer: "D" },
                    { question: 16, text: "With quality entertainment now cheaply available at home, people went out far less often. Many cinemas and theatres closed down, and town centers became much emptier at night.", answer: "H" },
                    { question: 17, text: "The work was conducted in secret and Zworykin did not publish his paper describing the Iconoscope in detail until 1933.", answer: "C" },
                    { question: 18, text: "Very soon the technical superiority of the Marconi-EMI system was so obvious that, on 30 January 1937, the BBC ended transmissions using Baird’s television equipment.", answer: "F" },
                    { question: 19, text: "just under 19,000 had been sold by 1939, when television in Britain abruptly came to an end for security reasons. War was about to be declared.", answer: "G" },
                    // Researcher → activity supports
                    { question: 20, text: "wrote about the possibility of a television system in a scientific journal, Nature, in 1911.", answer: "B" },
                    { question: 21, text: "funded a laboratory for him to continue his research.", answer: "E" },
                    { question: 22, text: "he televised the Epsom Derby horse race live.", answer: "A" },
                    { question: 23, text: "The new department of brilliant scientists was led by Isaac Schoenberg", answer: "D" },
                    // Sentence completion
                    { question: 24, text: "very expensive, possibly costing as much as a small car", answer: "small car" },
                    { question: 25, text: "within a radius of about 30 miles", answer: "30 miles" },
                    { question: 26, text: "studios in Birmingham opened", answer: "Birmingham" },
                ];

                // Define the text passages and their corresponding question numbers for Part 3
                const part3Highlights = [
                    { question: 27, text: "impossible to carry out two or three different tasks simultaneously with the same degree of concentration", answer: "B" },
                    { question: 28, text: "Each switchover from one task to another meant rethinking", answer: "C" },
                    { question: 29, text: "asked to name the colour of a word — such as ‘green’ — printed in a different colour — red, for example — they experienced difficulty", answer: "A" },
                    { question: 30, text: "takes place in ‘three-second windows’", answer: "B" },
                    { question: 31, text: "multitasking can bring about a brain condition that causes sufferers to constantly seek new information while having difficulties concentrating", answer: "D" },
                    { question: 32, text: "review your todo list and start to feel a headache coming on", answer: "B" },
                    { question: 33, text: "possible dangers of divided attention for drivers, air traffic controllers", answer: "D" },
                    { question: 34, text: "asked to name the colour of a word — such as ‘green’ — printed in a different colour", answer: "C" },
                    { question: 35, text: "Located behind the forehead, the prefrontal cortex", answer: "forehead" },
                    { question: 36, text: "assign mental resources", answer: "mental resources" },
                    { question: 37, text: "affect brain cells in another region, the hippocampus", answer: "cells" },
                    { question: 38, text: "forming new memories", answer: "new memories" },
                    { question: 39, text: "acquire new skills", answer: "new skills" },
                    { question: 40, text: "a growing number of studies show that trying to juggle jobs rather than completing them sequentially can take longer", answer: "B" }
                ];

                // Function to apply highlights to a passage
                function applyHighlights(passageElement, highlights) {
                    if (!passageElement) return;

                    // Clear any existing highlights
                    passageElement.querySelectorAll('.answer-highlight').forEach(el => {
                        const parent = el.parentNode;
                        parent.replaceChild(document.createTextNode(el.textContent), el);
                        parent.normalize();
                    });

                    // Add highlights for each answer
                    highlights.forEach(item => {
                        const paragraphs = passageElement.querySelectorAll('p');
                        paragraphs.forEach(paragraph => {
                            const html = paragraph.innerHTML;
                            if (!html || typeof html !== 'string') return;
                            if (html.includes(item.text)) {
                                const escapeRegExp = s => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                                const re = new RegExp(escapeRegExp(item.text));
                                const replaced = html.replace(
                                    re,
                                    `<span class="answer-highlight" data-question="${item.question}" style="
                                    background-color: #ffeb3b;
                                    padding: 2px 4px;
                                    border-radius: 3px;
                                    font-weight: bold;
                                    position: relative;
                                ">${item.text}<span style="
                                    position: absolute;
                                    top: -8px;
                                    right: -8px;
                                    background-color: #2196f3;
                                    color: white;
                                    border-radius: 50%;
                                    width: 20px;
                                    height: 20px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 12px;
                                    font-weight: bold;
                                ">${item.question}</span></span>`
                                );
                                paragraph.innerHTML = replaced;
                            }
                        });
                    });
                }

                // Apply highlights to Part 1 (The Green Revolution in China)
                const passageText1 = document.getElementById('passage-text-1');
                applyHighlights(passageText1, part1Highlights);

                // Apply highlights to Part 2 (Reclaiming the Night)
                const passageText2 = document.getElementById('passage-text-2');
                applyHighlights(passageText2, part2Highlights);

                // Apply highlights to Part 3 (Paper or Computer?)
                const passageText3 = document.getElementById('passage-text-3');
                applyHighlights(passageText3, part3Highlights);
            }

            function getUserAnswer(qNum) {
                const textInput = document.getElementById(`q${qNum}`);
                const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
                const dropZone = document.querySelector(`.drop-zone[data-q-start="${qNum}"]`);

                if (textInput) { // Handles <input type="text"> and <select>
                    return { value: textInput.value, text: textInput.value || 'N/A' };
                }
                if (radioInput) {
                    return { value: radioInput.value, text: radioInput.value };
                }
                if (dropZone) {
                    const droppedItem = dropZone.querySelector('.drag-item');
                    return {
                        value: droppedItem ? droppedItem.dataset.value : null,
                        text: droppedItem ? droppedItem.textContent.trim() : 'N/A'
                    };
                }
                // Handle clickable cells for questions 23-26
                if (qNum >= 23 && qNum <= 26) {
                    const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                    if (selectedCell) {
                        return { value: selectedCell.dataset.answer, text: selectedCell.dataset.answer };
                    }
                }
                return { value: null, text: 'N/A' };
            }

            function displayCorrectAnswer(qNum, correctAnswer) {
                // Handle multi-choice group questions (e.g., 24-26, 38-40)
                // No special checkbox groups used; fall through

                // Handle radio button questions by highlighting the correct label
                const correctRadioInput = document.querySelector(`input[name="q${qNum}"][value="${correctAnswer}"]`);
                if (correctRadioInput) {
                    const parentOption = correctRadioInput.closest('.tf-option, .multi-choice-option');
                    if (parentOption) {
                        parentOption.classList.add('correct-answer-highlight');
                        return;
                    }
                }

                // Handle text inputs, select dropdowns, and others by showing the answer next to them
                const inputEl = document.getElementById(`q${qNum}`);
                if (inputEl) {
                    const displaySpan = document.createElement('span');
                    displaySpan.className = 'correct-answer-display';
                    displaySpan.textContent = ` ✓ ${correctAnswer}`;
                    inputEl.insertAdjacentElement('afterend', displaySpan);
                    return; // Done
                }

                // Fallback for questions identified by a container (e.g., some T/F/NG questions)
                const element = findQuestionElement(qNum);
                if (element) {
                    const displaySpan = document.createElement('span');
                    displaySpan.className = 'correct-answer-display';
                    displaySpan.textContent = ` ✓ ${correctAnswer}`;
                    const itemContainer = element.querySelector('.tf-question-text');
                    if (itemContainer) {
                        itemContainer.appendChild(displaySpan);
                    } else {
                        element.appendChild(displaySpan);
                    }
                }
            }

            function findQuestionElement(qNum) {
                return document.querySelector(`[data-q-start="${qNum}"]`);
            }

            function addResultToModal(qNum, userAnswer, correctAnswer, isCorrect) {
                const resultsDetails = document.getElementById('results-details');
                const row = document.createElement('div');
                row.className = 'result-row';
                if (!isCorrect) {
                    row.classList.add('incorrect');
                }
                row.innerHTML = `
                <span class="q-num">${qNum}</span>
                <span class="user-ans">${userAnswer}</span>
                <span class="correct-ans">${correctAnswer}</span>
            `;
                resultsDetails.appendChild(row);
            }

            function showResultsModal() {
                document.getElementById('results-modal').classList.remove('hidden');
            }

            window.closeResultsModal = function () {
                document.getElementById('results-modal').classList.add('hidden');
                document.body.classList.remove('results-mode');
            }

            function disableInputs() {
                deliverButton.innerHTML = `<span>Checked! View Results.</span>`;
                deliverButton.removeEventListener('click', checkAnswers);
                deliverButton.onclick = showResultsModal;

                document.querySelectorAll('input, select').forEach(el => {
                    el.disabled = true;
                    if (el.matches('input[type=radio], input[type=checkbox]')) {
                        el.style.cursor = 'not-allowed';
                        el.parentElement.style.cursor = 'not-allowed';
                    }
                });
                document.querySelectorAll('.drag-item').forEach(el => {
                    el.setAttribute('draggable', 'false');
                    el.style.cursor = 'default';
                });
                document.querySelectorAll('.drop-zone').forEach(el => {
                    el.classList.add('disabled');
                });
            }

            function checkValue(userValue, correctValue) {
                if (userValue === null || userValue === undefined) return false;
                const formattedUserValue = userValue.trim().toLowerCase();
                if (Array.isArray(correctValue)) {
                    return correctValue.map(v => v.toLowerCase()).includes(formattedUserValue);
                } else {
                    return formattedUserValue === String(correctValue).toLowerCase();
                }
            }

            function markQuestion(qNum, isCorrect) {
                const subQuestionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                subQuestionBtn?.classList.add(isCorrect ? 'correct' : 'incorrect');

                const elementsToMark = [
                    document.querySelector(`.tf-question[data-q-start="${qNum}"]`),
                    document.querySelector(`.multi-choice-question[data-q-start="${qNum}"]`),
                    document.querySelector(`.matching-question-item[data-q-start="${qNum}"]`),
                    document.querySelector(`.drop-zone[data-q-start="${qNum}"]`),
                    document.getElementById(`q${qNum}`),
                    document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.tf-option'),
                    document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.multi-choice-option')
                ];

                elementsToMark.forEach(el => {
                    if (el) el.classList.add(isCorrect ? 'correct' : 'incorrect');
                });

                if (qNum === 14 || qNum === 15) {
                    const multiChoiceContainer = document.querySelector('.multi-choice-question[data-q-start="14"]');
                    if (multiChoiceContainer) multiChoiceContainer.classList.add(isCorrect ? 'correct' : 'incorrect');
                } else if (qNum >= 1 && qNum <= 5) {
                    const pMatchInput = document.getElementById(`q${qNum}`);
                    if (pMatchInput) pMatchInput.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
            }

            function switchToPart(partNumber) {
                console.log(`🔀 switchToPart called with partNumber: ${partNumber}, currentPassage: ${currentPassage}`);

                currentPassage = partNumber;

                // Hide all passages and questions
                document.querySelectorAll('.reading-passage, .question-set, .part-header').forEach(el => {
                    el.classList.add('hidden');
                });

                // Show the correct passage, questions, and header
                document.getElementById(`passage-text-${partNumber}`).classList.remove('hidden');
                document.getElementById(`questions-${partNumber}`).classList.remove('hidden');
                document.getElementById(`part-header-${partNumber}`).classList.remove('hidden');

                // Update bottom navigation 'selected' state
                document.querySelectorAll('.footer__questionWrapper___1tZ46').forEach((wrapper, index) => {
                    wrapper.classList.toggle('selected', (index + 1) === partNumber);
                });

                // Show/hide explanation buttons based on part
                const explanationButton = document.getElementById('show-explanation-btn');
                const explanationButtonPart3 = document.getElementById('show-explanation-btn-part3');

                if (explanationButton) {
                    if (partNumber === 2) {
                        explanationButton.style.display = 'block';
                    } else {
                        explanationButton.style.display = 'none';
                        // Hide explanation section when switching away from part 2
                        const explanationSection = document.getElementById('part-2-explanation');
                        if (explanationSection) {
                            explanationSection.classList.add('hidden');
                            explanationButton.textContent = 'Show Explanation';
                            explanationButton.style.backgroundColor = '#4a90e2';
                        }
                    }
                }

                if (explanationButtonPart3) {
                    if (partNumber === 3) {
                        explanationButtonPart3.style.display = 'block';
                    } else {
                        explanationButtonPart3.style.display = 'none';
                        // Hide explanation section when switching away from part 3
                        const explanationSection = document.getElementById('part-3-explanation');
                        if (explanationSection) {
                            explanationSection.classList.add('hidden');
                            explanationButtonPart3.textContent = 'Show Explanation';
                            explanationButtonPart3.style.backgroundColor = '#4a90e2';
                        }
                    }
                }

                console.log(`✅ switchToPart completed - switched to part ${partNumber}`);

                // Only go to first question when switching parts, not when staying in same part
                // This allows goToQuestion to work properly for specific question navigation
                // const firstQuestionOfPart = {1: 1, 2: 14, 3: 27}[partNumber];
                // goToQuestion(firstQuestionOfPart);
            }

            function goToQuestion(questionNumber) {
                console.log(`🎯 goToQuestion called with questionNumber: ${questionNumber}, currentQuestion: ${currentQuestion}, currentPassage: ${currentPassage}`);

                currentQuestion = questionNumber;

                let passageNumber = 1;
                if (questionNumber >= 14 && questionNumber <= 26) passageNumber = 2;
                else if (questionNumber >= 27) passageNumber = 3;

                console.log(`📍 Calculated passageNumber: ${passageNumber} for question ${questionNumber}`);

                if (currentPassage !== passageNumber) {
                    console.log(`🔄 Switching from part ${currentPassage} to part ${passageNumber} for question ${questionNumber}`);
                    switchToPart(passageNumber);
                    return;
                }

                console.log(`✅ Staying in same part (${currentPassage}) for question ${questionNumber}`);

                if (activeQuestionElement) {
                    // Remove active style from previous block
                    activeQuestionElement.classList.remove('active-question', 'active-input');
                    // Also remove from the container block if we previously set it
                    const prevBlock = activeQuestionElement.closest('[data-q-start]');
                    if (prevBlock) prevBlock.classList.remove('active-question');
                }

                // First, try to find the specific input element for questions 33-36
                let targetEl = document.getElementById(`q${questionNumber}`);
                if (targetEl) {
                    activeQuestionElement = targetEl;
                    console.log(`✅ Found specific input element:`, targetEl);
                    targetEl.classList.add('active-input');
                    scrollIntoViewIfNeeded(targetEl);
                } else {
                    // Fall back to looking for question containers
                    targetEl = document.querySelector(`[data-q-start="${questionNumber}"]`);
                    console.log(`🔍 Looking for target element with data-q-start="${questionNumber}":`, targetEl);

                    if (targetEl) {
                        activeQuestionElement = targetEl;
                        console.log(`✅ Found target element:`, targetEl);

                        if (targetEl.matches('input[type="text"]') || targetEl.matches('select')) {
                            targetEl.classList.add('active-input');
                            console.log(`📝 Added active-input class to input/select element`);
                        } else {
                            targetEl.classList.add('active-question');
                            console.log(`📋 Added active-question class to question element`);
                        }
                        scrollIntoViewIfNeeded(targetEl);
                    } else {
                        console.log(`⚠️ Target element not found, looking for paragraph matching question`);
                        const pMatch = document.querySelector(`.paragraph-matching-question select[id="q${questionNumber}"]`);
                        if (pMatch) {
                            activeQuestionElement = pMatch;
                            pMatch.classList.add('active-input');
                            scrollIntoViewIfNeeded(pMatch);
                            console.log(`✅ Found paragraph matching question:`, pMatch);
                        } else {
                            console.log(`❌ No target element found for question ${questionNumber}`);
                        }
                    }
                }

                updateNavigation();
                console.log(`✅ goToQuestion completed for question ${questionNumber}`);
            }

            // --- UI & NAVIGATION ---

            function updateNavigation() {
                console.log(`🔄 updateNavigation called for currentQuestion: ${currentQuestion}`);

                const navButtons = document.querySelectorAll('.subQuestion');
                navButtons.forEach(btn => btn.classList.remove('active'));
                const activeNav = document.querySelector(`.subQuestion[onclick="goToQuestion(${currentQuestion})"]`);
                if (activeNav) {
                    activeNav.classList.add('active');
                    console.log(`✅ Updated navigation - active nav button:`, activeNav);
                } else {
                    console.log(`⚠️ No active navigation button found for question ${currentQuestion}`);
                }

                const inputs = document.querySelectorAll('.answer-input, .drop-zone.filled, .summary-drop-zone.filled');
                inputs.forEach(input => input.classList.remove('active-input'));

                const activeInput = document.getElementById(`q${currentQuestion}`);
                if (activeInput) {
                    activeInput.classList.add('active-input');
                    if (typeof activeInput.focus === 'function') {
                        activeInput.focus();
                    }
                    console.log(`✅ Focused on input element:`, activeInput);
                } else {
                    console.log(`⚠️ No direct input found for question ${currentQuestion}, looking in question block`);
                    // Prefer the specific question element for styling (TF/MCQ), fallback to any data-q-start container
                    let activeQuestionBlock = document.querySelector(`.tf-question[data-q-start="${currentQuestion}"]`)
                        || document.querySelector(`.multi-choice-question[data-q-start="${currentQuestion}"]`)
                        || document.querySelector(`[data-q-start="${currentQuestion}"]`);
                    if (activeQuestionBlock) {
                        // Add active-question class to style number badge
                        activeQuestionBlock.classList.add('active-question');
                        const firstInput = activeQuestionBlock.querySelector('input, select');
                        if (firstInput) {
                            firstInput.classList.add('active-input');
                            if (typeof firstInput.focus === 'function') {
                                firstInput.focus();
                            }
                            console.log(`✅ Focused on input in question block:`, firstInput);
                        } else {
                            console.log(`⚠️ No input found in question block for question ${currentQuestion}`);
                        }
                    } else {
                        console.log(`❌ No question block found for question ${currentQuestion}`);
                    }
                }

                console.log(`✅ updateNavigation completed`);
            }

            function selectDragItem(item) {
                if (selectedDragItem) {
                    selectedDragItem.classList.remove('selected');
                }
                selectedDragItem = item;
                if (selectedDragItem) {
                    selectedDragItem.classList.add('selected');
                }
            }

            window.nextQuestion = () => currentQuestion < 40 && goToQuestion(currentQuestion + 1);
            window.previousQuestion = () => currentQuestion > 1 && goToQuestion(currentQuestion - 1);

            function updateAllIndicators() {
                updateAttemptedCount(1, 1, 13);
                updateAttemptedCount(2, 14, 26);
                updateAttemptedCount(3, 27, 40);
                updateAnsweredNav();
            }

            function updateAnsweredNav() {
                const navButtons = document.querySelectorAll('.subQuestion');
                navButtons.forEach(btn => {
                    const qNum = parseInt(btn.textContent, 10);
                    if (isQuestionAnswered(qNum)) {
                        btn.classList.add('answered');
                    } else {
                        btn.classList.remove('answered');
                    }
                });
            }

            function isQuestionAnswered(qNum) {
                const textInput = document.getElementById(`q${qNum}`);
                if (textInput && (textInput.value.trim() !== '' || (textInput.classList.contains('drop-zone') && textInput.children.length > 0))) {
                    return true;
                }
                const radio = document.querySelector(`input[name="q${qNum}"]:checked`);
                if (radio) {
                    return true;
                }
                const checkbox = document.querySelector(`input[name="q${qNum}"]:checked`);
                if (checkbox) {
                    return true;
                }
                // Handle drag & drop questions (e.g., 20-23)
                const dz = document.querySelector(`.drop-zone[data-q-start="${qNum}"]`);
                if (dz && dz.querySelector('.drag-item')) {
                    return true;
                }
                // Handle clickable-cell matrix questions (any question using clickable cells)
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return true;
                }
                return false;
            }

            function scrollIntoViewIfNeeded(element) {
                const panel = element.closest('.questions-panel, .passage-panel');
                const panelRect = panel.getBoundingClientRect();
                const elementRect = element.getBoundingClientRect();
                if (elementRect.top < panelRect.top || elementRect.bottom > panelRect.bottom) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            // --- DRAG AND DROP ---

            function initializeDragAndDrop() {
                document.querySelectorAll('.drag-item').forEach(item => {
                    item.addEventListener('dragstart', handleDragStart);
                    item.addEventListener('dragend', handleDragEnd);
                    item.addEventListener('click', () => selectDragItem(item));
                });
                document.querySelectorAll('.drop-zone, .drag-options-container').forEach(zone => {
                    zone.addEventListener('dragover', handleDragOver);
                    zone.addEventListener('dragleave', handleDragLeave);
                    zone.addEventListener('drop', handleDrop);
                });
            }

            function handleDragStart(e) {
                draggedItem = e.target;
                setTimeout(() => e.target.classList.add('dragging'), 0);
            }

            function handleDragEnd(e) {
                e.target.classList.remove('dragging');
                draggedItem = null;
            }

            function handleDragOver(e) {
                e.preventDefault();
                const targetZone = e.currentTarget;
                if (draggedItem && draggedItem.dataset.dndGroup === targetZone.dataset.dndGroup) {
                    targetZone.classList.add('drag-over');
                }
            }

            function handleDragLeave(e) {
                e.currentTarget.classList.remove('drag-over');
            }

            function handleDrop(e) {
                e.preventDefault();
                const targetZone = e.currentTarget;
                targetZone.classList.remove('drag-over');

                if (!draggedItem || draggedItem.dataset.dndGroup !== targetZone.dataset.dndGroup) {
                    return;
                }

                const sourceZone = draggedItem.parentElement;
                if (sourceZone === targetZone) return; // Prevent dropping on itself

                const existingItemInTarget = targetZone.classList.contains('drop-zone')
                    ? targetZone.querySelector('.drag-item')
                    : null;

                // First, clear the target drop-zone of any text (like question numbers) before adding the new item.
                if (targetZone.classList.contains('drop-zone')) {
                    Array.from(targetZone.childNodes).forEach(node => {
                        if (node.nodeType === Node.TEXT_NODE) {
                            node.remove();
                        }
                    });
                }

                // Move the item that was in the target (if any) to the source zone.
                if (existingItemInTarget) {
                    sourceZone.appendChild(existingItemInTarget);
                }

                // Finally, move the dragged item to the target zone.
                targetZone.appendChild(draggedItem);
                targetZone.classList.add('filled');
                // Lock the pill-like appearance for items dropped into zones
                if (draggedItem) {
                    draggedItem.style.cursor = 'default';
                }
                // Hide placeholder text (question number) once filled
                if (targetZone.textContent && /^\d+$/.test(targetZone.textContent.trim())) {
                    targetZone.textContent = '';
                }

                // After the move, clean up the source zone if it's a drop-zone and is now empty.
                if (sourceZone.classList.contains('drop-zone') && !sourceZone.querySelector('.drag-item')) {
                    sourceZone.classList.remove('filled');
                    const qNum = sourceZone.dataset.qStart;
                    sourceZone.innerText = qNum; // Restore the question number
                }

                updateAllIndicators();
            }

            // --- MISC HELPERS ---

            function startTimer() {
                if (timerInterval) clearInterval(timerInterval); // Ensure no multiple intervals
                timerInterval = setInterval(() => {
                    timeInSeconds--;
                    const minutes = Math.floor(timeInSeconds / 60);
                    const seconds = timeInSeconds % 60;
                    timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    if (timeInSeconds <= 0) {
                        clearInterval(timerInterval);
                        timerDisplay.textContent = "Time's up!";
                        // checkAnswers(); // Disabled to prevent modal from opening automatically.
                    }
                }, 1000);
                timerToggleButton.innerHTML = pauseIcon;
            }

            function pauseTimer() {
                clearInterval(timerInterval);
                timerToggleButton.innerHTML = playIcon;
            }

            function toggleTimer() {
                // Check based on the icon currently displayed
                if (timerToggleButton.innerHTML.includes('M6 19h4V5H6v14z')) { // Check for pause icon shape
                    pauseTimer();
                } else {
                    startTimer();
                }
            }

            function resetTimer() {
                timeInSeconds = 3600;
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                startTimer();
                timerToggleButton.innerHTML = pauseIcon;
            }

            function setupCheckboxLimits() {
                const checkboxGroups = [
                    { name: 'q38-40', limit: 3 }
                ];
                checkboxGroups.forEach(group => {
                    const checkboxes = document.querySelectorAll(`input[name="${group.name}"]`);
                    checkboxes.forEach(checkbox => {
                        checkbox.addEventListener('change', () => {
                            const checkedCount = document.querySelectorAll(`input[name="${group.name}"]:checked`).length;
                            if (checkedCount > group.limit) checkbox.checked = false;
                            updateAllIndicators();
                        });
                    });
                });
            }

            function setupExampleHeading() {
                const exampleBox = document.querySelector('.example-box');
                if (exampleBox) {
                    const title = document.createElement('p');
                    title.style.fontWeight = 'bold';
                    title.textContent = 'List of Statements';
                    // exampleBox.insertBefore(title, exampleBox.firstChild);
                }
            }

            function initResize(e) {
                e.preventDefault();
                const startX = e.clientX;
                const startWidth = passagePanel.offsetWidth;

                const doDrag = (e) => {
                    const newWidth = startWidth + e.clientX - startX;
                    if (newWidth > 200 && (document.body.clientWidth - newWidth - resizer.offsetWidth) > 200) {
                        passagePanel.style.flex = `0 0 ${newWidth}px`;
                    }
                };
                const stopDrag = () => {
                    window.removeEventListener('mousemove', doDrag, false);
                    window.removeEventListener('mouseup', stopDrag, false);
                };

                window.addEventListener('mousemove', doDrag, false);
                window.addEventListener('mouseup', stopDrag, false);
            }

            // --- CONTEXT MENU (Highlighting) ---

            function initializeContextMenu() {
                const panels = [passagePanel, questionsPanel];
                let targetElementForClear = null;

                // This listener simply tracks the last valid text selection in either panel.
                document.addEventListener('selectionchange', () => {
                    const selection = window.getSelection();
                    if (selection && !selection.isCollapsed && selection.toString().trim().length > 0) {
                        const range = selection.getRangeAt(0);
                        if (panels.some(panel => panel.contains(range.commonAncestorContainer))) {
                            selectedRange = range;
                            targetElementForClear = null; // New selection overrides clearing a specific element
                        }
                    }
                });

                const showContextMenu = (e) => {
                    const target = e.target;
                    const isClickOnHighlight = target.closest('.highlight, .comment-highlight');
                    const isSelectionActive = selectedRange && selectedRange.toString().trim().length > 0;

                    let showMenu = false;

                    if (isClickOnHighlight) {
                        document.getElementById('menu-highlight').style.display = 'none';
                        document.getElementById('menu-note').style.display = 'none';
                        document.getElementById('menu-clear').style.display = 'block';
                        document.getElementById('menu-clear-all').style.display = 'block';
                        contextMenu.targetElementForClear = isClickOnHighlight;
                        showMenu = true;
                    } else if (isSelectionActive && panels.some(panel => panel.contains(selectedRange.commonAncestorContainer))) {
                        document.getElementById('menu-highlight').style.display = 'flex';
                        document.getElementById('menu-note').style.display = 'flex';
                        document.getElementById('menu-clear').style.display = 'none';
                        document.getElementById('menu-clear-all').style.display = 'block'; // Always show clear all
                        showMenu = true;
                    }

                    if (showMenu) {
                        e.preventDefault();
                        contextMenu.style.display = 'block';
                        const menuHeight = contextMenu.offsetHeight;
                        const menuWidth = contextMenu.offsetWidth;
                        let left = e.pageX;
                        let top = e.pageY;
                        if (left + menuWidth > window.innerWidth) left = window.innerWidth - menuWidth - 5;
                        if (top + menuHeight > window.innerHeight) top = e.pageY - menuHeight - 5;
                        else top = e.pageY - menuHeight - 5;

                        contextMenu.style.left = `${left}px`;
                        contextMenu.style.top = `${top}px`;
                    }
                };

                panels.forEach(panel => {
                    panel.addEventListener('contextmenu', showContextMenu);
                });

                document.addEventListener('click', (e) => {
                    if (contextMenu.style.display === 'block' && !contextMenu.contains(e.target)) {
                        closeContextMenu();
                    }
                });
            }

            function closeContextMenu() {
                contextMenu.style.display = 'none';
                selectedRange = null; // Clear range after menu closes
            }

            function unwrapElement(element) {
                const parent = element.parentNode;
                if (!parent) return;
                while (element.firstChild) {
                    parent.insertBefore(element.firstChild, element);
                }
                parent.removeChild(element);
                parent.normalize();
            }

            window.highlightText = () => {
                if (selectedRange && !selectedRange.collapsed) {
                    const span = document.createElement('span');
                    span.className = 'highlight';
                    span.appendChild(selectedRange.extractContents());
                    selectedRange.insertNode(span);
                }
                closeContextMenu();
                window.getSelection().removeAllRanges();
            };

            window.addNote = () => {
                const note = prompt('Enter your note:');
                if (note && selectedRange && !selectedRange.collapsed) {
                    const span = document.createElement('span');
                    span.className = 'comment-highlight';
                    const tooltip = document.createElement('span');
                    tooltip.className = 'comment-tooltip';
                    tooltip.textContent = note;
                    span.appendChild(selectedRange.extractContents());
                    span.appendChild(tooltip);
                    selectedRange.insertNode(span);
                }
                closeContextMenu();
                window.getSelection().removeAllRanges();
            };

            window.clearHighlight = () => {
                const elementToClear = contextMenu.targetElementForClear;
                if (elementToClear) {
                    unwrapElement(elementToClear);
                }
                closeContextMenu();
                window.getSelection().removeAllRanges();
            };

            window.clearAllHighlights = () => {
                document.querySelectorAll('.highlight, .comment-highlight').forEach(unwrapElement);
                closeContextMenu();
                window.getSelection().removeAllRanges();
            };

            function updateAttemptedCount(part, startQ, endQ) {
                let answeredCount = 0;
                for (let i = startQ; i <= endQ; i++) {
                    if (isQuestionAnswered(i)) {
                        answeredCount++;
                    }
                }
                const partHeader = document.querySelector(`.footer__questionNo___3WNct[onclick="switchToPart(${part})"]`);
                if (partHeader) {
                    const countSpan = partHeader.querySelector('.attemptedCount');
                    if (countSpan) {
                        countSpan.textContent = `${answeredCount} of ${endQ - startQ + 1}`;
                    }
                }
            }

            // --- GLOBAL FUNCTION EXPOSURE ---
            window.nextQuestion = nextQuestion;
            window.previousQuestion = previousQuestion;
            window.goToQuestion = goToQuestion;
            window.switchToPart = switchToPart;
            window.closeResultsModal = closeResultsModal;
            window.highlightText = highlightText;
            window.addNote = addNote;
            window.clearHighlight = clearHighlight;
            window.clearAllHighlights = clearAllHighlights;

            // Explanation toggle function for Part 2
            window.toggleExplanation = function () {
                const explanationSection = document.getElementById('part-2-explanation');
                const button = document.getElementById('show-explanation-btn');

                if (explanationSection.classList.contains('hidden')) {
                    explanationSection.classList.remove('hidden');
                    button.textContent = 'Hide Explanation';
                    button.style.backgroundColor = '#dc3545';
                } else {
                    explanationSection.classList.add('hidden');
                    button.textContent = 'Show Explanation';
                    button.style.backgroundColor = '#4a90e2';
                }
            };

            // Explanation toggle function for Part 3
            window.toggleExplanationPart3 = function () {
                const explanationSection = document.getElementById('part-3-explanation');
                const button = document.getElementById('show-explanation-btn-part3');

                if (explanationSection.classList.contains('hidden')) {
                    explanationSection.classList.remove('hidden');
                    button.textContent = 'Hide Explanation';
                    button.style.backgroundColor = '#dc3545';
                } else {
                    explanationSection.classList.add('hidden');
                    button.textContent = 'Show Explanation';
                    button.style.backgroundColor = '#4a90e2';
                }
            };

            // --- START THE APP ---
            initialize();

            // Add event listeners for table radio buttons
            document.addEventListener('DOMContentLoaded', function () {
                const tableRadios = document.querySelectorAll('.table-radio');
                tableRadios.forEach(radio => {
                    radio.addEventListener('change', function () {
                        // Remove background color from all cells in the same row
                        const row = this.closest('tr');
                        const cells = row.querySelectorAll('td:not(.statement)');
                        cells.forEach(cell => {
                            cell.style.backgroundColor = '';
                        });

                        // Add background color to the selected cell
                        if (this.checked) {
                            this.closest('td').style.backgroundColor = '#e3f2fd';
                        }

                        updateAllIndicators();
                    });
                });


            });

            // Global function for selecting cells
            window.selectCell = function (cell, questionNum, value) {
                console.log('selectCell called:', questionNum, value);

                // Remove selected class from all cells in the same row
                const row = cell.closest('tr');
                const cellsInRow = row.querySelectorAll('.clickable-cell');
                cellsInRow.forEach(c => {
                    c.classList.remove('selected');
                    c.removeAttribute('data-selected');
                    c.removeAttribute('data-answer');
                });

                // Add selected class to clicked cell
                cell.classList.add('selected');
                cell.setAttribute('data-selected', 'true');
                cell.setAttribute('data-answer', value);

                console.log('Cell selected:', questionNum, value);
                updateAllIndicators();
            };



            // Note: switchToPart function is defined earlier in the code
            // This duplicate function has been removed to prevent conflicts
        });
    </script>
</body>

</html>