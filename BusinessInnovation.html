<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Reading Passage 3 ‚Äî Business Innovation</title>
<style>
  :root{--brand:#2563eb;--ink:#111827;--bg:#f7f7fb;--ok:#16a34a;--bad:#dc2626;--muted:#6b7280}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:#111}
  .container{display:flex;gap:20px;max-width:1200px;margin:0 auto;padding:20px 20px 96px}
  .card{background:#fff;border-radius:12px;box-shadow:0 4px 14px rgba(0,0,0,.08);padding:20px;overflow:auto;max-height:90vh}
  .passage{flex:1}
  .questions{flex:1}
  h1{color:var(--ink);border-bottom:2px solid var(--brand);padding-bottom:10px;margin:0 0 14px}
  h2{color:var(--brand);margin:22px 0 10px}
  h3{margin:8px 0 0}
  .muted{color:var(--muted)}

  /* Timer */
  .timerWrap{position:fixed;top:16px;right:16px;display:flex;align-items:center;gap:8px;z-index:10}
  .timer{background:var(--brand);color:#fff;padding:10px 14px;border-radius:8px;font-weight:700}
  .tbtn{border:1px solid #e5e7eb;background:#fff;color:#111;padding:8px 10px;border-radius:8px;cursor:pointer}

  /* Questions */
  .qsection{margin:14px 0 6px}
  .qblock{padding:14px;border:1px solid #e5e7eb;border-radius:12px;margin:12px 0}
  .qhead{font-weight:600;margin-bottom:8px}
  .options{margin-top:8px}
  .options label{display:block;margin:6px 0}
  select,input[type="text"]{padding:8px;border-radius:8px;border:1px solid #e5e7eb;width:100%;max-width:520px}
  .submit{background:var(--brand);color:#fff;border:0;padding:12px 18px;border-radius:8px;cursor:pointer;font-size:16px;margin-top:16px}
  .submit:hover{filter:brightness(.95)}

  /* Results */
  .results{display:none;margin-top:18px;background:#f8f9fa;border-radius:10px;padding:16px}
  .results ul{list-style:none;padding:0;margin:8px 0 0}
  .results li{margin:6px 0;padding:8px;border-radius:8px}
  .results li.ok{background:#ecfdf5;color:#065f46}
  .results li.bad{background:#fef2f2;color:#991b1b}
  .results .meta{font-size:13px;color:var(--muted)}

  /* Footer chips */
  .footerNav{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid #e5e7eb;padding:10px 12px;display:flex;flex-wrap:wrap;gap:8px;align-items:center;z-index:9}
  .chip{border:1px solid #d1d5db;background:#fff;color:#111;padding:6px 10px;border-radius:999px;cursor:pointer;font-size:14px}
  .chip.answered{border-color:#9ca3af;background:#f3f4f6}

  /* Highlights */
  .palette{position:fixed;background:#fff;padding:8px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.12);display:none;z-index:9}
  .hbtn{background:var(--brand);color:#fff;border:0;padding:6px 10px;border-radius:6px;margin:4px 4px 0 0;cursor:pointer}
  .highlight{background:yellow}

  .tg{position:fixed;bottom:96px;right:16px;background:#0088cc;color:#fff;border:0;padding:12px 16px;border-radius:9999px;display:flex;align-items:center;gap:8px;cursor:pointer;box-shadow:0 8px 20px rgba(0,136,204,.35)}

  /* Table styling */
  .innovation-table{width:100%;border-collapse:collapse;margin:16px 0}
  .innovation-table th,.innovation-table td{border:1px solid #e5e7eb;padding:12px;text-align:left;vertical-align:top}
  .innovation-table th{background:#f9fafb;font-weight:600}
  .innovation-table input{width:100%;border:none;background:transparent;padding:4px}
</style>
</head>
<body>
  <div class="timerWrap">
    <div class="timer" id="timer">20:00</div>
    <button class="tbtn" id="pauseBtn">‚è∏Ô∏è Pause</button>
    <button class="tbtn" id="resumeBtn" disabled>‚ñ∂Ô∏è Resume</button>
  </div>

  <!-- Highlight palettes -->
  <div class="palette" id="pPalette">
    <button class="hbtn" data-color="yellow">Yellow</button>
    <button class="hbtn" data-color="lightgreen">Green</button>
    <button class="hbtn" data-color="lightblue">Blue</button>
    <button class="hbtn" data-color="pink">Pink</button>
    <button class="hbtn" data-color="orange">Orange</button>
    <button class="hbtn" id="clearPMarks">Clear</button>
  </div>
  <div class="palette" id="qPalette">
    <button class="hbtn" data-color="yellow">Yellow</button>
    <button class="hbtn" data-color="lightgreen">Green</button>
    <button class="hbtn" data-color="lightblue">Blue</button>
    <button class="hbtn" data-color="pink">Pink</button>
    <button class="hbtn" data-color="orange">Orange</button>
    <button class="hbtn" id="clearQMarks">Clear</button>
  </div>

  <div class="container">
    <div class="card passage" id="passageCard">
      <h1 id="title"></h1>
      <div id="subtitle" class="muted"></div>

      <div id="passage">
        <h2>Reading Passage 3</h2>
        <h3>BUSINESS INNOVATION</h3>
        <p><em>As new 'wonder products' are getting harder and harder to find, what should companies do to survive in today's ever more competitive markets?</em></p>

        <p>The Oxford English Dictionary defines innovation as 'making changes to something established'. Invention, by contrast, is the act of 'coming upon or finding; discovery'. Revolutionary 'inventions' of 20th-century US firms include, for example, the safety razor, the hydraulic brake, and DNA fingerprinting. However, as <strong>Adrian Slywotsky</strong> of Mercer Management Consulting says, 'In most industries, truly differentiating new-product breakthroughs are becoming increasingly rare'. And as 'blockbuster' novel products become steadily more elusive, big companies would do well to focus instead on making lots of small things better.</p>

        <p>Unfortunately, big companies often have big problems with innovation. 'Innovators try to change the status quo', says <strong>Bhaskar Chakravorti</strong> of the Monitor Group, 'which is why markets tend to resist them'. Innovations frequently disrupt the way companies do things (and may have been doing them for years). And it is not just markets that are nervous of innovation. <strong>Michael Hammer</strong>, co-author of 'Re-engineering the Corporation', cites the case of a PC-maker that set out to imitate Dell's famous 'Build to Order' system of computer assembly. The company found its attempts were frustrated by both its head of manufacturing, who feared for his job, and its head of marketing, who did not want to upset his existing retail outlets. So the proposal got nowhere, and Dell continued to dominate the business.</p>

        <p><strong>Clayton Christensen</strong>, a Harvard Business School Professor, describes how <strong>disruptive innovations</strong> - simpler, cheaper and more convenient products that seriously upset the status quo - often herald the rapid downfall of thriving, long-standing businesses. This, it is widely recognised, is because most such organisations are designed to grow through a series of <strong>sustaining innovations</strong> - the sort which simply improve on existing products for existing markets.</p>

        <p><strong>William Baumol</strong>, professor at New York University, argues that large companies have been learning important lessons from the history of innovation. Most have both cut back and redirected their Research and Development spending in recent years. Innovation by big companies is now based less on the discoveries of white-coated scientists, and more on incremental improvements in the <strong>processes</strong> that constitute daily operations.</p>

        <p>According to marketing specialist <strong>Vijay Vishwanath</strong>, companies also need to adjust to the ongoing fragmentation of markets. Once-uniform mass markets are breaking up into countless 'niches', in which everything has to be customised for a small group of consumers. Looking for blockbusters in such a world is a daunting task. Another problem, according to Chakravorti, lies in the marketing of innovations. Too many executives are still stuck with the strategies used to sell Kodak's first camera 120 years ago, when the product was so revolutionary that the company could forget about competition for at least a decade. Today, rival products can be rushed onto the market at speeds which would have been unimaginable in those days.</p>

        <p>Companies that fail to come up with headline-hitting new products should not despair. 'There are plenty of other, albeit less glamorous, areas where innovation can take place', says <strong>Erik Brynjolfsson</strong> of the MIT Sloan School of Management. He claims that the roots of the USA's productivity surge originate in 'a genuine revolution in how American companies are using information technology to reinvent their business processes from top to bottom'.</p>

        <p>Hammer highlights several instances where firms have added considerably to their shareholder value through what he calls <strong>operational innovations</strong> - creativity in their business processes. Notable among these is the American retail giant <strong>Wal-Mart</strong>. While superficially mundane, their pioneering idea of '<strong>cross-docking</strong>' - shifting merchandise off trucks from suppliers and straight onto trucks heading for stores - has been fundamental to the company's ability to offer low prices, the platform for its outstanding success.</p>

        <p>Companies are also being encouraged to embrace <strong>strategic innovations</strong>, following the example of such firms as <strong>Southwest Airlines</strong>, a low-cost American regional carrier, whose creative strategies and shrewd timing won it a victory over its ailing competitor US Airways. The Swedish packaging company <strong>Tetra Pak</strong> also used this style of innovation, by moving away from delivering ready-made containers for customers into providing machinery and supplying dedicated materials for them to make their own packaging. This strips out many costs from the process, and also makes it very difficult for the customer to switch suppliers. Like Southwest Airlines, they achieved success through strategic innovations alone, with little innovation in either the underlying technology or the product sold.</p>

        <p>In his book 'How to Grow When Markets Don't', Slywotsky and his co-author Richard Wise recommend what they call <strong>demand innovations</strong>. A few far-sighted organisations such as the French industrial gas company <strong>Air Liquide</strong> have found success not - as in the case of strategic innovations - by meeting existing demand in a new way, but by discovering new forms of demand and adapting to supply the products or services required. Air Liquide had been a leading supplier of industrial gases until the early 1990s, when gas became a commodity and their operational income plunged. Realising the value of the skills they had gained over the decades, the company became a supplier not only of gas, but also of the <strong>management services</strong> to accompany it. Within a short time their profits rose again.</p>

        <p>There are certain things that managers can do to make innovations like these happen within their organisations. For example, projects with potential should be rapidly hived off into independent business units, away from the smothering influence of the status quo. The ultimate outcome of any one innovation may still be unpredictable, but the process from which it emerges is not.</p>
      </div>
    </div>

    <div class="card questions">
      <h1>Questions</h1>
      <div id="qroot"></div>
      <button class="submit" id="submitBtn">Submit Answers</button>
      <div class="results" id="results">
        <h2>Your Results</h2>
        <div id="score" class="meta"></div>
        <ul id="answers"></ul>
      </div>
    </div>
  </div>

  <div class="footerNav" id="footerNav"></div>
  <button class="tg" id="tgBtn">üì¢ Join my Telegram</button>

<script>
/* =======================
   CONFIG
   ======================= */
const CONFIG = {
  title: "READING PASSAGE 3 ‚Äî Business Innovation",
  subtitle: "You should spend about 20 minutes on Questions 27‚Äî40.",
  durationMinutes: 20,
  telegramLink: "https://t.me/yourchannel",
  showFooterNavigator: true,

  sections: [
    /* 27‚Äì31 YES/NO/NOT GIVEN */
    {
      type: "yesno",
      heading: "Questions 27‚Äì31",
      instructions: [
        "Do the following statements agree with the information given in Reading Passage 3?",
        "In boxes 27-31 on your answer sheet, write:",
        "YES if the statement agrees with the claims of the writer",
        "NO if the statement contradicts the claims of the writer", 
        "NOT GIVEN if it is impossible to say what the writer thinks about this"
      ],
      items: [
        { id: 27, text: "In order to stay in the market, companies today need to concentrate their efforts on finding genuinely original products.", correct: "NO" },
        { id: 28, text: "Disruptive innovations often pose serious threats to even successful, well-established companies.", correct: "YES" },
        { id: 29, text: "A key stage in the development of sustaining innovations involves research into the strengths and weaknesses of competitors' products.", correct: "NOT GIVEN" },
        { id: 30, text: "Manufacturers today are able to compete with innovations over shorter time periods than in the past.", correct: "YES" },
        { id: 31, text: "It is hard to tell what the long-term result of any innovation might be.", correct: "YES" }
      ]
    },

    /* 32‚Äì35 People matching */
    {
      type: "match",
      heading: "Questions 32‚Äì35",
      instructions: [
        "Look at the following points mentioned in the passage (Questions 32-35) and the list of people below.",
        "Match each point with the correct person, A-E.",
        "Write the correct letter, A-E, in boxes 32-35 on your answer sheet."
      ],
      people: {A:"Bhaskar Chakravorti",B:"Michael Hammer",C:"William Baumol",D:"Vijay Vishwanath",E:"Erik Brynjolfsson"},
      items: [
        { id: 32, prompt: "The need for companies to cater for ever more specialised sets of customers", correct: "D" },
        { id: 33, prompt: "An explanation for the recent upward trend in the US economy", correct: "E" },
        { id: 34, prompt: "An example of company personnel who resisted innovation", correct: "B" },
        { id: 35, prompt: "A shift in the way many companies are organising their budgets", correct: "C" }
      ]
    },

    /* 36‚Äì40 Table completion */
    {
      type: "table",
      heading: "Questions 36‚Äì40",
      instructions: [
        "Complete the table below.",
        "Choose NO MORE THAN TWO WORDS from the passage for each answer.",
        "Write your answers in boxes 36-40 on your answer sheet."
      ],
      items: [
        { id: 36, text: "Business processes", correct: "processes" },
        { id: 37, text: "Cross-docking", correct: "cross-docking" },
        { id: 38, text: "Strategic", correct: "Strategic" },
        { id: 39, text: "Demand innovations", correct: "Demand innovations" },
        { id: 40, text: "Management services", correct: "management services" }
      ]
    }
  ]
};

/* =======================
   RENDER
   ======================= */
document.getElementById('title').textContent = CONFIG.title;
document.getElementById('subtitle').textContent = CONFIG.subtitle || '';

const qroot = document.getElementById('qroot');
const navIds = [];
const answersMap = {};

function sectionHeader(t){ const h=document.createElement('h2'); h.className='qsection'; h.textContent=t; return h; }

/* YES/NO/NOT GIVEN renderer */
function renderYesNo(sec){
  qroot.appendChild(sectionHeader(sec.heading));
  (sec.instructions||[]).forEach(tx=>{ const p=document.createElement('p'); p.className='muted'; p.textContent=tx; qroot.appendChild(p); });
  sec.items.forEach(it=>{
    const b=document.createElement('div'); b.className='qblock'; b.id=`anchor-${it.id}`;
    const opts=['YES','NO','NOT GIVEN'].map(k=>`<label><input type="radio" name="q${it.id}" value="${k}"> ${k}</label>`).join('');
    b.innerHTML=`<div class="qhead"><strong>${it.id}.</strong> ${it.text}</div><div class="options">${opts}</div>`;
    qroot.appendChild(b); navIds.push(it.id); answersMap[it.id]=it.correct||'';
  });
}

/* Match renderer (select) */
function renderMatch(sec){
  qroot.appendChild(sectionHeader(sec.heading));
  (sec.instructions||[]).forEach(tx=>{ const p=document.createElement('p'); p.className='muted'; p.textContent=tx; qroot.appendChild(p); });

  const legend=document.createElement('div'); legend.className='qblock';
  legend.innerHTML = `<div class="qhead"><strong>List of People</strong></div>
    <div class="options">${Object.entries(sec.people).map(([k,v])=>`<div><b>${k}.</b> ${v}</div>`).join('')}</div>`;
  qroot.appendChild(legend);

  sec.items.forEach(it=>{
    const b=document.createElement('div'); b.className='qblock'; b.id=`anchor-${it.id}`;
    const sel=`<select id="q${it.id}" name="q${it.id}">
      <option value="">‚Äî</option>${Object.keys(sec.people).map(k=>`<option value="${k}">${k}</option>`).join('')}
    </select>`;
    b.innerHTML=`<div class="qhead"><strong>${it.id}.</strong> ${it.prompt}</div><div class="options">${sel}</div>`;
    qroot.appendChild(b); navIds.push(it.id); answersMap[it.id]=it.correct||'';
  });
}

/* Table renderer */
function renderTable(sec){
  qroot.appendChild(sectionHeader(sec.heading));
  (sec.instructions||[]).forEach(tx=>{ const p=document.createElement('p'); p.className='muted'; p.textContent=tx; qroot.appendChild(p); });
  
  const tableContainer = document.createElement('div');
  tableContainer.innerHTML = `
    <table class="innovation-table">
      <thead>
        <tr>
          <th>Type of innovations</th>
          <th>Definition</th>
          <th>Example</th>
          <th>Company</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Operational innovations</td>
          <td>Being innovative in the way existing business <strong>36.</strong> <input type="text" id="q36" name="q36" placeholder="Enter answer"> are carried out</td>
          <td>Moving goods by system known as <strong>37.</strong> <input type="text" id="q37" name="q37" placeholder="Enter answer"></td>
          <td>Wal-Mart</td>
        </tr>
        <tr>
          <td><strong>38.</strong> <input type="text" id="q38" name="q38" placeholder="Enter answer"> innovations</td>
          <td>Developing new approaches to meeting needs of existing markets</td>
          <td>Giving customers means to manufacture products themselves</td>
          <td>Tetra Pak</td>
        </tr>
        <tr>
          <td><strong>39.</strong> <input type="text" id="q39" name="q39" placeholder="Enter answer"> innovations</td>
          <td>Identifying and meeting new types of customer needs</td>
          <td>Offering customers <strong>40.</strong> <input type="text" id="q40" name="q40" placeholder="Enter answer"> to go with the main products</td>
          <td>Air Liquide</td>
        </tr>
      </tbody>
    </table>
  `;
  qroot.appendChild(tableContainer);
  
  // Add answers to map
  [36, 37, 38, 39, 40].forEach(id => {
    navIds.push(id);
    answersMap[id] = sec.items.find(item => item.id === id)?.correct || '';
  });
}

/* Build UI */
CONFIG.sections.forEach(sec=>{
  if (sec.type==='yesno') renderYesNo(sec);
  if (sec.type==='match') renderMatch(sec);
  if (sec.type==='table') renderTable(sec);
});

/* Footer chips */
const footerNav=document.getElementById('footerNav');
(function(){
  if(!CONFIG.showFooterNavigator){ footerNav.style.display='none'; return; }
  footerNav.innerHTML='<strong class="muted">Questions:</strong>';
  [...new Set(navIds)].sort((a,b)=>a-b).forEach(id=>{
    const chip=document.createElement('button'); chip.className='chip'; chip.id=`chip-${id}`; chip.textContent=id;
    chip.addEventListener('click',()=>{ 
      const anchor = document.getElementById(`anchor-${id}`) || document.getElementById(`q${id}`);
      if(anchor) anchor.scrollIntoView({behavior:'smooth',block:'center'}); 
    });
    footerNav.appendChild(chip);
  });
})();
function markChipAnswered(id, answered){
  const chip=document.getElementById(`chip-${id}`); if(chip) chip.classList.toggle('answered', !!answered);
}
document.addEventListener('change',(e)=>{
  const m=String(e.target.name||e.target.id||'').match(/q(\d+)/);
  const id=m?+m[1]:null; if(!id) return;
  const answered=(e.target.type==='radio') ? (!!document.querySelector(`input[name='q${id}']:checked`))
                 : (e.target.value.trim().length>0);
  markChipAnswered(id, answered);
});

/* Timer */
let timeLeft=Math.max(1,+CONFIG.durationMinutes||20)*60;
const timer=document.getElementById('timer');
const pauseBtn=document.getElementById('pauseBtn');
const resumeBtn=document.getElementById('resumeBtn');
let paused=false, iv;
const fmt=s=>`${String(Math.floor(s/60)).padStart(2,'0')}:${String(s%60).padStart(2,'0')}`;
function startTick(){ if(iv) clearInterval(iv);
  iv=setInterval(()=>{ if(paused) return; timer.textContent=fmt(timeLeft); if(timeLeft<=0){ clearInterval(iv); alert("Time's up! Submitting."); submit(); } timeLeft--; },1000);
}
timer.textContent=fmt(timeLeft); startTick();
pauseBtn.addEventListener('click',()=>{ paused=true; pauseBtn.disabled=true; resumeBtn.disabled=false; });
resumeBtn.addEventListener('click',()=>{ paused=false; pauseBtn.disabled=false; resumeBtn.disabled=true; });

/* Submit & grading */
document.getElementById('submitBtn').addEventListener('click', submit);
function submit(){
  paused=true; pauseBtn.disabled=true; resumeBtn.disabled=false;
  let total=0, graded=0, correctCount=0;
  const itemsOut=[];
  const ids=Object.keys(answersMap);

  ids.forEach(key=>{
    const ans=answersMap[key];
    const label=key;
    let user='';
    const picked=document.querySelector(`input[name="q${key}"]:checked`);
    if(picked){ user=picked.value; }
    else if(document.getElementById('q'+key)){ user=document.getElementById('q'+key).value; }
    const shown=user||'No answer';

    if(String(ans).trim()===''){ total++; itemsOut.push({label, status:'‚Äî not graded ‚Äî', user:shown, correct:'(no key)'}); return; }

    total++; graded++;
    const ok = shown.trim().toLowerCase() === String(ans).trim().toLowerCase();
    if(ok) correctCount++;
    itemsOut.push({label, status: ok? '‚úì Correct' : '‚úó Incorrect', user:shown, correct:String(ans)});
  });

  document.getElementById('score').innerHTML = `Graded ${graded} of ${total} ‚Ä¢ Score: ${correctCount}/${graded}`;
  document.getElementById('answers').innerHTML = itemsOut.map(it=>`<li class="${/Correct/.test(it.status)?'ok':'bad'}">Q${it.label}: ${it.status} ‚Äî Your: <b>${it.user}</b> | Correct: <b>${it.correct}</b></li>`).join('');
  const r=document.getElementById('results'); r.style.display='block'; r.scrollIntoView({behavior:'smooth'});
}

/* Highlights */
const passageCard=document.getElementById('passageCard');
const pPalette=document.getElementById('pPalette');
passageCard.addEventListener('mouseup',(e)=>{
  const sel=window.getSelection(); if(!sel||sel.toString().trim().length===0) return;
  if(!passageCard.contains(sel.getRangeAt(0).commonAncestorContainer)) return;
  const r=passageCard.getBoundingClientRect(), x=Math.min(e.clientX-r.left,r.width-10), y=Math.max(0,e.clientY-r.top-40);
  pPalette.style.left=(r.left+x)+'px'; pPalette.style.top=(r.top+y)+'px'; pPalette.style.display='block';
});
document.addEventListener('mousedown',(e)=>{ if(!pPalette.contains(e.target)) pPalette.style.display='none'; });
pPalette.querySelectorAll('.hbtn[data-color]').forEach(btn=>{
  btn.addEventListener('click',()=>{ markSelection(btn.dataset.color, passageCard); pPalette.style.display='none'; });
});
document.getElementById('clearPMarks').addEventListener('click',()=>{
  passageCard.querySelectorAll('span.highlight').forEach(n=>{ const p=n.parentNode; while(n.firstChild) p.insertBefore(n.firstChild,n); p.removeChild(n); p.normalize(); });
  pPalette.style.display='none';
});

/* Questions highlight */
const qCard=document.querySelector('.card.questions');
const qPalette=document.getElementById('qPalette');
qCard.addEventListener('mouseup',(e)=>{
  const sel=window.getSelection(); if(!sel||sel.toString().trim().length===0) return;
  if(!qCard.contains(sel.getRangeAt(0).commonAncestorContainer)) return;
  const node = sel.getRangeAt(0).commonAncestorContainer.nodeType===1 ? sel.getRangeAt(0).commonAncestorContainer : sel.getRangeAt(0).commonAncestorContainer.parentNode;
  if (node.closest && node.closest('input,textarea,select')) return;
  const r=qCard.getBoundingClientRect(), x=Math.min(e.clientX-r.left,r.width-10), y=Math.max(0,e.clientY-r.top-40);
  qPalette.style.left=(r.left+x)+'px'; qPalette.style.top=(r.top+y)+'px'; qPalette.style.display='block';
});
document.addEventListener('mousedown',(e)=>{ if(!qPalette.contains(e.target)) qPalette.style.display='none'; });
qPalette.querySelectorAll('.hbtn[data-color]').forEach(btn=>{
  btn.addEventListener('click',()=>{ markSelection(btn.dataset.color, qCard); qPalette.style.display='none'; });
});
document.getElementById('clearQMarks').addEventListener('click',()=>{
  qCard.querySelectorAll('span.highlight').forEach(n=>{ const p=n.parentNode; while(n.firstChild) p.insertBefore(n.firstChild,n); p.removeChild(n); p.normalize(); });
  qPalette.style.display='none';
});

/* Helper */
function markSelection(color, scope){
  const sel=window.getSelection(); if(!sel||!sel.rangeCount) return;
  const range=sel.getRangeAt(0);
  if(!scope.contains(range.commonAncestorContainer)) return;
  const container=range.commonAncestorContainer.nodeType===1? range.commonAncestorContainer : range.commonAncestorContainer.parentNode;
  if (container.closest && container.closest('input, textarea, select')) return;
  const frag=range.extractContents();
  const span=document.createElement('span'); span.className='highlight'; span.style.backgroundColor=color; span.appendChild(frag);
  range.insertNode(span); sel.removeAllRanges();
}

/* TG button */
document.querySelector('.tg').addEventListener('click',()=>window.open(CONFIG.telegramLink,'_blank'));
</script>
</body>
</html>