<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Full Reading Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            line-height: 1.4;
            font-size: 16px;
        }



        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
        }

        .ielts-logo {
            display: none;
        }

        .test-info {
            display: flex;
            align-items: center;
            gap: 30px;
            font-size: 14px;
            color: #333;
        }

        .audio-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .audio-icon {
            width: 16px;
            height: 16px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>') no-repeat center;
        }

        .header-icons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .telegram-link {
            color: #0088cc;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .telegram-link:hover {
            text-decoration: underline;
        }

        .telegram-link::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: currentColor;
            -webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }

        #volume-slider {
            -webkit-appearance: none;
            width: 80px;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
        }

        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
        }

        #volume-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            border: none;
        }

        .icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0.7;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .icon:hover {
            opacity: 1;
        }
        
        #play-pause-btn {
            background: none;
            border: none;
            padding: 0;
        }

        .main-container {
            margin-top: 60px;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            height: calc(100vh - 60px); /* Full height minus header */
        }

        .panels-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .passage-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px; /* Minimum width */
        }

        /* Passage Content */
        .text-center {
            text-align: center;
        }
        .reading-passage h4 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
       
        .reading-passage p {
            margin-bottom: 1.2em;
        }

        .question ul li label {
            display: block;
            margin-top: 8px;
            cursor: pointer;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px; /* Minimum width */
            border-left: 1px solid #e0e0e0;
        }

        .resizer {
            width: 10px;
            cursor: col-resize;
            background-color: #f0f0f0;
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="30" viewBox="0 0 10 30"><path d="M4 11h2v2H4zM4 15h2v2H4zM4 19h2v2H4z" fill="%23888"/></svg>');
            background-repeat: no-repeat;
            background-position: center;
            flex-shrink: 0;
            flex-grow: 0;
        }

        /* Left Panel */
        .left-panel {
            width: 100%;
            padding: 20px;
        }

        /* Right Panel */
        .right-panel {
            display: none;
            width: 50%;
            padding: 20px;
            position: relative;
        }

        .help-button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        .help-button:hover {
            background: #357abd;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .people-section {
            margin-bottom: 30px;
        }

        .people-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
        }

        .people-table th {
            text-align: left;
            padding: 10px;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .people-table td {
            padding: 8px 10px;
            border: 1px solid #ddd;
        }

        .person-name {
            font-size: 16px;
        }

        .question-number {
            background: white;
            border: 1px solid #4a90e2;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 14px;
            color: #4a90e2;
            min-width: 30px;
            text-align: center;
        }

        .assigned-responsibility {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 14px;
            border: 1px solid #ddd;
        }

        .responsibilities-section {
            margin-bottom: 30px;
        }

        .responsibility-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .responsibility-item {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .responsibility-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .responsibility-item.dragging {
            opacity: 0.5;
        }

        .questions-section {
            margin-bottom: 20px;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .instruction {
            margin-bottom: 20px;
            font-size: 16px;
            color: #666;
        }

        /* Map Styles */
        .map-container {
            position: relative;
            margin: 20px 0;
            display: flex;
            justify-content: center;
        }

        .map-svg {
            border: 2px solid #333;
            background: white;
        }

        .map-room {
            fill: #f9f9f9;
            stroke: #333;
            stroke-width: 1;
        }

        .map-text {
            font-family: Arial, sans-serif;
            font-size: 13px;
            text-anchor: middle;
            fill: #333;
        }

        .map-number {
            font-family: Arial, sans-serif;
            font-size: 16px;
            font-weight: bold;
            text-anchor: middle;
            fill: #333;
        }

        .room-labels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .room-label {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .room-label:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .room-label.dragging {
            opacity: 0.5;
        }

        /* Navigation Arrows */
        .nav-arrows {
            position: fixed;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 5px;
            z-index: 101;
        }

        .nav-arrow {
            width: 50px;
            height: 50px;
            background: #333;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: bold;
        }

        .nav-arrow:hover {
            background: #555;
        }

        .nav-arrow:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Bottom Navigation - Exact Match */
        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;
        
            padding: 0;
            display: flex;
            align-items: center;
            height: 80px;
            z-index: 100;
        }

        .footer__questionWrapper___1tZ46 {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }


        .footer__questionNo___3WNct {
            background: none;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .footer__questionNo___3WNct:hover {
            background-color: #f8f9fa;
        }

        .section-prefix {
            font-size: 16px;
        }

        .sectionNr {
            font-size: 16px;
            font-weight: bold;
        }

        .attemptedCount {
            font-size: 14px;
            color: #666;
            margin-left: 5px;
            font-weight: 400; /* Normal weight */
        }

        @media (max-width: 768px) {
            .attemptedCount {
                display: none;
            }
        }

        .footer__questionWrapper___1tZ46.selected .attemptedCount {
            display: none;
        }

        .footer__subquestionWrapper___9GgoP {
            display: none;
            gap: 2px;
            margin-left: 10px;
        }

        .footer__questionWrapper___1tZ46.selected .footer__subquestionWrapper___9GgoP {
            display: flex;
        }

        .subQuestion {
            width: 32px;
            height: 32px;
            border: 1px solid #ccc;
            background: white;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-radius: 2px;
        }

        .subQuestion.answered {
            background-color: #e9ecef;
            border-color: #ddd;
        }
        .subQuestion.correct {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }
        .subQuestion.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .subQuestion:hover {
            background-color: #f0f0f0;
            border-color: #999;
        }

        .subQuestion.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .subQuestion.completed {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .footer__deliverButton___3FM07 {
            margin-left: auto;
            margin-right: 20px;
            background-color: #f0f0f0;
            color: #333;
            border: 1px solid #ccc;
            padding: 12px 20px;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s, border-color 0.2s;
            min-width: 170px;
            justify-content: center;
        }

        .footer__deliverButton___3FM07:hover {
            background-color: #e0e0e0;
            border-color: #bbb;
        }

        .footer__deliverButton___3FM07:disabled {
            background: #e9ecef;
            color: #6c757d;
            cursor: not-allowed;
            border-color: #ddd;
        }

        .fa-check::before {
            content: "✓";
        }

        .hidden {
            display: none !important;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
            min-width: 140px;
        }

        .context-menu-item {
            padding: 12px 16px;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .context-menu-item:hover {
            background-color: #f8f9fa;
        }

        .context-menu-item:last-child {
            border-bottom: none;
        }

        .highlight {
            background-color: #ffff00;
        }

        .comment-highlight {
            background-color: #90EE90;
            position: relative;
            cursor: help;
        }

        .comment-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .comment-highlight:hover .comment-tooltip {
            opacity: 1;
        }

        .question {
            margin-bottom: 40px;
        }
        .question p {
            margin-bottom: 10px;
        }
        .question ul, .question .people-table {
            margin-top: 0;
        }
        .question-prompt {
            margin-bottom: 20px;
        }
        .question ul {
            list-style: none;
            padding-left: 0;
        }
        .question ul li {
            margin-bottom: 5px;
        }
        .answer-input {
            border: 1px solid #888;
            border-radius: 4px;
            background-color: #fff;
            padding: 2px 5px;
            font-size: 16px;
            text-align: center;
            margin-right: 4px;
            margin-left: 4px;
            transition: border-color 0.3s, box-shadow 0.3s;
            height: 28px; /* Standard height */
            width: 150px; /* Standard width */
        }
        .answer-input.active-input {
            border-color: #4a90e2;
            box-shadow: 0 0 3px 1px rgba(74, 144, 226, 0.5);
        }
        .answer-input::placeholder {
            color: #999;
            font-weight: bold;
            text-align: center;
        }
        .answer-input.correct {
            border-color: #28a745;
            background-color: #e9f7ef;
        }
        .answer-input.incorrect {
            border-color: #dc3545;
            background-color: #f8d7da;
            color: #721c24;
        }
        .answer-input {
    z-index: 10;
    position: relative;
    pointer-events: auto;
}
        .summary-text .answer-input {
            width: 120px;
            height: 24px;
            font-size: 14px;
            margin: 0 4px;
        }
        
        /* Minimalistic dropdown styling */
        .answer-select {
            border: 1px solid #313131;
            border-radius: 6px;
            background-color: #ffffff;
            padding: 2px 6px;
            font-size: 14px;
            font-family: inherit;
            color: #333;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 80px;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12"><path d="M6 8.825L1.175 4 2.238 2.938 6 6.7l3.763-3.762L10.825 4z" fill="%23666"/></svg>');
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 12px;
            padding-right: 28px;
        }
        
        .answer-select:hover {
            border-color: #4a90e2;
            box-shadow: 0 2px 4px rgba(74, 144, 226, 0.1);
        }
        
        .answer-select:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }
        
        .answer-select option {
            padding: 8px 12px;
            background-color: #ffffff;
            color: #333;
        }
        
        .answer-select option:hover {
            background-color: #f8f9fa;
        }
        
        /* Drag and Drop Styling for Questions 19-21 */
        .drag-drop-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }
        
        
        .recommendations-box h4 {
            margin-bottom: 10px;
            color: #333;
            font-size: 14px;
            font-weight: 600;
        }
        
        .drag-item {
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 8px 12px;
            margin-bottom: 8px;
            cursor: grab;
            font-size: 14px;
            transition: all 0.2s ease;
            user-select: none;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .drag-item:hover {
            background: #f0f8ff;
            border-color: #4a90e2;
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }
        
        .drag-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }
        
        .drag-item.used {
            opacity: 0.3;
            cursor: not-allowed;
            background: #f5f5f5;
        }
        
        .drag-item[data-dnd-group="summary-19-21"] {
            display: block;
            transition: all 0.2s ease;
        }
        
        .drag-item[data-dnd-group="summary-19-21"].used {
            display: none;
        }
        
        .drag-item[data-dnd-group="summary-19-21"].dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }
        
        .drop-zones-container {
            flex: 1;
        }
        
        .question-drop-zone {
            margin-bottom: 15px;
        }
        
        .question-drop-zone p {
            margin: 0;
            line-height: 1.6;
        }
        
        .drop-zone {
            display: inline-block;
            min-width: 120px;
            min-height: 32px;
            border: 2px dashed #ccc;
            border-radius: 6px;
            padding: 4px 8px;
            margin: 0 4px;
            background: #fafafa;
            color: #999;
            font-size: 14px;
            text-align: center;
            vertical-align: middle;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .drop-zone:hover {
            border-color: #4a90e2;
            background: #f0f8ff;
            color: #4a90e2;
        }
        
        .drop-zone.filled {
            border-style: solid;
            border-color: #4a90e2;
            background: #e3f2fd;
            color: #333;
            cursor: default;
        }
        
        .drop-zone.filled::after {
            content: "×";
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
        }
        .answer-inputs {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        .answer-inputs .answer-input {
            width: 200px;
            height: 30px;
            font-size: 16px;
        }
        .drag-drop-container {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }
        .recommendations-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-height: 200px;
        }
        .drag-item {
            background: white;
            border: 1px solid #9c9c9c;
            font-weight: 600;
            padding: 0px 5px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            transition: all 0.2s;
            user-select: none;
        }
        .drag-item:hover {
            background: #e9ecef;
        }
        .drag-item.dragging {
            opacity: 0.5;
        }
        .drag-item.selected {
            border-color: #4a90e2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.5);
        }
        .drop-zone {
            border: 2px dashed #aaa;
            border-radius: 4px;
            width: 50%;
            margin-top: 19px;
            margin-bottom: 5px;
            transition: background-color 0.2s, border-color 0.2s;
            padding: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .drop-zone.drag-over {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }
        .drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }
        .drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }
        .drop-zone.disabled {
            pointer-events: none;
        }
        .drop-zone .drag-item {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 15px;
            padding: 2px;
        }
        .drag-options-container {
            margin-top: 10px;
        }
        .drag-options-container .drag-item {
            display: block;
            width: fit-content;
            font-size: 15px;
            padding: 0.5px 10px;
            margin-bottom: 5px;
        }
        .drag-options-container .drag-item:last-child {
            margin-bottom: 0;
        }
        .q-number {
            color: #888;
            font-size: 14px;
            font-weight: bold;
        }
        .questions-container {
            width: 100%;
        }
        audio {
            width: 100%;
            margin-bottom: 20px;
        }
        .part-header {
            background-color: #f1f2ec;
            padding: 15px 20px;
            border: 1px solid #e0e0e0;
            text-align: left;
            margin: 10px 20px;
            border-radius: 5px;
        }
        .part-header p {
            margin: 0;
        }
        .part-header p:first-child {
            margin-bottom: 5px;
        }

        .question li.correct {
            color: #155724;
            font-weight: bold;
        }
        .question li.incorrect {
            color: #721c24;
        }
        .question li.correct::before {
            content: '✔ ';
            color: #28a745;
        }
        .question li.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }

        .example-box {
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .timer-container {
            display: flex;
            position: relative;
            cursor: default;
            color: #333;
            font-size: 16px;
            font-weight: 500;
            align-items: center;
        }
        .timer-container .timer-tooltip {
            display: none;
        }

        .timer-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 15px;
        }

        .timer-controls button {
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 50%;
            padding: 0;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }
        .timer-controls button:hover {
            background: #e0e0e0;
        }

        .timer-controls button svg {
            width: 20px;
            height: 20px;
            fill: #333;
        }

        .audio-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(40, 40, 40, 0.9);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }
        .audio-modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 500px;
            padding: 20px;
        }
        .audio-modal-content p {
            font-size: 16px;
            line-height: 1.5;
            color: #eee;
        }
        .audio-modal-icon {
            margin-bottom: 20px;
        }
        .modal-play-btn {
            background-color: #000;
            color: white;
            border: 1px solid white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }
        .modal-play-btn:hover {
            background-color: #333;
        }
        #goto-widget {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        #goto-input {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        #goto-btn {
            padding: 4px 10px;
            border: 1px solid #ccc;
            background-color: #f0f0f0;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Styles for TRUE/FALSE/NOT GIVEN questions */
        .tf-question {
            margin-bottom: 25px;
            padding: 10px 0px;
            border-radius: 4px;
            transition: border-color 0.3s, background-color 0.3s;
        }
        .tf-question-line {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 5px 0px;
            border-radius: 4px;
        }
        .tf-question-number, .question-number-box {
            border: 2px solid #ccc;
            padding: 2px 8px;
            margin-right: 10px;
            border-radius: 3px;
            font-weight: bold;
            transition: border-color 0.3s;
            display: inline-block;
        }
        .tf-question-text {
            padding-top: 3px;
        }
        .tf-options {
            padding-left: 5px;
        }
        .tf-option {
            display: block;
            margin-bottom: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        .tf-option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        .tf-question.correct .tf-question-line {
            background-color: #e9f7ef;
        }
        .tf-question.incorrect .tf-question-line {
            background-color: #f8d7da;
        }
        .matching-question-container {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        .matching-options-bank {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .matching-questions {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .matching-question-item {
            display: flex;
            align-items: center;
            gap: 15px;

            border: 2px solid transparent;
            border-radius: 4px;
            transition: border-color 0.3s;
        }
        .matching-question-item > span {
            flex: 1;
        }
        .matching-question-item.correct {
            background-color: #e9f7ef;
            border-color: #28a745 !important;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone {
            width: 200px;
            flex-shrink: 0;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #aaa;
        }
        .matching-options-bank .drag-item {
            font-size: 15px;
            text-align: center;
            border: 1px solid #ccc;
            background: #f9f9f9;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px; /* Minimum width */
            border-left: 1px solid #e0e0e0;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .summary-completion-container {
            margin-top: 20px;
        }
        .summary-text p {
            line-height: 2.5;
            font-size: 16px;
        }
        .summary-drop-zone {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            min-width:200px;
            height: 25px;
            border: 2px dashed #999;
            border-radius: 4px;
            margin: 0 5px;
            padding: 0 5px;
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
            color: #aaa;
            font-weight: bold;
        }
        .summary-drop-zone.filled {
            border-color: #4a90e2;
            background-color: #e3f2fd;
            color: #333;
            font-weight: bold;
            cursor: pointer;
        }
        
        .summary-drop-zone:hover {
            border-color: #4a90e2;
            background-color: #f0f8ff;
        }
        .summary-drop-zone.active-input {
             border-color: #4a90e2;
             box-shadow: none;
        }
        .summary-drop-zone .drag-item {
            font-size: 15px;
            font-weight: bold;
            background-color: transparent;
            border: none;
            padding: 0;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .summary-drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }
        
        .summary-drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }
        .summary-options-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .summary-options-bank .drag-item {
            flex-grow: 1;
            min-width: 100px;
            text-align: center;
        }
        .multi-choice-question {
            margin-bottom: 20px;
            border-radius: 4px;
            border: 3px solid transparent;
            transition: border-color 0.3s, background-color 0.3s;
        }
        .multi-choice-option {
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .multi-choice-option label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 16px;
        }
        .multi-choice-option input[type="checkbox"],
        .multi-choice-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.3);
            accent-color: #4a90e2;
        }
        .multi-choice-option.correct {
            background-color: #e9f7ef;
        }
        .multi-choice-option.incorrect {
            background-color: #f8d7da;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone.filled {
            border-color: #4a90e2;
        }
        .matching-question-item .drop-zone {
            width: 200px;
            height: 40px;
        }
        .paragraph-matching-question {
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 12px;
        }
        .paragraph-matching-question .answer-input {
            width: 80px;
            flex-shrink: 0;
        }

        .matching-form-container {
            margin-top: 20px;
        }
        .matching-form-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        .matching-form-label {
            flex-shrink: 0;
        }

        /* Results Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.hidden {
            display: none;
        }
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #888;
        }
        .modal-content h2 {
            text-align: center;
            margin-bottom: 15px;
            color: #333;
        }
        .results-summary {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        .results-details-container {
            overflow-y: auto;
            padding-right: 10px; /* For scrollbar */
        }
        .result-row {
            display: grid;
            grid-template-columns: 40px 1fr 1fr;
            gap: 15px;
            padding: 8px 5px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 15px;
        }
        .result-row.incorrect {
            background-color: #f8d7da;
        }
        .result-row .q-num {
            font-weight: bold;
        }
        .result-row .user-ans {
            color: #555;
        }
        .result-row .correct-ans {
            color: #155724;
            font-weight: 500;
        }
        .correct-answer-display {
            font-weight: bold;
            color: #28a745;
            margin-left: 10px;
            font-size: 14px;
        }
        .correct-answer-highlight, .tf-option.correct-answer-highlight, .multi-choice-option.correct-answer-highlight {
            background-color: #d4edda !important;
            border: 1px solid #c3e6cb !important;
            border-radius: 4px;
            padding: 4px;
        }
        .correct-answer-highlight {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
        }
        .centered-title {
    text-align: center;
    font-size: 50px;
    font-weight: bold;
    margin-bottom: 15px;
}

        .matching-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        
        .matching-table th {
            background-color: #007bff;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }
        
        .matching-table td {
            padding: 12px;
            border: 1px solid #ddd;
            vertical-align: top;
        }
        
        .matching-table .statement {
            text-align: left;
            width: 60%;
        }
        
        .matching-table .table-radio {
            margin: 0;
            transform: scale(1.2);
        }
        
        .matching-table td:not(.statement) {
            text-align: center;
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table th:not(:first-child) {
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table td:not(.statement):has(input:checked) {
            background-color: #e3f2fd;
        }
        
        .matching-table input[type="radio"]:checked {
            accent-color: #007bff;
        }
        
        .matching-table td.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table td.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .options-row {
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        .matching-table .options-row td {
            font-weight: 500;
            text-align: center;
            padding: 8px 12px;
            font-size: 13px;
        }
        
        .matching-table .options-row td:first-child {
            text-align: left;
            font-weight: normal;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell {
            cursor: pointer;
            transition: background-color 0.2s ease;
            min-height: 40px;
            border: 1px solid #ddd;
            position: relative;
        }
        
        .matching-table .clickable-cell:hover {
            background-color: #f0f8ff;
            border-color: #007bff;
        }
        
        .matching-table .clickable-cell.selected {
            background-color: #e3f2fd;
        }
        
        .matching-table .clickable-cell.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table .clickable-cell::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: transparent;
            transition: background-color 0.2s ease;
        }
        
        .matching-table .clickable-cell.selected::after {
        }
        
        /* Explanation Section Styles */
        .explanation-section {
            margin-top: 40px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .explanation-section h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
        }
        
        .explanation-content p {
            margin-bottom: 15px;
            line-height: 1.6;
            font-size: 16px;
        }
        
        .explanation-content strong {
            color: #4a90e2;
            font-weight: 600;
        }
        
        #show-explanation-btn {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        #show-explanation-btn:hover {
            background-color: #357abd;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="timer-container">
            <span class="timer-display">60:00</span>
            <div class="timer-controls">
                <button id="timer-toggle-btn" title="Pause/Resume Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>
                </button>
                <button id="timer-reset-btn" title="Reset Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/></svg>
                </button>
            </div>
        </div>
        <a href="https://t.me/Avazbeks_Media" target="_blank" class="telegram-link">
            Avazbeks_Media (Teacher Avazbek)
        </a>
    </div>

    <div class="main-container" id="main-container">
        <div id="passage-header-container">
            <div id="part-header-1" class="part-header">
                <p><strong>Part 1</strong></p>
                <p>Read the text and answer questions 1-13.</p>
            </div>
            <div id="part-header-2" class="part-header hidden">
                <p><strong>Part 2</strong></p>
                <p>Read the text and answer questions 14-26.</p>
            </div>
            <div id="part-header-3" class="part-header hidden">
                <p><strong>Part 3</strong></p>
                <p>Read the text and answer questions 27-40.</p>
            </div>
        </div>
        <div class="panels-container">
            <div class="passage-panel" id="passage-panel">
                <div id="passage-text-1" class="reading-passage">
                    <h4 class="text-center">Bondi Beach</h4>
                    <p><strong>A</strong>&nbsp;&nbsp;Bondi Beach, Australia's most famous beach, is located in the suburb of Bondi, in the Local Government Area of Waverley, seven kilometers from the centre of Sydney. "Bondi" or "Boondi" is an Aboriginal word meaning water breaking over rocks or the sound of breaking waves. The Australian Museum records that Bondi means a place where a flight of nullas took place. There are Aboriginal Rock carving on the northern end of the beach at Ben Buckler and south of Bondi Beach near McKenzies Beach on the coastal walk.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;The indigenous people of the area at the time of European settlement have generally been welcomed to as the Sydney people or the Eora (Eora means "the people"). One theory describes the Eora as a sub-group of the Darug language group which occupied the Cumberland Plain west to the Blue Mountains. However, another theory suggests that they were a distinct language group of their own. There is no clear evidence for the name or names of the particular band(s) of the Eora that roamed what is now the Waverley area. A number of place names within Waverley, most famously Bondi, have been based on words derived from Aboriginal languages of the Sydney region.</p>
                    <p><strong>C</strong>&nbsp;&nbsp;From the mid-1800s Bondi Beach was a favourite location for family outings and picnics. The beginnings of the suburb go back to 1809, when the early road builder, William Roberts, received from Governor Bligh a grant of 81 hectares of what is now most of the business and residential area of Bondi Beach. In 1851, Edward Smith Hall and Francis O'Brien purchased 200 acres of the Bondi area that embraced almost the whole frontage of Bondi Beach, and it was named the "The Bondi Estate." Between 1855 and 1877 O'Brien purchased Hall's share of the land, renamed the land the "O'Brien Estate," and made the beach and the surrounding land available to the public as a picnic ground and amusement resort. As the beach became increasingly popular, O'Brien threatened to stop public beach access. However, the Municipal Council believed that the Government needed to intervene to make the beach a public reserve.</p>
                    <p><strong>D</strong>&nbsp;&nbsp;During the 1900s beach became associated with health, leisure and democracy – a playground everyone could enjoy equally. Bondi Beach was a working-class suburb throughout most of the twentieth century with migrant people from New Zealand comprising the majority of the local population. The first tramway reached the beach in 1884. Following this, tram became the first public transportation in Bondi. As an alternative, this action changed the rule that only rich people can enjoy the beach. By the 1930s Bondi was drawing not only local visitors but also people from elsewhere in Australia and overseas. Advertising at the time referred to Bondi Beach as the "Playground of the Pacific".</p>
                    <p><strong>E</strong>&nbsp;&nbsp;There is a growing trend that people prefer having to relax near seaside instead of living unhealthily in cities. The increasing popularity of sea bathing during the late 1800s and early 1900s raised concerns about public safety and how to prevent people from drowning. In response, the world's first formally documented surf lifesaving club, the Bondi Surf Bathers' Life Saving Club, was formed in 1907. This was powerfully reinforced by the dramatic events of "Black Sunday" at Bondi in 1938. Some 35,000 people were on the beach and a large group of lifesavers were about to start a surf race when three freak waves hit the beach, sweeping hundreds of people out to sea. Lifesavers rescued 300 people. The largest mass rescue in the history of surf bathing, it confirmed the place of the lifesaver in the national imagination.</p>
                    <p><strong>F</strong>&nbsp;&nbsp;Bondi Beach is the endpoint of the City to Surf Fun Run which is held each year in August. Australian surf carnivals further instilled this image. A Royal Surf Carnival was held at Bondi Beach for Queen Elizabeth II during her first visited in Australia in 1954. Since 1867, there have been over fifty visits by a member of the British Royal Family to Australia. In addition to many activities, the Bondi Beach Markets is open every Sunday. Many wealthy people spend Christmas Day at the beach. However, the shortage of houses occurs when lots of people crushed to the seaside. Manly is the seashore town which solved this problem. However, people still choose Bondi as the satisfied destination rather than Manly.</p>
                    <p><strong>G</strong>&nbsp;&nbsp;Bondi Beach has a commercial area along Campbell Parade and adjacent side streets, featuring many popular cafes, restaurants, and hotels, with views of the contemporary beach. It is depicted as wholly modern and European. In the last decade, Bondi Beaches' unique position has seen a dramatic rise in svelte houses and apartments to take advantage of the views and scent of the sea. The valley running down to the beach is the famous world over for its view of distinctive red-tiled roofs. Those architectures are deeply influenced by British coastal town.</p>
                    <p><strong>H</strong>&nbsp;&nbsp;Bondi Beach hosted the beach volleyball competition at the 2000 Summer Olympics. A temporary 10,000-seat stadium, a much smaller stadium, 2 warm-up courts, and 3 training courts were set up to host the tournament. The Bondi Beach Volleyball Stadium was constructed for it and stood for just six weeks. Campaigners oppose both the social and environmental consequences of the development. The stadium will divide the beach in two and seriously restrict public access for swimming, walking, and other forms of outdoor recreation. People protest for their human rights of having a pure seaside and argue for health life in Bondi.</p>
                    <p><strong>I</strong>&nbsp;&nbsp;"They're prepared to risk lives and risk the Bondi beach environment for the sake of eight days of volleyball", said Stephen Uniacke, a construction lawyer involved in the campaign. Other environmental concerns include the possibility that soil dredged up from below the sand will acidify when brought to the surface.</p>
                </div>
                <div id="passage-text-2" class="reading-passage hidden">
                    <h4 class="text-center">Antarctica – in from the cold?</h4>
                    <p><strong>A</strong>&nbsp;&nbsp;A little over a century ago, men of the ilk of Scott, Shackleton and Mawson battled against Antarctica's blizzards, cold and deprivation. In the name of Empire and in an age of heroic deeds they created an image of Antarctica that was to last well into the 20th century – an image of remoteness, hardship, bleakness and isolation that was the province of only the most courageous of men. The image was one of a place removed from everyday reality, of a place with no apparent value to anyone.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;As we enter the 21st century, our perception of Antarctica has changed. Although physically Antarctica is no closer and probably no warmer, and to spend time there still demands a dedication not seen in ordinary life, the continent and its surrounding ocean are increasingly seen to an integral part of Planet Earth, and a key component in the Earth System. Is this because the world seems a little smaller these days, shrunk by TV and tourism, or is it because Antarctica really does occupy a central spot on Earth's mantle? Scientific research during the past half-century has revealed – and continues to reveal – that Antarctica's great mass and low temperature exert a major influence on climate and ocean circulation, factors which influence the lives of millions of people all over the globe.</p>
                    <p><strong>C</strong>&nbsp;&nbsp;Antarctica was not always cold. The slow break-up of the super-continent Gondwana with the northward movements of Africa, South America, India and Australia eventually created enough space around Antarctica for the development of an Antarctic Circumpolar Current (ACC), that flowed from west to east under the influence of the prevailing westerly winds. Antarctica cooled, its vegetation perished, glaciation began and the continent took on its present-day appearance. Today the ice that overlies the bedrock is up to 4km thick, and surface temperatures as low as – 89.2deg C have been recorded. The icy blast that howls over the ice cap and out to sea – the so-called katabatic wind – can reach 300 km/hr, creating fearsome wind-chill effects.</p>
                    <p><strong>D</strong>&nbsp;&nbsp;Out of this extreme environment come some powerful forces that reverberate around the world. The Earth's rotation, coupled to the generation of cells of low pressure off the Antarctic coast, would allow Astronauts a view of Antarctica that is as beautiful as it is awesome. Spinning away to the northeast, the cells grow and deepen, whipping up the Southern Ocean into the mountainous seas so respected by mariners. Recent work is showing that the temperature of the ocean may be a better predictor of rainfall in Australia than is the pressure difference between Darwin and Tahiti – the Southern Oscillation Index. By receiving more accurate predictions, graziers in northern Queensland are able to avoid overstocking in years when rainfall will be poor. Not only does this limit their losses but it prevents serious pasture degradation that may take decades to repair. CSIRO is developing this as a prototype forecasting system, but we can confidently predict that as we know more about the Antarctic and the Southern Ocean we will be able to enhance and extend our predictive ability.</p>
                    <p><strong>E</strong>&nbsp;&nbsp;The ocean's surface temperature results from the interplay between deep-water temperature, air temperature and ice. Each winter between 4 and 19 million square km of sea ice form, locking up huge quantities of heat close to the continent. Only now can we start to unravel the influence of sea ice on the weather that is experienced in southern Australia. But in another way, the extent of sea ice extends its influence far beyond Antarctica. Antarctic krill – the small shrimp-like crustaceans that are the staple diet for baleen whales, penguins, some seals, flighted sea birds and many fish – breed well in years when sea ice is extensive and poorly when it is not. Many species of baleen whales and flighted sea birds migrate between the hemispheres and when the krill are less abundant they do not thrive.</p>
                    <p><strong>F</strong>&nbsp;&nbsp;The circulatory system of the world's oceans is like a huge conveyor belt, moving water and dissolved minerals and nutrients from one hemisphere to the other, and from the ocean's abyssal depths to the surface. The ACC is the longest current in the world and has the largest flow. Through it, the deep flows of the Atlantic, Indian and Pacific Oceans are joined to form part of single global thermohaline circulation. During winter, the howling katabatics sometimes scour the ice off patches of the sea's surface leaving large ice-locked lagoons, or 'polynyas'. Recent research has shown that as fresh sea ice forms, it is continuously stripped away by the wind and maybe blown up to 90km in a single day. Since only freshwater freezes into ice, the water that remains becomes increasingly salty and dense, sinking until it spills over the continental shelf. Coldwater carries more oxygen than warm water, so when it rises, well into the northern hemisphere, it reoxygenates and revitalises the ocean. The state of the northern oceans and their biological productivity owe much to what happens in the Antarctic.</p>
                </div>
                <div id="passage-text-3" class="reading-passage hidden">
                    <h4 class="text-center">Talc Powder</h4>
                    <p><strong>A</strong>&nbsp;&nbsp;Peter Brigg discovers how talc from Luzenac's Trimouns in France finds its way into food and agricultural products – from chewing gum to olive oil. High in the French Pyrenees, some 1,700m above sea level, lies Trimouns, a huge deposit of hydrated magnesium silicate – talc to you and me. Talc from Trimouns, and from ten other Luzenac mines across the globe, is used in the manufacture of a vast array of everyday products extending from paper, paint and plaster to cosmetics, plastics and car tyres. And of course, there is always talc's best-known end use: talcum powder for babies' bottoms. But the true versatility of this remarkable mineral is nowhere better displayed than in its sometimes surprising use in certain niche markets in the food and agriculture industries.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;Take, for example, the chewing gum business. Every year, Talc de Luzenac France – which owns and operates the Trimouns mine and is a member of international Luzenac Group (the art of Rio Tinto minerals) – supplies about 6,000 tones of talc to chewing gum manufacturers in Europe. "We've been selling to this sector of the market since the 1960s," says Laurent Fournier, a sales manager in Luzenac's Specialties business unit in Toulouse. "Admittedly, in terms of our total annual sales of talc, the amount we supply to chewing gum manufacturers is relatively small, but we see is as a valuable niche market: one where customers place a premium on securing suppliers from a reliable, high-quality source. Because of this, long term allegiance to a proven supplier is very much a feature of this sector of the talc market." Switching sources – in the way that you might choose to buy, say, paperclips from Supplier A rather than from Supplier B – is not an easy option for chewing gum manufacturers," Fournier says. "The cost of reformulating is high, so when customers are using a talc grade that works, even if it's expensive, they are understandably reluctant to switch."</p>
                    <p><strong>C</strong>&nbsp;&nbsp;But how is talc actually used in the manufacture of chewing gum? Patrick Delord, an engineer with a degree in agronomics, who has been with Luzenac for 22 years and is now senior market development manager, Agriculture and Food, in Europe, explains that chewing gums has four main components. "The most important of them is the gum base," he says. "It's the gum base that puts the chew into chewing gum. It binds all the ingredients together, creating a soft, smooth texture. To this the manufacturer the adds sweeteners, softeners and flavourings. Our talc is used as a filler in the gum base. The amount varies between, say, ten and 35 per cent, depending on the type of gum. Fruit flavoured chewing gum, for example, is slightly acidic and would react with the calcium carbonate that the manufacturer might otherwise use as a filler. Talc, on the other hand, makes an ideal filler because it's non-reactive chemically. In the factory, talc is also used to dust the gum base pellets and to stop the chewing gum sticking during the lamination and packing process," Delord adds.</p>
                    <p><strong>D</strong>&nbsp;&nbsp;The chewing gum business is, however, just one example of talc's use in the food sector. For the past 20 years or so, olive oil processors in Spain have been taking advantage of talc's unique characteristics to help them boost the amount of oil they extract from crushed olives. According to Patrick Delord, talc is especially useful for treating what he calls "difficult" olives. After the olives are harvested – preferably early in the morning because their taste is better if they are gathered in the cool of the day – they are taken to the processing plant. There they are crushed and then stirred for 30-45 minutes. In the old days, the resulting paste was passed through an olive press but nowadays it's more common to add water and centrifuge the mixture to separate the water and oil from the solid matter. The oil and water are then allowed to settle so that the olive oil layer can be decanted off and bottle. "Difficult" olives are those that are more reluctant than the norm to yield up their full oil content. This may be attributable to the particular species of olive, or to its water content and the time of year the olives are collected – at the beginning and the end of the season their water content is often either too high or too low. These olives are easy to recognize because they produce a lot of extra foam during the stirring process, a consequence of an excess of a fine sold that acts as a natural emulsifier. The oil in this emulsion is lost when the water is disposed of. Not only that, if the wastewater is disposed of directly into local fields – often the case in many smaller processing operations – the emulsified oil may take some time to biodegrade and so be harmful to the environment.</p>
                    <p><strong>E</strong>&nbsp;&nbsp;"If you add between a half and two per cent of talc by weight during the stirring process, it absorbs the natural emulsifier in the olives and so boosts the amount of oil you can extract," says Delord. "In addition, talc's flat, 'platey' structure helps increase the size of the oil droplets liberated during stirring, which again improves the yield. However, because talc is chemically inert, it doesn't affect the colour, taste, appearance or composition of the resulting olive oil."</p>
                    <p><strong>F</strong>&nbsp;&nbsp;If the use of talc in olive oil processing and in chewing gum is long-established, new applications in the food and agriculture industries are also constantly being sought by Luzenac. One such promising new market is fruit crop protection, being pioneered in the US. Just like people, fruit can get sunburned. In fact, in very sunny regions up to 45 per cent of a typical crop can be affected by heat stress and sunburn. However, in the case of fruit, it's not so much the ultraviolet rays which harm the crop as the high surface temperature that the sun's rays create.</p>
                    <p><strong>G</strong>&nbsp;&nbsp;To combat this, farmers normally use either chemicals or spray a continuous fine canopy of mist above the fruit trees or bushes. The trouble is, this uses a lot of water – normally a precious commodity in hot, sunny areas – and it is therefore expensive. What's more, the ground can quickly become waterlogged. "So our idea was to coat the fruit with talc to protect it from the sun," says Greg Hunter, a marketing specialist who has been with Luzenac for ten years. "But to do this, several technical challenges had first to be overcome. Talc is very hydrophobic: it doesn't like water. So in order to have a viable product we needed a wettable powder – something that would go readily into suspension so that is could be sprayed onto the fruit. It also had to break the surface tension of the cutin (the natural waxy, waterproof layer on the fruit) and of course, it had to wash off easily when the fruit was harvested. No-one's going to want an apple that's covered in talc."</p>
                    <p><strong>H</strong>&nbsp;&nbsp;Initial trials in the state of Washington in 2003 showed that when the product was sprayed onto Granny Smith apples, it reduced their surface temperature and lowered the incidence of sunburn by up to 60 per cent. Today the new product, known as Envelop Maximum SPF, is in its second commercial year on the US market. Apple growers are the primary target although Hunter believes grape growers represent another sector with long term potential. He is also hopeful of extending sales to overseas markets such as Australia, South America and southern Europe.</p>
                </div>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="questions-panel" id="questions-panel">
                <div id="questions-1" class="question-set">
                    <div class="questions-container">
                        <div class="question" data-q-start="1" data-q-end="5">
                            <div class="question-prompt">
                                <p><strong>Questions 1-5</strong><br>
                                Do the following statements agree with the information given in Reading Passage 1?</p>
                                <p>In boxes 1-5 on your answer sheet, write</p>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><strong>TRUE</strong> if the statement agrees with the information</li>
                                    <li><strong>FALSE</strong> if the statement contradicts the information</li>
                                    <li><strong>NOT GIVEN</strong> if there is no information on this</li>
                                </ul>
                            </div>
                            <div class="tf-question" data-q-start="1" data-q-end="1">
                                <div class="tf-question-line"><span class="tf-question-number">1</span><span class="tf-question-text">The name of the Bondi beach is first called by the British settlers.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q1" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q1" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q1" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="2" data-q-end="2">
                                <div class="tf-question-line"><span class="tf-question-number">2</span><span class="tf-question-text">The aboriginal culture in Australia is different when compared with European culture.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q2" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q2" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q2" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="3" data-q-end="3">
                                <div class="tf-question-line"><span class="tf-question-number">3</span><span class="tf-question-text">Bondi beach area holds many contemporary hotels</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q3" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q3" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q3" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="4" data-q-end="4">
                                <div class="tf-question-line"><span class="tf-question-number">4</span><span class="tf-question-text">The seaside town in Bondi is affected by British culture for its characteristic red color</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q4" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q4" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q4" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="5" data-q-end="5">
                                <div class="tf-question-line"><span class="tf-question-number">5</span><span class="tf-question-text">Living near Bondi seashore is not beneficial for health.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q5" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q5" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q5" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                        </div>
                        <div class="question" data-q-start="6" data-q-end="9">
                            <div class="question-prompt">
                                <p><strong>Questions 6-9</strong><br>
                                Answer the questions below using <strong>NO MORE THAN TWO WORDS AND/OR NUMBERS</strong> from the passage for each answer.</p>
                                <p>Write your answers in boxes 6-9 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p><strong>6</strong>&nbsp;&nbsp;At the end of the 19th century, which public transport did people use to go to Bondi? <input type="text" class="answer-input" id="q6" placeholder="6"></p>
                                <p><strong>7</strong>&nbsp;&nbsp;When did the British Royalty first visit Bondi? <input type="text" class="answer-input" id="q7" placeholder="7"></p>
                                <p><strong>8</strong>&nbsp;&nbsp;Which Olympic event did Bondi hold in the 2000 Sydney Olympic games? <input type="text" class="answer-input" id="q8" placeholder="8"></p>
                                <p><strong>9</strong>&nbsp;&nbsp;What would be damaged if the stadium was built for that Olympic event? <input type="text" class="answer-input" id="q9" placeholder="9"></p>
                            </div>
                        </div>
                        <div class="question" data-q-start="10" data-q-end="13">
                            <div class="question-prompt">
                                <p><strong>Questions 10-13<br>Summary</strong></p>
                                <p>Complete the following summary of the paragraphs of Reading Passage, using <strong>NO MORE THAN TWO WORDS</strong> from the Reading Passage for each answer.</p>
                                <p>Write your answers in boxes 10-13 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p>Bondi beach holds the feature sports activities every year, which attracts lots of <input type="text" class="answer-input" id="q10" placeholder="10"> choosing to live at this place during the holidays. But local accommodation cannot meet with the expanding population, a nearby town of <input type="text" class="answer-input" id="q11" placeholder="11"> is the first suburb site to support the solution, yet people prefer <input type="text" class="answer-input" id="q12" placeholder="12"> as their best choice. Its seaside buildings are well-known in the world for the special scenic colored <input type="text" class="answer-input" id="q13" placeholder="13"> on buildings and the joyful smell from the sea.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Explanation Button for Part 1 -->
                    
                    
                    <!-- Part 1 Explanation Section -->
                    <div id="part-1-explanation" class="explanation-section hidden" style="margin-top: 40px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                        <h3 style="color: #333; margin-bottom: 20px; text-align: center;">Part 1 Explanation</h3>
                        <div class="explanation-content">
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 1:</strong> "Bondi" or "Boondi" is an Aboriginal word meaning water breaking over rocks or the sound of breaking waves. This shows the name was not first called by British settlers, making the answer FALSE.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 2:</strong> No direct comparison is made between Aboriginal culture and European culture in the passage. The passage mentions Aboriginal people and European settlement but doesn't compare the cultures, making the answer NOT GIVEN.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 3:</strong> "Bondi Beach has a commercial area along Campbell Parade and adjacent side streets, featuring many popular cafes, restaurants, and hotels..." This confirms that Bondi beach area holds many contemporary hotels, making the answer TRUE.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 4:</strong> "The valley running down to the beach is the famous world over for its view of distinctive red-tiled roofs. Those architectures are deeply influenced by British coastal town." This confirms that the seaside town in Bondi is affected by British culture for its characteristic red color, making the answer TRUE.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 5:</strong> "There is a growing trend that people prefer having to relax near seaside instead of living unhealthily in cities." This shows that living near Bondi seashore is beneficial for health, making the answer FALSE.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 6:</strong> "The first tramway reached the beach in 1884." This confirms that at the end of the 19th century, people used tram as public transport to go to Bondi.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 7:</strong> "A Royal Surf Carnival was held at Bondi Beach for Queen Elizabeth II during her first visited in Australia in 1954." This confirms that the British Royalty first visited Bondi in 1954.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 8:</strong> "Bondi Beach hosted the beach volleyball competition at the 2000 Summer Olympics." This confirms that Bondi held beach volleyball in the 2000 Sydney Olympic games.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 9:</strong> "The stadium will divide the beach in two and seriously restrict public access for swimming, walking, and other forms of outdoor recreation. Other environmental concerns include the possibility that soil dredged up from below the sand will acidify when brought to the surface." This confirms that public access would be damaged if the stadium was built for that Olympic event.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 10:</strong> "Many wealthy people spend Christmas Day at the beach." This confirms that Bondi beach holds feature sports activities every year, which attracts lots of visitors.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 11:</strong> "Manly is the seashore town which solved this problem." This confirms that Manly is the nearby town that supports the solution for accommodation.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 12:</strong> "However, people still choose Bondi as the satisfied destination rather than Manly." This confirms that people prefer Bondi as their best choice.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 13:</strong> "The valley running down to the beach is the famous world over for its view of distinctive red-tiled roofs." This confirms that its seaside buildings are well-known in the world for the special scenic colored red-tiled roofs.
                            </p>
                        </div>
                    </div>
                </div>
                <div id="questions-2" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="14" data-q-end="18">
                            <div class="question-prompt">
                                <p><strong>Questions 14-18</strong><br>The reading Passage has seven paragraphs <strong>A-F</strong></p>
                                <p>Which paragraph contains the following information?</p>
                                <p>Write the correct letter <strong>A-F</strong>, in boxes 14-18 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p><strong>14</strong>&nbsp;&nbsp;The example of research on weather prediction on agriculture 
                                    <select class="answer-select" id="q14">
                                        <option value="">Select answer</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </p>
                                <p><strong>15</strong>&nbsp;&nbsp;Antarctic sea ice brings life back to the world oceans' vitality. 
                                    <select class="answer-select" id="q15">
                                        <option value="">Select answer</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </p>
                                <p><strong>16</strong>&nbsp;&nbsp;A food chain that influences the animals living pattern based on Antarctic fresh sea ice 
                                    <select class="answer-select" id="q16">
                                        <option value="">Select answer</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </p>
                                <p><strong>17</strong>&nbsp;&nbsp;The explanation of how atmosphere pressure above Antarctica can impose an effect on global climate change 
                                    <select class="answer-select" id="q17">
                                        <option value="">Select answer</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </p>
                                <p><strong>18</strong>&nbsp;&nbsp;Antarctica was once thought to be a forgotten and insignificant continent 
                                    <select class="answer-select" id="q18">
                                        <option value="">Select answer</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="C">C</option>
                                        <option value="D">D</option>
                                        <option value="E">E</option>
                                        <option value="F">F</option>
                                    </select>
                                </p>
                            </div>
                        </div>
                        <div class="question" data-q-start="19" data-q-end="21">
                            <div class="question-prompt">
                                <p><strong>Questions 19-21</strong><br>Complete the summary of the paragraphs of Reading Passage 2 by dragging the correct words from the list below.</p>
                                <p>Drag the correct option to each gap in the summary.</p>
                            </div>
                            <div class="drag-drop-container">
                                <div class="summary-completion-container" style="flex: 2;">
                                    <div class="summary-text">
                                        <p>
                                            Globally, mass Antarctica's size and <span class="summary-drop-zone" data-q-start="19" data-dnd-group="summary-19-21">19</span> influence climate change. <span class="summary-drop-zone" data-q-start="20" data-dnd-group="summary-19-21">20</span> contributory to western wind. Southern Oscillation Index based on air pressure can predict <span class="summary-drop-zone" data-q-start="21" data-dnd-group="summary-19-21">21</span> in Australia.
                                        </p>
                                    </div>
                                </div>
                                <div class="recommendations-box" data-dnd-group="summary-19-21" style="flex: 1;">
                                    <p><strong>List of Options</strong></p>
                                    <div class="drag-item" draggable="true" data-value="A" data-dnd-group="summary-19-21">A. Antarctic Circumpolar Current (ACC)</div>
                                    <div class="drag-item" draggable="true" data-value="B" data-dnd-group="summary-19-21">B. katabatic winds</div>
                                    <div class="drag-item" draggable="true" data-value="C" data-dnd-group="summary-19-21">C. rainfall</div>
                                    <div class="drag-item" draggable="true" data-value="D" data-dnd-group="summary-19-21">D. temperature</div>
                                    <div class="drag-item" draggable="true" data-value="E" data-dnd-group="summary-19-21">E. glaciers</div>
                                    <div class="drag-item" draggable="true" data-value="F" data-dnd-group="summary-19-21">F. pressure</div>
                                </div>
                            </div>
                        </div>
                        <div class="question" data-q-start="22" data-q-end="26">
                            <div class="question-prompt">
                                <p><strong>Questions 22-26</strong><br>Choose the correct answer.</p>
                                <p>Write your answer in box 22-26 on your answer sheet.</p>
                            </div>
                            <div class="multi-choice-question" data-q-start="22" data-q-end="22">
                                <p><strong>22</strong>&nbsp;&nbsp;In paragraph B, the author wants to tell which of the following truth about the Antarctic?</p>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q22" value="A"> To show Antarctica has been a central topic of global warming in Mass media</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q22" value="B"> To illustrate its huge sea ice brings food to million lives to places in the world</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q22" value="C"> To show it is the heart and its significance to the global climate and current</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q22" value="D"> To illustrate it locates in the central spot on Earth geographically</label>
                                </div>
                            </div>
                            <div class="multi-choice-question" data-q-start="23" data-q-end="23">
                                <p><strong>23</strong>&nbsp;&nbsp;Why do Australian farmers keep an eye on the Antarctic ocean temperature?</p>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q23" value="A"> Help farmers reduce their economic or ecological losses</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q23" value="B"> Retrieve grassland decreased in the overgrazing process</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q23" value="C"> Prevent animal from dying</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q23" value="D"> A cell provides fertilizer for the grassland</label>
                                </div>
                            </div>
                            <div class="multi-choice-question" data-q-start="24" data-q-end="24">
                                <p><strong>24</strong>&nbsp;&nbsp;What is the final effect of katabatic winds?</p>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q24" value="A"> Increase the moving speed of ocean current</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q24" value="B"> Increase salt level near the ocean surface</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q24" value="C"> Bring fresh ice into southern oceans</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q24" value="D"> Pile up the mountainous ice cap respected by mariners</label>
                                </div>
                            </div>
                            <div class="multi-choice-question" data-q-start="25" data-q-end="25">
                                <p><strong>25</strong>&nbsp;&nbsp;The break of the continental shelf is due to the</p>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q25" value="A"> Salt and density increase</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q25" value="B"> Salt and density decrease</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q25" value="C"> global warming resulting in a rising temperature</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q25" value="D"> fresh ice melting into ocean water</label>
                                </div>
                            </div>
                            <div class="multi-choice-question" data-q-start="26" data-q-end="26">
                                <p><strong>26</strong>&nbsp;&nbsp;The decrease in the number of Whales and seabirds is due to</p>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q26" value="A"> killers whales are more active around</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q26" value="B"> Sea birds are affected by high sea level salty</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q26" value="C"> less sea ice reduces the productivity of food source</label>
                                </div>
                                <div class="multi-choice-option">
                                    <label><input type="radio" name="q26" value="D"> seals fail to reproduce babies</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="questions-3" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="27" data-q-end="32">
                            <div class="question-prompt">
                                <p><strong>Questions 27-32</strong><br>Use the information in the passage to match each use of talc powder with current application from A, B or C.</p>
                                <p>Write the appropriate letters A-C in boxes 27-32 on your answer sheet.</p>
                                <p><strong>NB</strong> You may use any letter more than once.</p>
                                <p><strong>A</strong> Fruit protection<br>
                                <strong>B</strong> Chewing gum business<br>
                                <strong>C</strong> Olive oil extraction</p>
                            </div>
                            <div class="table-container">
                                <table class="matching-table">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>A</th>
                                            <th>B</th>
                                            <th>C</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="statement">27. Talc is used to increase the size of drops.</td>
                                            <td class="clickable-cell" data-question="27" data-value="A" onclick="selectCell(this, 27, 'A')"></td>
                                            <td class="clickable-cell" data-question="27" data-value="B" onclick="selectCell(this, 27, 'B')"></td>
                                            <td class="clickable-cell" data-question="27" data-value="C" onclick="selectCell(this, 27, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">28. Talc is applied to reduce foaming.</td>
                                            <td class="clickable-cell" data-question="28" data-value="A" onclick="selectCell(this, 28, 'A')"></td>
                                            <td class="clickable-cell" data-question="28" data-value="B" onclick="selectCell(this, 28, 'B')"></td>
                                            <td class="clickable-cell" data-question="28" data-value="C" onclick="selectCell(this, 28, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">29. Talc is employed as a filler of base.</td>
                                            <td class="clickable-cell" data-question="29" data-value="A" onclick="selectCell(this, 29, 'A')"></td>
                                            <td class="clickable-cell" data-question="29" data-value="B" onclick="selectCell(this, 29, 'B')"></td>
                                            <td class="clickable-cell" data-question="29" data-value="C" onclick="selectCell(this, 29, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">30. Talc is modified and prevented sunburn.</td>
                                            <td class="clickable-cell" data-question="30" data-value="A" onclick="selectCell(this, 30, 'A')"></td>
                                            <td class="clickable-cell" data-question="30" data-value="B" onclick="selectCell(this, 30, 'B')"></td>
                                            <td class="clickable-cell" data-question="30" data-value="C" onclick="selectCell(this, 30, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">31. Talc is added to stop the stickiness.</td>
                                            <td class="clickable-cell" data-question="31" data-value="A" onclick="selectCell(this, 31, 'A')"></td>
                                            <td class="clickable-cell" data-question="31" data-value="B" onclick="selectCell(this, 31, 'B')"></td>
                                            <td class="clickable-cell" data-question="31" data-value="C" onclick="selectCell(this, 31, 'C')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">32. Talc is used to increase production.</td>
                                            <td class="clickable-cell" data-question="32" data-value="A" onclick="selectCell(this, 32, 'A')"></td>
                                            <td class="clickable-cell" data-question="32" data-value="B" onclick="selectCell(this, 32, 'B')"></td>
                                            <td class="clickable-cell" data-question="32" data-value="C" onclick="selectCell(this, 32, 'C')"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="question" data-q-start="33" data-q-end="38">
                            <div class="question-prompt">
                                <p><strong>Questions 33-38</strong><br>Complete the following summary of the paragraphs of Reading Passage, using <strong>NO MORE THAN TWO WORDS</strong> from the Reading Passage for each answer.</p>
                                <p>Write your answers in boxes 33-38 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p>Spanish olive oil industry has been using talc in the oil extraction process for about <input type="text" class="answer-input" id="q33" placeholder="33"> years. It is useful in dealing with difficult olives which often produce a high amount of <input type="text" class="answer-input" id="q34" placeholder="34"> because of the high content of solid materials. When smaller factories release <input type="text" class="answer-input" id="q35" placeholder="35">, it could be <input type="text" class="answer-input" id="q36" placeholder="36"> to the environment because it is hard to <input type="text" class="answer-input" id="q37" placeholder="37"> and usually takes time as it contains emulsified. However, talc power added in the process is able to absorb the emulsifier oil. It improves the oil extraction production because with the aid of talc powder, size of oil <input type="text" class="answer-input" id="q38" placeholder="38"> increased.</p>
                            </div>
                        </div>
                        <div class="question" data-q-start="39" data-q-end="40">
                            <div class="question-prompt">
                                <p><strong>Questions 39-40</strong><br>Answer the questions below using NO MORE THAN THREE WORDS from the passage for each answer.</p>
                                <p>Write your answers in boxes 39-40 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p><strong>39</strong>&nbsp;&nbsp;In which process is talc used to clear the stickiness of chewing gum? <input type="text" class="answer-input" id="q39" placeholder="39"></p>
                                <p><strong>40</strong>&nbsp;&nbsp;Which group of farmers does Envelop intend to target in a long view? <input type="text" class="answer-input" id="q40" placeholder="40"></p>
                            </div>
                        </div>
                                            </div>
                    </div>
                    
                    <!-- Explanation Button -->
                    
                    
                    <!-- Part 2 Explanation Section -->
                <div id="part-2-explanation" class="explanation-section" style="margin-top: 40px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h3 style="color: #333; margin-bottom: 20px; text-align: center;">Part 2 Explanation</h3>
                    <div class="explanation-content">
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 14:</strong> "Recent work is showing that the temperature of the ocean may be a better predictor of rainfall in Australia than is the pressure difference between Darwin and Tahiti... graziers in northern Queensland are able to avoid overstocking in years when rainfall will be poor." This passage discusses research on weather prediction for agriculture, which is found in paragraph D.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 15:</strong> "The state of the northern oceans and their biological productivity owe much to what happens in the Antarctic." This passage describes how Antarctic sea ice brings life back to the world oceans' vitality, which is found in paragraph F.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 16:</strong> "Antarctic krill – the small shrimp-like crustaceans that are the staple diet for baleen whales, penguins, some seals... breed well in years when sea ice is extensive and poorly when it is not." This passage describes a food chain that influences animals' living patterns based on Antarctic sea ice, which is found in paragraph E.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 17:</strong> "Scientific research... has revealed... Antarctica's great mass and low temperature exert a major influence on climate and ocean circulation..." This passage explains how atmospheric pressure above Antarctica affects global climate change, which is found in paragraph C.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 18:</strong> "...they created an image of Antarctica... of remoteness, hardship, bleakness and isolation that was the province of only the most courageous of men... with no apparent value to anyone." This passage shows that Antarctica was once thought to be a forgotten and insignificant continent, which is found in paragraph A.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 19:</strong> "Scientific research... Antarctica's great mass and low temperature exert a major influence on climate and ocean circulation..." This passage mentions that Antarctica's size and temperature influence climate change, corresponding to answer D (temperature).
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 20:</strong> "The slow break-up of the super-continent Gondwana... eventually created enough space around Antarctica for the development of an Antarctic Circumpolar Current (ACC), that flowed from west to east under the influence of the prevailing westerly winds." This passage describes how the ACC is contributory to western winds, corresponding to answer A (Antarctic Circumpolar Current).
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 21:</strong> "Recent work is showing that the temperature of the ocean may be a better predictor of rainfall in Australia than is the pressure difference between Darwin and Tahiti – the Southern Oscillation Index." This passage explains that the Southern Oscillation Index based on air pressure can predict rainfall in Australia, corresponding to answer C (rainfall).
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 22:</strong> "...the continent and its surrounding ocean are increasingly seen to an integral part of Planet Earth, and a key component in the Earth System." This passage shows that Antarctica is the heart and has significance to global climate and current, corresponding to answer C.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 23:</strong> "...graziers in northern Queensland are able to avoid overstocking in years when rainfall will be poor. Not only does this limit their losses but it prevents serious pasture degradation..." This passage explains why Australian farmers monitor Antarctic ocean temperature to help reduce economic or ecological losses, corresponding to answer A.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 24:</strong> "During winter, the howling katabatics sometimes scour the ice off patches of the sea's surface..." This passage describes the final effect of katabatic winds increasing salt level near the ocean surface, corresponding to answer B.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 25:</strong> "...the water that remains becomes increasingly salty and dense, sinking until it spills over the continental shelf." This passage explains that the break of the continental shelf is due to salt and density increase, corresponding to answer A.
                        </p>
                        <p style="margin-bottom: 15px; line-height: 1.6;">
                            <strong>Question 26:</strong> "...when the krill are less abundant they [whales, sea birds] do not thrive." This passage explains that the decrease in whales and seabirds is due to less sea ice reducing the productivity of food source, corresponding to answer C.
                        </p>
                    </div>
                    
                    <!-- Explanation Button for Part 2 -->
                    <div style="text-align: center; margin-top: 30px;">
                        <button id="show-explanation-btn" onclick="toggleExplanation()" style="background-color: #dc3545; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer; transition: background-color 0.2s;">
                            Hide Explanation
                        </button>
                    </div>
                    
                    
                    
                    <!-- Part 3 Explanation Section -->
                    <div id="part-3-explanation" class="explanation-section hidden" style="margin-top: 40px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                        <h3 style="color: #333; margin-bottom: 20px; text-align: center;">Part 3 Explanation</h3>
                        <div class="explanation-content">
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 27:</strong> "In addition, talc's flat, 'platey' structure helps increase the size of the oil droplets liberated during stirring..." This passage describes how talc increases oil droplet size during olive oil extraction, which corresponds to answer C (Olive oil extraction).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 28:</strong> "These olives are easy to recognize because they produce a lot of extra foam during the stirring process..." "...it absorbs the natural emulsifier in the olives and so boosts the amount of oil you can extract." This passage explains how talc reduces foaming by absorbing emulsifiers, which corresponds to answer C (Olive oil extraction).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 29:</strong> "Our talc is used as a filler in the gum base." This passage directly states that talc is used as a filler in chewing gum, which corresponds to answer B (Chewing gum business).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 30:</strong> "So our idea was to coat the fruit with talc to protect it from the sun..." This passage describes how talc prevents sunburn on fruit, which corresponds to answer A (Fruit protection).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 31:</strong> "In the factory, talc is also used to dust the gum base pellets and to stop the chewing gum sticking during the lamination and packing process." This passage explains how talc prevents stickiness in chewing gum production, which corresponds to answer B (Chewing gum business).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 32:</strong> "...it absorbs the natural emulsifier in the olives and so boosts the amount of oil you can extract." This passage describes how talc increases oil production, which corresponds to answer C (Olive oil extraction).
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 33:</strong> "For the past 20 years or so, olive oil processors in Spain have been taking advantage of talc's unique characteristics..." This passage mentions that Spanish olive oil industry has been using talc for about 20 years.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 34:</strong> "These olives are easy to recognize because they produce a lot of extra foam during the stirring process..." This passage mentions that difficult olives produce extra foam.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 35:</strong> "...if the wastewater is disposed of directly into local fields – often the case in many smaller processing operations..." This passage mentions wastewater being released by smaller factories.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 36:</strong> "...the emulsified oil may take some time to biodegrade and so be harmful to the environment." This passage states that emulsified oil can be harmful to the environment.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 37:</strong> "...may take some time to biodegrade..." This passage mentions that emulsified oil is hard to biodegrade.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 38:</strong> "...talc's flat, 'platey' structure helps increase the size of the oil droplets liberated during stirring..." This passage explains how talc increases the size of oil droplets.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 39:</strong> "...used to dust the gum base pellets and to stop the chewing gum sticking during the lamination and packing process." This passage mentions the lamination and packing process where talc is used to prevent stickiness.
                            </p>
                            <p style="margin-bottom: 15px; line-height: 1.6;">
                                <strong>Question 40:</strong> "Apple growers are the primary target although Hunter believes grape growers represent another sector with long term potential." This passage mentions that grape growers are the long-term target for Envelop.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Arrows -->
    <div class="nav-arrows">
        <button class="nav-arrow" onclick="previousQuestion()" id="prevBtn">‹</button>
        <button class="nav-arrow" onclick="nextQuestion()" id="nextBtn">›</button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-row perScorableItem" aria-label="Questions">
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(1)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">1</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(1)"><span class="sr-only">Question 1</span><span aria-hidden="true">1</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(2)"><span class="sr-only">Question 2</span><span aria-hidden="true">2</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(3)"><span class="sr-only">Question 3</span><span aria-hidden="true">3</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(4)"><span class="sr-only">Question 4</span><span aria-hidden="true">4</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(5)"><span class="sr-only">Question 5</span><span aria-hidden="true">5</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(6)"><span class="sr-only">Question 6</span><span aria-hidden="true">6</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(7)"><span class="sr-only">Question 7</span><span aria-hidden="true">7</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(8)"><span class="sr-only">Question 8</span><span aria-hidden="true">8</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(9)"><span class="sr-only">Question 9</span><span aria-hidden="true">9</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(10)"><span class="sr-only">Question 10</span><span aria-hidden="true">10</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(11)"><span class="sr-only">Question 11</span><span aria-hidden="true">11</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(12)"><span class="sr-only">Question 12</span><span aria-hidden="true">12</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(13)"><span class="sr-only">Question 13</span><span aria-hidden="true">13</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 selected multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(2)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">2</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(14)"><span class="sr-only">Question 14</span><span aria-hidden="true">14</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(15)"><span class="sr-only">Question 15</span><span aria-hidden="true">15</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(16)"><span class="sr-only">Question 16</span><span aria-hidden="true">16</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(17)"><span class="sr-only">Question 17</span><span aria-hidden="true">17</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(18)"><span class="sr-only">Question 18</span><span aria-hidden="true">18</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(19)"><span class="sr-only">Question 19</span><span aria-hidden="true">19</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(20)"><span class="sr-only">Question 20</span><span aria-hidden="true">20</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(21)"><span class="sr-only">Question 21</span><span aria-hidden="true">21</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(22)"><span class="sr-only">Question 22</span><span aria-hidden="true">22</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(23)"><span class="sr-only">Question 23</span><span aria-hidden="true">23</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(24)"><span class="sr-only">Question 24</span><span aria-hidden="true">24</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(25)"><span class="sr-only">Question 25</span><span aria-hidden="true">25</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(26)"><span class="sr-only">Question 26</span><span aria-hidden="true">26</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(3)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">3</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 14</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(27)"><span class="sr-only">Question 27</span><span aria-hidden="true">27</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(28)"><span class="sr-only">Question 28</span><span aria-hidden="true">28</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(29)"><span class="sr-only">Question 29</span><span aria-hidden="true">29</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(30)"><span class="sr-only">Question 30</span><span aria-hidden="true">30</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(31)"><span class="sr-only">Question 31</span><span aria-hidden="true">31</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(32)"><span class="sr-only">Question 32</span><span aria-hidden="true">32</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(33)"><span class="sr-only">Question 33</span><span aria-hidden="true">33</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(34)"><span class="sr-only">Question 34</span><span aria-hidden="true">34</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(35)"><span class="sr-only">Question 35</span><span aria-hidden="true">35</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(36)"><span class="sr-only">Question 36</span><span aria-hidden="true">36</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(37)"><span class="sr-only">Question 37</span><span aria-hidden="true">37</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(38)"><span class="sr-only">Question 38</span><span aria-hidden="true">38</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(39)"><span class="sr-only">Question 39</span><span aria-hidden="true">39</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(40)"><span class="sr-only">Question 40</span><span aria-hidden="true">40</span></button>
            </div>
        </div>
        
        <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton___3FM07">
            <i class="fa fa fa-check" aria-hidden="true"></i>
            <span>Check Answers</span>
        </button>
    </nav>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div id="menu-highlight" class="context-menu-item" onclick="highlightText()">
            Highlight
        </div>
        <div id="menu-note" class="context-menu-item" onclick="addNote()">
            Note
        </div>
        <div id="menu-clear" class="context-menu-item" onclick="clearHighlight()">
            Clear
        </div>
        <div id="menu-clear-all" class="context-menu-item" onclick="clearAllHighlights()">
            Clear All
        </div>
    </div>

    <div id="results-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closeResultsModal()">&times;</button>
            <h2>Results</h2>
            <div class="results-summary">
                <p>Score: <span id="results-score"></span> / 40</p>
                <p>IELTS Band: <span id="results-band"></span></p>
            </div>
            <div id="results-details" class="results-details-container">
                <!-- Results for each question will be injected here -->
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- STATE VARIABLES ---
        let currentPassage = 1;
        let currentQuestion = 1;
        let selectedRange = null;
        let timeInSeconds = 3600;
        let timerInterval;
        let draggedItem = null;
        let activeQuestionElement = null;
        let selectedDragItem = null;

        // --- GLOBAL FUNCTIONS ---
        function getFirstQuestionOfPart(part) {
            switch(part) {
                case 1: return 1;
                case 2: return 14;
                case 3: return 27;
                default: return 1;
            }
        }

        // --- DOM ELEMENTS ---
        const timerDisplay = document.querySelector('.timer-display');
        const timerToggleButton = document.getElementById('timer-toggle-btn');
        const timerResetButton = document.getElementById('timer-reset-btn');
        const deliverButton = document.getElementById('deliver-button');
        const resizer = document.getElementById('resizer');
        const passagePanel = document.getElementById('passage-panel');
        const questionsPanel = document.getElementById('questions-panel');
        const contextMenu = document.getElementById('contextMenu');

        // --- ICON SVGs ---
        const playIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>';
        const pauseIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';

        // --- ANSWERS ---
        const correctAnswers = {
            '1': 'FALSE', '2': 'NOT GIVEN', '3': 'TRUE', '4': 'TRUE', '5': 'FALSE',
            '6': 'tram', '7': '1954', '8': 'beach volleyball', '9': 'public access',
            '10': 'visitors', '11': 'Manly', '12': 'Bondi', '13': 'red-tiled roofs',
            '14': 'D', '15': 'F', '16': 'E', '17': 'D', '18': 'A',
            '19': 'D', '20': 'A', '21': 'C',
            '22': 'C', '23': 'A', '24': 'B', '25': 'A', '26': 'C',
            '27': 'C', '28': 'C', '29': 'B', '30': 'A', '31': 'B', '32': 'C',
            '33': '20', '34': 'foam', '35': 'wastewater', '36': 'harmful', '37': 'biodegrade', '38': 'droplets',
            '39': 'lamination and packing', '40': 'grape growers'
        };

        // --- INITIALIZATION ---
        function initialize() {
            console.log(`🚀 Initializing application...`);
            startTimer();
            initializeDragAndDrop();
            setupCheckboxLimits();
            setupExampleHeading();
            console.log(`📋 Setting up initial state - switching to part 1`);
            switchToPart(1); // Also calls goToQuestion(1) and updateNavigation
            
            document.body.addEventListener('input', updateAllIndicators);
            document.body.addEventListener('change', updateAllIndicators);
            deliverButton.addEventListener('click', checkAnswers);
            timerToggleButton.addEventListener('click', toggleTimer);
            timerResetButton.addEventListener('click', resetTimer);

            // Add click listeners to question containers for navigation
            document.querySelectorAll('[data-q-start]').forEach(el => {
                el.addEventListener('click', (event) => {
                    // Stop event propagation to prevent parent container clicks
                    event.stopPropagation();
                    
                    const qNum = parseInt(el.dataset.qStart, 10);
                    const qEnd = parseInt(el.dataset.qEnd, 10);
                    
                    console.log(`🖱️ Question container clicked - qNum: ${qNum}, qEnd: ${qEnd}, currentQuestion: ${currentQuestion}, element:`, el);
                    
                    // Handle cases where qNum is NaN
                    if (isNaN(qNum)) {
                        console.log(`ℹ️ Container without valid question number, ignoring navigation`);
                        return;
                    }
                    
                    // Only navigate if this is a single question (qStart === qEnd) or if we're clicking on a specific question within a group
                    if (qNum === qEnd || el.classList.contains('tf-question')) {
                        if (currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum}`);
                            goToQuestion(qNum);
                        } else {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed`);
                        }
                    } else {
                        console.log(`ℹ️ Ignoring click on group container (${qNum}-${qEnd})`);
                    }
                });
            });
            
            // Add specific click listeners for individual question elements to prevent parent container interference
            document.querySelectorAll('.tf-question, .summary-text').forEach(el => {
                el.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const qNum = parseInt(el.dataset.qStart, 10);
                    console.log(`🎯 Individual question element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, element:`, el);
                    
                    // Handle cases where qNum is NaN (like .summary-text containers)
                    if (isNaN(qNum)) {
                        console.log(`ℹ️ Container without specific question number, ignoring navigation`);
                        return;
                    }
                    
                    if (currentQuestion !== qNum) {
                        console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (individual element)`);
                        goToQuestion(qNum);
                    } else {
                        console.log(`ℹ️ Already on question ${qNum}, no navigation needed (individual element)`);
                    }
                });
            });
            
            // Add specific click listeners for individual input elements in questions 33-36
            document.querySelectorAll('.answer-input[id^="q3"]').forEach(input => {
                input.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const qNum = parseInt(input.id.replace('q', ''), 10);
                    console.log(`📝 Input element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, input:`, input);
                    
                    if (currentQuestion !== qNum) {
                        console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (input element)`);
                        goToQuestion(qNum);
                    } else {
                        console.log(`ℹ️ Already on question ${qNum}, no navigation needed (input element)`);
                    }
                });
            });
            
            // Add click listeners for the paragraph elements containing questions 33-36
            document.querySelectorAll('.summary-text p').forEach(p => {
                p.addEventListener('click', (event) => {
                    event.stopPropagation();
                    // Extract question number from the paragraph text (e.g., "33" from "<strong>33</strong>")
                    const strongElement = p.querySelector('strong');
                    if (strongElement) {
                        const qNum = parseInt(strongElement.textContent, 10);
                        console.log(`📄 Summary paragraph clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, paragraph:`, p);
                        
                        if (!isNaN(qNum) && currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (summary paragraph)`);
                            goToQuestion(qNum);
                        } else if (!isNaN(qNum)) {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed (summary paragraph)`);
                        }
                    }
                });
            });

            resizer.addEventListener('mousedown', initResize, false);
            initializeContextMenu();
        }

        // --- CORE TEST LOGIC ---

        function checkAnswers() {
            // Disable all inputs to prevent changes
            const allInputs = document.querySelectorAll('input, select, textarea');
            allInputs.forEach(input => {
                input.disabled = true;
            });

            // Disable all drag and drop functionality
            document.querySelectorAll('.drag-item').forEach(item => {
                item.setAttribute('draggable', 'false');
                item.style.cursor = 'not-allowed';
                item.style.pointerEvents = 'none';
            });

            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.style.pointerEvents = 'none';
                zone.classList.add('disabled');
            });

            // Disable submit button
            deliverButton.disabled = true;
            deliverButton.style.cursor = 'not-allowed';
            
            clearInterval(timerInterval);
            let score = 0;
            const totalQuestions = 40;
            const resultsDetailsContainer = document.getElementById('results-details');
            resultsDetailsContainer.innerHTML = '';

            document.querySelectorAll('.correct, .incorrect, .correct-answer-highlight').forEach(el => {
                el.classList.remove('correct', 'incorrect', 'correct-answer-highlight');
            });
            document.querySelectorAll('.correct-answer-display').forEach(el => el.remove());

            for (let i = 1; i <= totalQuestions; i++) {
                const questionKey = String(i);
                const correctAnswer = correctAnswers[questionKey];
                let userAnswer = '';
                let isCorrect = false;
                
                let userAnswerDisplay = 'Not Answered';
                const correctAnswerText = Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : correctAnswer;

                const textInput = document.getElementById(`q${i}`);
                const radioGroup = document.querySelectorAll(`input[name="q${i}"][type="radio"]`);
                
                // Handle Text and Select Inputs
                if (textInput && (textInput.tagName === 'INPUT' || textInput.tagName === 'SELECT')) {
                    const element = textInput.closest('.matching-form-row') || textInput;
                    userAnswer = textInput.value.trim();
                    userAnswerDisplay = userAnswer || 'Not Answered';

                    if (textInput.tagName === 'SELECT') {
                        isCorrect = userAnswer === correctAnswer;
                    } else {
                        isCorrect = Array.isArray(correctAnswer) ?
                            correctAnswer.some(ans => userAnswer.toLowerCase() === ans.toLowerCase()) :
                            userAnswer.toLowerCase() === correctAnswer.toLowerCase();
                    }
                    
                    if (isCorrect) {
                        score++;
                        element.classList.add('correct');
                    } else {
                        element.classList.add('incorrect');
                        const correctAnswerSpan = document.createElement('span');
                        correctAnswerSpan.className = 'correct-answer-display';
                        correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`;
                        textInput.parentNode.insertBefore(correctAnswerSpan, textInput.nextSibling);
                    }
                }
                // Handle summary completion questions (19-21)
                else if (i >= 19 && i <= 21) {
                    console.log(`🔍 Checking summary completion question ${i}`);
                    const dropZone = document.querySelector(`.summary-drop-zone[data-q-start="${i}"]`);
                    
                    console.log(`📍 Drop zone for question ${i}:`, dropZone);
                    console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                    
                    if (dropZone && dropZone.classList.contains('filled')) {
                        userAnswer = dropZone.dataset.answer;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        // Mark the drop zone as correct or incorrect
                        dropZone.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                        
                        // Show correct answer if wrong
                        if (!isCorrect && correctAnswer) {
                            const correctAnswerSpan = document.createElement('span');
                            correctAnswerSpan.className = 'correct-answer-display';
                            // Find the correct drag item to get the full text
                            const correctDragItem = document.querySelector(`.drag-item[data-value="${correctAnswer}"][data-dnd-group="summary-19-21"]`);
                            const correctAnswerText = correctDragItem ? correctDragItem.textContent : correctAnswer;
                            correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`;
                            dropZone.appendChild(correctAnswerSpan);
                        }
                    } else {
                        // No answer provided - mark as incorrect
                        console.log(`⚠️ No answer provided for question ${i}`);
                        if (dropZone) {
                            dropZone.classList.add('incorrect');
                        }
                        if (correctAnswer) {
                            const correctAnswerSpan = document.createElement('span');
                            correctAnswerSpan.className = 'correct-answer-display';
                            // Find the correct drag item to get the full text
                            const correctDragItem = document.querySelector(`.drag-item[data-value="${correctAnswer}"][data-dnd-group="summary-19-21"]`);
                            const correctAnswerText = correctDragItem ? correctDragItem.textContent : correctAnswer;
                            correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`;
                            dropZone.appendChild(correctAnswerSpan);
                        }
                    }
                }
                // Handle table matching questions (27-32)
                else if (i >= 27 && i <= 32) {
                    console.log(`🔍 Checking table matching question ${i}`);
                    const selectedCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-selected="true"]`);
                    
                    console.log(`📍 Selected cell for question ${i}:`, selectedCell);
                    console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                    
                    if (selectedCell) {
                        userAnswer = selectedCell.dataset.value;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        // Mark the selected cell as correct or incorrect
                        selectedCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                        
                        // Show correct answer if wrong
                        if (!isCorrect && correctAnswer) {
                            const correctCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-value="${correctAnswer}"]`);
                            if (correctCell) {
                                correctCell.classList.add('correct-answer-highlight');
                            }
                        }
                    } else {
                        // No answer provided - mark as incorrect
                        console.log(`⚠️ No answer provided for question ${i}`);
                        if (correctAnswer) {
                            const correctCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-value="${correctAnswer}"]`);
                            if (correctCell) {
                                correctCell.classList.add('correct-answer-highlight');
                            }
                        }
                    }
                }
                // Handle Radio Button Inputs (T/F, MCQs)
                else if (radioGroup.length > 0) {
                    const questionContainer = radioGroup[0]?.closest('.tf-question') || radioGroup[0]?.closest('.multi-choice-question');
                    const checkedRadio = document.querySelector(`input[name="q${i}"]:checked`);

                    if (checkedRadio) {
                        userAnswer = checkedRadio.value;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;

                        const userLabel = checkedRadio.closest('.tf-option, .multi-choice-option');
                        if (userLabel) {
                            userLabel.classList.add(isCorrect ? 'correct' : 'incorrect');
                        }
                        
                        // Handle table radio buttons
                        if (checkedRadio.classList.contains('table-radio')) {
                            const tableCell = checkedRadio.closest('td');
                            if (tableCell) {
                                tableCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                            }
                        }
                    }

                    if (isCorrect) {
                        score++;
                    } else {
                        if (questionContainer){
                            const correctOptionEl = questionContainer.querySelector(`input[value="${correctAnswerText}"]`);
                            if (correctOptionEl) {
                                const correctLabel = correctOptionEl.closest('.tf-option, .multi-choice-option');
                                if (correctLabel) {
                                    correctLabel.classList.add('correct-answer-highlight');
                                }
                            }
                        }
                    }
                }
                // Handle clickable cells for questions 21-26
                else if (i >= 21 && i <= 26) {
                    console.log(`🔍 Checking clickable cell question ${i}`);
                    const selectedCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-selected="true"]`);
                    console.log(`📍 Selected cell for question ${i}:`, selectedCell);
                    console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                    
                    if (selectedCell) {
                        userAnswer = selectedCell.dataset.answer;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        selectedCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                    } else {
                        console.log(`⚠️ No answer provided for question ${i}`);
                        userAnswerDisplay = 'Not Answered';
                    }
                    
                    // Handle highlighting correct answers for incorrect responses
                    if (!isCorrect) {
                        const correctCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-value="${correctAnswerText}"]`);
                        if (correctCell) {
                            correctCell.classList.add('correct-answer-highlight');
                            console.log(`✅ Highlighted correct answer for question ${i}:`, correctCell);
                        } else {
                            console.log(`⚠️ Could not find correct cell for question ${i} with value "${correctAnswerText}"`);
                        }
                    }
                }
                // Handle Checkbox Inputs (Multiple choice questions like 24-26)
                else if (i >= 24 && i <= 26) {
                    const checkedCheckboxes = document.querySelectorAll(`input[name="q24-26"]:checked`);
                    const userAnswers = Array.from(checkedCheckboxes).map(cb => cb.value).sort();
                    const correctAnswersArr = Array.isArray(correctAnswer) ? correctAnswer : [correctAnswer];
                    const correctAnswersSorted = correctAnswersArr.sort();
                    
                    userAnswerDisplay = userAnswers.length > 0 ? userAnswers.join(', ') : 'Not Answered';
                    isCorrect = userAnswers.length === correctAnswersSorted.length && 
                               userAnswers.every((ans, index) => ans === correctAnswersSorted[index]);

                    if (isCorrect) {
                        score++;
                        checkedCheckboxes.forEach(cb => {
                            cb.closest('.multi-choice-option')?.classList.add('correct');
                        });
                    } else {
                        checkedCheckboxes.forEach(cb => {
                            cb.closest('.multi-choice-option')?.classList.add('incorrect');
                        });
                        // Highlight correct answers
                        correctAnswersArr.forEach(ansValue => {
                            const correctCheckbox = document.querySelector(`input[name="q24-26"][value="${ansValue}"]`);
                            if (correctCheckbox) {
                                correctCheckbox.closest('.multi-choice-option')?.classList.add('correct-answer-highlight');
                            }
                        });
                    }
                }
                 
                // For showing results in the modal
                 const resultRow = `
                    <div class="result-row ${isCorrect ? '' : 'incorrect'}">
                        <span class="q-num">${i}</span>
                        <span class="user-ans">${userAnswerDisplay}</span>
                        <span class="correct-ans">${correctAnswerText}</span>
                    </div>`;
                resultsDetailsContainer.innerHTML += resultRow;
                
                // Update nav button color
                const navButton = document.querySelector(`.subQuestion[onclick="goToQuestion(${i})"]`);
                if (navButton) {
                    navButton.classList.remove('answered', 'active');
                    navButton.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
            }

            document.getElementById('results-score').textContent = score;
            document.getElementById('results-band').textContent = calculateBandScore(score);
            document.getElementById('results-modal').classList.remove('hidden');
            
            // Change button to "My Result" with green styling
            deliverButton.innerHTML = `<span>My Result</span>`;
            deliverButton.style.backgroundColor = '#4CAF50';
            deliverButton.style.color = 'white';
            deliverButton.style.borderColor = '#4CAF50';
            deliverButton.disabled = false;
            deliverButton.style.cursor = 'pointer';
            deliverButton.removeEventListener('click', checkAnswers);
            deliverButton.addEventListener('click', showResultsModal);
            
            // Highlight correct answers in the passage
            highlightCorrectAnswersInPassage();
        }

        function calculateBandScore(score) {
            if (score >= 39) return '9.0';
            const mapping = {
                40: 9.0, 39: 9.0, 38: 8.5, 37: 8.5, 36: 8.0, 35: 8.0, 34: 7.5,
                33: 7.5, 32: 7.0, 31: 7.0, 30: 7.0, 29: 6.5, 28: 6.5, 27: 6.5,
                26: 6.0, 25: 6.0, 24: 6.0, 23: 5.5, 22: 5.5, 21: 5.5, 20: 5.5,
                19: 5.0, 18: 5.0, 17: 5.0, 16: 5.0, 15: 5.0, 14: 4.5, 13: 4.5,
                12: 4.0, 11: 4.0, 10: 4.0, 9: 3.5, 8: 3.5, 7: 3.0, 6: 3.0,
                5: 2.5, 4: 2.5
            };
            if (score <= 0) return 0.0;
            if (score === 1) return 1.0;
            if (score <= 3) return 2.0;
            if (score <= 5) return 2.5;
            return mapping[score] || 0.0;
        }

        function highlightCorrectAnswersInPassage() {
            // Define the text passages and their corresponding question numbers for Part 1
            const part1Highlights = [
                {
                    question: 1,
                    text: "Bondi or Boondi is an Aboriginal word meaning water breaking over rocks or the sound of breaking waves",
                    answer: "FALSE"
                },
                {
                    question: 2,
                    text: "The indigenous people of the area at the time of European settlement have generally been welcomed to as the Sydney people or the Eora",
                    answer: "NOT GIVEN"
                },
                {
                    question: 3,
                    text: "Bondi Beach has a commercial area along Campbell Parade and adjacent side streets, featuring many popular cafes, restaurants, and hotels",
                    answer: "TRUE"
                },
                {
                    question: 4,
                    text: "The valley running down to the beach is the famous world over for its view of distinctive red-tiled roofs. Those architectures are deeply influenced by British coastal town",
                    answer: "TRUE"
                },
                {
                    question: 5,
                    text: "During the 1900s beach became associated with health, leisure and democracy",
                    answer: "FALSE"
                },
                {
                    question: 6,
                    text: "The first tramway reached the beach in 1884. Following this, tram became the first public transportation in Bondi",
                    answer: "tram"
                },
                {
                    question: 7,
                    text: "A Royal Surf Carnival was held at Bondi Beach for Queen Elizabeth II during her first visited in Australia in 1954",
                    answer: "1954"
                },
                {
                    question: 8,
                    text: "Bondi Beach hosted the beach volleyball competition at the 2000 Summer Olympics",
                    answer: "beach volleyball"
                },
                {
                    question: 9,
                    text: "The stadium will divide the beach in two and seriously restrict public access for swimming, walking, and other forms of outdoor recreation",
                    answer: "public access"
                },
                {
                    question: 10,
                    text: "Bondi Beach is the endpoint of the City to Surf Fun Run which is held each year in August",
                    answer: "visitors"
                },
                {
                    question: 11,
                    text: "Manly is the seashore town which solved this problem",
                    answer: "Manly"
                },
                {
                    question: 12,
                    text: "However, people still choose Bondi as the satisfied destination rather than Manly",
                    answer: "Bondi"
                },
                {
                    question: 13,
                    text: "The valley running down to the beach is the famous world over for its view of distinctive red-tiled roofs",
                    answer: "red-tiled roofs"
                }
            ];

            // Define the text passages and their corresponding question numbers for Part 2
            const part2Highlights = [
                {
                    question: 14,
                    text: "Recent work is showing that the temperature of the ocean may be a better predictor of rainfall in Australia than is the pressure difference between Darwin and Tahiti – the Southern Oscillation Index. By receiving more accurate predictions, graziers in northern Queensland are able to avoid overstocking in years when rainfall will be poor",
                    answer: "D"
                },
                {
                    question: 15,
                    text: "Coldwater carries more oxygen than warm water, so when it rises, well into the northern hemisphere, it reoxygenates and revitalises the ocean",
                    answer: "F"
                },
                {
                    question: 16,
                    text: "Antarctic krill – the small shrimp-like crustaceans that are the staple diet for baleen whales, penguins, some seals, flighted sea birds and many fish – breed well in years when sea ice is extensive and poorly when it is not",
                    answer: "E"
                },
                {
                    question: 17,
                    text: "The Earth's rotation, coupled to the generation of cells of low pressure off the Antarctic coast, would allow Astronauts a view of Antarctica that is as beautiful as it is awesome. Spinning away to the northeast, the cells grow and deepen, whipping up the Southern Ocean into the mountainous seas so respected by mariners",
                    answer: "D"
                },
                {
                    question: 18,
                    text: "The image was one of a place removed from everyday reality, of a place with no apparent value to anyone",
                    answer: "A"
                },
                {
                    question: 19,
                    text: "Antarctica's great mass and low temperature exert a major influence on climate and ocean circulation",
                    answer: "D"
                },
                {
                    question: 20,
                    text: "The slow break-up of the super-continent Gondwana with the northward movements of Africa, South America, India and Australia eventually created enough space around Antarctica for the development of an Antarctic Circumpolar Current (ACC), that flowed from west to east under the influence of the prevailing westerly winds",
                    answer: "A"
                },
                {
                    question: 21,
                    text: "Recent work is showing that the temperature of the ocean may be a better predictor of rainfall in Australia than is the pressure difference between Darwin and Tahiti – the Southern Oscillation Index",
                    answer: "C"
                },
                {
                    question: 22,
                    text: "the continent and its surrounding ocean are increasingly seen to an integral part of Planet Earth, and a key component in the Earth System",
                    answer: "C"
                },
                {
                    question: 23,
                    text: "By receiving more accurate predictions, graziers in northern Queensland are able to avoid overstocking in years when rainfall will be poor. Not only does this limit their losses but it prevents serious pasture degradation that may take decades to repair",
                    answer: "A"
                },
                {
                    question: 24,
                    text: "Since only freshwater freezes into ice, the water that remains becomes increasingly salty and dense, sinking until it spills over the continental shelf",
                    answer: "B"
                },
                {
                    question: 25,
                    text: "Since only freshwater freezes into ice, the water that remains becomes increasingly salty and dense, sinking until it spills over the continental shelf",
                    answer: "A"
                },
                {
                    question: 26,
                    text: "Many species of baleen whales and flighted sea birds migrate between the hemispheres and when the krill are less abundant they do not thrive",
                    answer: "C"
                }
            ];

            // Define the text passages and their corresponding question numbers for Part 3
            const part3Highlights = [
                {
                    question: 27,
                    text: "talc's flat, 'platey' structure helps increase the size of the oil droplets liberated during stirring",
                    answer: "C"
                },
                {
                    question: 28,
                    text: "If you add between a half and two per cent of talc by weight during the stirring process, it absorbs the natural emulsifier in the olives",
                    answer: "C"
                },
                {
                    question: 29,
                    text: "Our talc is used as a filler in the gum base",
                    answer: "B"
                },
                {
                    question: 30,
                    text: "Initial trials in the state of Washington in 2003 showed that when the product was sprayed onto Granny Smith apples, it reduced their surface temperature and lowered the incidence of sunburn by up to 60 per cent",
                    answer: "A"
                },
                {
                    question: 31,
                    text: "talc is also used to dust the gum base pellets and to stop the chewing gum sticking during the lamination and packing process",
                    answer: "B"
                },
                {
                    question: 32,
                    text: "it absorbs the natural emulsifier in the olives and so boosts the amount of oil you can extract",
                    answer: "C"
                },
                {
                    question: 33,
                    text: "For the past 20 years or so, olive oil processors in Spain have been taking advantage of talc's unique characteristics",
                    answer: "20"
                },
                {
                    question: 34,
                    text: "These olives are easy to recognize because they produce a lot of extra foam during the stirring process",
                    answer: "foam"
                },
                {
                    question: 35,
                    text: "if the wastewater is disposed of directly into local fields – often the case in many smaller processing operations",
                    answer: "wastewater"
                },
                {
                    question: 36,
                    text: "the emulsified oil may take some time to biodegrade and so be harmful to the environment",
                    answer: "harmful"
                },
                {
                    question: 37,
                    text: "the emulsified oil may take some time to biodegrade",
                    answer: "biodegrade"
                },
                {
                    question: 38,
                    text: "talc's flat, 'platey' structure helps increase the size of the oil droplets liberated during stirring",
                    answer: "droplets"
                },
                {
                    question: 39,
                    text: "talc is also used to dust the gum base pellets and to stop the chewing gum sticking during the lamination and packing process",
                    answer: "lamination and packing"
                },
                {
                    question: 40,
                    text: "Apple growers are the primary target although Hunter believes grape growers represent another sector with long term potential",
                    answer: "grape growers"
                }
            ];

            // Function to apply highlights to a passage
            function applyHighlights(passageElement, highlights) {
                if (!passageElement) return;

                // Clear any existing highlights
                passageElement.querySelectorAll('.answer-highlight').forEach(el => {
                    const parent = el.parentNode;
                    parent.replaceChild(document.createTextNode(el.textContent), el);
                    parent.normalize();
                });

                // Add highlights for each answer
                highlights.forEach(item => {
                    const paragraphs = passageElement.querySelectorAll('p');
                    paragraphs.forEach(paragraph => {
                        const text = paragraph.textContent;
                        if (text.includes(item.text)) {
                            const highlightedText = text.replace(
                                item.text,
                                `<span class="answer-highlight" data-question="${item.question}" style="
                                    background-color: #ffeb3b;
                                    padding: 2px 4px;
                                    border-radius: 3px;
                                    font-weight: bold;
                                    position: relative;
                                ">${item.text}<span style="
                                    position: absolute;
                                    top: -8px;
                                    right: -8px;
                                    background-color: #2196f3;
                                    color: white;
                                    border-radius: 50%;
                                    width: 20px;
                                    height: 20px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 12px;
                                    font-weight: bold;
                                ">${item.question}</span></span>`
                            );
                            paragraph.innerHTML = highlightedText;
                        }
                    });
                });
            }

            // Apply highlights to Part 1 (Bondi Beach)
            const passageText1 = document.getElementById('passage-text-1');
            applyHighlights(passageText1, part1Highlights);

            // Apply highlights to Part 2 (Reclaiming the Night)
            const passageText2 = document.getElementById('passage-text-2');
            applyHighlights(passageText2, part2Highlights);

            // Apply highlights to Part 3 (Talc Powder)
            const passageText3 = document.getElementById('passage-text-3');
            applyHighlights(passageText3, part3Highlights);
        }

        function getUserAnswer(qNum) {
            const textInput = document.getElementById(`q${qNum}`);
            const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
            const dropZone = document.querySelector(`.drop-zone[data-q-start="${qNum}"]`);
            const summaryDropZone = document.querySelector(`.summary-drop-zone[data-q-start="${qNum}"]`);

            if (textInput) { // Handles <input type="text"> and <select>
                return { value: textInput.value, text: textInput.value || 'N/A' };
            }
            if (radioInput) {
                return { value: radioInput.value, text: radioInput.value };
            }
            if (dropZone) {
                const droppedItem = dropZone.querySelector('.drag-item');
                return { 
                    value: droppedItem ? droppedItem.dataset.value : null, 
                    text: droppedItem ? droppedItem.textContent.trim() : 'N/A' 
                };
            }
            if (summaryDropZone) {
                if (summaryDropZone.classList.contains('filled')) {
                    return { 
                        value: summaryDropZone.dataset.answer, 
                        text: summaryDropZone.textContent.trim() 
                    };
                } else {
                    return { 
                        value: null, 
                        text: 'N/A' 
                    };
                }
            }
            // Handle clickable cells for questions 23-26 and 27-32
            if (qNum >= 23 && qNum <= 26) {
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return { value: selectedCell.dataset.answer, text: selectedCell.dataset.answer };
                }
            }
            if (qNum >= 27 && qNum <= 32) {
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return { value: selectedCell.dataset.value, text: selectedCell.dataset.value };
                }
            }
            return { value: null, text: 'N/A' };
        }

        function displayCorrectAnswer(qNum, correctAnswer) {
            // Handle summary completion questions (19-21)
            if (qNum >= 19 && qNum <= 21) {
                const dropZone = document.querySelector(`.summary-drop-zone[data-q-start="${qNum}"]`);
                if (dropZone) {
                    const displaySpan = document.createElement('span');
                    displaySpan.className = 'correct-answer-display';
                    // Find the correct drag item to get the full text
                    const correctDragItem = document.querySelector(`.drag-item[data-value="${correctAnswer}"][data-dnd-group="summary-19-21"]`);
                    const correctAnswerText = correctDragItem ? correctDragItem.textContent : correctAnswer;
                    displaySpan.textContent = ` ✓ ${correctAnswerText}`;
                    dropZone.appendChild(displaySpan);
                }
                return;
            }
            
            // Handle table matching questions (27-32)
            if (qNum >= 27 && qNum <= 32) {
                const correctCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-value="${correctAnswer}"]`);
                if (correctCell) {
                    correctCell.classList.add('correct-answer-highlight');
                }
                return;
            }
            
            // Handle multi-choice group questions (e.g., 24-26, 38-40)
            if ((qNum >= 24 && qNum <= 26) || (qNum >= 38 && qNum <= 40)) {
                const groupName = (qNum >= 24 && qNum <= 26) ? 'q24-26' : 'q38-40';
                const correctAnswersArr = Array.isArray(correctAnswer) ? correctAnswer : [correctAnswer];
                correctAnswersArr.forEach(ansValue => {
                    const correctInput = document.querySelector(`input[name="${groupName}"][value="${ansValue}"]`);
                    correctInput?.closest('.multi-choice-option')?.classList.add('correct-answer-highlight');
                });
                return;
            }

            // Handle radio button questions by highlighting the correct label
            const correctRadioInput = document.querySelector(`input[name="q${qNum}"][value="${correctAnswer}"]`);
            if (correctRadioInput) {
                const parentOption = correctRadioInput.closest('.tf-option, .multi-choice-option');
                if (parentOption) {
                    parentOption.classList.add('correct-answer-highlight');
                    return;
                }
            }

            // Handle text inputs, select dropdowns, and others by showing the answer next to them
            const inputEl = document.getElementById(`q${qNum}`);
            if (inputEl) {
                const displaySpan = document.createElement('span');
                displaySpan.className = 'correct-answer-display';
                displaySpan.textContent = ` ✓ ${correctAnswer}`;
                inputEl.insertAdjacentElement('afterend', displaySpan);
                return; // Done
            }
            
            // Fallback for questions identified by a container (e.g., some T/F/NG questions)
            const element = findQuestionElement(qNum);
            if (element) {
                const displaySpan = document.createElement('span');
                displaySpan.className = 'correct-answer-display';
                displaySpan.textContent = ` ✓ ${correctAnswer}`;
                const itemContainer = element.querySelector('.tf-question-text');
                if (itemContainer) {
                     itemContainer.appendChild(displaySpan);
                } else {
                     element.appendChild(displaySpan);
                }
            }
        }
        
        function findQuestionElement(qNum) {
             return document.querySelector(`[data-q-start="${qNum}"]`);
        }

        function addResultToModal(qNum, userAnswer, correctAnswer, isCorrect) {
            const resultsDetails = document.getElementById('results-details');
            const row = document.createElement('div');
            row.className = 'result-row';
            if (!isCorrect) {
                row.classList.add('incorrect');
            }
            row.innerHTML = `
                <span class="q-num">${qNum}</span>
                <span class="user-ans">${userAnswer}</span>
                <span class="correct-ans">${correctAnswer}</span>
            `;
            resultsDetails.appendChild(row);
        }

        function showResultsModal() {
            document.getElementById('results-modal').classList.remove('hidden');
        }

        window.closeResultsModal = function() {
            document.getElementById('results-modal').classList.add('hidden');
        }
        
        function disableInputs() {
            deliverButton.innerHTML = `<span>Checked! View Results.</span>`;
            deliverButton.removeEventListener('click', checkAnswers);
            deliverButton.onclick = showResultsModal;

            document.querySelectorAll('input, select').forEach(el => {
                el.disabled = true;
                 if (el.matches('input[type=radio], input[type=checkbox]')) {
                     el.style.cursor = 'not-allowed';
                     el.parentElement.style.cursor = 'not-allowed';
                 }
            });
            document.querySelectorAll('.drag-item').forEach(el => {
                el.setAttribute('draggable', 'false');
                el.style.cursor = 'default';
            });
            document.querySelectorAll('.drop-zone').forEach(el => {
                el.classList.add('disabled');
            });
        }

        function checkValue(userValue, correctValue) {
            if (userValue === null || userValue === undefined) return false;
            const formattedUserValue = userValue.trim().toLowerCase();
            if (Array.isArray(correctValue)) {
                return correctValue.map(v => v.toLowerCase()).includes(formattedUserValue);
            } else {
                return formattedUserValue === String(correctValue).toLowerCase();
            }
        }

        function markQuestion(qNum, isCorrect) {
            const subQuestionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
            subQuestionBtn?.classList.add(isCorrect ? 'correct' : 'incorrect');

            const elementsToMark = [
                document.querySelector(`.tf-question[data-q-start="${qNum}"]`),
                document.querySelector(`.multi-choice-question[data-q-start="${qNum}"]`),
                document.querySelector(`.matching-question-item[data-q-start="${qNum}"]`),
                document.querySelector(`.drop-zone[data-q-start="${qNum}"]`),
                document.getElementById(`q${qNum}`),
                document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.tf-option'),
                document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.multi-choice-option')
            ];
            
            elementsToMark.forEach(el => {
                if (el) el.classList.add(isCorrect ? 'correct' : 'incorrect');
            });

             if (qNum === 14 || qNum === 15) {
                const multiChoiceContainer = document.querySelector('.multi-choice-question[data-q-start="14"]');
                if (multiChoiceContainer) multiChoiceContainer.classList.add(isCorrect ? 'correct' : 'incorrect');
             } else if (qNum >= 1 && qNum <= 5) {
                const pMatchInput = document.getElementById(`q${qNum}`);
                if (pMatchInput) pMatchInput.classList.add(isCorrect ? 'correct' : 'incorrect');
             } else if (qNum >= 38 && qNum <= 40) {
                // For this group, individual options are marked, not the container.
             }
        }

        function switchToPart(partNumber) {
            console.log(`🔀 switchToPart called with partNumber: ${partNumber}, currentPassage: ${currentPassage}`);
            
            currentPassage = partNumber;

            // Hide all passages and questions
            document.querySelectorAll('.reading-passage, .question-set, .part-header').forEach(el => {
                el.classList.add('hidden');
            });

            // Show the correct passage, questions, and header
            document.getElementById(`passage-text-${partNumber}`).classList.remove('hidden');
            document.getElementById(`questions-${partNumber}`).classList.remove('hidden');
            document.getElementById(`part-header-${partNumber}`).classList.remove('hidden');

            // Update bottom navigation 'selected' state
            document.querySelectorAll('.footer__questionWrapper___1tZ46').forEach((wrapper, index) => {
                wrapper.classList.toggle('selected', (index + 1) === partNumber);
            });

            // Show/hide explanation buttons based on part
            const explanationButton = document.getElementById('show-explanation-btn');
            const explanationButtonPart3 = document.getElementById('show-explanation-btn-part3');
            
            if (explanationButton) {
                if (partNumber === 2) {
                    explanationButton.style.display = 'block';
                } else {
                    explanationButton.style.display = 'none';
                    // Hide explanation section when switching away from part 2
                    const explanationSection = document.getElementById('part-2-explanation');
                    if (explanationSection) {
                        explanationSection.classList.add('hidden');
                        explanationButton.textContent = 'Show Explanation';
                        explanationButton.style.backgroundColor = '#4a90e2';
                    }
                }
            }
            
            if (explanationButtonPart3) {
                if (partNumber === 3) {
                    explanationButtonPart3.style.display = 'block';
                } else {
                    explanationButtonPart3.style.display = 'none';
                    // Hide explanation section when switching away from part 3
                    const explanationSection = document.getElementById('part-3-explanation');
                    if (explanationSection) {
                        explanationSection.classList.add('hidden');
                        explanationButtonPart3.textContent = 'Show Explanation';
                        explanationButtonPart3.style.backgroundColor = '#4a90e2';
                    }
                }
            }

            console.log(`✅ switchToPart completed - switched to part ${partNumber}`);
            
            // Only go to first question when switching parts, not when staying in same part
            // This allows goToQuestion to work properly for specific question navigation
            // const firstQuestionOfPart = {1: 1, 2: 14, 3: 27}[partNumber];
            // goToQuestion(firstQuestionOfPart);
        }
        
        function goToQuestion(questionNumber) {
            console.log(`🎯 goToQuestion called with questionNumber: ${questionNumber}, currentQuestion: ${currentQuestion}, currentPassage: ${currentPassage}`);
            
            currentQuestion = questionNumber;

            let passageNumber = 1;
            if (questionNumber >= 14 && questionNumber <= 26) passageNumber = 2;
            else if (questionNumber >= 27) passageNumber = 3;
            
            console.log(`📍 Calculated passageNumber: ${passageNumber} for question ${questionNumber}`);
            
            if (currentPassage !== passageNumber) {
                console.log(`🔄 Switching from part ${currentPassage} to part ${passageNumber} for question ${questionNumber}`);
                switchToPart(passageNumber);
                return; 
            }

            console.log(`✅ Staying in same part (${currentPassage}) for question ${questionNumber}`);

            if (activeQuestionElement) {
                activeQuestionElement.classList.remove('active-question', 'active-input');
            }

            // First, try to find the specific input element for questions 33-36
            let targetEl = document.getElementById(`q${questionNumber}`);
            if (targetEl) {
                activeQuestionElement = targetEl;
                console.log(`✅ Found specific input element:`, targetEl);
                targetEl.classList.add('active-input');
                scrollIntoViewIfNeeded(targetEl);
            } else {
                // Fall back to looking for question containers
                targetEl = document.querySelector(`[data-q-start="${questionNumber}"]`);
                console.log(`🔍 Looking for target element with data-q-start="${questionNumber}":`, targetEl);

                if (targetEl) {
                    activeQuestionElement = targetEl;
                    console.log(`✅ Found target element:`, targetEl);
                    
                    if (targetEl.matches('input[type="text"]') || targetEl.matches('select')) {
                        targetEl.classList.add('active-input');
                        console.log(`📝 Added active-input class to input/select element`);
                    } else {
                        targetEl.classList.add('active-question');
                        console.log(`📋 Added active-question class to question element`);
                    }
                    scrollIntoViewIfNeeded(targetEl);
                } else {
                    console.log(`⚠️ Target element not found, looking for paragraph matching question`);
                    const pMatch = document.querySelector(`.paragraph-matching-question select[id="q${questionNumber}"]`);
                    if(pMatch) {
                        activeQuestionElement = pMatch;
                        pMatch.classList.add('active-input');
                        scrollIntoViewIfNeeded(pMatch);
                        console.log(`✅ Found paragraph matching question:`, pMatch);
                    } else {
                        console.log(`❌ No target element found for question ${questionNumber}`);
                    }
                }
            }

            updateNavigation();
            console.log(`✅ goToQuestion completed for question ${questionNumber}`);
        }
        
        // --- UI & NAVIGATION ---

        function updateNavigation() {
            console.log(`🔄 updateNavigation called for currentQuestion: ${currentQuestion}`);
            
            const navButtons = document.querySelectorAll('.subQuestion');
            navButtons.forEach(btn => btn.classList.remove('active'));
            const activeNav = document.querySelector(`.subQuestion[onclick="goToQuestion(${currentQuestion})"]`);
            if (activeNav) {
                activeNav.classList.add('active');
                console.log(`✅ Updated navigation - active nav button:`, activeNav);
            } else {
                console.log(`⚠️ No active navigation button found for question ${currentQuestion}`);
            }

            const inputs = document.querySelectorAll('.answer-input, .drop-zone.filled, .summary-drop-zone.filled');
            inputs.forEach(input => input.classList.remove('active-input'));
            
            const activeInput = document.getElementById(`q${currentQuestion}`);
            if (activeInput) {
                activeInput.classList.add('active-input');
                if (typeof activeInput.focus === 'function') {
                    activeInput.focus();
                }
                console.log(`✅ Focused on input element:`, activeInput);
            } else {
                console.log(`⚠️ No direct input found for question ${currentQuestion}, looking in question block`);
                const activeQuestionBlock = document.querySelector(`[data-q-start="${currentQuestion}"]`);
                if (activeQuestionBlock) {
                    const firstInput = activeQuestionBlock.querySelector('input, select');
                    if(firstInput) {
                        firstInput.classList.add('active-input');
                         if (typeof firstInput.focus === 'function') {
                            firstInput.focus();
                        }
                        console.log(`✅ Focused on input in question block:`, firstInput);
                    } else {
                        console.log(`⚠️ No input found in question block for question ${currentQuestion}`);
                    }
                } else {
                    console.log(`❌ No question block found for question ${currentQuestion}`);
                }
            }
            
            console.log(`✅ updateNavigation completed`);
        }
        
        function selectDragItem(item) {
            if (selectedDragItem) {
                selectedDragItem.classList.remove('selected');
            }
            selectedDragItem = item;
            if (selectedDragItem) {
                selectedDragItem.classList.add('selected');
            }
        }
        
        window.nextQuestion = () => currentQuestion < 40 && goToQuestion(currentQuestion + 1);
        window.previousQuestion = () => currentQuestion > 1 && goToQuestion(currentQuestion - 1);

        function updateAllIndicators() {
            updateAttemptedCount(1, 1, 13);
            updateAttemptedCount(2, 14, 26);
            updateAttemptedCount(3, 27, 40);
            updateAnsweredNav();
        }
        
        function updateAnswer(questionId, value) {
            // This function updates the answer tracking for a specific question
            // The actual answer tracking is handled by the UI elements themselves
            console.log(`📝 Updating answer for question ${questionId}: ${value}`);
            updateAllIndicators();
        }

        function updateAnsweredNav() {
            const navButtons = document.querySelectorAll('.subQuestion');
            navButtons.forEach(btn => {
                const qNum = parseInt(btn.textContent, 10);
                if (isQuestionAnswered(qNum)) {
                    btn.classList.add('answered');
                } else {
                    btn.classList.remove('answered');
                }
            });
        }
        
        function isQuestionAnswered(qNum) {
            const textInput = document.getElementById(`q${qNum}`);
            if (textInput && (textInput.value.trim() !== '' || (textInput.classList.contains('drop-zone') && textInput.children.length > 0))) {
                return true;
            }
            const radio = document.querySelector(`input[name="q${qNum}"]:checked`);
            if (radio) {
                return true;
            }
            const checkbox = document.querySelector(`input[name="q${qNum}"]:checked`);
            if (checkbox) {
                return true;
            }
            // Handle summary drop zones for questions 19-21
            const summaryDropZone = document.querySelector(`.summary-drop-zone[data-q-start="${qNum}"]`);
            if (summaryDropZone && summaryDropZone.classList.contains('filled')) {
                return true;
            }
            // Handle clickable cells for questions 23-26 and 27-32
            if (qNum >= 23 && qNum <= 26) {
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return true;
                }
            }
            if (qNum >= 27 && qNum <= 32) {
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return true;
                }
            }
            return false;
        }

        function scrollIntoViewIfNeeded(element) {
            const panel = element.closest('.questions-panel, .passage-panel');
            const panelRect = panel.getBoundingClientRect();
            const elementRect = element.getBoundingClientRect();
            if (elementRect.top < panelRect.top || elementRect.bottom > panelRect.bottom) {
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        // --- DRAG AND DROP ---
        
        function initializeDragAndDrop() {
            // Initialize general drag and drop for other questions
            document.querySelectorAll('.drag-item:not([data-dnd-group="summary-19-21"])').forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('click', () => selectDragItem(item));
            });
            document.querySelectorAll('.drop-zone, .drag-options-container').forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });
            
            // Initialize drag and drop for Questions 19-21
            initializeQuestions1921DragDrop();
        }
        
        function initializeQuestions1921DragDrop() {
            const dragItems = document.querySelectorAll('.drag-item[data-dnd-group="summary-19-21"]');
            const dropZones = document.querySelectorAll('.summary-drop-zone[data-dnd-group="summary-19-21"]');
            
            console.log('Initializing drag and drop for questions 19-21');
            console.log('Drag items found:', dragItems.length);
            console.log('Drop zones found:', dropZones.length);
            
            dragItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    console.log('Drag start:', item.dataset.value);
                    e.dataTransfer.setData('text/plain', item.dataset.value);
                    item.classList.add('dragging');
                });
                
                item.addEventListener('dragend', (e) => {
                    console.log('Drag end');
                    item.classList.remove('dragging');
                });
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.style.borderColor = '#4a90e2';
                    zone.style.background = '#f0f8ff';
                });
                
                zone.addEventListener('dragleave', (e) => {
                    if (!zone.contains(e.relatedTarget)) {
                        zone.style.borderColor = '#999';
                        zone.style.background = '#fafafa';
                    }
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    console.log('Drop event triggered');
                    const value = e.dataTransfer.getData('text/plain');
                    console.log('Dropped value:', value);
                    
                    // Find the drag item
                    const dragItem = document.querySelector(`.drag-item[data-value="${value}"][data-dnd-group="summary-19-21"]`);
                    console.log('Found drag item:', dragItem);
                    
                    if (dragItem) {
                        // If the drop zone is already filled, return the previous item to the options
                        if (zone.classList.contains('filled')) {
                            const previousValue = zone.dataset.answer;
                            const previousItem = document.querySelector(`.drag-item[data-value="${previousValue}"][data-dnd-group="summary-19-21"]`);
                            if (previousItem) {
                                previousItem.style.display = 'block';
                                previousItem.classList.remove('used');
                            }
                        }
                        
                        // Hide the dragged item from the options list
                        dragItem.style.display = 'none';
                        dragItem.classList.add('used');
                        
                        // Add to new drop zone
                        zone.textContent = dragItem.textContent;
                        zone.dataset.answer = value;
                        zone.classList.add('filled');
                        
                        // Update answer tracking
                        const questionId = zone.dataset.qStart;
                        console.log('Updating answer for question:', questionId, 'with value:', value);
                        updateAnswer(questionId, value);
                    }
                    
                    zone.style.borderColor = '#999';
                    zone.style.background = '#fafafa';
                });
                
                // Add click to remove functionality
                zone.addEventListener('click', (e) => {
                    if (zone.classList.contains('filled')) {
                        const value = zone.dataset.answer;
                        const dragItem = document.querySelector(`.drag-item[data-value="${value}"][data-dnd-group="summary-19-21"]`);
                        
                        if (dragItem) {
                            // Show the item back in the options list
                            dragItem.style.display = 'block';
                            dragItem.classList.remove('used');
                        }
                        
                        // Clear the drop zone
                        zone.textContent = zone.dataset.qStart;
                        zone.classList.remove('filled');
                        zone.dataset.answer = '';
                        
                        const questionId = zone.dataset.qStart;
                        updateAnswer(questionId, '');
                    }
                });
            });
        }

        function handleDragStart(e) {
            draggedItem = e.target;
            setTimeout(() => e.target.classList.add('dragging'), 0);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedItem = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            const targetZone = e.currentTarget;
            if (draggedItem && draggedItem.dataset.dndGroup === targetZone.dataset.dndGroup) {
                targetZone.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const targetZone = e.currentTarget;
            targetZone.classList.remove('drag-over');

            if (!draggedItem || draggedItem.dataset.dndGroup !== targetZone.dataset.dndGroup) {
                return;
            }

            const sourceZone = draggedItem.parentElement;
            if (sourceZone === targetZone) return; // Prevent dropping on itself

            const existingItemInTarget = targetZone.classList.contains('drop-zone') 
                ? targetZone.querySelector('.drag-item') 
                : null;

            // First, clear the target drop-zone of any text (like question numbers) before adding the new item.
            if (targetZone.classList.contains('drop-zone')) {
                Array.from(targetZone.childNodes).forEach(node => {
                    if (node.nodeType === Node.TEXT_NODE) {
                        node.remove();
                    }
                });
            }

            // Move the item that was in the target (if any) to the source zone.
            if (existingItemInTarget) {
                sourceZone.appendChild(existingItemInTarget);
            }
            
            // Finally, move the dragged item to the target zone.
            targetZone.appendChild(draggedItem);
            targetZone.classList.add('filled');

            // After the move, clean up the source zone if it's a drop-zone and is now empty.
            if (sourceZone.classList.contains('drop-zone') && !sourceZone.querySelector('.drag-item')) {
                 sourceZone.classList.remove('filled');
                 const qNum = sourceZone.dataset.qStart;
                 sourceZone.innerText = qNum; // Restore the question number
            }
            
            // Handle summary drop zones specifically
            if (targetZone.classList.contains('summary-drop-zone')) {
                const questionId = targetZone.dataset.qStart;
                const value = draggedItem.dataset.value;
                updateAnswer(questionId, value);
            }
            
            updateAllIndicators();
        }
        
        // --- MISC HELPERS ---
        
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval); // Ensure no multiple intervals
            timerInterval = setInterval(() => {
                timeInSeconds--;
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                if (timeInSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "Time's up!";
                    // checkAnswers(); // Disabled to prevent modal from opening automatically.
                }
            }, 1000);
            timerToggleButton.innerHTML = pauseIcon;
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            timerToggleButton.innerHTML = playIcon;
        }

        function toggleTimer() {
            // Check based on the icon currently displayed
            if (timerToggleButton.innerHTML.includes('M6 19h4V5H6v14z')) { // Check for pause icon shape
                pauseTimer();
            } else {
                startTimer();
            }
        }

        function resetTimer() {
            timeInSeconds = 3600;
            const minutes = Math.floor(timeInSeconds / 60);
            const seconds = timeInSeconds % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            startTimer();
            timerToggleButton.innerHTML = pauseIcon;
        }
        
        function setupCheckboxLimits() {
            const checkboxGroups = [
                { name: 'q38-40', limit: 3 }
            ];
            checkboxGroups.forEach(group => {
                const checkboxes = document.querySelectorAll(`input[name="${group.name}"]`);
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        const checkedCount = document.querySelectorAll(`input[name="${group.name}"]:checked`).length;
                        if (checkedCount > group.limit) checkbox.checked = false;
                        updateAllIndicators();
                    });
                });
            });
        }

        function setupExampleHeading() {
            const exampleBox = document.querySelector('.example-box');
            if(exampleBox){
                const title = document.createElement('p');
                title.style.fontWeight = 'bold';
                title.textContent = 'List of Statements';
                // exampleBox.insertBefore(title, exampleBox.firstChild);
            }
        }
        
        function initResize(e) {
            e.preventDefault();
            const startX = e.clientX;
            const startWidth = passagePanel.offsetWidth;
            
            const doDrag = (e) => {
                const newWidth = startWidth + e.clientX - startX;
                if (newWidth > 200 && (document.body.clientWidth - newWidth - resizer.offsetWidth) > 200) {
                    passagePanel.style.flex = `0 0 ${newWidth}px`;
                }
            };
            const stopDrag = () => {
                window.removeEventListener('mousemove', doDrag, false);
                window.removeEventListener('mouseup', stopDrag, false);
            };
            
            window.addEventListener('mousemove', doDrag, false);
            window.addEventListener('mouseup', stopDrag, false);
        }
        
        // --- CONTEXT MENU (Highlighting) ---
        
        function initializeContextMenu() {
            const panels = [passagePanel, questionsPanel];
            let targetElementForClear = null;

            // This listener simply tracks the last valid text selection in either panel.
            document.addEventListener('selectionchange', () => {
                const selection = window.getSelection();
                if (selection && !selection.isCollapsed && selection.toString().trim().length > 0) {
                    const range = selection.getRangeAt(0);
                    if (panels.some(panel => panel.contains(range.commonAncestorContainer))) {
                        selectedRange = range;
                        targetElementForClear = null; // New selection overrides clearing a specific element
                    }
                }
            });

            const showContextMenu = (e) => {
                const target = e.target;
                const isClickOnHighlight = target.closest('.highlight, .comment-highlight');
                const isSelectionActive = selectedRange && selectedRange.toString().trim().length > 0;
                
                let showMenu = false;

                if (isClickOnHighlight) {
                    document.getElementById('menu-highlight').style.display = 'none';
                    document.getElementById('menu-note').style.display = 'none';
                    document.getElementById('menu-clear').style.display = 'block';
                    document.getElementById('menu-clear-all').style.display = 'block';
                    contextMenu.targetElementForClear = isClickOnHighlight;
                    showMenu = true;
                } else if (isSelectionActive && panels.some(panel => panel.contains(selectedRange.commonAncestorContainer))) {
                    document.getElementById('menu-highlight').style.display = 'flex';
                    document.getElementById('menu-note').style.display = 'flex';
                    document.getElementById('menu-clear').style.display = 'none';
                    document.getElementById('menu-clear-all').style.display = 'block'; // Always show clear all
                    showMenu = true;
                }

                if (showMenu) {
                    e.preventDefault();
                    contextMenu.style.display = 'block';
                    const menuHeight = contextMenu.offsetHeight;
                    const menuWidth = contextMenu.offsetWidth;
                    let left = e.pageX;
                    let top = e.pageY;
                    if (left + menuWidth > window.innerWidth) left = window.innerWidth - menuWidth - 5;
                    if (top + menuHeight > window.innerHeight) top = e.pageY - menuHeight - 5;
                    else top = e.pageY - menuHeight - 5;
                    
                    contextMenu.style.left = `${left}px`;
                    contextMenu.style.top = `${top}px`;
                }
            };

            panels.forEach(panel => {
                panel.addEventListener('contextmenu', showContextMenu);
            });

            document.addEventListener('click', (e) => {
                if (contextMenu.style.display === 'block' && !contextMenu.contains(e.target)) {
                    closeContextMenu();
                }
            });
        }

        function closeContextMenu() {
            contextMenu.style.display = 'none';
            selectedRange = null; // Clear range after menu closes
        }

        function unwrapElement(element) {
            const parent = element.parentNode;
            if (!parent) return;
            while (element.firstChild) {
                parent.insertBefore(element.firstChild, element);
            }
            parent.removeChild(element);
            parent.normalize();
        }

        window.highlightText = () => {
            if (selectedRange && !selectedRange.collapsed) {
                const span = document.createElement('span');
                span.className = 'highlight';
                span.appendChild(selectedRange.extractContents());
                selectedRange.insertNode(span);
            }
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        window.addNote = () => {
            const note = prompt('Enter your note:');
            if (note && selectedRange && !selectedRange.collapsed) {
                const span = document.createElement('span');
                span.className = 'comment-highlight';
                const tooltip = document.createElement('span');
                tooltip.className = 'comment-tooltip';
                tooltip.textContent = note;
                span.appendChild(selectedRange.extractContents());
                span.appendChild(tooltip);
                selectedRange.insertNode(span);
            }
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        window.clearHighlight = () => {
             const elementToClear = contextMenu.targetElementForClear;
             if (elementToClear) {
                 unwrapElement(elementToClear);
             }
             closeContextMenu();
             window.getSelection().removeAllRanges();
        };
        
        window.clearAllHighlights = () => {
            document.querySelectorAll('.highlight, .comment-highlight').forEach(unwrapElement);
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        function updateAttemptedCount(part, startQ, endQ) {
            let answeredCount = 0;
            for (let i = startQ; i <= endQ; i++) {
                if (isQuestionAnswered(i)) {
                    answeredCount++;
                }
            }
            const partHeader = document.querySelector(`.footer__questionNo___3WNct[onclick="switchToPart(${part})"]`);
            if (partHeader) {
                const countSpan = partHeader.querySelector('.attemptedCount');
                if (countSpan) {
                     countSpan.textContent = `${answeredCount} of ${endQ - startQ + 1}`;
                }
            }
        }

        // --- GLOBAL FUNCTION EXPOSURE ---
        window.nextQuestion = nextQuestion;
        window.previousQuestion = previousQuestion;
        window.goToQuestion = goToQuestion;
        window.switchToPart = switchToPart;
        window.closeResultsModal = closeResultsModal;
        window.highlightText = highlightText;
        window.addNote = addNote;
        window.clearHighlight = clearHighlight;
        window.clearAllHighlights = clearAllHighlights;
        
        // Explanation toggle function for Part 1
        window.toggleExplanationPart1 = function() {
            const explanationSection = document.getElementById('part-1-explanation');
            const button = document.getElementById('show-explanation-btn-part1');
            
            if (explanationSection.classList.contains('hidden')) {
                explanationSection.classList.remove('hidden');
                button.textContent = 'Hide Explanation';
                button.style.backgroundColor = '#dc3545';
            } else {
                explanationSection.classList.add('hidden');
                button.textContent = 'Show Explanation';
                button.style.backgroundColor = '#4a90e2';
            }
        };
        
        // Explanation toggle function for Part 2
        window.toggleExplanation = function() {
            const explanationSection = document.getElementById('part-2-explanation');
            const button = document.getElementById('show-explanation-btn');
            
            if (explanationSection.classList.contains('hidden')) {
                explanationSection.classList.remove('hidden');
                button.textContent = 'Hide Explanation';
                button.style.backgroundColor = '#dc3545';
            } else {
                explanationSection.classList.add('hidden');
                button.textContent = 'Show Explanation';
                button.style.backgroundColor = '#4a90e2';
            }
        };
        
        // Explanation toggle function for Part 3
        window.toggleExplanationPart3 = function() {
            const explanationSection = document.getElementById('part-3-explanation');
            const button = document.getElementById('show-explanation-btn-part3');
            
            if (explanationSection.classList.contains('hidden')) {
                explanationSection.classList.remove('hidden');
                button.textContent = 'Hide Explanation';
                button.style.backgroundColor = '#dc3545';
            } else {
                explanationSection.classList.add('hidden');
                button.textContent = 'Show Explanation';
                button.style.backgroundColor = '#4a90e2';
            }
        };

        // --- START THE APP ---
        initialize();

        // Add event listeners for table radio buttons
        document.addEventListener('DOMContentLoaded', function() {
            const tableRadios = document.querySelectorAll('.table-radio');
            tableRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Remove background color from all cells in the same row
                    const row = this.closest('tr');
                    const cells = row.querySelectorAll('td:not(.statement)');
                    cells.forEach(cell => {
                        cell.style.backgroundColor = '';
                    });
                    
                    // Add background color to the selected cell
                    if (this.checked) {
                        this.closest('td').style.backgroundColor = '#e3f2fd';
                    }
                    
                    updateAllIndicators();
                });
            });
            

        });

        // Global function for selecting cells
        window.selectCell = function(cell, questionNum, value) {
            console.log('selectCell called:', questionNum, value);
            
            // Remove selected class from all cells in the same row
            const row = cell.closest('tr');
            const cellsInRow = row.querySelectorAll('.clickable-cell');
            cellsInRow.forEach(c => {
                c.classList.remove('selected');
                c.removeAttribute('data-selected');
                c.removeAttribute('data-answer');
            });
            
            // Add selected class to clicked cell
            cell.classList.add('selected');
            cell.setAttribute('data-selected', 'true');
            cell.setAttribute('data-answer', value);
            
            console.log('Cell selected:', questionNum, value);
            updateAllIndicators();
        };



        // Note: switchToPart function is defined earlier in the code
        // This duplicate function has been removed to prevent conflicts
    });
    </script>
</body>
</html>