<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Reading Practice - Mite Harvestmen</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            line-height: 1.4;
            font-size: 16px;
        }

        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
        }

        .test-info {
            display: flex;  
            align-items: center;
            gap: 30px;
            font-size: 14px;
            color: #333;
        }

        .audio-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .audio-icon {
            width: 16px;
            height: 16px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>') no-repeat center;
        }

        .header-icons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .telegram-link {
            color: #3e3e3e;
            text-decoration: none;
            font-weight: 700;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border: 2px solid #3e3e3e;
            border-radius: 9999px;
            background-color: #ffffff;
            line-height: 1;
        }

        .telegram-link:hover {
            text-decoration: underline;
        }

        .telegram-link::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: currentColor;
            -webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }

        #volume-slider {
            -webkit-appearance: none;
            width: 80px;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
        }

        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
        }

        #volume-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            border: none;
        }

        .icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0.7;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .icon:hover {
            opacity: 1;
        }
        
        #play-pause-btn {
            background: none;
            border: none;
            padding: 0;
        }

        .main-container {
            margin-top: 60px;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            height: calc(100vh - 60px);
            position: relative;
        }

        /* Page watermark */
        body::after {
            content: "@Full Exam Materials";
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) rotate(-20deg);
            font-size: 72px;
            font-weight: 800;
            letter-spacing: 2px;
            color: #000000;
            opacity: 0.04;
            pointer-events: none;
            z-index: 0;
            white-space: nowrap;
        }

        .panels-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .passage-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .passage-panel::-webkit-scrollbar {
            width: 8px;
            background: transparent;
        }
        
        .passage-panel::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .passage-panel::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .passage-panel:hover::-webkit-scrollbar-thumb {
            opacity: 1;
        }

        .text-center {
            text-align: center;
        }
        .reading-passage h4 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
       
        .reading-passage p {
            margin-bottom: 1.2em;
            text-align: justify;
        }

        .question ul li label {
            display: block;
            margin-top: 8px;
            cursor: pointer;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
            border-left: 1px solid #e0e0e0;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .questions-panel::-webkit-scrollbar {
            width: 8px;
            background: transparent;
        }
        
        .questions-panel::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .questions-panel::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .questions-panel:hover::-webkit-scrollbar-thumb {
            opacity: 1;
        }

        .resizer {
            position: relative;
            background: transparent;
            cursor: col-resize;
            flex-shrink: 0;
            flex-grow: 0;
            z-index: 5;
            width: 16px;
            touch-action: none;
            -webkit-user-select: none;
            user-select: none;
        }
        .resizer::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 3px;
            transform: translateX(-50%);
            background-color: #3e3e3e;
        }
        .resizer::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 36px;
            height: 36px;
            background-color: #ffffff;
            border: 2px solid #3e3e3e;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="%233e3e3e" fill="%233e3e3e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 8l-4 4 4 4"/><path d="M16 8l4 4-4 4"/><line x1="4" y1="12" x2="20" y2="12"/></svg>');
            background-repeat: no-repeat;
            background-size: 60% 60%;
            background-position: center;
            pointer-events: none;
        }

        .nav-arrows {
            position: fixed;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 6px;
            z-index: 101;
        }

        .nav-arrow {
            width: 48px;
            height: 48px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: 700;
            color: #fff;
            transition: transform 0.1s ease, background-color 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.25);
            outline: none;
        }
        .nav-arrow.prev { background-color: #4b5563; }
        .nav-arrow.next { background-color: #000000; }

        .nav-arrow:hover { transform: translateY(-1px); }
        .nav-arrow:active { transform: translateY(0); }
        .nav-arrow:focus-visible { box-shadow: 0 0 0 3px rgba(59,130,246,0.4); }

        .nav-arrow:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Bottom Navigation */
        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;
            padding: 0;
            display: flex;
            align-items: center;
            height: 80px;
            z-index: 100;
        }

        .footer__questionWrapper___1tZ46 {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }

        .footer__questionNo___3WNct {
            background: none;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .footer__questionNo___3WNct:hover {
            background-color: #f8f9fa;
        }

        .section-prefix {
            font-size: 16px;
        }

        .sectionNr {
            font-size: 16px;
            font-weight: bold;
        }

        .attemptedCount {
            font-size: 14px;
            color: #666;
            margin-left: 5px;
            font-weight: 400;
        }

        .footer__questionWrapper___1tZ46.selected .attemptedCount {
            display: none;
        }

        .footer__subquestionWrapper___9GgoP {
            display: none;
            gap: 2px;
            margin-left: 10px;
        }

        .footer__questionWrapper___1tZ46.selected .footer__subquestionWrapper___9GgoP {
            display: flex;
        }

        .subQuestion {
            width: 32px;
            height: 32px;
            border: 1px solid #ccc;
            background: white;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-radius: 2px;
        }

        .subQuestion.answered {
            background-color: #e9ecef;
            border-color: #ddd;
        }
        .subQuestion.correct {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }
        .subQuestion.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .subQuestion:hover {
            background-color: #f0f0f0;
            border-color: #999;
        }

        .subQuestion.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .subQuestion.completed {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .footer__deliverButton___3FM07 {
            margin-left: auto;
            margin-right: 20px;
            background-color: #f3f4f6;
            color: #111827;
            border: 1px solid #d1d5db;
            padding: 10px 16px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: transform 0.08s ease, background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            min-width: 160px;
            justify-content: center;
        }

        .footer__deliverButton___3FM07:hover {
            background-color: #ebedf0;
            border-color: #c7ccd4;
        }

        .footer__deliverButton___3FM07:active {
            transform: translateY(1px);
        }

        .footer__deliverButton___3FM07:focus-visible {
            box-shadow: 0 0 0 3px rgba(59,130,246,0.35);
            outline: none;
        }

        .footer__deliverButton___3FM07:disabled {
            background: #eef0f3;
            color: #9ca3af;
            cursor: not-allowed;
            border-color: #e5e7eb;
            box-shadow: none;
        }

        .hidden {
            display: none !important;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
            min-width: 140px;
        }

        .context-menu-item {
            padding: 12px 16px;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .context-menu-item:hover {
            background-color: #f8f9fa;
        }

        .context-menu-item:last-child {
            border-bottom: none;
        }

        .highlight {
            background-color: #ffff00;
        }

        .comment-highlight {
            background-color: #90EE90;
            position: relative;
            cursor: help;
        }

        .comment-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .comment-highlight:hover .comment-tooltip {
            opacity: 1;
        }

        .question {
            margin-bottom: 40px;
        }
        .question p {
            margin-bottom: 10px;
        }
        .question ul, .question .people-table {
            margin-top: 0;
        }
        .question-prompt {
            margin-bottom: 20px;
        }
        .question ul {
            list-style: none;
            padding-left: 0;
        }
        .question ul li {
            margin-bottom: 5px;
        }
        .answer-input {
            border: 1px solid #bfbfbf;
            border-radius: 4px;
            background-color: #fff;
            padding: 2px 8px;
            font-size: 16px;
            text-align: left;
            font-weight: 700;
            margin-right: 6px;
            margin-left: 6px;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            height: 28px;
            min-width: 150px;
            -webkit-autocomplete: none;
            -moz-autocomplete: none;
            autocomplete: none;
        }
        
        /* Disable autocomplete suggestions for all input fields */
        input[type="text"], input[type="email"], input[type="password"], input[type="search"], input[type="url"], input[type="tel"], input[type="number"] {
            -webkit-autocomplete: none;
            -moz-autocomplete: none;
            autocomplete: none;
        }
        
        /* Global scrollbar styling */
        * {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        *::-webkit-scrollbar {
            width: 8px;
            background: transparent;
        }
        
        *::-webkit-scrollbar-track {
            background: transparent;
        }
        
        *::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        *:hover::-webkit-scrollbar-thumb {
            opacity: 1;
        }
        .answer-input.active-input,
        .answer-input:focus {
            border-color: #3581d8;
            border-width: 2px;
            outline: none;
        }
        .answer-input::placeholder {
            color: #666;
            font-weight: 700;
            text-align: center;
        }
        .answer-input.correct {
            border-color: #28a745;
            background-color: #e9f7ef;
        }
        .answer-input.incorrect {
            border-color: #dc3545;
            background-color: #f8d7da;
            color: #721c24;
        }
        .answer-input {
            z-index: 10;
            position: relative;
            pointer-events: auto;
        }
        .summary-text .answer-input {
            width: 120px;
            height: 24px;
            font-size: 14px;
            margin: 0 4px;
        }
        .answer-inputs {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        .answer-inputs .answer-input {
            width: 200px;
            height: 30px;
            font-size: 16px;
        }
        .drag-drop-container {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }
        .recommendations-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-height: 200px;
        }
        .drag-item {
            background: white;
            border: 1px solid #9c9c9c;
            font-weight: 600;
            padding: 0px 5px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            transition: all 0.2s;
            user-select: none;
        }
        .drag-item:hover {
            background: #e9ecef;
        }
        .drag-item.dragging {
            opacity: 0.5;
        }
        .drag-item.selected {
            border-color: #4a90e2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.5);
        }
        .drop-zone {
            border: 2px dashed #aaa;
            border-radius: 4px;
            width: 50%;
            margin-top: 19px;
            margin-bottom: 5px;
            transition: background-color 0.2s, border-color 0.2s;
            padding: 0.5px;
            display: flex;
            align-items: center;
            position: relative;
            color: #afafaf;
            font-weight: 600;
            height: 27px;
        }
        .drop-zone.drag-over {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }
        .drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }
        .drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }
        .drop-zone.disabled {
            pointer-events: none;
        }
        .drop-zone .drag-item {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 15px;
            padding: 2px;
        }
        .drag-options-container {
            margin-top: 10px;
        }
        .drag-options-container .drag-item {
            display: block;
            width: fit-content;
            font-size: 15px;
            padding: 0.5px 10px;
            margin-bottom: 5px;
        }
        .drag-options-container .drag-item:last-child {
            margin-bottom: 0;
        }
        .q-number {
            color: #888;
            font-size: 14px;
            font-weight: bold;
        }
        .questions-container {
            width: 100%;
        }
        .part-header {
            background-color: #f1f2ec;
            padding: 15px 20px;
            border: 1px solid #e0e0e0;
            text-align: left;
            margin: 10px 20px;
            border-radius: 5px;
        }
        .part-header p {
            margin: 0;
        }
        .part-header p:first-child {
            margin-bottom: 5px;
        }

        .question li.correct {
            color: #155724;
            font-weight: bold;
        }
        .question li.incorrect {
            color: #721c24;
        }
        .question li.correct::before {
            content: '✔ ';
            color: #28a745;
        }
        .question li.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }

        .timer-container {
            display: flex;
            position: relative;
            cursor: default;
            color: #333;
            font-size: 16px;
            font-weight: 500;
            align-items: center;
        }
        .timer-container .timer-tooltip {
            display: none;
        }

        .timer-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 15px;
        }

        .timer-controls button {
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 50%;
            padding: 0;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }
        .timer-controls button:hover {
            background: #e0e0e0;
        }

        .timer-controls button svg {
            width: 20px;
            height: 20px;
            fill: #333;
        }

        /* Styles for TRUE/FALSE/NOT GIVEN questions */
        .tf-question {
            margin-bottom: 25px;
            padding: 10px 0px;
            border-radius: 4px;
            transition: border-color 0.3s, background-color 0.3s;
        }
        .tf-question-line {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 5px 0px;
            border-radius: 4px;
        }
        .tf-question-number, .question-number-box {
            border: 2px solid #ccc;
            padding: 2px 8px;
            margin-right: 10px;
            border-radius: 3px;
            font-weight: bold;
            transition: border-color 0.3s;
            display: inline-block;
        }
        /* Active question blue outline for TF */
        .tf-question.active-question .tf-question-number {
            border-color: #4a90e2;
        }
        .tf-question-text {
            padding-top: 3px;
        }
        .tf-options {
            padding-left: 5px;
        }
        .tf-option {
            display: block;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 10px 12px;
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            background-color: #fff;
        }
        .tf-option:hover {
            background-color: #f1f7ff;
            border-color: #c6dcfb;
        }
        .tf-option:has(input[type="radio"]:checked) {
            background-color: #cfe3f9;
            border-color: #7db3f5;
        }
        /* Answer checking states for TF/NG */
        .tf-option.correct {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            border-width: 1px;
        }
        .tf-option.incorrect {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            border-width: 1px;
        }
        /* Ensure selected-blue visuals don't conflict once results are shown */
        body.results-mode .tf-option:has(input[type="radio"]:checked) {
            box-shadow: none;
        }
        .tf-option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .answer-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
            font-size: 14px;
            min-width: 120px;
            cursor: pointer;
        }

        .answer-select:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }
        .tf-question.correct .tf-question-line {
            background-color: #e9f7ef;
        }
        .tf-question.incorrect .tf-question-line {
            background-color: #f8d7da;
        }
        .matching-question-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 15px;
        }
        .matching-options-bank {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .matching-questions {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .matching-question-item {
            display: flex;
            align-items: center;
            gap: 15px;

            border: 2px solid transparent;
            border-radius: 4px;
            transition: border-color 0.3s;
        }
        .matching-question-item > span {
            flex: 1;
        }
        .matching-question-item.correct {
            background-color: #e9f7ef;
            border-color: #28a745 !important;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone {
            width: auto;
            min-width: 200px;
            flex-shrink: 0;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            font-weight: bold;
            color: #aaa;
        }
        .matching-options-bank .drag-item {
            font-size: 15px;
            border: 1px solid #ccc;
            background: #f9f9f9;
            max-width: 700px;
        }

        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .summary-completion-container {
            margin-top: 20px;
        }
        .summary-text p {
            line-height: 3.0;
            font-size: 16px;
            margin-bottom: 12px;
        }
        .summary-text li {
            line-height: 2.2;
            margin-bottom: 10px;
        }
        .summary-drop-zone {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            min-width:200px;
            height: 25px;
            border: 2px dashed #999;
            border-radius: 4px;
            margin: 0 5px;
            padding: 0 5px;
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
            color: #aaa;
            font-weight: bold;
            text-align: center;
        }
        .summary-drop-zone.filled {
            border-color: #4a90e2;
        }
        .summary-drop-zone.active-input {
             border-color: #4a90e2;
             box-shadow: none;
        }
        .summary-drop-zone .drag-item {
            font-size: 15px;
            font-weight: bold;
            background-color: transparent;
            border: none;
            padding: 0;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .summary-options-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .summary-options-bank .drag-item {
            flex-grow: 1;
            min-width: 100px;
            text-align: center;
        }

        /* Filled drop-zone pill styling */
        .drop-zone.filled {
            background-color: transparent;
            border: none !important;
            outline: none !important;
            box-shadow: none !important;
            padding: 0;
        }
        .drop-zone.filled .drag-item {
            width: auto;
            height: auto;
            display: inline-block;
            border: 2px solid #4a90e2;
            border-radius: 10px;
            padding: 4px 10px;
            font-weight: 700;
            background: #fff;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.15);
            cursor: default;
            white-space: nowrap;
        }
        .multi-choice-question {
            margin-bottom: 20px;
            padding: 10px;
            border-radius: 4px;
            border: 3px solid transparent;
            transition: border-color 0.3s, background-color 0.3s;
        }
        /* MCQ number badge: style first strong within prompt */
        .multi-choice-question .question-prompt p > strong:first-child {
            border: 2px solid #ccc;
    padding: 2px 8px;
    margin-right: 10px;
    border-radius: 3px;
    font-weight: bold;
    transition: border-color 0.3s;
    display: inline-block;
        }
        /* Active question blue outline for MCQ */
        .multi-choice-question.active-question .question-prompt p > strong:first-child {
            border-color: #4a90e2;
            border-width: 2px;
        }
        .multi-choice-option {
            padding: 10px 12px;
            background-color: #fff;
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
        }
        .multi-choice-option:hover {
            background-color: #f1f7ff;
            border-color: #c6dcfb;
        }
        .multi-choice-option:has(input:checked) {
            background-color: #cfe3f9;
            border-color: #7db3f5;
        }
        /* Answer checking states for MCQ */
        .multi-choice-option.correct {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            box-shadow: inset 0 0 0 2px rgba(40, 167, 69, 0.25) !important;
            border-width: 1px;
            border-radius: 6px;
        }
        .multi-choice-option.incorrect {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            box-shadow: inset 0 0 0 2px rgba(220, 53, 69, 0.25) !important;
            border-width: 1px;
            border-radius: 6px;
        }
        /* Correct answer reveal for unselected option after checking */
        .tf-option.correct-answer-highlight,
        .multi-choice-option.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
        }
        body.results-mode .multi-choice-option:has(input:checked) { box-shadow: none; }
        .multi-choice-option label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 16px;
        }
        .multi-choice-option input[type="checkbox"],
        .multi-choice-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.3);
            accent-color: #4a90e2;
        }
        .multi-choice-option.correct {
            background-color: #e9f7ef;
        }
        .multi-choice-option.incorrect {
            background-color: #f8d7da;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone.filled {
            border-color: #4a90e2;
        }
        .matching-question-item .drop-zone {
            width: 200px;
            height: 40px;
        }
        .paragraph-matching-question {
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 12px;
        }
        .paragraph-matching-question .answer-input {
            width: 80px;
            flex-shrink: 0;
        }

        .matching-form-container {
            margin-top: 20px;
        }
        .matching-form-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        .matching-form-label {
            flex-shrink: 0;
        }

        /* Results Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(17, 24, 39, 0.6);
            backdrop-filter: blur(3px);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.hidden {
            display: none;
        }
        .modal-content {
            background: #ffffff;
            padding: 24px;
            border-radius: 14px;
            width: 92%;
            max-width: 780px;
            max-height: 86vh;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 1px solid #e5e7eb;
            box-shadow: 0 20px 60px rgba(0,0,0,0.25);
        }
        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #666;
        }
        .modal-content h2 {
            text-align: center;
            margin-bottom: 18px;
            color: #111827;
        }
        .results-summary {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 16px;
            text-align: center;
            border-bottom: 1px solid #eef2f7;
            padding-bottom: 12px;
        }
        .results-summary p {
            margin: 0;
            font-size: 14px;
            color: #374151;
        }
        .results-summary p span {
            display: inline-block;
            padding: 4px 10px;
            margin-left: 6px;
            border-radius: 999px;
            background: #f3f4f6;
            font-weight: 700;
            color: #111827;
        }
        .results-details-container {
            overflow-y: auto;
            padding-right: 10px;
            border-radius: 8px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .results-details-container::-webkit-scrollbar {
            width: 8px;
            background: transparent;
        }
        
        .results-details-container::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .results-details-container::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .results-details-container:hover::-webkit-scrollbar-thumb {
            opacity: 1;
        }
        .result-row {
            display: grid;
            grid-template-columns: 56px 1fr 1fr;
            gap: 12px;
            padding: 10px 8px;
            border-bottom: 1px solid #eef2f7;
            font-size: 15px;
            align-items: center;
        }
        .result-row.correct {
            background-color: #f3faf5;
        }
        .result-row.incorrect {
            background-color: #fff5f5;
        }
        .result-row .q-num {
            font-weight: 700;
            color: #111827;
            background: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            width: 42px;
            height: 30px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .result-row .user-ans {
            color: #374151;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            padding: 4px 8px;
            border-radius: 6px;
        }
        .result-row .correct-ans {
            color: #065f46;
            font-weight: 600;
            background: #ecfdf5;
            border: 1px solid #a7f3d0;
            padding: 4px 8px;
            border-radius: 6px;
        }
        .correct-answer-display {
            font-weight: bold;
            color: #28a745;
            margin-left: 10px;
            font-size: 14px;
        }
        
        .matching-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        
        .matching-table th {
            background-color: #007bff;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }
        
        .matching-table td {
            padding: 12px;
            border: 1px solid #ddd;
            vertical-align: top;
        }
        
        .matching-table .statement {
            text-align: left;
            width: 60%;
            font-size: 15px;
        }
        
        .matching-table .table-radio {
            margin: 0;
            transform: scale(1.2);
        }
        
        .matching-table td:not(.statement) {
            text-align: center;
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table th:not(:first-child) {
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table td:not(.statement):has(input:checked) {
            background-color: #e3f2fd;
        }
        
        .matching-table input[type="radio"]:checked {
            accent-color: #007bff;
        }
        
        .matching-table td.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table td.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .options-row {
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        .matching-table .options-row td {
            font-weight: 500;
            text-align: center;
            padding: 8px 12px;
            font-size: 13px;
        }
        
        .matching-table .options-row td:first-child {
            text-align: left;
            font-weight: normal;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell {
            cursor: pointer;
            transition: background-color 0.2s ease;
            min-height: 40px;
            border: 1px solid #ddd;
            position: relative;
        }
        
        .matching-table .clickable-cell:hover {
            background-color: #f0f8ff;
            border-color: #007bff;
        }
        
        .matching-table .clickable-cell.selected {
            background-color: #e3f2fd;
        }
        
        .matching-table .clickable-cell.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table .clickable-cell::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: transparent;
            transition: background-color 0.2s ease;
        }
        
        .matching-table .clickable-cell.selected::after {
        }
        
        /* Responsive styles */
        @media (max-width: 768px) {
            .attemptedCount {
                display: none;
            }
            
            .resizer {
                width: 20px;
            }
            
            .resizer::after {
                width: 44px;
                height: 44px;
            }
            
            .drop-zone {
                min-height: 44px;
                padding: 10px;
            }
            
            .drag-item {
                min-height: 44px;
                padding: 10px;
                font-size: 16px;
            }
            
            .matching-table td {
                padding: 12px 8px;
                min-height: 44px;
            }
            
            .clickable-cell {
                min-height: 44px;
                padding: 10px;
            }
            
            .header {
                padding: 10px 15px;
                height: 70px;
            }
            
            .timer-container {
                font-size: 18px;
            }
            
            .telegram-link {
                padding: 8px 16px;
                font-size: 14px;
            }
            
            .question {
                margin-bottom: 25px;
            }
            
            .question-prompt {
                margin-bottom: 20px;
            }
            
            .question-prompt p {
                font-size: 16px;
                line-height: 1.5;
            }
        }
        
        @media (max-width: 480px) {
            .main-container {
                flex-direction: column;
            }
            
            .passage-panel, .questions-panel {
                width: 100%;
                min-width: auto;
            }
            
            .resizer {
                display: none;
            }
            
            .footer__questionWrapper___1tZ46 {
                margin-right: 5px;
            }
            
            .footer__questionNo___3WNct {
                padding: 10px 12px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="timer-container">
            <span class="timer-display">60:00</span>
            <div class="timer-controls">
                <button id="timer-toggle-btn" title="Pause/Resume Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>
                </button>
                <button id="timer-reset-btn" title="Reset Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/></svg>
                </button>
            </div>
        </div>
        <a href="https://t.me/ielts_material_full" target="_blank" class="telegram-link">
          Full Exam Materials
        </a>
    </div>

    <div class="main-container" id="main-container">
        <div id="passage-header-container">
            <div id="part-header-3" class="part-header">
                <p><strong>Part 3</strong></p>
                <p>Read the text and answer questions 27-40.</p>
            </div>
        </div>
        <div class="panels-container">
            <div class="passage-panel" id="passage-panel">
                <div id="passage-text-3" class="reading-passage">
                    <h4 class="text-center">The value of research into mite harvestmen</h4>
                    <p>Few people have heard of the mite harvestman, and fewer still would recognise it at close range. The insect is a relative of the far more familiar daddy longlegs. But its legs are stubby rather than long, and its body is only as big as a sesame seed. To find mite harvestmen, scientists go to dark, humid forests and sift through the leaf litter. The animals respond by turning motionless, making them impossible for even a trained eye to pick out. 'They look like grains of dirt,' said Gonzalo Giribet, an invertebrate biologist at Harvard University.</p>
                    <p>Dr Giribet and his colleagues have spent six years searching for mite harvestmen on five continents. The animals have an extraordinary story to tell they carry a record of hundreds of millions of years of geological history, chronicling the journeys that continents have made around the Earth. The Earth's landmasses have slowly collided and broken apart again several times, carrying animals and plants with them. These species have provided clues to the continents' paths.</p>
                    <p>The notion of continental drift originally came from such clues. In 1911, the German scientist Alfred Wegener was struck by the fact that fossils of similar animals and plants could be found on either side of the Atlantic. The ocean was too big for the species to have travelled across it on their own. Wegener speculated correctly, as it turned out that the surrounding continents had originally been welded together in a single landmass, which he called Pangea.</p>
                    <p>Continental drift, or plate tectonics as it is scientifically known, helped move species around the world. Armadillos and their relatives are found in South America and Africa today because their ancestors evolved when the continents were joined. When South America and North America connected a few million years ago, armadillos spread north, too.</p>
                    <p>Biogeographers can learn clues about continental drift by comparing related species. However, they must also recognise cases where species have spread for other reasons, such as by crossing great stretches of water. The island of Hawaii, for example, was home to a giant flightless goose that has become extinct. Studies on DNA extracted from its bones show that it evolved from the Canada goose. Having colonised Hawaii, it branched off from that species, losing its ability to fly. This evolution occurred half a million years ago, when geologists estimate that Hawaii emerged from the Pacific.</p>
                    <p>When species jump around the planet, their histories blur. It is difficult to say much about where cockroaches evolved, for example, because they can move quickly from continent to continent. This process, known as dispersal, limits many studies. 'Most of them tend to concentrate on particular parts of the world,' Dr Giribet said. I wanted to find a new system for studying biogeography on a global scale.</p>
                    <p>Dr Giribet realised that mite harvestmen might be that system. The 5,000 or so mite harvestmen species can be found on every continent except Antarctica. Unlike creatures found around the world like cockroaches, mite harvestmen cannot disperse well. The typical harvestman species has a range of fewer than 50 miles. Harvestmen are not found on young islands like Hawaii, as these types of islands emerged long after the break-up of Pangea.</p>
                    <p>According to Assistant Professor Sarah Boyer, a former student of Dr Giribet. 'It's really hard to find a group of species that is distributed all over the world but that also doesn't disperse very far.' What mite harvestmen lack in mobility, they make up in age. Their ancestors were among the first land animals, and fossils of daddy longlegs have been found in 400 million-year-old rocks.</p>
                    <p>Mite harvestmen evolved long before Pangea broke up and have been carried along by continental drift ever since they've managed to get themselves around the world only because they've been around for hundreds of millions of years, Dr Boyer said. Dr Boyer, Dr Giribet and their colleagues have gathered thousands of mite harvestmen from around the world, from which they extracted DNA. Variations in the genes helped the scientists build an evolutionary tree. By calculating how quickly the DNA mutated, the scientists could estimate when lineages branched off. They then compared the harvestmen's evolution to the movements of the continents. The patterns are remarkably clear.' Dr Boyer said.</p>
                    <p>The scientists found that they could trace mite harvestmen from their ancestors on Pangea. One lineage includes species in Chile South Africa, Sri Lanka and other places separated by thousands of miles of ocean. But 150 million years ago, all those sites were in Gondwana which was a region of Pangea.</p>
                    <p>The harvestmen preserve smaller patterns of continental drift, as well as bigger ones. After analyzing the DNA of a Florida harvestman, Metasiro americanus, the scientists were surprised to find that it was not related to other North American species. Its closest relatives live in West Africa. Dr Boyer then began investigating the geological history of Florida and found recent research to explain the mystery. Florida started out welded to West Africa near Senegal. North America than collied into them Pangea was forming. About 170 million years ago, North America ripped away from West Africa, taking Florida with it. The African ancestors of Florida's harvestmen came along the ride.</p>
                    <p>Dr Giribet now hopes to study dozens or even hundreds of species, to find clues about plate tectonics that a single animal could not show.</p>
                </div>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="questions-panel" id="questions-panel">
                <div id="questions-3" class="question-set">
                    <div class="questions-container">
                        <!-- Questions 27-32: Multiple Choice -->
                        <div class="question" data-q-start="27" data-q-end="32">
                            <div class="question-prompt">
                                <p><strong>Questions 27–32</strong></p>
                                <p>Choose the correct letter, A, B, C or D.</p>
                            </div>
                            <div class="multi-choice-question" data-q-start="27" data-q-end="27">
                                <div class="question-prompt">
                                    <p><strong>27.</strong> Why is it difficult to find mite harvestmen?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q27" value="A"> They are too small to see with naked eye.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q27" value="B"> They can easily be confused with daddy longlegs.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q27" value="C"> They are hard to distinguish from their surroundings.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q27" value="D"> They do not exist in large numbers in any one place.</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="28" data-q-end="28">
                                <div class="question-prompt">
                                    <p><strong>28.</strong> Why are mite harvestmen of interest to Dr Giribet and his colleagues?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q28" value="A"> They have been studied far less than most other species.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q28" value="B"> They show the effects of climate on the evolution of animals.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q28" value="C"> They have an unusual relationship with plants and other animals.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q28" value="D"> They provide evidence relating to a field of study other than insects.</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="29" data-q-end="29">
                                <div class="question-prompt">
                                    <p><strong>29.</strong> What factor contributed to Wegener's idea that present-day continents used to form a single landmass?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q29" value="A"> changes in the level of the ocean</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q29" value="B"> the distance that species could travel</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q29" value="C"> the lack of certain fossils on one side of the Atlantic</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q29" value="D"> similarities in living conditions on both sides of the Atlantic</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="30" data-q-end="30">
                                <div class="question-prompt">
                                    <p><strong>30.</strong> What point is made by the reference to armadillos?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q30" value="A"> regions have both separated and become connected</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q30" value="B"> certain animals could travel longer distances than others</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q30" value="C"> the oldest species of animals are likely to be found in Africa</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q30" value="D"> there is a tendency for animals to spread in a particular direction</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="31" data-q-end="31">
                                <div class="question-prompt">
                                    <p><strong>31.</strong> Which of the following is stated in the fifth paragraph?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q31" value="A"> Hawaii is a habitat that cannot support large birds.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q31" value="B"> Hawaii is an attractive habitat for certain species of birds.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q31" value="C"> flightless birds are more likely to become extinct than others.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q31" value="D"> the Hawaiian goose became flightless after it had reached Hawaii.</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="32" data-q-end="32">
                                <div class="question-prompt">
                                    <p><strong>32.</strong> Why is evidence from cockroaches of limited value?</p>
                                </div>
                                <div class="multi-choice-option"><label><input type="radio" name="q32" value="A"> they spread too fast</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q32" value="B"> they multiply too quickly</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q32" value="C"> they are found in too few places</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q32" value="D"> they have divided into too many species</label></div>
                            </div>
                        </div>

                        <!-- Questions 33-36: Yes/No/Not Given -->
                        <div class="question" data-q-start="33" data-q-end="36">
                            <div class="question-prompt">
                                <p><strong>Questions 33–36</strong></p>
                                <p>Do the following statements agree with the claims of the writer in Reading Passage 3?</p>
                                <p>In boxes 33-36 on your answer sheet, write</p>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><strong>YES</strong> if the statement agrees with the claims of the writer</li>
                                    <li><strong>NO</strong> if the statement contradicts with the claims of the writer</li>
                                    <li><strong>NOT GIVEN</strong> if it is impossible to say what the writer thinks about this</li>
                                </ul>
                            </div>
                            <div class="tf-question" data-q-start="33" data-q-end="33">
                                <div class="tf-question-line"><span class="tf-question-number">33</span><span class="tf-question-text">The colonization of Hawaii by geese provides evidence of continental drift.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q33" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q33" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q33" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="34" data-q-end="34">
                                <div class="tf-question-line"><span class="tf-question-number">34</span><span class="tf-question-text">The reason why mite harvestmen don't exist on Hawaii can be explained.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q34" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q34" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q34" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="35" data-q-end="35">
                                <div class="tf-question-line"><span class="tf-question-number">35</span><span class="tf-question-text">The DNA of certain species has evolved more quickly than that of others.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q35" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q35" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q35" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="36" data-q-end="36">
                                <div class="tf-question-line"><span class="tf-question-number">36</span><span class="tf-question-text">Dr Boyer's theory concerning the origins of Florida is widely accepted.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q36" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q36" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q36" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                        </div>

                        <!-- Questions 37-40: Summary Completion -->
                        <div class="question" data-q-start="37" data-q-end="40">
                            <div class="question-prompt">
                                <p><strong>Questions 37–40</strong></p>
                                <p>Complete the summary using the list of words, A-I, below</p>
                                <p>Write the correct letter, A-I, in boxes 37-40 on your answer sheet</p>
                            </div>
                            <div class="summary-completion-container">
                                <div class="summary-text">
                                    <h4>The age and evolution of mite harvestmen</h4>
                                    <p>Some of the first creatures to live on land were the <span class="summary-drop-zone" data-question="37" id="drop-zone-37">37</span> of mite harvestmen. Boyer, Giribet and others study differences in the <span class="summary-drop-zone" data-question="38" id="drop-zone-38">38</span> of these insects, and trace the development of a number of <span class="summary-drop-zone" data-question="39" id="drop-zone-39">39</span> of the species.</p>
                                    <p>Their evolution appears to reflect changes in the location of <span class="summary-drop-zone" data-question="40" id="drop-zone-40">40</span>. For example, the same type of mite harvestman is found in places that are now far apart but used to form Gondwana, part of a huge landmass.</p>
                                </div>
                                <div class="summary-options-bank drag-summary-bank">
                                    <div class="drag-item" data-answer="A">A.branches</div>
                                    <div class="drag-item" data-answer="B">B.fossils</div>
                                    <div class="drag-item" data-answer="C">C.drift</div>
                                    <div class="drag-item" data-answer="D">D.DNA</div>
                                    <div class="drag-item" data-answer="E">E.evolution</div>
                                    <div class="drag-item" data-answer="F">F.Pangea</div>
                                    <div class="drag-item" data-answer="G">G.dispersal</div>
                                    <div class="drag-item" data-answer="H">H.ancestors</div>
                                    <div class="drag-item" data-answer="I">I.continents</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Arrows -->
    <div class="nav-arrows">
        <button class="nav-arrow prev" onclick="previousQuestion()" id="prevBtn" aria-label="Previous question">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
        <button class="nav-arrow next" onclick="nextQuestion()" id="nextBtn" aria-label="Next question">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-row perScorableItem" aria-label="Questions">
        <div class="footer__questionWrapper___1tZ46 selected multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">3</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 14</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(27)"><span class="sr-only">Question 27</span><span aria-hidden="true">27</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(28)"><span class="sr-only">Question 28</span><span aria-hidden="true">28</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(29)"><span class="sr-only">Question 29</span><span aria-hidden="true">29</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(30)"><span class="sr-only">Question 30</span><span aria-hidden="true">30</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(31)"><span class="sr-only">Question 31</span><span aria-hidden="true">31</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(32)"><span class="sr-only">Question 32</span><span aria-hidden="true">32</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(33)"><span class="sr-only">Question 33</span><span aria-hidden="true">33</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(34)"><span class="sr-only">Question 34</span><span aria-hidden="true">34</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(35)"><span class="sr-only">Question 35</span><span aria-hidden="true">35</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(36)"><span class="sr-only">Question 36</span><span aria-hidden="true">36</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(37)"><span class="sr-only">Question 37</span><span aria-hidden="true">37</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(38)"><span class="sr-only">Question 38</span><span aria-hidden="true">38</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(39)"><span class="sr-only">Question 39</span><span aria-hidden="true">39</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(40)"><span class="sr-only">Question 40</span><span aria-hidden="true">40</span></button>
            </div>
        </div>
        
        <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton___3FM07">
            <i class="fa fa fa-check" aria-hidden="true"></i>
            <span>Check Answers</span>
        </button>
    </nav>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div id="menu-highlight" class="context-menu-item" onclick="highlightText()">
            Highlight
        </div>
        <div id="menu-note" class="context-menu-item" onclick="addNote()">
            Note
        </div>
        <div id="menu-clear" class="context-menu-item" onclick="clearHighlight()">
            Clear
        </div>
        <div id="menu-clear-all" class="context-menu-item" onclick="clearAllHighlights()">
            Clear All
        </div>
    </div>

    <!-- Results Modal -->
    <div id="results-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closeResultsModal()">&times;</button>
            <h2>Results</h2>
            <div class="results-summary">
                <p>Score: <span id="results-score"></span> / 14</p>
                <p>IELTS Band: <span id="results-band"></span></p>
            </div>
            <div id="results-details" class="results-details-container">
                <!-- Results for each question will be injected here -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- STATE VARIABLES ---
            let currentQuestion = 27;
            let selectedRange = null;
            let timeInSeconds = 3600;
            let timerInterval;
            let draggedItem = null;
            let activeQuestionElement = null;
            let selectedDragItem = null;

            // --- GLOBAL FUNCTIONS ---
            function getFirstQuestionOfPart(part) {
                return 27;
            }

            // --- DOM ELEMENTS ---
            const timerDisplay = document.querySelector('.timer-display');
            const timerToggleButton = document.getElementById('timer-toggle-btn');
            const timerResetButton = document.getElementById('timer-reset-btn');
            const deliverButton = document.getElementById('deliver-button');
            const resizer = document.getElementById('resizer');
            const passagePanel = document.getElementById('passage-panel');
            const questionsPanel = document.getElementById('questions-panel');
            const contextMenu = document.getElementById('contextMenu');

            // --- ICON SVGs ---
            const playIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>';
            const pauseIcon = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';

            // --- ANSWERS ---
            const correctAnswers = {
                // Multiple Choice Questions (27-32)
                '27': 'C', // They are hard to distinguish from their surroundings
                '28': 'D', // They provide evidence relating to a field of study other than insects
                '29': 'B', // the distance that species could travel
                '30': 'A', // regions have both separated and become connected
                '31': 'D', // the Hawaiian goose became flightless after it had reached Hawaii
                '32': 'A', // they spread too fast
                // Yes/No/Not Given Questions (33-36)
                '33': 'NO', // The colonization of Hawaii by geese provides evidence of continental drift
                '34': 'YES', // The reason why mite harvestmen don't exist on Hawaii can be explained
                '35': 'NOT GIVEN', // The DNA of certain species has evolved more quickly than that of others
                '36': 'NOT GIVEN', // Dr Boyer's theory concerning the origins of Florida is widely accepted
                // Summary Completion Questions (37-40)
                '37': 'H', // ancestors
                '38': 'D', // DNA
                '39': 'A', // branches
                '40': 'I'  // continents
            };

            // --- INITIALIZATION ---
            function initialize() {
                console.log(`🚀 Initializing application...`);
                startTimer();
                initializeDragAndDrop();
                setupCheckboxLimits();
                console.log(`📋 Setting up initial state - starting with question 27`);
                goToQuestion(27);
                updateNavigation();
                
                document.body.addEventListener('input', updateAllIndicators);
                document.body.addEventListener('change', updateAllIndicators);
                deliverButton.addEventListener('click', checkAnswers);
                timerToggleButton.addEventListener('click', toggleTimer);
                timerResetButton.addEventListener('click', resetTimer);

                // Add click listeners to question containers for navigation
                document.querySelectorAll('[data-q-start]').forEach(el => {
                    el.addEventListener('click', (event) => {
                        event.stopPropagation();
                        
                        const qNum = parseInt(el.dataset.qStart, 10);
                        const qEnd = parseInt(el.dataset.qEnd, 10);
                        
                        console.log(`🖱️ Question container clicked - qNum: ${qNum}, qEnd: ${qEnd}, currentQuestion: ${currentQuestion}, element:`, el);
                        
                        if (isNaN(qNum)) {
                            console.log(`ℹ️ Container without valid question number, ignoring navigation`);
                            return;
                        }
                        
                        if (qNum === qEnd || el.classList.contains('tf-question') || el.classList.contains('multi-choice-question')) {
                            if (currentQuestion !== qNum) {
                                console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum}`);
                                goToQuestion(qNum);
                            } else {
                                console.log(`ℹ️ Already on question ${qNum}, no navigation needed`);
                            }
                        } else {
                            console.log(`ℹ️ Ignoring click on group container (${qNum}-${qEnd})`);
                        }
                    });
                });
                
                // Add specific click listeners for individual question elements
                document.querySelectorAll('.tf-question, .multi-choice-question, .summary-text').forEach(el => {
                    el.addEventListener('click', (event) => {
                        event.stopPropagation();
                        const qNum = parseInt(el.dataset.qStart, 10);
                        console.log(`🎯 Individual question element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, element:`, el);
                        
                        if (isNaN(qNum)) {
                            console.log(`ℹ️ Container without specific question number, ignoring navigation`);
                            return;
                        }
                        
                        if (currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (individual element)`);
                            goToQuestion(qNum);
                        } else {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed (individual element)`);
                        }
                    });
                });
                
                // Add specific click listeners for summary drop zones
                document.querySelectorAll('.summary-drop-zone').forEach(zone => {
                    zone.addEventListener('click', (event) => {
                        event.stopPropagation();
                        const qNum = parseInt(zone.dataset.question, 10);
                        console.log(`📝 Drop zone clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, zone:`, zone);
                        
                        if (currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (drop zone)`);
                            goToQuestion(qNum);
                        } else {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed (drop zone)`);
                        }
                    });
                });

                resizer.addEventListener('mousedown', initResize, false);
                initializeContextMenu();
            }

            // --- CORE TEST LOGIC ---

            function checkAnswers() {
                // Disable all inputs to prevent changes
                const allInputs = document.querySelectorAll('input, select, textarea');
                allInputs.forEach(input => {
                    input.disabled = true;
                });

                // Disable all drag and drop functionality
                document.querySelectorAll('.drag-item').forEach(item => {
                    item.setAttribute('draggable', 'false');
                    item.style.cursor = 'not-allowed';
                    item.style.pointerEvents = 'none';
                });

                document.querySelectorAll('.drop-zone, .summary-drop-zone').forEach(zone => {
                    zone.style.pointerEvents = 'none';
                    zone.classList.add('disabled');
                });

                // Disable submit button
                deliverButton.disabled = true;
                deliverButton.style.cursor = 'not-allowed';
                
                clearInterval(timerInterval);
                let score = 0;
                const totalQuestions = 14;
                const resultsDetailsContainer = document.getElementById('results-details');
                resultsDetailsContainer.innerHTML = '';

                document.querySelectorAll('.correct, .incorrect, .correct-answer-highlight').forEach(el => {
                    el.classList.remove('correct', 'incorrect', 'correct-answer-highlight');
                });
                document.querySelectorAll('.correct-answer-display').forEach(el => el.remove());

                for (let i = 27; i <= 40; i++) {
                    const questionKey = String(i);
                    const correctAnswer = correctAnswers[questionKey];
                    let userAnswer = '';
                    let isCorrect = false;
                    
                    let userAnswerDisplay = 'Not Answered';
                    const correctAnswerText = Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : correctAnswer;

                    const textInput = document.getElementById(`q${i}`);
                    const selectInput = document.querySelector(`select[name="q${i}"]`);
                    const radioGroup = document.querySelectorAll(`input[name="q${i}"][type="radio"]`);
                    
                    // Handle Radio Button Inputs (Multiple Choice and Yes/No/Not Given)
                    if (radioGroup.length > 0) {
                        const questionContainer = radioGroup[0]?.closest('.tf-question') || radioGroup[0]?.closest('.multi-choice-question');
                        const checkedRadio = document.querySelector(`input[name="q${i}"]:checked`);

                        if (checkedRadio) {
                            userAnswer = checkedRadio.value;
                            userAnswerDisplay = userAnswer;
                            isCorrect = userAnswer === correctAnswer;

                            const userLabel = checkedRadio.closest('.tf-option, .multi-choice-option');
                            if (userLabel) {
                                userLabel.classList.add(isCorrect ? 'correct' : 'incorrect');
                            }
                        }

                        if (isCorrect) {
                            score++;
                        } else {
                            if (questionContainer){
                                const correctOptionEl = questionContainer.querySelector(`input[name="q${i}"][value="${correctAnswerText}"]`);
                                if (correctOptionEl) {
                                    const correctLabel = correctOptionEl.closest('.tf-option, .multi-choice-option');
                                    if (correctLabel) {
                                        correctLabel.classList.add('correct-answer-highlight');
                                    }
                                }
                            }
                        }
                    }
                    // Handle summary drop zone questions (37-40)
                    else if (document.querySelector(`.summary-drop-zone[data-question="${i}"]`)) {
                        console.log(`🔍 Checking summary drop zone question ${i}`);
                        const summaryDropZone = document.querySelector(`.summary-drop-zone[data-question="${i}"]`);
                        const droppedItem = summaryDropZone ? summaryDropZone.querySelector('.drag-item') : null;
                        
                        console.log(`📍 Summary drop zone for question ${i}:`, summaryDropZone);
                        console.log(`📍 Dropped item for question ${i}:`, droppedItem);
                        console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                        
                        if (droppedItem) {
                            userAnswer = droppedItem.dataset.value;
                            userAnswerDisplay = userAnswer;
                            isCorrect = userAnswer === correctAnswer;
                            
                            console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                            
                            // Mark the summary drop zone as correct or incorrect
                            summaryDropZone.classList.add(isCorrect ? 'correct' : 'incorrect');
                            
                            if (isCorrect) {
                                score++;
                                console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                            } else {
                                console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                            }
                            
                            // Show correct answer if wrong
                            if (!isCorrect && correctAnswer) {
                                const correctAnswerSpan = document.createElement('span');
                                correctAnswerSpan.className = 'correct-answer-display';
                                correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswer}</span>`;
                                summaryDropZone.appendChild(correctAnswerSpan);
                            }
                        } else {
                            // No answer provided - mark as incorrect
                            console.log(`⚠️ No answer provided for question ${i}`);
                            if (summaryDropZone) {
                                summaryDropZone.classList.add('incorrect');
                            }
                            if (correctAnswer) {
                                const correctAnswerSpan = document.createElement('span');
                                correctAnswerSpan.className = 'correct-answer-display';
                                correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswer}</span>`;
                                summaryDropZone.appendChild(correctAnswerSpan);
                            }
                        }
                    }

                    // For showing results in the modal
                    const resultRow = `
                        <div class="result-row ${isCorrect ? '' : 'incorrect'}">
                            <span class="q-num">${i}</span>
                            <span class="user-ans">${userAnswerDisplay}</span>
                            <span class="correct-ans">${correctAnswerText}</span>
                        </div>`;
                    resultsDetailsContainer.innerHTML += resultRow;
                    
                    // Update nav button color
                    const navButton = document.querySelector(`.subQuestion[onclick="goToQuestion(${i})"]`);
                    if (navButton) {
                        navButton.classList.remove('answered', 'active');
                        navButton.classList.add(isCorrect ? 'correct' : 'incorrect');
                    }
                }

                document.getElementById('results-score').textContent = score;
                document.getElementById('results-band').textContent = calculateBandScore(score);
                document.body.classList.add('results-mode');
                document.getElementById('results-modal').classList.remove('hidden');
                
                // Change button to "My Result" with green styling
                deliverButton.innerHTML = `<span>My Result</span>`;
                deliverButton.style.backgroundColor = '#4CAF50';
                deliverButton.style.color = 'white';
                deliverButton.style.borderColor = '#4CAF50';
                deliverButton.disabled = false;
                deliverButton.style.cursor = 'pointer';
                deliverButton.removeEventListener('click', checkAnswers);
                deliverButton.addEventListener('click', showResultsModal);
                
                // Highlight correct answers in the passage
                highlightCorrectAnswersInPassage();
            }

            function calculateBandScore(score) {
                if (score >= 13) return '9.0';
                const mapping = {
                    14: 9.0, 13: 9.0, 12: 8.5, 11: 8.5, 10: 8.0, 9: 8.0, 8: 7.5,
                    7: 7.5, 6: 7.0, 5: 7.0, 4: 7.0, 3: 6.5, 2: 6.5, 1: 6.5,
                    0: 0.0
                };
                return mapping[score] || 0.0;
            }

            function highlightCorrectAnswersInPassage() {
                // Define the text passages and their corresponding question numbers
                const highlights = [
                    { question: 27, text: "The animals respond by turning motionless, making them impossible for even a trained eye to pick out.", answer: "C" },
                    { question: 28, text: "The animals have an extraordinary story to tell they carry a record of hundreds of millions of years of geological history", answer: "D" },
                    { question: 29, text: "The ocean was too big for the species to have travelled across it on their own.", answer: "B" },
                    { question: 30, text: "Armadillos and their relatives are found in South America and Africa today because their ancestors evolved when the continents were joined.", answer: "A" },
                    { question: 31, text: "Having colonised Hawaii, it branched off from that species, losing its ability to fly.", answer: "D" },
                    { question: 32, text: "it is difficult to say much about where cockroaches evolved, for example, because they can move quickly from continent to continent.", answer: "A" },
                    { question: 33, text: "The colonization of Hawaii by geese provides evidence of continental drift.", answer: "NO" },
                    { question: 34, text: "Harvestmen are not found on young islands like Hawaii, as these types of islands emerged long after the break-up of Pangea.", answer: "YES" },
                    { question: 37, text: "Their ancestors were among the first land animals", answer: "H" },
                    { question: 38, text: "from which they extracted DNA", answer: "D" },
                    { question: 39, text: "when lineages branched off", answer: "A" },
                    { question: 40, text: "changes in the location of continents", answer: "I" }
                ];

                // Function to apply highlights to a passage
                function applyHighlights(passageElement, highlights) {
                    if (!passageElement) return;

                    // Clear any existing highlights
                    passageElement.querySelectorAll('.answer-highlight').forEach(el => {
                        const parent = el.parentNode;
                        parent.replaceChild(document.createTextNode(el.textContent), el);
                        parent.normalize();
                    });

                    // Add highlights for each answer
                    highlights.forEach(item => {
                        const paragraphs = passageElement.querySelectorAll('p');
                        paragraphs.forEach(paragraph => {
                            const html = paragraph.innerHTML;
                            if (!html || typeof html !== 'string') return;
                            if (html.includes(item.text)) {
                                const escapeRegExp = s => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                                const re = new RegExp(escapeRegExp(item.text));
                                const replaced = html.replace(
                                    re,
                                    `<span class="answer-highlight" data-question="${item.question}" style="
                                        background-color: #ffeb3b;
                                        padding: 2px 4px;
                                        border-radius: 3px;
                                        font-weight: bold;
                                        position: relative;
                                    ">${item.text}<span style="
                                        position: absolute;
                                        top: -8px;
                                        right: -8px;
                                        background-color: #2196f3;
                                        color: white;
                                        border-radius: 50%;
                                        width: 20px;
                                        height: 20px;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        font-size: 12px;
                                        font-weight: bold;
                                    ">${item.question}</span></span>`
                                );
                                paragraph.innerHTML = replaced;
                            }
                        });
                    });
                }

                // Apply highlights to the passage
                const passageText3 = document.getElementById('passage-text-3');
                applyHighlights(passageText3, highlights);
            }

            function addResultToModal(qNum, userAnswer, correctAnswer, isCorrect) {
                const resultsDetails = document.getElementById('results-details');
                const row = document.createElement('div');
                row.className = 'result-row';
                if (!isCorrect) {
                    row.classList.add('incorrect');
                }
                row.innerHTML = `
                    <span class="q-num">${qNum}</span>
                    <span class="user-ans">${userAnswer}</span>
                    <span class="correct-ans">${correctAnswer}</span>
                `;
                resultsDetails.appendChild(row);
            }

            function showResultsModal() {
                document.getElementById('results-modal').classList.remove('hidden');
            }

            window.closeResultsModal = function() {
                document.getElementById('results-modal').classList.add('hidden');
                document.body.classList.remove('results-mode');
            }
            
            function disableInputs() {
                deliverButton.innerHTML = `<span>Checked! View Results.</span>`;
                deliverButton.removeEventListener('click', checkAnswers);
                deliverButton.onclick = showResultsModal;

                document.querySelectorAll('input, select').forEach(el => {
                    el.disabled = true;
                     if (el.matches('input[type=radio], input[type=checkbox]')) {
                         el.style.cursor = 'not-allowed';
                         el.parentElement.style.cursor = 'not-allowed';
                     }
                });
                document.querySelectorAll('.drag-item').forEach(el => {
                    el.setAttribute('draggable', 'false');
                    el.style.cursor = 'default';
                });
                document.querySelectorAll('.drop-zone, .summary-drop-zone').forEach(el => {
                    el.classList.add('disabled');
                });
            }

            function markQuestion(qNum, isCorrect) {
                const subQuestionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                subQuestionBtn?.classList.add(isCorrect ? 'correct' : 'incorrect');

                const elementsToMark = [
                    document.querySelector(`.tf-question[data-q-start="${qNum}"]`),
                    document.querySelector(`.multi-choice-question[data-q-start="${qNum}"]`),
                    document.querySelector(`.summary-drop-zone[data-question="${qNum}"]`)
                ];
                
                elementsToMark.forEach(el => {
                    if (el) el.classList.add(isCorrect ? 'correct' : 'incorrect');
                });
            }

            // --- UI & NAVIGATION ---

            function goToQuestion(questionNumber) {
                console.log(`🎯 goToQuestion called with questionNumber: ${questionNumber}, currentQuestion: ${currentQuestion}`);
                
                currentQuestion = questionNumber;

                if (activeQuestionElement) {
                    // Remove active style from previous block
                    activeQuestionElement.classList.remove('active-question', 'active-input');
                    // Also remove from the container block if we previously set it
                    const prevBlock = activeQuestionElement.closest('[data-q-start]');
                    if (prevBlock) prevBlock.classList.remove('active-question');
                }

                // First, try to find the specific input element
                let targetEl = document.getElementById(`q${questionNumber}`);
                if (targetEl) {
                    activeQuestionElement = targetEl;
                    console.log(`✅ Found specific input element:`, targetEl);
                    targetEl.classList.add('active-input');
                    scrollIntoViewIfNeeded(targetEl);
                } else {
                    // Fall back to looking for question containers
                    targetEl = document.querySelector(`[data-q-start="${questionNumber}"]`);
                    console.log(`🔍 Looking for target element with data-q-start="${questionNumber}":`, targetEl);

                    if (targetEl) {
                        activeQuestionElement = targetEl;
                        console.log(`✅ Found target element:`, targetEl);
                        
                        if (targetEl.matches('input[type="text"]') || targetEl.matches('select')) {
                            targetEl.classList.add('active-input');
                            console.log(`📝 Added active-input class to input/select element`);
                        } else {
                            targetEl.classList.add('active-question');
                            console.log(`📋 Added active-question class to question element`);
                        }
                        scrollIntoViewIfNeeded(targetEl);
                    } else {
                        console.log(`⚠️ Target element not found, looking for summary drop zone`);
                        const summaryZone = document.querySelector(`.summary-drop-zone[data-question="${questionNumber}"]`);
                        if(summaryZone) {
                            activeQuestionElement = summaryZone;
                            summaryZone.classList.add('active-input');
                            scrollIntoViewIfNeeded(summaryZone);
                            console.log(`✅ Found summary drop zone:`, summaryZone);
                        } else {
                            console.log(`❌ No target element found for question ${questionNumber}`);
                        }
                    }
                }

                updateNavigation();
                console.log(`✅ goToQuestion completed for question ${questionNumber}`);
            }
            
            function updateNavigation() {
                console.log(`🔄 updateNavigation called for currentQuestion: ${currentQuestion}`);
                
                const navButtons = document.querySelectorAll('.subQuestion');
                navButtons.forEach(btn => btn.classList.remove('active'));
                const activeNav = document.querySelector(`.subQuestion[onclick="goToQuestion(${currentQuestion})"]`);
                if (activeNav) {
                    activeNav.classList.add('active');
                    console.log(`✅ Updated navigation - active nav button:`, activeNav);
                } else {
                    console.log(`⚠️ No active navigation button found for question ${currentQuestion}`);
                }

                const inputs = document.querySelectorAll('.answer-input, .summary-drop-zone');
                inputs.forEach(input => input.classList.remove('active-input'));
                
                const activeInput = document.getElementById(`q${currentQuestion}`);
                if (activeInput) {
                    activeInput.classList.add('active-input');
                    if (typeof activeInput.focus === 'function') {
                        activeInput.focus();
                    }
                    console.log(`✅ Focused on input element:`, activeInput);
                } else {
                    console.log(`⚠️ No direct input found for question ${currentQuestion}, looking in question block`);
                    // Prefer the specific question element for styling (TF/MCQ), fallback to any data-q-start container
                    let activeQuestionBlock = document.querySelector(`.tf-question[data-q-start="${currentQuestion}"]`) 
                        || document.querySelector(`.multi-choice-question[data-q-start="${currentQuestion}"]`) 
                        || document.querySelector(`[data-q-start="${currentQuestion}"]`);
                    if (activeQuestionBlock) {
                        // Add active-question class to style number badge
                        activeQuestionBlock.classList.add('active-question');
                        const firstInput = activeQuestionBlock.querySelector('input, select');
                        if(firstInput) {
                            firstInput.classList.add('active-input');
                             if (typeof firstInput.focus === 'function') {
                                firstInput.focus();
                            }
                            console.log(`✅ Focused on input in question block:`, firstInput);
                        } else {
                            console.log(`⚠️ No input found in question block for question ${currentQuestion}`);
                        }
                    } else {
                        console.log(`❌ No question block found for question ${currentQuestion}`);
                    }
                }
                
                console.log(`✅ updateNavigation completed`);
            }
            
            function selectDragItem(item) {
                if (selectedDragItem) {
                    selectedDragItem.classList.remove('selected');
                }
                selectedDragItem = item;
                if (selectedDragItem) {
                    selectedDragItem.classList.add('selected');
                }
            }
            
            window.nextQuestion = () => currentQuestion < 40 && goToQuestion(currentQuestion + 1);
            window.previousQuestion = () => currentQuestion > 27 && goToQuestion(currentQuestion - 1);

            function updateAllIndicators() {
                updateAttemptedCount();
                updateAnsweredNav();
            }
            
            function updateAnsweredNav() {
                const navButtons = document.querySelectorAll('.subQuestion');
                navButtons.forEach(btn => {
                    const qNum = parseInt(btn.textContent, 10);
                    if (isQuestionAnswered(qNum)) {
                        btn.classList.add('answered');
                    } else {
                        btn.classList.remove('answered');
                    }
                });
            }
            
            function isQuestionAnswered(qNum) {
                // Check for radio buttons (Multiple Choice and Yes/No/Not Given)
                const radio = document.querySelector(`input[name="q${qNum}"]:checked`);
                if (radio) {
                    return true;
                }
                // Handle summary drop zone questions (37-40)
                const summaryDz = document.querySelector(`.summary-drop-zone[data-question="${qNum}"]`);
                if (summaryDz && summaryDz.querySelector('.drag-item')) {
                    return true;
                }
                return false;
            }

            function scrollIntoViewIfNeeded(element) {
                const panel = element.closest('.questions-panel, .passage-panel');
                const panelRect = panel.getBoundingClientRect();
                const elementRect = element.getBoundingClientRect();
                if (elementRect.top < panelRect.top || elementRect.bottom > panelRect.bottom) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
            
            // --- DRAG AND DROP ---
            
            function initializeDragAndDrop() {
                document.querySelectorAll('.drag-item').forEach(item => {
                    item.addEventListener('dragstart', handleDragStart);
                    item.addEventListener('dragend', handleDragEnd);
                    item.addEventListener('click', () => selectDragItem(item));
                });
                document.querySelectorAll('.summary-drop-zone').forEach(zone => {
                    zone.addEventListener('dragover', handleDragOver);
                    zone.addEventListener('dragleave', handleDragLeave);
                    zone.addEventListener('drop', handleDrop);
                });
            }

            function handleDragStart(e) {
                draggedItem = e.target;
                setTimeout(() => e.target.classList.add('dragging'), 0);
            }

            function handleDragEnd(e) {
                e.target.classList.remove('dragging');
                draggedItem = null;
            }

            function handleDragOver(e) {
                e.preventDefault();
                const targetZone = e.currentTarget;
                if (draggedItem && draggedItem.dataset.dndGroup === targetZone.dataset.dndGroup) {
                    targetZone.classList.add('drag-over');
                }
            }

            function handleDragLeave(e) {
                e.currentTarget.classList.remove('drag-over');
            }

            function handleDrop(e) {
                e.preventDefault();
                const targetZone = e.currentTarget;
                targetZone.classList.remove('drag-over');

                if (!draggedItem || draggedItem.dataset.dndGroup !== targetZone.dataset.dndGroup) {
                    return;
                }

                const sourceZone = draggedItem.parentElement;
                if (sourceZone === targetZone) return; // Prevent dropping on itself

                const existingItemInTarget = targetZone.querySelector('.drag-item');

                // First, clear the target drop-zone of any text (like question numbers) before adding the new item.
                if (targetZone.classList.contains('summary-drop-zone')) {
                    Array.from(targetZone.childNodes).forEach(node => {
                        if (node.nodeType === Node.TEXT_NODE) {
                            node.remove();
                        }
                    });
                }

                // Move the item that was in the target (if any) to the source zone.
                if (existingItemInTarget) {
                    sourceZone.appendChild(existingItemInTarget);
                }
                
                // Finally, move the dragged item to the target zone.
                targetZone.appendChild(draggedItem);
                targetZone.classList.add('filled');
                // Lock the pill-like appearance for items dropped into zones
                if (draggedItem) {
                    draggedItem.style.cursor = 'default';
                }
                // Hide placeholder text (question number) once filled
                if (targetZone.textContent && /^\d+$/.test(targetZone.textContent.trim())) {
                    targetZone.textContent = '';
                }

                // After the move, clean up the source zone if it's a drop-zone and is now empty.
                if (sourceZone.classList.contains('summary-drop-zone') && !sourceZone.querySelector('.drag-item')) {
                     sourceZone.classList.remove('filled');
                     const qNum = sourceZone.dataset.question;
                     if (sourceZone.classList.contains('summary-drop-zone')) {
                         sourceZone.innerText = qNum; // Restore the question number
                     }
                }
                
                updateAllIndicators();
            }
            
            // --- MISC HELPERS ---
            
            function startTimer() {
                if (timerInterval) clearInterval(timerInterval); // Ensure no multiple intervals
                timerInterval = setInterval(() => {
                    timeInSeconds--;
                    const minutes = Math.floor(timeInSeconds / 60);
                    const seconds = timeInSeconds % 60;
                    timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    if (timeInSeconds <= 0) {
                        clearInterval(timerInterval);
                        timerDisplay.textContent = "Time's up!";
                    }
                }, 1000);
                timerToggleButton.innerHTML = pauseIcon;
            }

            function pauseTimer() {
                clearInterval(timerInterval);
                timerToggleButton.innerHTML = playIcon;
            }

            function toggleTimer() {
                // Check based on the icon currently displayed
                if (timerToggleButton.innerHTML.includes('M6 19h4V5H6v14z')) { // Check for pause icon shape
                    pauseTimer();
                } else {
                    startTimer();
                }
            }

            function resetTimer() {
                timeInSeconds = 3600;
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                startTimer();
                timerToggleButton.innerHTML = pauseIcon;
            }
            
            function setupCheckboxLimits() {
                // No checkbox questions in this passage
            }

            function initResize(e) {
                e.preventDefault();
                const startX = e.clientX;
                const startWidth = passagePanel.offsetWidth;
                
                const doDrag = (e) => {
                    const newWidth = startWidth + e.clientX - startX;
                    if (newWidth > 200 && (document.body.clientWidth - newWidth - resizer.offsetWidth) > 200) {
                        passagePanel.style.flex = `0 0 ${newWidth}px`;
                    }
                };
                const stopDrag = () => {
                    window.removeEventListener('mousemove', doDrag, false);
                    window.removeEventListener('mouseup', stopDrag, false);
                };
                
                window.addEventListener('mousemove', doDrag, false);
                window.addEventListener('mouseup', stopDrag, false);
            }
            
            // --- CONTEXT MENU (Highlighting) ---
            
            function initializeContextMenu() {
                const panels = [passagePanel, questionsPanel];
                let targetElementForClear = null;

                // This listener simply tracks the last valid text selection in either panel.
                document.addEventListener('selectionchange', () => {
                    const selection = window.getSelection();
                    if (selection && !selection.isCollapsed && selection.toString().trim().length > 0) {
                        const range = selection.getRangeAt(0);
                        if (panels.some(panel => panel.contains(range.commonAncestorContainer))) {
                            selectedRange = range;
                            targetElementForClear = null; // New selection overrides clearing a specific element
                        }
                    }
                });

                const showContextMenu = (e) => {
                    const target = e.target;
                    const isClickOnHighlight = target.closest('.highlight, .comment-highlight');
                    const isSelectionActive = selectedRange && selectedRange.toString().trim().length > 0;
                    
                    let showMenu = false;

                    if (isClickOnHighlight) {
                        document.getElementById('menu-highlight').style.display = 'none';
                        document.getElementById('menu-note').style.display = 'none';
                        document.getElementById('menu-clear').style.display = 'block';
                        document.getElementById('menu-clear-all').style.display = 'block';
                        contextMenu.targetElementForClear = isClickOnHighlight;
                        showMenu = true;
                    } else if (isSelectionActive && panels.some(panel => panel.contains(selectedRange.commonAncestorContainer))) {
                        document.getElementById('menu-highlight').style.display = 'flex';
                        document.getElementById('menu-note').style.display = 'flex';
                        document.getElementById('menu-clear').style.display = 'none';
                        document.getElementById('menu-clear-all').style.display = 'block'; // Always show clear all
                        showMenu = true;
                    }

                    if (showMenu) {
                        e.preventDefault();
                        contextMenu.style.display = 'block';
                        const menuHeight = contextMenu.offsetHeight;
                        const menuWidth = contextMenu.offsetWidth;
                        let left = e.pageX;
                        let top = e.pageY;
                        if (left + menuWidth > window.innerWidth) left = window.innerWidth - menuWidth - 5;
                        if (top + menuHeight > window.innerHeight) top = e.pageY - menuHeight - 5;
                        else top = e.pageY - menuHeight - 5;
                        
                        contextMenu.style.left = `${left}px`;
                        contextMenu.style.top = `${top}px`;
                    }
                };

                panels.forEach(panel => {
                    panel.addEventListener('contextmenu', showContextMenu);
                });

                document.addEventListener('click', (e) => {
                    if (contextMenu.style.display === 'block' && !contextMenu.contains(e.target)) {
                        closeContextMenu();
                    }
                });
            }

            function closeContextMenu() {
                contextMenu.style.display = 'none';
                selectedRange = null; // Clear range after menu closes
            }

            function unwrapElement(element) {
                const parent = element.parentNode;
                if (!parent) return;
                while (element.firstChild) {
                    parent.insertBefore(element.firstChild, element);
                }
                parent.removeChild(element);
                parent.normalize();
            }

            window.highlightText = () => {
                if (selectedRange && !selectedRange.collapsed) {
                    const span = document.createElement('span');
                    span.className = 'highlight';
                    span.appendChild(selectedRange.extractContents());
                    selectedRange.insertNode(span);
                }
                closeContextMenu();
                window.getSelection().removeAllRanges();
            };

            window.addNote = () => {
                const note = prompt('Enter your note:');
                if (note && selectedRange && !selectedRange.collapsed) {
                    const span = document.createElement('span');
                    span.className = 'comment-highlight';
                    const tooltip = document.createElement('span');
                    tooltip.className = 'comment-tooltip';
                    tooltip.textContent = note;
                    span.appendChild(selectedRange.extractContents());
                    span.appendChild(tooltip);
                    selectedRange.insertNode(span);
                }
                closeContextMenu();
                window.getSelection().removeAllRanges();
            };

            window.clearHighlight = () => {
                 const elementToClear = contextMenu.targetElementForClear;
                 if (elementToClear) {
                     unwrapElement(elementToClear);
                 }
                 closeContextMenu();
                 window.getSelection().removeAllRanges();
            };
            
            window.clearAllHighlights = () => {
                document.querySelectorAll('.highlight, .comment-highlight').forEach(unwrapElement);
                closeContextMenu();
                window.getSelection().removeAllRanges();
            };

            function updateAttemptedCount() {
                let answeredCount = 0;
                for (let i = 27; i <= 40; i++) {
                    if (isQuestionAnswered(i)) {
                        answeredCount++;
                    }
                }
                const partHeader = document.querySelector('.footer__questionNo___3WNct');
                if (partHeader) {
                    const countSpan = partHeader.querySelector('.attemptedCount');
                    if (countSpan) {
                         countSpan.textContent = `${answeredCount} of 14`;
                    }
                }
            }

            // --- GLOBAL FUNCTION EXPOSURE ---
            window.nextQuestion = nextQuestion;
            window.previousQuestion = previousQuestion;
            window.goToQuestion = goToQuestion;
            window.closeResultsModal = closeResultsModal;
            window.highlightText = highlightText;
            window.addNote = addNote;
            window.clearHighlight = clearHighlight;
            window.clearAllHighlights = clearAllHighlights;

            // --- START THE APP ---
            initialize();
        });
        let draggedItem = null;

document.querySelectorAll('.summary-options-bank .drag-item').forEach(item => {
    item.setAttribute("draggable", "true");

    item.addEventListener("dragstart", () => {
        draggedItem = item;
        item.classList.add("dragging");
    });

    item.addEventListener("dragend", () => {
        draggedItem = null;
        item.classList.remove("dragging");
    });
});

document.querySelectorAll('.summary-drop-zone').forEach(zone => {
    zone.addEventListener("dragover", (e) => {
        e.preventDefault();
        zone.classList.add("drag-over");
    });

    zone.addEventListener("dragleave", () => {
        zone.classList.remove("drag-over");
    });

    zone.addEventListener("drop", () => {
        zone.classList.remove("drag-over");
        if (!draggedItem) return;

        const existing = zone.querySelector('.drag-item');
        if (existing) {
            document.querySelector('.summary-options-bank').appendChild(existing);
        }

        zone.innerHTML = "";
        zone.appendChild(draggedItem);
    });
});

</script>
</body>
</html>