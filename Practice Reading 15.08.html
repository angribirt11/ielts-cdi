<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Full Reading Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            line-height: 1.4;
            font-size: 16px;
        }



        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
        }

        .ielts-logo {
            display: none;
        }

        .test-info {
            display: flex;  
            align-items: center;
            gap: 30px;
            font-size: 14px;
            color: #333;
        }

        .audio-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }

        .audio-icon {
            width: 16px;
            height: 16px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>') no-repeat center;
        }

        .header-icons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .telegram-link {
            color: #3e3e3e;
            text-decoration: none;
            font-weight: 700;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border: 2px solid #3e3e3e;
            border-radius: 9999px;
            background-color: #ffffff;
            line-height: 1;
        }

        .telegram-link:hover {
            background-color: #f6f6f6;
        }

        .telegram-link::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: currentColor;
            -webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }

        #volume-slider {
            -webkit-appearance: none;
            appearance: none;
            width: 80px;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 2px;
            cursor: pointer;
        }

        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
        }

        #volume-slider::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #333;
            cursor: pointer;
            border: none;
        }

        .icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            opacity: 0.7;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .icon:hover {
            opacity: 1;
        }
        
        #play-pause-btn {
            background: none;
            border: none;
            padding: 0;
        }

        .main-container {
            margin-top: 60px;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            height: calc(100vh - 60px); /* Full height minus header */
            position: relative;
        }

        /* Page watermark */
        body::after {
            content: "@MINDLESS_WRITER";
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) rotate(-20deg);
            font-size: 72px;
            font-weight: 800;
            letter-spacing: 2px;
            color: #000000;
            opacity: 0.04; /* subtle */
            pointer-events: none;
            z-index: 0;
            white-space: nowrap;
        }

        .panels-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .passage-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px; /* Minimum width */
        }

        /* Passage Content */
        .text-center {
            text-align: center;
        }
        .reading-passage h4 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
       
        .reading-passage p {
            margin-bottom: 1.2em;
        }

        .question ul li label {
            display: block;
            margin-top: 8px;
            cursor: pointer;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px; /* Minimum width */
            border-left: 1px solid #e0e0e0;
        }

        .resizer {
            position: relative;
            background: transparent;
            cursor: col-resize;
            flex-shrink: 0;
            flex-grow: 0;
            z-index: 5;
            width: 16px; /* Larger hit area so users don't need to be pixel-perfect */
            touch-action: none; /* Better touch dragging */
            -webkit-user-select: none;
            user-select: none;
        }
        .resizer::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 3px; /* Slightly thicker visual line */
            transform: translateX(-50%);
            background-color: #3e3e3e;
        }
        .resizer::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 36px; /* larger grab handle */
            height: 36px;
            background-color: #ffffff;
            border: 2px solid #3e3e3e;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="%233e3e3e" fill="%233e3e3e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 8l-4 4 4 4"/><path d="M16 8l4 4-4 4"/><line x1="4" y1="12" x2="20" y2="12"/></svg>');
            background-repeat: no-repeat;
            background-size: 60% 60%;
            background-position: center;
            pointer-events: none;
        }

        /* Left Panel */
        .left-panel {
            width: 100%;
            padding: 20px;
        }

        /* Right Panel */
        .right-panel {
            display: none;
            width: 50%;
            padding: 20px;
            position: relative;
        }

        .help-button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 20px;
        }

        .help-button:hover {
            background: #357abd;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .people-section {
            margin-bottom: 30px;
        }

        .people-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
        }

        .people-table th {
            text-align: left;
            padding: 10px;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .people-table td {
            padding: 8px 10px;
            border: 1px solid #ddd;
        }

        .person-name {
            font-size: 16px;
        }

        .question-number {
            background: white;
            border: 1px solid #4a90e2;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            font-size: 14px;
            color: #4a90e2;
            min-width: 30px;
            text-align: center;
        }

        .assigned-responsibility {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 14px;
            border: 1px solid #ddd;
        }

        .responsibilities-section {
            margin-bottom: 30px;
        }

        .responsibility-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .responsibility-item {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .responsibility-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .responsibility-item.dragging {
            opacity: 0.5;
        }

        .questions-section {
            margin-bottom: 20px;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .instruction {
            margin-bottom: 20px;
            font-size: 16px;
            color: #666;
        }

        /* Map Styles */
        .map-container {
            position: relative;
            margin: 20px 0;
            display: flex;
            justify-content: center;
        }

        .map-svg {
            border: 2px solid #333;
            background: white;
        }

        .map-room {
            fill: #f9f9f9;
            stroke: #333;
            stroke-width: 1;
        }

        .map-text {
            font-family: Arial, sans-serif;
            font-size: 13px;
            text-anchor: middle;
            fill: #333;
        }

        .map-number {
            font-family: Arial, sans-serif;
            font-size: 16px;
            font-weight: bold;
            text-anchor: middle;
            fill: #333;
        }

        .room-labels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .room-label {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            text-align: center;
            transition: all 0.2s;
        }

        .room-label:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .room-label.dragging {
            opacity: 0.5;
        }

        /* Navigation Arrows */
        .nav-arrows {
            position: fixed;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 6px;
            z-index: 101;
        }

        .nav-arrow {
            width: 48px;
            height: 48px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: 700;
            color: #fff;
            transition: transform 0.1s ease, background-color 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.25);
            outline: none;
        }
        .nav-arrow.prev { background-color: #4b5563; }
        .nav-arrow.next { background-color: #000000; }

        .nav-arrow:hover { transform: translateY(-1px); }
        .nav-arrow:active { transform: translateY(0); }
        .nav-arrow:focus-visible { box-shadow: 0 0 0 3px rgba(59,130,246,0.4); }

        .nav-arrow:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Bottom Navigation - Exact Match */
        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;
        
            padding: 0;
            display: flex;
            align-items: center;
            height: 80px;
            z-index: 100;
        }

        .footer__questionWrapper___1tZ46 {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }


        .footer__questionNo___3WNct {
            background: none;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .footer__questionNo___3WNct:hover {
            background-color: #f8f9fa;
        }

        .section-prefix {
            font-size: 16px;
        }

        .sectionNr {
            font-size: 16px;
            font-weight: bold;
        }

        .attemptedCount {
            font-size: 14px;
            color: #666;
            margin-left: 5px;
            font-weight: 400; /* Normal weight */
        }

        @media (max-width: 768px) {
            .attemptedCount {
                display: none;
            }
        }

        .footer__questionWrapper___1tZ46.selected .attemptedCount {
            display: none;
        }

        .footer__subquestionWrapper___9GgoP {
            display: none;
            gap: 2px;
            margin-left: 10px;
        }

        .footer__questionWrapper___1tZ46.selected .footer__subquestionWrapper___9GgoP {
            display: flex;
        }

        .subQuestion {
            width: 32px;
            height: 32px;
            border: 1px solid #ccc;
            background: white;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-radius: 2px;
        }

        .subQuestion.answered {
            background-color: #e9ecef;
            border-color: #ddd;
        }
        .subQuestion.correct {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }
        .subQuestion.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .subQuestion:hover {
            background-color: #f0f0f0;
            border-color: #999;
        }

        .subQuestion.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .subQuestion.completed {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .footer__deliverButton___3FM07 {
            margin-left: auto;
            margin-right: 20px;
            background-color: #f3f4f6;
            color: #111827;
            border: 1px solid #d1d5db;
            padding: 10px 16px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: transform 0.08s ease, background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            min-width: 160px;
            justify-content: center;
        }

        .footer__deliverButton___3FM07:hover {
            background-color: #ebedf0;
            border-color: #c7ccd4;
        }

        .footer__deliverButton___3FM07:active {
            transform: translateY(1px);
        }

        .footer__deliverButton___3FM07:focus-visible {
            box-shadow: 0 0 0 3px rgba(59,130,246,0.35);
            outline: none;
        }

        .footer__deliverButton___3FM07:disabled {
            background: #eef0f3;
            color: #9ca3af;
            cursor: not-allowed;
            border-color: #e5e7eb;
            box-shadow: none;
        }

        

        .hidden {
            display: none !important;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
            min-width: 140px;
        }

        .context-menu-item {
            padding: 12px 16px;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .context-menu-item:hover {
            background-color: #f8f9fa;
        }

        .context-menu-item:last-child {
            border-bottom: none;
        }

        .highlight {
            background-color: #ffff00;
        }

        .comment-highlight {
            background-color: #90EE90;
            position: relative;
            cursor: help;
        }

        .comment-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .comment-highlight:hover .comment-tooltip {
            opacity: 1;
        }

        .question {
            margin-bottom: 40px;
        }
        .question p {
            margin-bottom: 10px;
        }
        .question ul, .question .people-table {
            margin-top: 0;
        }
        .question-prompt {
            margin-bottom: 20px;
        }
        .question ul {
            list-style: none;
            padding-left: 0;
        }
        .question ul li {
            margin-bottom: 5px;
        }
        .answer-input {
            border: 1px solid #bfbfbf;
            border-radius: 4px;
            background-color: #fff;
            padding: 2px 8px;
            font-size: 16px;
            text-align: left;
            font-weight: 700;
            margin-right: 6px;
            margin-left: 6px;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            height: 28px;
            min-width: 150px;
        }
        .answer-input.active-input,
        .answer-input:focus {
            border-color: #3581d8;
            border-width: 2px;
            outline: none;
        }
        .answer-input::placeholder {
            color: #666;
            font-weight: 700;
            text-align: center;
        }
        .answer-input.correct {
            border-color: #28a745;
            background-color: #e9f7ef;
        }
        .answer-input.incorrect {
            border-color: #dc3545;
            background-color: #f8d7da;
            color: #721c24;
        }
        .answer-input {
    z-index: 10;
    position: relative;
    pointer-events: auto;
}
        .summary-text .answer-input {
            width: 120px;
            height: 24px;
            font-size: 14px;
            margin: 0 4px;
        }
        .answer-inputs {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        .answer-inputs .answer-input {
            width: 200px;
            height: 30px;
            font-size: 16px;
        }
        .drag-drop-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-top: 20px;
            align-items: flex-start;
        }
        .recommendations-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-height: 200px;
        }
        .drag-item {
            background: white;
            border: 1px solid #9c9c9c;
            font-weight: 600;
            padding: 0px 5px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            transition: all 0.2s;
            user-select: none;
        }
        .drag-item:hover {
            background: #e9ecef;
        }
        .drag-item.dragging {
            opacity: 0.5;
        }
        .drag-item.selected {
            border-color: #4a90e2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.5);
        }
        .drop-zone {
            border: 2px dashed #aaa;
            border-radius: 4px;
            width: 50%;
            margin-top: 19px;
            margin-bottom: 5px;
            transition: background-color 0.2s, border-color 0.2s;
            padding: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            color: #7a7a7a;
            font-weight: 600;
        }
        .drop-zone.drag-over {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }
        .drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }
        .drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }
        .drop-zone.disabled {
            pointer-events: none;
        }
        .drop-zone .drag-item {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 15px;
            padding: 2px;
        }
        .drag-options-container {
            margin-top: 10px;
        }
        .drag-options-container .drag-item {
            display: block;
            width: fit-content;
            font-size: 15px;
            padding: 0.5px 10px;
            margin-bottom: 5px;
        }
        .drag-options-container .drag-item:last-child {
            margin-bottom: 0;
        }
        .q-number {
            color: #888;
            font-size: 14px;
            font-weight: bold;
        }
        .questions-container {
            width: 100%;
        }
        audio {
            width: 100%;
            margin-bottom: 20px;
        }
        .part-header {
            background-color: #f1f2ec;
            padding: 15px 20px;
            border: 1px solid #e0e0e0;
            text-align: left;
            margin: 10px 20px;
            border-radius: 5px;
        }
        .part-header p {
            margin: 0;
        }
        .part-header p:first-child {
            margin-bottom: 5px;
        }

        .question li.correct {
            color: #155724;
            font-weight: bold;
        }
        .question li.incorrect {
            color: #721c24;
        }
        .question li.correct::before {
            content: '✔ ';
            color: #28a745;
        }
        .question li.incorrect::before {
            content: '✖ ';
            color: #dc3545;
        }

        .example-box {
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .timer-container {
            display: flex;
            position: relative;
            cursor: default;
            color: #333;
            font-size: 16px;
            font-weight: 500;
            align-items: center;
        }
        .timer-container .timer-tooltip {
            display: none;
        }

        .timer-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 15px;
        }

        .timer-controls button {
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 50%;
            padding: 0;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }
        .timer-controls button:hover {
            background: #e0e0e0;
        }

        .timer-controls button svg {
            width: 20px;
            height: 20px;
            fill: #3e3e3e;
        }

        .audio-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(40, 40, 40, 0.9);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }
        .audio-modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 500px;
            padding: 20px;
        }
        .audio-modal-content p {
            font-size: 16px;
            line-height: 1.5;
            color: #eee;
        }
        .audio-modal-icon {
            margin-bottom: 20px;
        }
        .modal-play-btn {
            background-color: #000;
            color: white;
            border: 1px solid white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }
        .modal-play-btn:hover {
            background-color: #333;
        }
        #goto-widget {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        #goto-input {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        #goto-btn {
            padding: 4px 10px;
            border: 1px solid #ccc;
            background-color: #f0f0f0;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Styles for TRUE/FALSE/NOT GIVEN questions */
        .tf-question {
            margin-bottom: 25px;
            padding: 10px 0px;
            border-radius: 4px;
            transition: border-color 0.3s, background-color 0.3s;
        }
        .tf-question-line {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 5px 0px;
            border-radius: 4px;
        }
        .tf-question-number, .question-number-box {
            border: 2px solid #ccc;
            padding: 2px 8px;
            margin-right: 10px;
            border-radius: 3px;
            font-weight: bold;
            transition: border-color 0.3s;
            display: inline-block;
        }
        /* Active question blue outline for TF (clears when navigating away) */
        .tf-question.active-question .tf-question-number {
            border-color: #4a90e2;
        }
        .tf-question-text {
            padding-top: 3px;
        }
        .tf-options {
            padding-left: 5px;
        }
        .tf-option {
            display: block;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 10px 12px;
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
            background-color: #fff;
        }
        .tf-option:hover {
            background-color: #f1f7ff;
            border-color: #c6dcfb;
        }
        .tf-option:has(input[type="radio"]:checked) {
            background-color: #cfe3f9;
            border-color: #7db3f5;
        }
        /* Answer checking states for TF/NG */
        .tf-option.correct {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            border-width: 1px;
        }
        .tf-option.incorrect {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            border-width: 1px;
        }
        /* Ensure selected-blue visuals don't conflict once results are shown */
        body.results-mode .tf-option:has(input[type="radio"]:checked) {
            box-shadow: none;
        }
        .tf-option input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        .tf-question.correct .tf-question-line {
            background-color: #e9f7ef;
        }
        .tf-question.incorrect .tf-question-line {
            background-color: #f8d7da;
        }
        .matching-question-container {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        .matching-options-bank {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .matching-questions {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .matching-question-item {
            display: flex;
            align-items: center;
            gap: 15px;

            border: 2px solid transparent;
            border-radius: 4px;
            transition: border-color 0.3s;
        }
        .matching-question-item > span {
            flex: 1;
        }
        .matching-question-item.correct {
            background-color: #e9f7ef;
            border-color: #28a745 !important;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone {
            width: auto;                 /* JS will set a consistent width */
            min-width: 200px;
            flex-shrink: 0;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            font-weight: bold;
            color: #aaa;
            padding: 4px 6px;
            min-height: 40px;
        }
        .matching-options-bank .drag-item {
            font-size: 15px;
            text-align: center;
            border: 1px solid #ccc;
            background: #f9f9f9;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px; /* Minimum width */
            border-left: 1px solid #e0e0e0;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .summary-completion-container {
            margin-top: 20px;
        }
        .summary-text p {
            line-height: 3.0;
            font-size: 16px;
            margin-bottom: 12px;
        }
        .summary-text li {
            line-height: 2.2;
            margin-bottom: 10px;
        }
        .summary-drop-zone {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            max-width:200px;
            height: 25px;
            border: 2px dashed #999;
            border-radius: 4px;
            margin: 0 5px;
            padding: 0 5px;
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
            color: #aaa;
            font-weight: bold;
        }
        .summary-drop-zone.filled {
            border-color: #4a90e2;
        }
        .summary-drop-zone.active-input {
             border-color: #4a90e2;
             box-shadow: none;
        }
        .summary-drop-zone .drag-item {
            font-size: 15px;
            font-weight: bold;
            background-color: transparent;
            border: none;
            padding: 0;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .summary-options-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .summary-options-bank .drag-item {
            flex-grow: 1;
            min-width: 100px;
            text-align: center;
        }

        /* Filled drop-zone pill styling */
        .drop-zone.filled {
            background-color: transparent;
            border: none !important;
            outline: none !important;
            box-shadow: none !important;
            padding: 0;
        }

        /* Passage 2 heading drop-zones behavior */
        #passage-text-2 .drop-zone[data-dnd-group="p2-14-20"] {
            width: 50% !important;          /* start at half passage width */
            display: inline-flex;           /* allow shrink to content later */
            justify-content: flex-start;
            align-items: center;
            min-height: 40px;
            padding: 6px 8px;
        }
        #passage-text-2 .drop-zone[data-dnd-group="p2-14-20"].filled {
            width: auto !important;         /* shrink to option width after drop */
            padding: 0;                      /* use pill padding */
        }
        #passage-text-2 .drop-zone[data-dnd-group="p2-14-20"].filled .drag-item {
            width: auto;                     /* pill sizes to its content */
            max-width: none;
            white-space: nowrap;             /* keep single-line headings */
            line-height: 1.5;
        }
        .drop-zone.filled .drag-item {
            border: 2px solid #4a90e2;
            border-radius: 10px;
            padding: 4px 10px 4px 36px; /* extra left space for letter badge */
            font-weight: 700;
            background: #fff;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.15);
            cursor: default;
            white-space: normal;         /* allow wrapping of long text */
            position: relative;          /* allow left badge positioning */
            text-align: left;            /* left-align option text */
            width: 100%;                 /* fill the drop-zone */
            max-width: 100%;
            font-size: 15px;             /* show option text */
            line-height: 1.4;
            word-break: break-word;      /* break long words if needed */
        }

        /* Show the letter as a left badge inside the pill when dropped */
        .drop-zone.filled .drag-item::before {
            content: attr(data-value);
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            color: #4a90e2;
            background: #ffffff;
            font-weight: 800;
            line-height: 1;
            font-size: 14px;             /* restore visible letter size */
        }

        /* Hide the inline <strong>letter</strong> inside the pill to avoid duplication */
        .drop-zone.filled .drag-item strong {
            display: none;
        }
        .multi-choice-question {
            margin-bottom: 20px;
            padding: 10px;
            border-radius: 4px;
            border: 3px solid transparent;
            transition: border-color 0.3s, background-color 0.3s;
        }
        /* MCQ number badge: style first strong within prompt */
        .multi-choice-question .question-prompt p > strong:first-child {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
            padding: 2px 6px;
            margin-right: 8px;
            border: 1px solid #d0d7e2;
            border-radius: 6px;
            background: #fff;
        }
        /* Active question blue outline for MCQ (clears when navigating away) */
        .multi-choice-question.active-question .question-prompt p > strong:first-child {
            border-color: #4a90e2;
            border-width: 2px;
        }
        .multi-choice-option {
            padding: 10px 12px;
            background-color: #fff;
            transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
        }
        .multi-choice-option:hover {
            background-color: #f1f7ff;
            border-color: #c6dcfb;
        }
        .multi-choice-option:has(input:checked) {
            background-color: #cfe3f9;
            border-color: #7db3f5;
        }
        /* Answer checking states for MCQ */
        .multi-choice-option.correct {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
            box-shadow: inset 0 0 0 2px rgba(40, 167, 69, 0.25) !important;
            border-width: 1px;
            border-radius: 6px;
        }
        .multi-choice-option.incorrect {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            box-shadow: inset 0 0 0 2px rgba(220, 53, 69, 0.25) !important;
            border-width: 1px;
            border-radius: 6px;
        }
        /* Correct answer reveal for unselected option after checking */
        .tf-option.correct-answer-highlight,
        .multi-choice-option.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #28a745 !important;
        }
        body.results-mode .multi-choice-option:has(input:checked) { box-shadow: none; }
        .multi-choice-option label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 16px;
        }
        .multi-choice-option input[type="checkbox"],
        .multi-choice-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.3);
            accent-color: #4a90e2;
        }
        .multi-choice-option.correct {
            background-color: #e9f7ef;
        }
        .multi-choice-option.incorrect {
            background-color: #f8d7da;
        }
        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }
        .matching-question-item .drop-zone.filled {
            border-color: #4a90e2;
        }
        .matching-question-item .drop-zone { /* ensure no width override later */
            width: auto;
        }
        .paragraph-matching-question {
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 12px;
        }
        .paragraph-matching-question .answer-input {
            width: 80px;
            flex-shrink: 0;
        }

        .matching-form-container {
            margin-top: 20px;
        }
        .matching-form-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        .matching-form-label {
            flex-shrink: 0;
        }

        /* Results Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(17, 24, 39, 0.6);
            backdrop-filter: blur(3px);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.hidden {
            display: none;
        }
        .modal-content {
            background: #ffffff;
            padding: 24px;
            border-radius: 14px;
            width: 92%;
            max-width: 780px;
            max-height: 86vh;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 1px solid #e5e7eb;
            box-shadow: 0 20px 60px rgba(0,0,0,0.25);
        }
        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #666;
        }
        .modal-content h2 {
            text-align: center;
            margin-bottom: 18px;
            color: #111827;
        }
        .results-summary {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 16px;
            text-align: center;
            border-bottom: 1px solid #eef2f7;
            padding-bottom: 12px;
        }
        .results-summary p {
            margin: 0;
            font-size: 14px;
            color: #374151;
        }
        .results-summary p span {
            display: inline-block;
            padding: 4px 10px;
            margin-left: 6px;
            border-radius: 999px;
            background: #f3f4f6;
            font-weight: 700;
            color: #111827;
        }
        .results-details-container {
            overflow-y: auto;
            padding-right: 10px; /* For scrollbar */
            border-radius: 8px;
        }
        .result-row {
            display: grid;
            grid-template-columns: 56px 1fr 1fr;
            gap: 12px;
            padding: 10px 8px;
            border-bottom: 1px solid #eef2f7;
            font-size: 15px;
            align-items: center;
        }
        .result-row.correct {
            background-color: #f3faf5;
        }
        .result-row.incorrect {
            background-color: #fff5f5;
        }
        .result-row .q-num {
            font-weight: 700;
            color: #111827;
            background: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            width: 42px;
            height: 30px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .result-row .user-ans {
            color: #374151;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            padding: 4px 8px;
            border-radius: 6px;
        }
        .result-row .correct-ans {
            color: #065f46;
            font-weight: 600;
            background: #ecfdf5;
            border: 1px solid #a7f3d0;
            padding: 4px 8px;
            border-radius: 6px;
        }
        .correct-answer-display {
            font-weight: bold;
            color: #28a745;
            margin-left: 10px;
            font-size: 14px;
        }
        
        
        .centered-title {
    text-align: center;
    font-size: 50px;
    font-weight: bold;
    margin-bottom: 15px;
}

        .matching-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        
        .matching-table th {
            background-color: #007bff;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #ddd;
        }
        
        .matching-table td {
            padding: 12px;
            border: 1px solid #ddd;
            vertical-align: top;
        }
        
        .matching-table .statement {
            text-align: left;
            width: 60%;
        }
        
        .matching-table .table-radio {
            margin: 0;
            transform: scale(1.2);
        }
        
        .matching-table td:not(.statement) {
            text-align: center;
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table th:not(:first-child) {
            width: 6.67%;
            min-width: 60px;
        }
        
        .matching-table td:not(.statement):has(input:checked) {
            background-color: #e3f2fd;
        }
        
        .matching-table input[type="radio"]:checked {
            accent-color: #007bff;
        }
        
        .matching-table td.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table td.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .options-row {
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        .matching-table .options-row td {
            font-weight: 500;
            text-align: center;
            padding: 8px 12px;
            font-size: 13px;
        }
        
        .matching-table .options-row td:first-child {
            text-align: left;
            font-weight: normal;
        }
        
        .matching-table td.correct-answer-highlight {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell {
            cursor: pointer;
            transition: background-color 0.2s ease;
            min-height: 40px;
            border: 1px solid #ddd;
            position: relative;
        }
        
        .matching-table .clickable-cell:hover {
            background-color: #f0f8ff;
            border-color: #007bff;
        }
        
        .matching-table .clickable-cell.selected {
            background-color: #e3f2fd;
        }
        
        .matching-table .clickable-cell.correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb;
        }
        
        .matching-table .clickable-cell.incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb;
        }
        
        .matching-table .clickable-cell::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: transparent;
            transition: background-color 0.2s ease;
        }
        
        
        
        /* Explanation Section Styles */
        .explanation-section {
            margin-top: 40px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .explanation-section h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
        }
        
        .explanation-content p {
            margin-bottom: 15px;
            line-height: 1.6;
            font-size: 16px;
        }
        
        .explanation-content strong {
            color: #4a90e2;
            font-weight: 600;
        }
        
        #show-explanation-btn {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        #show-explanation-btn:hover {
            background-color: #357abd;
        }
        /* Mobile bottom bar */
        .mobile-bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: #ffffff;
            border-top: 1px solid #e5e7eb;
            display: none;
            align-items: center;
            justify-content: space-between;
            padding: 0 12px;
            z-index: 1100;
        }
        .mobile-bottom-bar .mobile-btn {
            background: #f3f4f6;
            color: #111827;
            border: 1px solid #d1d5db;
            padding: 8px 12px;
            font-size: 15px;
            font-weight: 700;
            border-radius: 8px;
        }
        .mobile-bottom-bar .mobile-btn:active {
            transform: translateY(1px);
        }
        .question-picker-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
        }
        .qp-btn {
            height: 40px;
            border: 1px solid #d1d5db;
            background: #fff;
            border-radius: 8px;
            font-weight: 700;
            color: #111827;
        }
        .qp-btn.answered { background-color: #e9ecef; border-color: #ddd; }
        .qp-btn.correct { background-color: #28a745; color: #fff; border-color: #28a745; }
        .qp-btn.incorrect { background-color: #dc3545; color: #fff; border-color: #dc3545; }

        @media (max-width: 768px) {
            .nav-row { display: none; }
            .mobile-bottom-bar { display: flex; }
            .panels-container { flex-direction: row; }
            .passage-panel, .questions-panel { flex: 0 0 50%; padding: 12px 12px 80px; }
            .resizer { width: 8px; }
            body { font-size: 15px; }
        }

        /* Auto-hide scrollbars: hidden by default, show on hover/scroll */
        .scrollbar-hidden {
            -ms-overflow-style: none; /* IE and old Edge */
            scrollbar-width: none;    /* Firefox */
        }
        .scrollbar-hidden::-webkit-scrollbar {
            width: 0;
            height: 0;
        }
        .scrollbar-visible {
            scrollbar-width: thin; /* Firefox */
        }
        .scrollbar-visible::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .scrollbar-visible::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.06);
        }
        .scrollbar-visible::-webkit-scrollbar-thumb {
            background-color: rgba(0,0,0,0.35);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="timer-container">
            <span class="timer-display">60:00</span>
            <div class="timer-controls">
                <button id="timer-toggle-btn" title="Pause/Resume Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="#3e3e3e"><path d="M8 5v14l11-7z"/></svg>
                </button>
                <button id="timer-reset-btn" title="Reset Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="#3e3e3e"><path d="M12 5V2L7 7l5 5V9a6 6 0 11-6 6H4a8 8 0 108-8z"/></svg>
                </button>
            </div>
        </div>
        <a href="https://t.me/Avazbeks_Media" target="_blank" class="telegram-link">
            Avazbeks_Media
        </a>
    </div>

    <div class="main-container" id="main-container">
        <div id="passage-header-container">
            <div id="part-header-1" class="part-header">
                <p><strong>Part 1</strong></p>
                <p>Read the text and answer questions 1-13.</p>
            </div>
            <div id="part-header-2" class="part-header hidden">
                <p><strong>Part 2</strong></p>
                <p>Read the text and answer questions 14-26.</p>
            </div>
            <div id="part-header-3" class="part-header hidden">
                <p><strong>Part 3</strong></p>
                <p>Read the text and answer questions 27-40.</p>
            </div>
        </div>
        <div class="panels-container">
            <div class="passage-panel scrollbar-hidden" id="passage-panel">
                <div id="passage-text-1" class="reading-passage">
                    <h4 class="text-center">New Agriculture in Oregon, US</h4>
                    <p><strong>A</strong>&nbsp;&nbsp;Onion growers in eastern Oregon are adopting a system that saves water and keeps topsoil in place while producing the highest quality “super-colossal” onions. Pear growers in southern Oregon have reduced their use of some of the most toxic pesticides by up to two-thirds, and are still producing top-quality pear. Range managers throughout the state have controlled the poisonous weed tansy ragwort with insect predators and saved the Oregon livestock industry up to $4.8 million a year.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;These are some of the results Oregon growers have achieved in collaboration with Oregon State University (OSU) researchers as they test new farming methods including integrated pest management (IPM). Nationwide, however, IPM has not delivered results comparable to those in Oregon. A recent U.S General Accounting Office (GAO) report indicates that while integrated pest management can result in dramatically reduced pesticide use, the federal government has been lacking in effectively promoting that goal and implementing IPM. Farmers also blame the government for not making the new options of pest management attractive. “Wholesale changes in the way that farmers control the pests on their farms is an expensive business.” Tony Brown, of the National Farmers Association, says. “If the farmers are given tax breaks to offset the expenditure, then they would willingly accept the new practices.” The report goes on to note that even though the use of the riskiest pesticides has declined nationwide, they still make up more than 40 percent of all pesticides used today; and national pesticide use has risen by 40 million kilograms since 1992. “Our food supply remains the safest and highest quality on Earth but we continue to overdose our farmland with powerful and toxic pesticides and to under-use the safe and effective alternatives,” charged Patrick Leahy, who commissioned the report. Green action groups disagree about the safety issue. “There is no way that habitual consumption of foodstuffs grown using toxic chemical of the nature found on today’s farms can be healthy for consumers,” noted Bill Bowler, spokesman for Green Action, one of many lobbyists interested in this issue.</p>
                    <p><strong>C</strong>&nbsp;&nbsp;The GAO report singles out Oregon’s apple and pear producers who have used the new IPM techniques with growing success. Although Oregon is clearly ahead of the nation, scientists at OSU are taking the Government Accounting Office criticisms seriously. “We must continue to develop effective alternative practices that will reduce environmental hazards and produce high-quality products,” said Paul Jepson, a professor of entomology at OSU and new director of</p>
                    <p><strong>D</strong>&nbsp;&nbsp;OSU’s Integrated Plant Protection Centre (IPPC). The IPPC brings together scientists from OSU’s Agricultural Experiment Station, OSU Extension service, the U.S. Department of Agriculture and Oregon farmers to help develop agricultural systems that will save water and soil, and reduce pesticides. In response to the GAO report, the Centre is putting even more emphasis on integrating research and farming practices to improve Oregon agriculture environmentally and economically.</p>
                    <p><strong>E</strong>&nbsp;&nbsp;“The GAO report criticizes agencies for not clearly communicating the goals of IPM,” said Jepson. “Our challenge is to greatly improve the communication to and from growers, to learn what works and what doesn’t. the work coming from OSU researchers must be adopted in the field and not simply languish in scientific journals.”</p>
                    <p><strong>F</strong>&nbsp;&nbsp;In Oregon, growers and scientists are working together to instigate new practices. For example, a few years ago scientists at OSU’s Malheur Experiment Station began testing a new drip irrigation system to replace old ditches that wasted water and washed soil and fertilizer into streams. The new system cut water and fertilizer use by half kept topsoil in place and protected water quality.</p>
                    <p><strong>G</strong>&nbsp;&nbsp;In addition, the new system produced crops of very large onions, rated “super-colossal” and highly valued by the restaurant industry and food processors. Art Pimms, one of the researchers at Malheur comments: “Growers are finding that when they adopt more environmentally benign practices, they can have excellent results. The new practices benefit the environment and give the growers their success.”</p>
                    <p><strong>H</strong>&nbsp;&nbsp;OSU researcher in Malheur next tested straw mulch and found that it successfully held soil in place and kept the ground moist with less irrigation. In addition, and unexpectedly, the scientists found that the mulched soil created a home for beneficial beetles and spiders that prey on onion thrips – a notorious pest in commercial onion fields – a discovery that could reduce the need for pesticides. “I would never have believed that we could replace the artificial pest controls that we had before and still keep our good results,” commented Steve Black, a commercial onion farmer in Oregon, “but instead we have actually surpassed expectations.”</p>
                    <p><strong>I</strong>&nbsp;&nbsp;OSU researchers throughout the state have been working to reduce dependence on broad-spectrum chemical spays that are toxic to many kinds of organisms, including humans. “Consumers are rightly putting more and more pressure on the industry to change its reliance on chemical pesticides, but they still want a picture-perfect product,” said Rick Hilton, an entomologist at OSU’s Southern Oregon Research and Extension Centre, where researches help pear growers reduce the need for highly toxic pesticides. Picture perfect pears are an important product in Oregon and traditionally they have required lots of chemicals. In recent years, the industry has faced stiff competition from overseas producers, so any new methods that growers adopt must make sense economically as well as environmentally. Hilton is testing a growth regulator that interferes with the molting of codling moth larvae. Another study used pheromone dispensers to disrupt codling moth mating. These and other methods of integrated pest management have allowed pear growers to reduce their use of organophosphates by two-thirds and reduce all other synthetic pesticides by even more and still produce top-quality pears. These and other studies around the state are part of the effort of the IPPC to find alternative farming practices that benefit both the economy and the environment.</p>
                </div>
                <div id="passage-text-2" class="reading-passage hidden">
                    <h4 class="text-center">The evolutional mystery: Crocodile survives</h4>
                    <div class="drop-zone" data-dnd-group="p2-14-20" data-q-start="14">14</div>
                    <p>Crocodiles have been around for 200 million years, but they’re certainly not primitive. The early forms of crocodiles are known as Crocodilian. Since they spent most of their life beneath water, accordingly their body adapted to aquatic lifestyle. Due to the changes formed within their body shape and tendency to adapt according to the climate they were able to survive when most of the reptiles of their period are just a part of history. In their tenure on Earth, they’ve endured the impacts of meteors, planetary refrigeration, extreme upheavals of the Earth’s tectonic surface and profound climate change. They were around for the rise and fall of the dinosaurs, and even 65 million years of supposed mammalian dominance has failed to loosen their grip on the environments they inhabit. Today’s crocodiles and alligators are little changed from their prehistoric ancestors, a telling clue that these reptiles were (and remain) extremely well adapted to their environment.</p>
                    <div class="drop-zone" data-dnd-group="p2-14-20" data-q-start="15">15</div>
                    <p>The first crocodile-like ancestors appeared about 230 million years ago, with many of the features that make crocs such successful stealth hunters already in place: streamlined body, long tail, protective armour and long jaws. They have long head and a long tail that helps them to change their direction in water while moving. They have four legs which are short and are webbed. Never underestimate their ability to move on ground. When they move they can move at such a speed that won’t give you a second chance to make a mistake by going close to them especially when hungry. They can lift their whole body within seconds from ground. The fastest way by which most species can move is a sort of “belly run”, where the body moves like a snake, members huddled to the side paddling away frenetically while the tail whips back and forth. When “belly running” Crocodiles can reach speeds up to 10 or 11 km/h (about 7mph), and often faster if they are sliding down muddy banks. Other form of movement is their “high walk”, where the body is elevated above the ground.</p>
                    <div class="drop-zone" data-dnd-group="p2-14-20" data-q-start="16">16</div>
                    <p>Crocodilians have no lips. When submerged in their classic ‘sit and wait’ position, their mouths fill with water. The nostrils on the tip of the elongated snout lead into canals that run through bone to open behind the valve – allowing the crocodilian to breathe through its nostrils even though its mouth is under water. When the animal is totally submerged, another valve seals the nostrils, so the crocodilian can open its mouth to catch prey with no fear of drowning. The thin skin on the crocodilian head and face is covered with tiny, pigmented domes, forming a network of neural pressure receptors that can detect barely perceptible vibrations in the water. This enables a crocodile lying in silent darkness to suddenly throw its head sideways and grasp with deadly accuracy small prey moving close by.</p>
                    <div class="drop-zone" data-dnd-group="p2-14-20" data-q-start="17">17</div>
                    <p>Like other reptiles, crocodiles are endothermic animals (cold-blooded, or whose body temperature varies with the temperature of the surrounding environment) and, therefore, need to sunbathe, to raise the temperature of the body. On the contrary, if it is too hot, they prefer being in water or in the shade. Being a cold-blooded species, the crocodilian heart is unique in having an actively controlled valve that can redirect, at will, blood flow away from the lungs and recirculate it around the body, taking oxygen to where it’s needed most. In addition, their metabolism is a very slow one, so, they can survive for long periods without feeding. Crocodiles are capable of slowing their metabolism even further allowing them to survive for a full year without feeding. Compared to mammals and birds, crocodilians have slow metabolisms that burn much less fuel, and are ideally suited to relatively unstable environments that would defeat mammals with their high food demands.</p>
                    <div class="drop-zone" data-dnd-group="p2-14-20" data-q-start="18">18</div>
                    <p>Crocodiles use a very effective technique to catch the prey. The prey remains almost unaware of the fact that there can be any crocodile beneath water. It is due to the fact that when the crocodile sees its prey it moves under water without making any noise and significant movement. It keeps only its eyes above water surface. When it feels it has reached sufficiently close to the target it whistles out of water with wide open jaws. 80 percent of their attempts are successful. They have very powerful jaws. Once the prey trapped in its jaws they swallow it. Their power can be judged from the fact they can kill the wild zebras which come to watery areas in search of water. They do not chew their food. They normally feed on small animals, big fish, birds and even human flesh. As like some water creatures that interact by making sounds crocodiles also use many sounds to communicate with other crocodiles. They exist where conditions have remained the same and they are free of human interference. The crocodile is successful because it switches its feeding methods. It hunts fish, grabs birds at the surface, hides among the water edge vegetation to wait for a gazelle to come by, and when there is a chance for an ambush, the crocodile lunges forward, knocks the animal with its powerful tail and then drags it to water where it quickly drowns. Another way is to wait motionless for an animal to come to the water’s edge and grabs it by its nose where it is held to drown.</p>
                    <div class="drop-zone" data-dnd-group="p2-14-20" data-q-start="19">19</div>
                    <p>In many places inhabited by crocodilians, the hot season brings drought that dries up their hunting grounds and takes away the means to regulate their body temperature. They allowed reptiles to dominate the terrestrial environment. Furthermore, many crocs protect themselves from this by digging burrows and entombing themselves in mud, waiting for months without access to food or water, until the rains arrive. To do this, they sink into a quiescent state called aestivation.</p>
                    <div class="drop-zone" data-dnd-group="p2-14-20" data-q-start="20">20</div>
                    <p>Most of (At least nine species of) crocodilian are thought to aestivate during dry periods. Kennett and Christian’s six-year study of Australian freshwater crocodiles – Crocodylus johnstoni (the King Crocodiles). The crocodiles spent almost four months a year underground without access to water. Doubly labeled water was used to measure field metabolic rates and water flux, and plasma (and cloacal fluid samples were taken at approximately monthly intervals during some years to monitor the effects of aestivation with respect to the accumulation of nitrogenous wastes and electrolyte concentrations. Double found that the crocodiles’ metabolic engines tick over, producing waste and using up water and fat reserves. Waste products are stored in the urine, which gets increasingly concentrated as the months pass. However, the concentration of waste products in the blood changes very little, allowing the crocodiles to function normally. Furthermore, though the animals lost water and body mass (just over one-tenth of their initial mass) while underground, the losses were proportional: on emergence, the aestivating crocodiles were not dehydrated and exhibited no other detrimental effects such as a decreased growth rate. Kennett and Christian believe this ability of individuals to sit out the bad times and endure long periods of enforced starvation must surely be key to the survival of the crocodilian line through time.</p>
                </div>
                <div id="passage-text-3" class="reading-passage hidden">
                    <h4 class="text-center">Learning lessons from the past</h4>
                    <p><strong>A</strong>&nbsp;&nbsp;Many past societies collapsed or vanished, leaving behind monumental ruins such as those that the poet Shelley imagined in his sonnet, Ozymandias. By collapse, I mean a drastic decrease in human population size and/or political/economic/social complexity, over a considerable, for an extended time. By those standards, most people would consider the following past societies to have been famous victims of full-fledged collapses rather than of just minor declines: the Anasazi and Cahokia within the boundaries of the modem US, the Maya cities in Central American, Moche and Tiwanaku societies in South America, Norse Greenland, Mycenean Greece and Minoan Crete in Europe, Great Zimbabwe in Africa, Angkor Wat and the Harappan Indus Valley cities in Asia, and Easter Island in the Pacific Ocean.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;The monumental ruins left behind by those past societies hold a fascination for all of us. We marvel at them when as children we first learn of them through pictures. When we grow up, many of us plan vacations in order to experience them at first hand. We feel drawn to their often spectacular and haunting beauty, and also to the mysteries that they pose. The scales of the ruins testify to the former wealth and power of their builders. Yet these builders vanished, abandoning the great structures that they had created at such effort. How could a society that was once so mighty end up collapsing?</p>
                    <p><strong>C</strong>&nbsp;&nbsp;It has long been suspected that many of those mysterious abandonments were at least partly triggered by ecological problems: people inadvertently destroying the environmental resources on which their societies depended. This suspicion of unintended ecological suicide (ecocide) has been confirmed by discoveries made in recent decades by archaeologists, climatologists, historians, palaeontologists, and palynologists (pollen scientists). The processes through which past societies have undermined themselves by damaging their environments fall into eight categories, whose relative importance differs from case to case: deforestation and habitat destruction, soil problems, water management problems, overhunting, overfishing, effects of introduced species on native species, human population growth, and increased impact of people.</p>
                    <p><strong>D</strong>&nbsp;&nbsp;Those past collapses tended to follow somewhat similar courses constituting variations on a theme. Writers find it tempting to draw analogies between the course of human societies and the course of individual human lives – to talk of a society’s birth, growth, peak, old age and eventual death. But that metaphor proves erroneous for many past societies: they declined rapidly after reaching peak numbers and power, and those rapid declines must have come as a surprise and shock to their citizens. Obviously, too, this trajectory is not one that all past societies followed unvaryingly to completion: different societies collapsed to different degrees and in somewhat different ways, while many societies did not collapse at all.</p>
                    <p><strong>E</strong>&nbsp;&nbsp;Today many people feel that environmental problems overshadow all the other threats to global civilisation. These environmental problems include the same eight that undermined past societies, plus four new ones: human-caused climate change, the build-up of toxic chemicals in the environment, energy shortages, and full human utilisation of the Earth’s photosynthetic capacity. But the seriousness of these current environmental problems is vigorously debated. Are the risks greatly exaggerated, or conversely are they underestimated? Will modem technology solve our problems, or is it creating new problems faster than it solves old ones? When we deplete one resource (eg wood, oil, or ocean fish), can we count on being able to substitute some new resource (eg plastics, wind and solar energy, or farmed fish)? Isn’t the rate of human population growth declining, such that we’re already on course for the world’s population to level off at home manageable number of people?</p>
                    <p><strong>F</strong>&nbsp;&nbsp;Questions like this illustrate why those famous collapses of past civilisations have taken on more meaning than just that of a romantic mystery. Perhaps there are some practical lessons that we could learn from all those past collapses. But there are also differences between the modem world and its problems, and those past societies and their problems. We shouldn’t be so naive as to think that the study of the past will yield simple solutions, directly transferable to our societies today. We differ from past societies in some respects that put us at lower risk than them; some of those respects often mentioned include our powerful technology (ie its beneficial effects), globalisation, modem medicine, and greater knowledge of past societies and of distant modem societies. We also differ from past societies in some respects that put us at greater risk than them: again, our potent technology (ie its unintended destructive effects), globalisation (such that now a problem in one part of the world affects all the rest), the dependence of millions of us on modern medicine for our survival, and our much larger human population. Perhaps we can still learn from the past, but only if we think carefully about its lessons.</p>
                </div>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="questions-panel scrollbar-hidden" id="questions-panel">
                <div id="questions-1" class="question-set">
                    <div class="questions-container">
                        <div class="question" data-q-start="1" data-q-end="8">
                            <div class="question-prompt">
                                <p><strong>Questions 1-8</strong></p>
                                <p>Use the information in the passage to match the people (listed A–G) with opinions or deeds below.</p>
                                <p>Write the appropriate letters A–G in boxes 1–8 on your answer sheet.</p>
                                <p><em>NB&nbsp; You may use any letter more than once</em></p>
                            <div class="people-section">
                                    <p><strong>A</strong> Tony Brown</p>
                                    <p><strong>B</strong> Patrick Leahy</p>
                                    <p><strong>C</strong> Bill Bowler</p>
                                    <p><strong>D</strong> Paul Jepson</p>
                                    <p><strong>E</strong> Art Pimms</p>
                                    <p><strong>F</strong> Steve Black</p>
                                    <p><strong>G</strong> Rick Hilton</p>
                                </div>
                                </div>
                            <div class="table-container">
                                <table class="matching-table">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>A</th>
                                            <th>B</th>
                                            <th>C</th>
                                            <th>D</th>
                                            <th>E</th>
                                            <th>F</th>
                                            <th>G</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="statement">1. There is a double-advantage to the new techniques.</td>
                                            <td class="clickable-cell" data-question="1" data-value="A" onclick="selectCell(this, 1, 'A')"></td>
                                            <td class="clickable-cell" data-question="1" data-value="B" onclick="selectCell(this, 1, 'B')"></td>
                                            <td class="clickable-cell" data-question="1" data-value="C" onclick="selectCell(this, 1, 'C')"></td>
                                            <td class="clickable-cell" data-question="1" data-value="D" onclick="selectCell(this, 1, 'D')"></td>
                                            <td class="clickable-cell" data-question="1" data-value="E" onclick="selectCell(this, 1, 'E')"></td>
                                            <td class="clickable-cell" data-question="1" data-value="F" onclick="selectCell(this, 1, 'F')"></td>
                                            <td class="clickable-cell" data-question="1" data-value="G" onclick="selectCell(this, 1, 'G')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">2. The work on developing these alternative techniques is not finished.</td>
                                            <td class="clickable-cell" data-question="2" data-value="A" onclick="selectCell(this, 2, 'A')"></td>
                                            <td class="clickable-cell" data-question="2" data-value="B" onclick="selectCell(this, 2, 'B')"></td>
                                            <td class="clickable-cell" data-question="2" data-value="C" onclick="selectCell(this, 2, 'C')"></td>
                                            <td class="clickable-cell" data-question="2" data-value="D" onclick="selectCell(this, 2, 'D')"></td>
                                            <td class="clickable-cell" data-question="2" data-value="E" onclick="selectCell(this, 2, 'E')"></td>
                                            <td class="clickable-cell" data-question="2" data-value="F" onclick="selectCell(this, 2, 'F')"></td>
                                            <td class="clickable-cell" data-question="2" data-value="G" onclick="selectCell(this, 2, 'G')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">3. Eating food that has had chemicals used in its production is dangerous to our health.</td>
                                            <td class="clickable-cell" data-question="3" data-value="A" onclick="selectCell(this, 3, 'A')"></td>
                                            <td class="clickable-cell" data-question="3" data-value="B" onclick="selectCell(this, 3, 'B')"></td>
                                            <td class="clickable-cell" data-question="3" data-value="C" onclick="selectCell(this, 3, 'C')"></td>
                                            <td class="clickable-cell" data-question="3" data-value="D" onclick="selectCell(this, 3, 'D')"></td>
                                            <td class="clickable-cell" data-question="3" data-value="E" onclick="selectCell(this, 3, 'E')"></td>
                                            <td class="clickable-cell" data-question="3" data-value="F" onclick="selectCell(this, 3, 'F')"></td>
                                            <td class="clickable-cell" data-question="3" data-value="G" onclick="selectCell(this, 3, 'G')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">4. Changing current farming methods into a new one is not a cheap process.</td>
                                            <td class="clickable-cell" data-question="4" data-value="A" onclick="selectCell(this, 4, 'A')"></td>
                                            <td class="clickable-cell" data-question="4" data-value="B" onclick="selectCell(this, 4, 'B')"></td>
                                            <td class="clickable-cell" data-question="4" data-value="C" onclick="selectCell(this, 4, 'C')"></td>
                                            <td class="clickable-cell" data-question="4" data-value="D" onclick="selectCell(this, 4, 'D')"></td>
                                            <td class="clickable-cell" data-question="4" data-value="E" onclick="selectCell(this, 4, 'E')"></td>
                                            <td class="clickable-cell" data-question="4" data-value="F" onclick="selectCell(this, 4, 'F')"></td>
                                            <td class="clickable-cell" data-question="4" data-value="G" onclick="selectCell(this, 4, 'G')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">5. Results have exceeded the anticipated goal.</td>
                                            <td class="clickable-cell" data-question="5" data-value="A" onclick="selectCell(this, 5, 'A')"></td>
                                            <td class="clickable-cell" data-question="5" data-value="B" onclick="selectCell(this, 5, 'B')"></td>
                                            <td class="clickable-cell" data-question="5" data-value="C" onclick="selectCell(this, 5, 'C')"></td>
                                            <td class="clickable-cell" data-question="5" data-value="D" onclick="selectCell(this, 5, 'D')"></td>
                                            <td class="clickable-cell" data-question="5" data-value="E" onclick="selectCell(this, 5, 'E')"></td>
                                            <td class="clickable-cell" data-question="5" data-value="F" onclick="selectCell(this, 5, 'F')"></td>
                                            <td class="clickable-cell" data-question="5" data-value="G" onclick="selectCell(this, 5, 'G')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">6. The research done should be translated into practical projects.</td>
                                            <td class="clickable-cell" data-question="6" data-value="A" onclick="selectCell(this, 6, 'A')"></td>
                                            <td class="clickable-cell" data-question="6" data-value="B" onclick="selectCell(this, 6, 'B')"></td>
                                            <td class="clickable-cell" data-question="6" data-value="C" onclick="selectCell(this, 6, 'C')"></td>
                                            <td class="clickable-cell" data-question="6" data-value="D" onclick="selectCell(this, 6, 'D')"></td>
                                            <td class="clickable-cell" data-question="6" data-value="E" onclick="selectCell(this, 6, 'E')"></td>
                                            <td class="clickable-cell" data-question="6" data-value="F" onclick="selectCell(this, 6, 'F')"></td>
                                            <td class="clickable-cell" data-question="6" data-value="G" onclick="selectCell(this, 6, 'G')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">7. The U.S. produces the best food in the world nowadays.</td>
                                            <td class="clickable-cell" data-question="7" data-value="A" onclick="selectCell(this, 7, 'A')"></td>
                                            <td class="clickable-cell" data-question="7" data-value="B" onclick="selectCell(this, 7, 'B')"></td>
                                            <td class="clickable-cell" data-question="7" data-value="C" onclick="selectCell(this, 7, 'C')"></td>
                                            <td class="clickable-cell" data-question="7" data-value="D" onclick="selectCell(this, 7, 'D')"></td>
                                            <td class="clickable-cell" data-question="7" data-value="E" onclick="selectCell(this, 7, 'E')"></td>
                                            <td class="clickable-cell" data-question="7" data-value="F" onclick="selectCell(this, 7, 'F')"></td>
                                            <td class="clickable-cell" data-question="7" data-value="G" onclick="selectCell(this, 7, 'G')"></td>
                                        </tr>
                                        <tr>
                                            <td class="statement">8. Expectations of end-users of agricultural products affect the products.</td>
                                            <td class="clickable-cell" data-question="8" data-value="A" onclick="selectCell(this, 8, 'A')"></td>
                                            <td class="clickable-cell" data-question="8" data-value="B" onclick="selectCell(this, 8, 'B')"></td>
                                            <td class="clickable-cell" data-question="8" data-value="C" onclick="selectCell(this, 8, 'C')"></td>
                                            <td class="clickable-cell" data-question="8" data-value="D" onclick="selectCell(this, 8, 'D')"></td>
                                            <td class="clickable-cell" data-question="8" data-value="E" onclick="selectCell(this, 8, 'E')"></td>
                                            <td class="clickable-cell" data-question="8" data-value="F" onclick="selectCell(this, 8, 'F')"></td>
                                            <td class="clickable-cell" data-question="8" data-value="G" onclick="selectCell(this, 8, 'G')"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                                </div>

                        <div class="question" data-q-start="9" data-q-end="13">
                            <div class="question-prompt">
                                <p><strong>Questions 9-13</strong></p>
                                <p>Do the following statements agree with the information given in Reading Passage 1?</p>
                                <p>In boxes 9-13 on your answer sheet, write</p>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><strong>YES</strong> if the statement is true</li>
                                    <li><strong>NO</strong> if the statement is false</li>
                                    <li><strong>NOT GIVEN</strong> if the information is not given in the passage</li>
                                </ul>
                            </div>
                            <div class="tf-question" data-q-start="9" data-q-end="9">
                                <div class="tf-question-line"><span class="tf-question-number">9</span><span class="tf-question-text">Integrated Pest Management has generally been regarded as a success across the US.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q9" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q9" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q9" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="10" data-q-end="10">
                                <div class="tf-question-line"><span class="tf-question-number">10</span><span class="tf-question-text">Oregon farmers of apples and pears have been promoted as successful examples of Integrated Pest Management.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q10" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q10" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q10" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="11" data-q-end="11">
                                <div class="tf-question-line"><span class="tf-question-number">11</span><span class="tf-question-text">The IPPC uses scientists from different organisations globally.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q11" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q11" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q11" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="12" data-q-end="12">
                                <div class="tf-question-line"><span class="tf-question-number">12</span><span class="tf-question-text">Straw mulch experiments produced unplanned benefits.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q12" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q12" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q12" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="13" data-q-end="13">
                                <div class="tf-question-line"><span class="tf-question-number">13</span><span class="tf-question-text">The apple industry is now facing a lot of competition from abroad.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q13" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q13" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q13" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                        </div>

                        
                    </div>
                </div>
                <div id="questions-2" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="14" data-q-end="20">
                            <div class="question-prompt">
                                <p><strong>Questions 14-20</strong></p>
                                <p>Drag the correct heading (<strong>i–xi</strong>) onto the drop-zone above each paragraph in the passage.</p>
                                <div class="drag-options-container recommendations-box" data-dnd-group="p2-14-20">
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="i"><strong>i</strong> The competitors with the dinosaur</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="ii"><strong>ii</strong> A historical event for the Supreme survivors</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="iii"><strong>iii</strong> What makes the crocodile the fastest running animal on land</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="iv"><strong>iv</strong> Regulated body temperature by the surrounding environment</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="v"><strong>v</strong> Underwater aid in body structure offered to a successful predator</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="vi"><strong>vi</strong> The perfectly designed body for a great land roamer</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="vii"><strong>vii</strong> Slow metabolisms which makes crocodile a unique reptile</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="viii"><strong>viii</strong> The favorable features in the impact of a drought</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="ix"><strong>ix</strong> Shifting Eating habits and food intake</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="x"><strong>x</strong> A project on a special mechanism</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p2-14-20" data-value="xi"><strong>xi</strong> A unique findings has been achieved recently</div>
                                </div>
                            </div>
                        </div>

                        <div class="question" data-q-start="21" data-q-end="26">
                            <div class="question-prompt">
                                <p><strong>Questions 21-26</strong></p>
                                <p>Complete the summary and write the correct answer (<strong>NO MORE THAN TWO WORDS OR A NUMBER</strong>) in boxes 21-26 on your answer sheet.</p>
                            </div>
                            <div class="summary-text">
                                <p>In many places inhabited by crocodilians, most types of the crocodile have evolved a successful scheme to survive in the drought brought by a <input type="text" class="answer-input" id="q21" placeholder="21">. According to Kennett and Christian’s six-year study of Australian freshwater crocodiles’ aestivation, they found Aestivating crocodiles spent around <input type="text" class="answer-input" id="q22" placeholder="22"> a year without access to <input type="text" class="answer-input" id="q23" placeholder="23">. The absolute size of body water pools declined proportionately with <input type="text" class="answer-input" id="q24" placeholder="24">; thus there is no sign of <input type="text" class="answer-input" id="q25" placeholder="25"> and other health-damaging impact in the crocodiles even after an aestivation period. This super capacity helps crocodiles endure the tough drought without slowing their speed of <input type="text" class="answer-input" id="q26" placeholder="26"> significantly.</p>
                            </div>
                        </div>

                        <!-- Removed duplicate MCQ block for Questions 25-26 to avoid ID/name conflicts with summary (21-26) -->
                                    </div>
                                </div>
                <div id="questions-3" class="question-set hidden">
                    <div class="questions-container">
                        <div class="question" data-q-start="27" data-q-end="29">
                            <div class="question-prompt">
                                <p><strong>Questions 27-29</strong></p>
                                <p>Choose the correct answer.</p>
                            </div>
                            <div class="multi-choice-question" data-q-start="27" data-q-end="27">
                                <div class="question-prompt"><p><strong>27</strong> When the writer describes the impact of monumental ruins today, he emphasizes</p></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q27" value="A"> the income they generate from tourism.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q27" value="B"> the area of land they occupy.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q27" value="C"> their archaeological value.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q27" value="D"> their romantic appeal.</label></div>
                            </div>
                            <div class="multi-choice-question" data-q-start="28" data-q-end="28">
                                <div class="question-prompt"><p><strong>28</strong> Recent findings concerning vanished civilisations</p></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q28" value="A"> have overturned long-held beliefs.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q28" value="B"> caused controversy amongst scientists.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q28" value="C"> come from a variety of disciplines.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q28" value="D"> identified one main cause of environmental damage.</label></div>
                        </div>
                            <div class="multi-choice-question" data-q-start="29" data-q-end="29">
                                <div class="question-prompt"><p><strong>29</strong> What does the writer say about ways in which former societies collapsed?</p></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q29" value="A"> The pace of decline was usually similar.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q29" value="B"> The likelihood of collapse would have been foreseeable.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q29" value="C"> Deterioration invariably led to total collapse.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q29" value="D"> Individual citizens could sometimes influence the course of events.</label></div>
                    </div>
                </div>

                        <div class="question" data-q-start="30" data-q-end="34">
                            <div class="question-prompt">
                                <p><strong>Questions 30-34</strong></p>
                                <p>Do the following statements agree with the views of the writer in Reading Passage?</p>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><strong>YES</strong> if the statement agrees with the claims of the writer</li>
                                    <li><strong>NO</strong> if the statement contradicts the claims of the writer</li>
                                    <li><strong>NOT GIVEN</strong> if it is impossible to say what the writer thinks about this</li>
                                </ul>
                            </div>
                            <div class="tf-question" data-q-start="30" data-q-end="30">
                                <div class="tf-question-line"><span class="tf-question-number">30</span><span class="tf-question-text">It is widely believed that environmental problems represent the main danger faced by the modern world.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q30" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q30" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q30" value="NOT GIVEN"> NOT GIVEN</label>
                            </div>
                        </div>
                            <div class="tf-question" data-q-start="31" data-q-end="31">
                                <div class="tf-question-line"><span class="tf-question-number">31</span><span class="tf-question-text">The accumulation of poisonous substances is a relatively modern problem.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q31" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q31" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q31" value="NOT GIVEN"> NOT GIVEN</label>
                            </div>
                            </div>
                            <div class="tf-question" data-q-start="32" data-q-end="32">
                                <div class="tf-question-line"><span class="tf-question-number">32</span><span class="tf-question-text">There is general agreement that the threats posed by environmental problems are very serious.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q32" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q32" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q32" value="NOT GIVEN"> NOT GIVEN</label>
                            </div>
                            </div>
                            <div class="tf-question" data-q-start="33" data-q-end="33">
                                <div class="tf-question-line"><span class="tf-question-number">33</span><span class="tf-question-text">Some past societies resembled present-day societies more closely than others.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q33" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q33" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q33" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="34" data-q-end="34">
                                <div class="tf-question-line"><span class="tf-question-number">34</span><span class="tf-question-text">We should be careful when drawing comparisons between past and present.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q34" value="YES"> YES</label>
                                    <label class="tf-option"><input type="radio" name="q34" value="NO"> NO</label>
                                    <label class="tf-option"><input type="radio" name="q34" value="NOT GIVEN"> NOT GIVEN</label>
                            </div>
                            </div>
                            </div>

                        <div class="question" data-q-start="35" data-q-end="39">
                            <div class="question-prompt">
                                <p><strong>Questions 35-39</strong></p>
                                <p>Complete each sentence with the correct ending, <strong>A–F</strong>, below.</p>
                                <p>Drag the correct letter <strong>A–F</strong> into boxes <strong>35–39</strong>.</p>
                            </div>
                            <div class="drag-drop-container">
                                <div class="matching-questions">
                                    <div class="matching-question-item" data-q-start="35" data-q-end="35">
                                        <span>Evidence of the greatness of some former civilisations</span>
                                        <div class="drop-zone" data-dnd-group="p3-35-39" data-q-start="35">35</div>
                                    </div>
                                    <div class="matching-question-item" data-q-start="36" data-q-end="36">
                                        <span>The parallel between an individual’s life and the life of a society</span>
                                        <div class="drop-zone" data-dnd-group="p3-35-39" data-q-start="36">36</div>
                                    </div>
                                    <div class="matching-question-item" data-q-start="37" data-q-end="37">
                                        <span>The number of environmental problems that societies face</span>
                                        <div class="drop-zone" data-dnd-group="p3-35-39" data-q-start="37">37</div>
                                    </div>
                                    <div class="matching-question-item" data-q-start="38" data-q-end="38">
                                        <span>The power of technology</span>
                                        <div class="drop-zone" data-dnd-group="p3-35-39" data-q-start="38">38</div>
                                    </div>
                                    <div class="matching-question-item" data-q-start="39" data-q-end="39">
                                        <span>A consideration of historical events and trends</span>
                                        <div class="drop-zone" data-dnd-group="p3-35-39" data-q-start="39">39</div>
                                    </div>
                                </div>
                                <div class="drag-options-container recommendations-box" data-dnd-group="p3-35-39">
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-35-39" data-value="A"><strong>A</strong> is not necessarily valid.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-35-39" data-value="B"><strong>B</strong> provides grounds for an optimistic outlook.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-35-39" data-value="C"><strong>C</strong> exists in the form of physical structures.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-35-39" data-value="D"><strong>D</strong> is potentially both positive and negative.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-35-39" data-value="E"><strong>E</strong> will not provide direct solutions for present problems.</div>
                                    <div class="drag-item" draggable="true" data-dnd-group="p3-35-39" data-value="F"><strong>F</strong> is greater now than in the past.</div>
                                </div>
                            </div>
                        </div>

                        <div class="question" data-q-start="40" data-q-end="40">
                            <div class="question-prompt">
                                <p><strong>Question 40</strong></p>
                                <p>Choose the correct answer.</p>
                            </div>
                            <div class="multi-choice-question" data-q-start="40" data-q-end="40">
                                <div class="question-prompt"><p><strong>40</strong> What is the main argument of Reading Passage 3?</p></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q40" value="A"> There are differences as well as similarities between past and present societies.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q40" value="B"> More should be done to preserve the physical remains of earlies civilisations.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q40" value="C"> Some historical accounts of great civilisations are inaccurate.</label></div>
                                <div class="multi-choice-option"><label><input type="radio" name="q40" value="D"> Modern societies are dependent on each other for their continuing survival.</label></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Arrows -->
    <div class="nav-arrows">
        <button class="nav-arrow prev" onclick="previousQuestion()" id="prevBtn" aria-label="Previous question">
            <!-- Left arrow icon -->
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
        <button class="nav-arrow next" onclick="nextQuestion()" id="nextBtn" aria-label="Next question">
            <!-- Right arrow icon -->
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-row perScorableItem" aria-label="Questions">
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(1)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">1</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(1)"><span class="sr-only">Question 1</span><span aria-hidden="true">1</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(2)"><span class="sr-only">Question 2</span><span aria-hidden="true">2</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(3)"><span class="sr-only">Question 3</span><span aria-hidden="true">3</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(4)"><span class="sr-only">Question 4</span><span aria-hidden="true">4</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(5)"><span class="sr-only">Question 5</span><span aria-hidden="true">5</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(6)"><span class="sr-only">Question 6</span><span aria-hidden="true">6</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(7)"><span class="sr-only">Question 7</span><span aria-hidden="true">7</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(8)"><span class="sr-only">Question 8</span><span aria-hidden="true">8</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(9)"><span class="sr-only">Question 9</span><span aria-hidden="true">9</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(10)"><span class="sr-only">Question 10</span><span aria-hidden="true">10</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(11)"><span class="sr-only">Question 11</span><span aria-hidden="true">11</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(12)"><span class="sr-only">Question 12</span><span aria-hidden="true">12</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(13)"><span class="sr-only">Question 13</span><span aria-hidden="true">13</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 selected multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(2)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">2</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 13</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(14)"><span class="sr-only">Question 14</span><span aria-hidden="true">14</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(15)"><span class="sr-only">Question 15</span><span aria-hidden="true">15</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(16)"><span class="sr-only">Question 16</span><span aria-hidden="true">16</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(17)"><span class="sr-only">Question 17</span><span aria-hidden="true">17</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(18)"><span class="sr-only">Question 18</span><span aria-hidden="true">18</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(19)"><span class="sr-only">Question 19</span><span aria-hidden="true">19</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(20)"><span class="sr-only">Question 20</span><span aria-hidden="true">20</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(21)"><span class="sr-only">Question 21</span><span aria-hidden="true">21</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(22)"><span class="sr-only">Question 22</span><span aria-hidden="true">22</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(23)"><span class="sr-only">Question 23</span><span aria-hidden="true">23</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(24)"><span class="sr-only">Question 24</span><span aria-hidden="true">24</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(25)"><span class="sr-only">Question 25</span><span aria-hidden="true">25</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(26)"><span class="sr-only">Question 26</span><span aria-hidden="true">26</span></button>
            </div>
        </div>
        
        <div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
            <button role="tab" class="footer__questionNo___3WNct" onclick="switchToPart(3)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">3</span>
                    <span class="attemptedCount" aria-hidden="true">0 of 14</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper___9GgoP">
                <button class="subQuestion scorable-item" onclick="goToQuestion(27)"><span class="sr-only">Question 27</span><span aria-hidden="true">27</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(28)"><span class="sr-only">Question 28</span><span aria-hidden="true">28</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(29)"><span class="sr-only">Question 29</span><span aria-hidden="true">29</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(30)"><span class="sr-only">Question 30</span><span aria-hidden="true">30</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(31)"><span class="sr-only">Question 31</span><span aria-hidden="true">31</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(32)"><span class="sr-only">Question 32</span><span aria-hidden="true">32</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(33)"><span class="sr-only">Question 33</span><span aria-hidden="true">33</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(34)"><span class="sr-only">Question 34</span><span aria-hidden="true">34</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(35)"><span class="sr-only">Question 35</span><span aria-hidden="true">35</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(36)"><span class="sr-only">Question 36</span><span aria-hidden="true">36</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(37)"><span class="sr-only">Question 37</span><span aria-hidden="true">37</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(38)"><span class="sr-only">Question 38</span><span aria-hidden="true">38</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(39)"><span class="sr-only">Question 39</span><span aria-hidden="true">39</span></button>
                <button class="subQuestion scorable-item" onclick="goToQuestion(40)"><span class="sr-only">Question 40</span><span aria-hidden="true">40</span></button>
            </div>
        </div>
        
        <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton___3FM07">
            <i class="fa fa fa-check" aria-hidden="true"></i>
            <span>Check Answers</span>
        </button>
    </nav>

    <!-- Mobile Bottom Bar -->
    <div class="mobile-bottom-bar" aria-label="Mobile Controls">
        <button class="mobile-btn" onclick="previousQuestion()">Prev</button>
        <div style="display:flex; align-items:center; gap:8px;">
            <button class="mobile-btn" onclick="switchToPart(1)">P1</button>
            <button class="mobile-btn" onclick="switchToPart(2)">P2</button>
            <button class="mobile-btn" onclick="switchToPart(3)">P3</button>
        </div>
        <div style="display:flex; align-items:center; gap:8px;">
            <button class="mobile-btn" onclick="nextQuestion()">Next</button>
            <button class="mobile-btn" onclick="(function(){var b=document.getElementById('deliver-button'); if(b){b.click();}})()">Check</button>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div id="menu-highlight" class="context-menu-item" onclick="highlightText()">
            Highlight
        </div>
        <div id="menu-note" class="context-menu-item" onclick="addNote()">
            Note
        </div>
        <div id="menu-clear" class="context-menu-item" onclick="clearHighlight()">
            Clear
        </div>
        <div id="menu-clear-all" class="context-menu-item" onclick="clearAllHighlights()">
            Clear All
        </div>
    </div>

    <div id="results-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closeResultsModal()">&times;</button>
            <h2>Results</h2>
            <div class="results-summary">
                <p>Score: <span id="results-score"></span> / 40</p>
                <p>IELTS Band: <span id="results-band"></span></p>
            </div>
            <div id="results-details" class="results-details-container">
                <!-- Results for each question will be injected here -->
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- STATE VARIABLES ---
        let currentPassage = 1;
        let currentQuestion = 1;
        let selectedRange = null;
        let timeInSeconds = 3600;
        let timerInterval;
        let draggedItem = null;
        let activeQuestionElement = null;
        let selectedDragItem = null;

        // --- GLOBAL FUNCTIONS ---
        function getFirstQuestionOfPart(part) {
            switch(part) {
                case 1: return 1;
                case 2: return 14;
                case 3: return 27;
                default: return 1;
            }
        }

        // --- DOM ELEMENTS ---
        const timerDisplay = document.querySelector('.timer-display');
        const timerToggleButton = document.getElementById('timer-toggle-btn');
        const timerResetButton = document.getElementById('timer-reset-btn');
        const deliverButton = document.getElementById('deliver-button');
        const resizer = document.getElementById('resizer');
        const passagePanel = document.getElementById('passage-panel');
        const questionsPanel = document.getElementById('questions-panel');
        const contextMenu = document.getElementById('contextMenu');

        // --- Replace Part 1 content and questions with 'Plain English Campaign' ---
        try {
            const passage1El = document.getElementById('passage-text-1');
            if (passage1El) {
                passage1El.innerHTML = `
                    <h4 class="text-center">Plain English Campaign</h4>
                    <p><strong>A</strong>&nbsp;&nbsp;We launched Plain English Campaign in 1979 with a ritual shredding of appalling government and municipal council forms in Parliament Square, London. We had become so fed up of people visiting our advice centre in Salford, Greater Manchester, to complain about incomprehensible forms that we thought we ought to take action. At the time the shredding seemed like merely throwing sand in the eyes of the charging lion, but it briefly caught the public imagination and left an impression on government and business. Although we’re pleased with the new plain English awareness in government departments, many local councils and businesses maintain a stout resistance to change. One council began a letter to its tenants about a rent increase with two sentences averaging 95 words, full of bizarre housing finance jargon and waffle about Acts of Parliament. The London Borough of Ealing sent such an incomprehensible letter to ISO residents that 40 of them wrote or telephoned to complain and ask for clarification. Many were upset and frightened that the council was planning to imprison them if they didn’t fill in the accompanying form. In fact, the letter meant nothing of the sort, and the council had to send another letter to explain.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;Plain legal English can be used as a marketing tactic. Provincial Insurance issued their plain English Home Cover policy in 1983 and sold it heavily as such. In the first 18 months, its sales rocketed, drawing in about an extra £1.5 million of business. Recently, the Eagle Star Group launched a plain English policy to a chorus of congratulatory letters from policyholders. People, it seems, prefer to buy a policy they can understand.</p>
                    <p><strong>C</strong>&nbsp;&nbsp;Two kinds of instructions give us a lot of concern – medical labels and do-it-yourself products. With medical labels, there is a serious gap between what the professionals think is clear and what is really clear to patients. A survey by pharmacists Raynor and Sillito found that 31% of patients misunderstood the instruction on eye drops ‘To be instilled’, while 33% misunderstood ‘Use sparingly’. The instruction ‘Take two tablets 4 hourly’ is so prone to misunderstanding (for example, as 8 tablets an hour) that we think it should be banned. Unclear instructions on do-it-yourself products cause expense and frustration to customers. Writing the necessary instructions for these products is usually entrusted to someone who knows the product inside out, yet the best qualification for writing instructions is ignorance. The writer is then like a first-time user, discovering how to use the product in a step-by-step way. Instructions never seem to be tested with first-time users before being issued. So vital steps are missed out or components are mislabeled or not labelled at all. For example, the instructions for assembling a sliding door gear say: ‘The pendant bolt centres are fixed and should be at an equal distance from the centre of the door.’ This neglects to explain who should do the fixing and how the bolt centres will get into the correct position. By using an imperative and an active verb the instruction becomes much clearer: ‘Make sure you fix the centres of the pendant bolts at an equal distance from the centre of the door.’</p>
                    <p><strong>D</strong>&nbsp;&nbsp;Effectively, the Plain English movement in the US began with President Jimmy Carter’s Executive Order 12044 of 23 March 1978, that required regulations to be written in plain language. There were earlier government efforts to inform consumers about their rights and obligations, such as the Truth in Lending Act (1969) and the Fair Credit Billing Act (1975), which emphasized a body of information that consumers need in simple language. But President Carter’s executive order gave the prestige and force of a president to the movement. All over the country isolated revolts or efforts against legalistic gobbledygook at the federal, state and corporate levels seemed to grow into a small revolution. These efforts and advances between the years 1978 and 1985 are described in the panel ‘The Plain English Scorecard’.</p>
                    <p><strong>E</strong>&nbsp;&nbsp;The Bastille has not fallen yet. The forces of resistance are strong, as one can see from the case of Pennsylvania as cited in the Scorecard. In addition, President Ronald Reagan’s executive order of 19 February 1981, revoking President Carter’s earlier executive order, has definitely slowed the pace of plain English legislation in the United States. There are three main objections to the idea of plain English. They are given below, with the campaign’s answer to them:</p>
                    <p><strong>F</strong>&nbsp;&nbsp;The statute would cause unending litigation and clog the courts. Simply not true in all the ten states with plain English laws for consumer contracts and the 34 states with laws or regulations for insurance policies. Since 1978 when plain English law went into effect in New York there have been only four litigations and only two decisions. Massachusetts had zero cases. The cost of compliance would be enormous. Translation of legal contracts into non-legal everyday language would be a waste of time and money. The experience of several corporations has proved that the cost of compliance is often outweighed by solid benefits and litigation savings. Citibank of New York made history in 1975 by introducing a simplified promissory note and afterwards simplified all their forms. Citibank counsel Carl Falsenfield says: ‘We have lost no money and there has been no litigation as a result of simplification.’ The cost-effectiveness of clarity is demonstrable. A satisfied customer more readily signs on the bottom line and thus contributes to the corporation’s bottom line. Some documents simply can’t be simplified. The only legal language that has been tested for centuries in the courts is precise enough to deal with a mortgage, a deed, a lease, or an insurance policy. Here, too, the experience of several corporations and insurance companies has proved that contracts and policies can be made more understandable without sacrificing legal effectiveness.</p>
                    <p><strong>G</strong>&nbsp;&nbsp;What does the future hold for the Plain English movement? Today, American consumers are buffeted by an assortment of pressures. Never before have consumers had as many choices in areas like financial services, travel, telephone services, and supermarket products. There are about 300 long-distance phone companies in the US. Not long ago, the average supermarket carried 9,000 items; today, it carries 22,000. More importantly, this expansion of options – according to a recent report – is faced by a staggering 30 million Americans lacking the reading skills to handle the minimal demands of daily living. The consumer’s need, therefore, for information expressed in plain English is more critical than ever.</p>
                    <p><strong>H</strong>&nbsp;&nbsp;What is needed today is not a brake on the movement’s momentum but another push toward plain English contracts from consumers. I still hear plain English on the TV and in the streets, and read plain English in popular magazines and best-sellers, but not yet in many functional documents. Despite some victories, the war against gobbledygook is not over yet. We do well to remember the warning of Chrissie Maher, organizer of Plain English Campaign in the UK: ‘People are not just injured when medical labels are written in gobbledygook – they die. Drivers are not just hurt when their medicines don’t tell them they could fall asleep at the wheel – they are killed.’</p>
                `;
            }

            const questions1El = document.getElementById('questions-1');
            if (questions1El) {
                questions1El.innerHTML = `
                    <div class="questions-container">
                        <div class="question" data-q-start="1" data-q-end="6">
                            <div class="question-prompt">
                                <p><strong>Questions 1-6</strong></p>
                                <p>Do the following statements agree with the information given in Reading Passage 1?</p>
                                <p>In boxes 1-6 on your answer sheet, write</p>
                                <ul style="list-style: none; padding-left: 0;">
                                    <li><strong>TRUE</strong> if the statement is true</li>
                                    <li><strong>FALSE</strong> if the statement is false</li>
                                    <li><strong>NOT GIVEN</strong> if the information is not given in the passage</li>
                                </ul>
                            </div>
                            <div class="tf-question" data-q-start="1" data-q-end="1">
                                <div class="tf-question-line"><span class="tf-question-number">1</span><span class="tf-question-text">In marketing area, the spread of Plain English can generate economic benefit.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q1" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q1" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q1" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="2" data-q-end="2">
                                <div class="tf-question-line"><span class="tf-question-number">2</span><span class="tf-question-text">Because doctors tend to use jargon when they talk with patients, thereafter many patients usually get confused with medicine dose.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q2" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q2" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q2" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="3" data-q-end="3">
                                <div class="tf-question-line"><span class="tf-question-number">3</span><span class="tf-question-text">After successive election over U.S president Jimmy Carter, the effect of Plain English Campaign is less distinctive than that of the previous one.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q3" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q3" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q3" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="4" data-q-end="4">
                                <div class="tf-question-line"><span class="tf-question-number">4</span><span class="tf-question-text">The Plain English campaigner has a problem of talking with the officials.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q4" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q4" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q4" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="5" data-q-end="5">
                                <div class="tf-question-line"><span class="tf-question-number">5</span><span class="tf-question-text">Work check is made regularly by the judge in the court scenario.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q5" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q5" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q5" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                            <div class="tf-question" data-q-start="6" data-q-end="6">
                                <div class="tf-question-line"><span class="tf-question-number">6</span><span class="tf-question-text">Compared with the situation of the past, consumers are now facing less intensity of label reading pressure in a supermarket in America.</span></div>
                                <div class="tf-options">
                                    <label class="tf-option"><input type="radio" name="q6" value="TRUE"> TRUE</label>
                                    <label class="tf-option"><input type="radio" name="q6" value="FALSE"> FALSE</label>
                                    <label class="tf-option"><input type="radio" name="q6" value="NOT GIVEN"> NOT GIVEN</label>
                                </div>
                            </div>
                        </div>

                        <div class="question" data-q-start="7" data-q-end="13">
                            <div class="question-prompt">
                                <p><strong>Questions 7-13</strong></p>
                                <p>Complete the following summary of the paragraphs of Reading Passage.</p>
                                <p>Using <strong>NO MORE THAN THREE WORDS</strong> from the Reading Passage for each answer.</p>
                            </div>
                            <div class="summary-text">
                                <p>Campaigners experienced a council renting document full of strange <input type="text" class="answer-input" id="q7" placeholder="7"> of housing in terms of an Act. They are anxious in some other field, for instance, when reading a label of medicine, there was an obvious <input type="text" class="answer-input" id="q8" placeholder="8"> for patients.</p>
                                <p>Another notable field was on <input type="text" class="answer-input" id="q9" placeholder="9"> products, it not only additionally cost buyers but caused <input type="text" class="answer-input" id="q10" placeholder="10">, thus writer should regard himself as a <input type="text" class="answer-input" id="q11" placeholder="11">. However, oppositions against the Plain English Campaign under certain circumstances, e.g. <input type="text" class="answer-input" id="q12" placeholder="12"> language had been embellished as an accurate language used in the <input type="text" class="answer-input" id="q13" placeholder="13">.</p>
                            </div>
                        </div>
                    </div>
                `;
            }
        } catch (e) {
            console.warn('Failed to inject Plain English Campaign content:', e);
        }

        // --- Replace Part 2 content and questions with 'Follow your nose' ---
        try {
            const passage2El = document.getElementById('passage-text-2');
            if (passage2El) {
                passage2El.innerHTML = `
                    <h4 class="text-center">Follow your nose</h4>
                    <p><strong>A</strong>&nbsp;&nbsp;Aromatherapy is the most widely used complementary therapy in the National Health Service, and doctors use it most often for treating dementia. For elderly patients who have difficulty interacting verbally, and to whom conventional medicine has little to offer, aromatherapy can bring benefits in terms of better sleep, improved motivation, and less disturbed behaviour. So the thinking goes. But last year, a systematic review of health care databases found almost no evidence that aromatherapy is effective in the treatment of dementia. Other findings suggest that aromatherapy works only if you believe it will. In fact, the only research that has unequivocally shown it to have an effect has been carried out on animals.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;Behavioural studies have consistently shown that odours elicit emotional memories far more readily than other sensory cues. And earlier this year, Rachel Herz, of Brown University in Providence, Rhode Island, and colleagues peered into people’s heads using functional Magnetic Resonance Imaging (fMRI) to corroborate that. They scanned the brains of five women while they either looked at a photo of a bottle of perfume that evoked a pleasant memory for them, or smelled that perfume. One woman, for instance, remembered how as a child living in Paris—she would watch with excitement as her mother dressed to go out and sprayed herself with that perfume. The women themselves described the perfume as far more evocative than the photo, and Herz and co-workers found that the scent did indeed activate the amygdala and other brain regions associated with emotion processing far more strongly than the photograph. But the interesting thing was that the memory itself was no better recalled by the odour than by the picture. “People don’t remember any more detail or with any more clarity when the memory is recalled with an odour,” she says. “However, with the odour, you have this intense emotional feeling that’s really visceral.”</p>
                    <p><strong>C</strong>&nbsp;&nbsp;That’s hardly surprising, Herz thinks, given how the brain has evolved. “The way I like to think about it is that emotion and olfaction are essentially the same things,” she says. “The part of the brain that controls emotion literally grew out of the part of the brain that controls smell.” That, she says, probably explains why memories for odours that are associated with intense emotions are so strongly entrenched in us, because the smell was initially a survival skill: a signal to approach or to avoid.</p>
                    <p><strong>D</strong>&nbsp;&nbsp;Eric Vermetten, a psychiatrist at the University of Utrecht in the Netherlands, says that doctors have long known about the potential of smells to act as traumatic reminders, but the evidence has been largely anecdotal. Last year, he and others set out to document it by describing three cases of post-traumatic stress disorder (PTSD) in which patients reported either that a certain smell triggered their flashbacks, or that smell was a feature of the flashback itself. The researchers concluded that odours could be made use of in exposure therapy, or for reconditioning patients’ fear responses.</p>
                    <p><strong>E</strong>&nbsp;&nbsp;After Vermetten presented his findings at a conference, doctors in the audience told him how they had turned this association around and put it to good use. PTSD patients often undergo group therapy, but the therapy itself can expose them to traumatic reminders. “Some clinicians put a strip of vanilla or a strong, pleasant, everyday odorant such as coffee under their patients’ noses, so that they have this continuous olfactory stimulation,” says Vermetten. So armed, the patients seem to be better protected against flashbacks. It’s purely anecdotal, and nobody knows what’s happening in the brain, says Vermetten, but it’s possible that the neural pathways by which the odour elicits the pleasant, everyday memory override the fear-conditioned neural pathways that respond to verbal cues.</p>
                    <p><strong>F</strong>&nbsp;&nbsp;According to Herz, the therapeutic potential of odours could lie in their very unreliability. She has shown with her perfume-bottle experiment that they don’t guarantee any better recall, even if the memories they elicit feel more real. And there’s plenty of research to show that our noses can be tricked, because being predominantly visual and verbal creatures, we put more faith in those other modalities. In 2001, for instance, Gil Morrot, of the National Institute for Agronomic Research in Montpellier, tricked 54 oenology students by secretly colouring a white wine with an odourless red dye just before they were asked to describe the odours of a range of red and white wines. The students described the coloured wine using terms typically reserved for red wines. What’s more, just like experts, they used terms alluding to the wine’s redness and darkness—visual rather than olfactory qualities. Smell, the researchers concluded, cannot be separated from the other senses.</p>
                    <p><strong>G</strong>&nbsp;&nbsp;Last July, Jay Gottfried and Ray Dolan of the Wellcome Department of Imaging Neuroscience in London took that research a step further when they tested people’s response times in naming an odour, either when presented with an image that was associated with the odour or one that was not. So, they asked them to sniff vanilla and simultaneously showed them either a picture of ice cream or of cheese, while scanning their brains in a fMRI machine. People named the smells faster when the picture showed something semantically related to them, and when that happened, a structure called the hippocampus was strongly activated. The researchers’ interpretation was that the hippocampus plays a role in integrating information from the senses— information that the brain then uses to decide what it is perceiving.</p>
                `;
            }

            const questions2El = document.getElementById('questions-2');
            if (questions2El) {
                questions2El.innerHTML = `
                    <div class=\"questions-container\">
                        <div class=\"question\" data-q-start=\"14\" data-q-end=\"18\">
                            <div class=\"question-prompt\">
                                <p><strong>Questions 14-18</strong></p>
                                <p>Reading Passage 2 has seven paragraphs, A-G</p>
                                <p>Choose the correct heading for paragraph A, C-E and G from the list of headings below.</p>
                                <p>Write the correct number i-ix in boxes 14-18 on your answer sheet.</p>
                                <ul style=\"list-style: none; padding-left: 0;\">
                                    <li>i Remembering the past more clearly</li>
                                    <li>ii Bringing back painful memories</li>
                                    <li>iii Originally an alarm signal</li>
                                    <li>iv The physical effects of scent versus image</li>
                                    <li>v Checking unreliable evidence</li>
                                    <li>vi Reinforcing one sense with another</li>
                                    <li>vii Protection against reliving the past</li>
                                    <li>viii The overriding power of sight and sound</li>
                                    <li>ix Conflicting views</li>
                                </ul>
                            </div>
                            <div class=\"answer-inputs\">
                                <label>14 Paragraph A
                                    <select id=\"q14\">
                                        <option value=\"\"></option>
                                        <option>i</option><option>ii</option><option>iii</option><option>iv</option><option>v</option><option>vi</option><option>vii</option><option>viii</option><option>ix</option>
                                    </select>
                                </label>
                                <label>15 Paragraph C
                                    <select id=\"q15\">
                                        <option value=\"\"></option>
                                        <option>i</option><option>ii</option><option>iii</option><option>iv</option><option>v</option><option>vi</option><option>vii</option><option>viii</option><option>ix</option>
                                    </select>
                                </label>
                                <label>16 Paragraph D
                                    <select id=\"q16\">
                                        <option value=\"\"></option>
                                        <option>i</option><option>ii</option><option>iii</option><option>iv</option><option>v</option><option>vi</option><option>vii</option><option>viii</option><option>ix</option>
                                    </select>
                                </label>
                                <label>17 Paragraph E
                                    <select id=\"q17\">
                                        <option value=\"\"></option>
                                        <option>i</option><option>ii</option><option>iii</option><option>iv</option><option>v</option><option>vi</option><option>vii</option><option>viii</option><option>ix</option>
                                    </select>
                                </label>
                                <label>18 Paragraph G
                                    <select id=\"q18\">
                                        <option value=\"\"></option>
                                        <option>i</option><option>ii</option><option>iii</option><option>iv</option><option>v</option><option>vi</option><option>vii</option><option>viii</option><option>ix</option>
                                    </select>
                                </label>
                            </div>
                        </div>

                        <div class=\"question\" data-q-start=\"19\" data-q-end=\"24\">
                            <div class=\"question-prompt\">
                                <p><strong>Questions 19–24</strong></p>
                                <p>Match each finding with the correct researcher by clicking a cell in the table.</p>
                                <p><strong>Researchers</strong>: <br><strong>A</strong> Rachel Herz &nbsp; <br><strong>B</strong> Eric Vermetten &nbsp; <br><strong>C</strong> Gil Morrot &nbsp; <br><strong>D</strong> Jay Gottfried and Ray Dolan</p>
                            </div>
                            <div class=\"table-container\">
                                <table class=\"matching-table\">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>A</th>
                                            <th>B</th>
                                            <th>C</th>
                                            <th>D</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class=\"statement\">19. Smell can trigger images of horrible events.</td>
                                            <td class=\"clickable-cell\" data-question=\"19\" data-value=\"A\" onclick=\"selectCell(this, 19, 'A')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"19\" data-value=\"B\" onclick=\"selectCell(this, 19, 'B')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"19\" data-value=\"C\" onclick=\"selectCell(this, 19, 'C')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"19\" data-value=\"D\" onclick=\"selectCell(this, 19, 'D')\"></td>
                                        </tr>
                                        <tr>
                                            <td class=\"statement\">20. Memory cannot get sharper by smell.</td>
                                            <td class=\"clickable-cell\" data-question=\"20\" data-value=\"A\" onclick=\"selectCell(this, 20, 'A')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"20\" data-value=\"B\" onclick=\"selectCell(this, 20, 'B')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"20\" data-value=\"C\" onclick=\"selectCell(this, 20, 'C')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"20\" data-value=\"D\" onclick=\"selectCell(this, 20, 'D')\"></td>
                                        </tr>
                                        <tr>
                                            <td class=\"statement\">21. Faster naming with odour + related picture.</td>
                                            <td class=\"clickable-cell\" data-question=\"21\" data-value=\"A\" onclick=\"selectCell(this, 21, 'A')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"21\" data-value=\"B\" onclick=\"selectCell(this, 21, 'B')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"21\" data-value=\"C\" onclick=\"selectCell(this, 21, 'C')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"21\" data-value=\"D\" onclick=\"selectCell(this, 21, 'D')\"></td>
                                        </tr>
                                        <tr>
                                            <td class=\"statement\">22. Pleasant smells counteract unpleasant recollections.</td>
                                            <td class=\"clickable-cell\" data-question=\"22\" data-value=\"A\" onclick=\"selectCell(this, 22, 'A')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"22\" data-value=\"B\" onclick=\"selectCell(this, 22, 'B')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"22\" data-value=\"C\" onclick=\"selectCell(this, 22, 'C')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"22\" data-value=\"D\" onclick=\"selectCell(this, 22, 'D')\"></td>
                                        </tr>
                                        <tr>
                                            <td class=\"statement\">23. Smell cannot be isolated from visual cues.</td>
                                            <td class=\"clickable-cell\" data-question=\"23\" data-value=\"A\" onclick=\"selectCell(this, 23, 'A')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"23\" data-value=\"B\" onclick=\"selectCell(this, 23, 'B')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"23\" data-value=\"C\" onclick=\"selectCell(this, 23, 'C')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"23\" data-value=\"D\" onclick=\"selectCell(this, 23, 'D')\"></td>
                                        </tr>
                                        <tr>
                                            <td class=\"statement\">24. Emotion area is more stimulated by smell than image.</td>
                                            <td class=\"clickable-cell\" data-question=\"24\" data-value=\"A\" onclick=\"selectCell(this, 24, 'A')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"24\" data-value=\"B\" onclick=\"selectCell(this, 24, 'B')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"24\" data-value=\"C\" onclick=\"selectCell(this, 24, 'C')\"></td>
                                            <td class=\"clickable-cell\" data-question=\"24\" data-value=\"D\" onclick=\"selectCell(this, 24, 'D')\"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class=\"question\" data-q-start=\"25\" data-q-end=\"26\">
                            <div class=\"question-prompt\">
                                <p><strong>Questions 25–26</strong></p>
                                <p>Choose the correct answer.</p>
                            </div>
                            <div class=\"multi-choice-question\" data-q-start=\"25\" data-q-end=\"25\">
                                <div class=\"question-prompt\"><p><strong>25</strong> In the article, what is the opinion about the conventional method of aromatherapy?</p></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q25\" value=\"A\"> Aromatherapy is the use of essential oils extracted from plants.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q25\" value=\"B\"> Evidence has proved that aromatherapy is effective in treating dementia.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q25\" value=\"C\"> People who feel aromatherapy is effective to believe it is useful.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q25\" value=\"D\"> Aromatherapy is especially helpful for elderly patients.</label></div>
                            </div>
                            <div class=\"multi-choice-question\" data-q-start=\"26\" data-q-end=\"26\">
                                <div class=\"question-prompt\"><p><strong>26</strong> What is Rachel Hertz’s conclusion?</p></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q26\" value=\"A\"> The area of the brain which activates emotion has the same physiological structure as the part controlling olfaction.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q26\" value=\"B\"> We cannot depend on smell, and people have more confidence in sight and spoken or written words.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q26\" value=\"C\"> Odours can recall real memories even after the perfume-bottle experiment.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q26\" value=\"D\"> Smell has proved its therapeutic effect over a long time span.</label></div>
                            </div>
                        </div>
                    </div>
                `;
            }
        } catch (e) {
            console.warn('Failed to inject Follow your nose content:', e);
        }

        // Build drag-and-drop for Part 2 (Q14-18): drop-zones in passage and options in questions
        function setupPart2DragHeadings() {
            try {
                const passage = document.getElementById('passage-text-2');
                if (passage) {
                    const getParagraphByLetter = (letter) => {
                        const paras = Array.from(passage.querySelectorAll(':scope > p'));
                        return paras.find(p => {
                            const s = p.querySelector('strong');
                            return s && s.textContent.trim() === letter;
                        });
                    };
                    const mapping = { 'A': 14, 'C': 15, 'D': 16, 'E': 17, 'G': 18 };
                    Object.entries(mapping).forEach(([letter, qNum]) => {
                        const para = getParagraphByLetter(letter);
                        if (!para) return;
                        const prev = para.previousElementSibling;
                        if (!(prev && prev.classList && prev.classList.contains('drop-zone') && prev.dataset.qStart === String(qNum))) {
                            const dz = document.createElement('div');
                            dz.className = 'drop-zone';
                            dz.dataset.dndGroup = 'p2-14-18';
                            dz.dataset.qStart = String(qNum);
                            dz.textContent = String(qNum);
                            para.parentNode.insertBefore(dz, para);
                        }
                    });

                    // Insert fixed, non-editable examples: Paragraph B -> iv, Paragraph F -> v
                    const ensureFixedExample = (letter, value) => {
                        const para = getParagraphByLetter(letter);
                        if (!para) return;
                        const prev = para.previousElementSibling;
                        const already = prev && prev.classList && prev.classList.contains('drop-zone') && prev.classList.contains('disabled');
                        if (already) return;
                        const dz = document.createElement('div');
                        dz.className = 'drop-zone filled disabled';
                        dz.style.pointerEvents = 'none';
                        dz.dataset.dndGroup = 'p2-14-18';
                        const pill = document.createElement('div');
                        pill.className = 'drag-item';
                        pill.setAttribute('draggable', 'false');
                        pill.dataset.dndGroup = 'p2-14-18';
                        pill.dataset.value = value;
                        const headingLabels = {
                            'i': 'Remembering the past more clearly',
                            'ii': 'Bringing back painful memories',
                            'iii': 'Originally an alarm signal',
                            'iv': 'The physical effects of scent versus image',
                            'v': 'Checking unreliable evidence',
                            'vi': 'Reinforcing one sense with another',
                            'vii': 'Protection against reliving the past',
                            'viii': 'The overriding power of sight and sound',
                            'ix': 'Conflicting views'
                        };
                        const label = headingLabels[value] || '';
                        pill.innerHTML = `<strong>${value}</strong> ${label}`;
                        dz.appendChild(pill);
                        para.parentNode.insertBefore(dz, para);
                    };
                    ensureFixedExample('B', 'iv');
                    ensureFixedExample('F', 'v');
                }

                const questions2 = document.getElementById('questions-2');
                if (questions2) {
                    const block = questions2.querySelector('.question[data-q-start="14"][data-q-end="18"]');
                    if (block) {
                        block.innerHTML = `
                            <div class="question-prompt">
                                <p><strong>Questions 14-18</strong></p>
                                <p>Drag the correct heading (i–ix) onto the drop-zone above each paragraph in the passage.</p>
                            </div>
                            <div class="drag-options-container recommendations-box" data-dnd-group="p2-14-18">
                                <div class="drag-item" draggable="true" data-dnd-group="p2-14-18" data-value="i"><strong>i</strong> Remembering the past more clearly</div>
                                <div class="drag-item" draggable="true" data-dnd-group="p2-14-18" data-value="ii"><strong>ii</strong> Bringing back painful memories</div>
                                <div class="drag-item" draggable="true" data-dnd-group="p2-14-18" data-value="iii"><strong>iii</strong> Originally an alarm signal</div>
                                <div class="drag-item" draggable="true" data-dnd-group="p2-14-18" data-value="iv"><strong>iv</strong> The physical effects of scent versus image</div>
                                <div class="drag-item" draggable="true" data-dnd-group="p2-14-18" data-value="v"><strong>v</strong> Checking unreliable evidence</div>
                                <div class="drag-item" draggable="true" data-dnd-group="p2-14-18" data-value="vi"><strong>vi</strong> Reinforcing one sense with another</div>
                                <div class="drag-item" draggable="true" data-dnd-group="p2-14-18" data-value="vii"><strong>vii</strong> Protection against reliving the past</div>
                                <div class="drag-item" draggable="true" data-dnd-group="p2-14-18" data-value="viii"><strong>viii</strong> The overriding power of sight and sound</div>
                                <div class="drag-item" draggable="true" data-dnd-group="p2-14-18" data-value="ix"><strong>ix</strong> Conflicting views</div>
                            </div>
                        `;
                    }
                }

                // Bind DnD listeners specifically for this group (avoid double-binding others)
                const bindForGroup = (group) => {
                    document.querySelectorAll(`.drag-item[data-dnd-group="${group}"]`).forEach(item => {
                        if (item.dataset.dndBound === '1') return;
                        item.addEventListener('dragstart', handleDragStart);
                        item.addEventListener('dragend', handleDragEnd);
                        item.addEventListener('click', () => selectDragItem(item));
                        item.dataset.dndBound = '1';
                    });
                    document.querySelectorAll(`.drop-zone, .drag-options-container`).forEach(zone => {
                        const zGroup = zone.dataset.dndGroup;
                        if (zGroup !== group) return;
                        if (zone.dataset.dndBound === '1') return;
                        zone.addEventListener('dragover', handleDragOver);
                        zone.addEventListener('dragleave', handleDragLeave);
                        zone.addEventListener('drop', handleDrop);
                        zone.dataset.dndBound = '1';
                    });
                };
                bindForGroup('p2-14-18');
            } catch (e) {
                console.warn('setupPart2DragHeadings failed:', e);
            }
        }

        // --- Replace Part 3 content and questions with 'Architecture in Britain' ---
        try {
            const passage3El = document.getElementById('passage-text-3');
            if (passage3El) {
                passage3El.innerHTML = `
                    <h4 class=\"text-center\">Book review on Musicophilia</h4>
                    <p><em>Norman M. Weinberger reviews the latest work of Oliver Sacks on music.</em></p>
                    <p>Architecture is about evolution, not revolution. It used to be thought that once the Romans pulled out of Britain in the fifth century, their elegant villas, carefully-planned towns and engineering marvels like Hadrian’s Wall simply fell into decay as British culture was plunged into the Dark Ages. It took the Norman Conquest of 1066 to bring back the light, and the Gothic cathedral-builders of the Middle Ages played an important part in the revival of British culture. However, the truth is not as simple as that. Romano-British culture—and that included architecture along with language, religion, political organisation and the arts—survived long after the Roman withdrawal. And although the Anglo-Saxons had a sophisticated building style of their own, little survives to bear witness to their achievements as the vast majority of Anglo-Saxon buildings were made of wood.</p>
                    <p>Even so, the period between the Norman landing at Pevensey in 1066 and the day in 1485 when Richard III lost his horse and his head at Bosworth, ushering in the Tudors and the Early Modern period, marks a rare flowering of British buildings. And it is all the more remarkable because the underlying ethos of medieval architecture was “fitness for purpose”. The great cathedrals and parish churches that lifted up their towers to heaven were not only acts of devotion in stone; they were also fiercely functional buildings. Castles served their particular purpose and their battlements and turrets were for use rather than ornament. The rambling manor houses of the later Middle Ages, however, were primarily homes, their owners achieving respect and maintaining status by their hospitality and good lordship rather than the grandeur of their buildings. In a sense, the buildings of the 16th century were also governed by fitness for purpose—only now, the purpose was very different. In domestic architecture, in particular, buildings were used to display status and wealth.</p>
                    <p>This stately and curious workmanship showed itself in various ways. A greater sense of security led to more outward-looking buildings, as opposed to the medieval arrangement where the need for defence created houses that faced inward onto a courtyard or series of courtyards. This allowed for much more in the way of exterior ornament. The rooms themselves tended to be bigger and lighter—as an expensive commodity, the use of great expanses of glass was in itself a statement of wealth. There was also a general move towards balanced and symmetrical exteriors with central entrances. With the exception of Inigo Jones (1573-1652), whose confident handling of classical detail and proportion set him apart from all other architects of the period, most early 17th century buildings tended to take the innocent exuberance of late Tudor to work one step further. But during the 1640s and 50s, the Civil War and its aftermath sent many gentlemen and nobles to the Continent either to escape the fighting or, when the war was lost, to follow Charles II into exile. There they came into contact with French, Dutch and Italian architecture and, with Charles’s restoration in 1660, there was a flurry of building activity as royalists reclaimed their property and built themselves houses reflecting the latest European trends. The British Baroque was a reassertion of authority, an expression of absolutist ideology by men who remembered a world turned upside down during the Civil War. The style is heavy and rich, sometimes overblown and melodramatic. The politics which underpin it are questionable, but its products are breathtaking.</p>
                    <p>The huge glass-and-iron Crystal Palace, designed by Joseph Paxton to house the Great Exhibition of 1851, shows another strand to 19th century architecture—one which embraced new industrial processes. But it wasn’t long before even this confidence in progress came to be regarded with suspicion. Mass production resulted in buildings and furnishings that were too perfect, as the individual craftsman no longer had a major role in their creation. Railing against the dehumanising effects of industrialisation, reformers like John Ruskin and William Morris made a concerted effort to return to hand-crafted, pre-industrial manufacturing techniques. Morris’s influence grew from the production of furniture and textiles until by the 1880s a generation of principled young architects was following his call for good, honest construction.</p>
                    <p>The most important trends in early 20th century architecture simply passed Britain by. Whilst Gropius was working on cold, hard expanses of glass, and Le Corbusier was experimenting with the use of reinforced concrete frames, we had staid establishment architects like Edwin Lutyens producing Neo-Georgian and Renaissance country houses for an outmoded landed class. In addition, there was slightly batty architect craftsmen, the heirs of William Morris, still trying to turn the clock back to before the Industrial Revolution by making chairs and spurning new technology. Only a handful of Modern Movement buildings of any real merit were produced here during the 1920s and 1930s, and most of these were the work of foreign architects such as Serge Chermayeff, Berthold Lubetkin and Erno Gold-finger who had settled in this country.</p>
                    <p>After the Second World War, the situation began to change. The Modern Movement’s belief in progress and the future struck a chord with the mood of post-war Britain and, as reconstruction began under Attlee’s Labour government in 1945, there was a desperate need for cheap housing which could be produced quickly. The use of prefabricated elements, metal frames, concrete cladding and the absence of decoration—all of which had been embraced by Modernists abroad and viewed with suspicion by the British—were adopted to varying degrees for housing developments and schools. Local authorities, charged with the task of rebuilding city centres, became important patrons of architecture. This represented a shift away from the private individuals who had dominated the architectural scene for centuries.</p>
                    <p>Since the War, it has been corporate bodies like these local authorities, together with national and multinational companies, and large educational institutions, which have dominated British architecture. By the late 1980s the Modern Movement, unfairly blamed for the social experiments implicit in high-rise housing, had lost out to irony and spectacle in the shape of post-modernism, with its cheerful borrowings from anywhere and any period. But now, in the new Millennium, even post-modernism is showing signs of age. What comes next?</p>
                `;
            }

            const questions3El = document.getElementById('questions-3');
            if (questions3El) {
                questions3El.innerHTML = `
                    <div class=\"questions-container\">
                        <div class=\"question\" data-q-start=\"27\" data-q-end=\"31\">
                            <div class=\"question-prompt\">
                                <p><strong>Questions 27-31</strong></p>
                                <p>Choose the correct answer.</p>
                            </div>
                            <div class=\"multi-choice-question\" data-q-start=\"27\" data-q-end=\"27\">
                                <div class=\"question-prompt\"><p><strong>27</strong> After Romans left Britain,</p></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q27\" value=\"A\"> their achievements were neglected.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q27\" value=\"B\"> their cultural legacy endured.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q27\" value=\"C\"> there was an abrupt culture change.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q27\" value=\"D\"> their buildings were well protected.</label></div>
                            </div>
                            <div class=\"multi-choice-question\" data-q-start=\"28\" data-q-end=\"28\">
                                <div class=\"question-prompt\"><p><strong>28</strong> Medieval architecture aspired all above to be</p></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q28\" value=\"A\"> immense.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q28\" value=\"B\"> useful.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q28\" value=\"C\"> decorative.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q28\" value=\"D\"> durable.</label></div>
                            </div>
                            <div class=\"multi-choice-question\" data-q-start=\"29\" data-q-end=\"29\">
                                <div class=\"question-prompt\"><p><strong>29</strong> Which of the following architectural features characterize the 16th-century architecture in Britain?</p></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q29\" value=\"A\"> They faced inward.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q29\" value=\"B\"> They had plain exteriors.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q29\" value=\"C\"> They had small windows.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q29\" value=\"D\"> They used symmetry in architecture.</label></div>
                            </div>
                            <div class=\"multi-choice-question\" data-q-start=\"30\" data-q-end=\"30\">
                                <div class=\"question-prompt\"><p><strong>30</strong> How did the 17th-century British buildings come to be influenced by styles from continental Europe?</p></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q30\" value=\"A\"> Fugitives brought ideas from continental Europe back to Britain.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q30\" value=\"B\"> British craftsmen went to work in other countries.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q30\" value=\"C\"> Monarchs encouraged cultural contact with other countries.</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q30\" value=\"D\"> Buildings were restored by architects in European countries.</label></div>
                            </div>
                            <div class=\"multi-choice-question\" data-q-start=\"31\" data-q-end=\"31\">
                                <div class=\"question-prompt\"><p><strong>31</strong> What drove building designs after the Second World War?</p></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q31\" value=\"A\"> Conservatism</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q31\" value=\"B\"> a housing shortage</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q31\" value=\"C\"> foreign architecture</label></div>
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q31\" value=\"D\"> wealthy patronage</label></div>
                            </div>
                        </div>

                        <div class=\"question\" data-q-start=\"32\" data-q-end=\"40\">
                            <div class=\"question-prompt\">
                                <p><strong>Questions 32–40</strong></p>
                                <p>Complete the sentences below. Choose <strong>NO MORE THAN THREE WORDS</strong> from the passage for each answer.</p>
                            </div>
                            <div class=\"answer-inputs\">
                                <p>&bull;&nbsp;&nbsp;Because most Anglo-Saxon buildings were constructed from <input type=\"text\" class=\"answer-input\" id=\"q32\" placeholder=\"32\">, few of them have survived.</p>
                                <p>&bull;&nbsp;&nbsp;The owners of medieval manor houses in Britain earned their reputation through their <input type=\"text\" class=\"answer-input\" id=\"q33\" placeholder=\"33\"> and elegance.</p>
                                <p>&bull;&nbsp;&nbsp;The 16th-century building was designed to show evidence of <input type=\"text\" class=\"answer-input\" id=\"q34\" placeholder=\"34\"> and</p>
                                <p>&bull;&nbsp;&nbsp;In the 16th century, the use of glass was fashionable, even though it was an <input type=\"text\" class=\"answer-input\" id=\"q35\" placeholder=\"35\">.</p>
                                <p>&bull;&nbsp;&nbsp;Inigo Jones was particularly skilful in designing architecture in the <input type=\"text\" class=\"answer-input\" id=\"q36\" placeholder=\"36\"> style.</p>
                                <p>&bull;&nbsp;&nbsp;Though William Morris designed <input type=\"text\" class=\"answer-input\" id=\"q37\" placeholder=\"37\"> and <input type=\"text\" class=\"answer-input\" id=\"q38\" placeholder=\"38\">, his emphasis on hand-crafting influenced architects.</p>
                                <p>&bull;&nbsp;&nbsp;In the early 20th century, architects like <input type=\"text\" class=\"answer-input\" id=\"q39\" placeholder=\"39\"> were producing conservative designs.</p>
                                <p>&bull;&nbsp;&nbsp;Before the Second World War, modern movement buildings in Britain were mainly designed by <input type=\"text\" class=\"answer-input\" id=\"q40\" placeholder=\"40\">.</p>
                                <p>&bull;&nbsp;&nbsp;After the Second World War, much architecture was commissioned by <input type=\"text\" class=\"answer-input\" id=\"q41\" placeholder=\"41\"> rather than private individuals.</p>
                            </div>
                        </div>
                    </div>
                `;
            }
        } catch (e) {
            console.warn('Failed to inject Architecture in Britain content:', e);
        }

        // --- Override Part 3 with 'Musicophilia' content and questions ---
        try {
            const passage3El = document.getElementById('passage-text-3');
            if (passage3El) {
                passage3El.innerHTML = `
                    <h4 class=\"text-center\">Book review on Musicophilia</h4>
                    <p><em>Norman M. Weinberger reviews the latest work of Oliver Sacks on music.</em></p>
                    <p><strong>A</strong>&nbsp;&nbsp;Music and the brain are both endlessly fascinating subjects, and as a neuroscientist specialising in auditory learning and memory, I find them especially intriguing. So I had high expectations of Musicophilia, the latest offering from neurologist and prolific author Oliver Sacks. And I confess to feeling a little guilty reporting that my reactions to the book are mixed.</p>
                    <p><strong>B</strong>&nbsp;&nbsp;Sacks himself is the best part of Musicophilia. He richly documents his own life in the book and reveals highly personal experiences. The photograph of him on the cover of the book— which shows him wearing headphones, eyes closed, clearly enchanted as he listens to Alfred Brendel perform Beethoven’s Pathetique Sonata— makes a positive impression that is borne out by the contents of the book. Sacks’ voice throughout is steady and erudite but never pontifical. He is neither self-conscious nor self-promoting.</p>
                    <p><strong>C</strong>&nbsp;&nbsp;The preface gives a good idea of what the book will deliver. In it, Sacks explains that he wants to convey the insights gleaned from the “enormous and rapidly growing body of work on the neural underpinnings of musical perception and imagery, and the complex and often bizarre disorders to which these are prone.” He also stresses the importance of “the simple art of observation” and “the richness of the human context.” He wants to combine “observation and description with the latest in technology,” he says, and to imaginatively enter into the experience of his patients and subjects. The reader can see that Sacks, who has been practicing neurology for 40 years, is torn between the “old-fashioned” path of observation and the new-fangled, high-tech approach: He knows that he needs to take heed of the latter, but his heart lies with the former.</p>
                    <p><strong>D</strong>&nbsp;&nbsp;The book consists mainly of detailed descriptions of cases, most of them involving patients whom Sacks has seen in his practice. Brief discussions of contemporary neuroscientific reports are sprinkled liberally throughout the text. Part, “Haunted by Music,” begins with the strange case of Tony Cicoria, a nonmusical, middle-aged surgeon who was consumed by a love of music after being hit by lightning. He suddenly began to crave listening to piano music, which he had never cared for in the past. He started to play the piano and then to compose music, which arose spontaneously in his mind in a “torrent” of notes. How could this happen? Was the cause psychological? (He had had a near-death experience when the lightning struck him.) Or was it the direct result of a change in the auditory regions of his cerebral cortex? Electroencephalography (EEG) showed his brain waves to be normal in the mid-1990s, just after his trauma and subsequent “conversion” to music. There are now more sensitive tests, but Cicoria has declined to undergo them; he does not want to delve into the causes of his musicality. What a shame!</p>
                    <p><strong>E</strong>&nbsp;&nbsp;Part II, “A Range of Musicality,” covers a wider variety of topics, but unfortunately, some of the chapters offer little or nothing that is new. For example, chapter 13, which is five pages long, merely notes that the blind often has better hearing than the sighted. The most interesting chapters are those that present the strangest cases. Chapter 8 is about “amusia,” an inability to hear sounds like music, and “dysharmonia,” a highly specific impairment of the ability to hear harmony, with the ability to understand melody left intact. Such specific “dissociations” are found throughout the cases Sacks recounts.</p>
                    <p><strong>F</strong>&nbsp;&nbsp;To Sacks’s credit, part III, “Memory, Movement and Music,” brings us into the underappreciated realm of music therapy. Chapter 16 explains how “melodic intonation therapy” is being used to help expressive aphasic patients (those unable to express their thoughts verbally following a stroke or other cerebral incident) once again become capable of fluent speech. In chapter 20, Sacks demonstrates the near-miraculous power of music to animate Parkinson’s patients and other people with severe movement disorders, even those who are frozen into odd postures. Scientists cannot yet explain how music achieves this effect.</p>
                    <p><strong>G</strong>&nbsp;&nbsp;To readers who are unfamiliar with neuroscience and music behavior, Musicophilia may be something of a revelation. But the book will not satisfy those seeking the causes and implications of the phenomena Sacks describes. For one thing, Sacks appears to be more at ease discussing patients than discussing experiments. And he tends to be rather uncritical in accepting scientific findings and theories.</p>
                    <p><strong>H</strong>&nbsp;&nbsp;It’s true that the causes of music-brain oddities remain poorly understood. However, Sacks could have done more to draw out some of the implications of the careful observations that he and other neurologists have made and of the treatments that have been successful. For example, he might have noted that the many specific dissociations among components of music comprehension, such as loss of the ability to perceive harmony but not melody, indicate that there is no music center in the brain. Because many people who read the book are likely to believe in the brain localisation of all mental functions, this was a missed educational opportunity.</p>
                    <p><strong>I</strong>&nbsp;&nbsp;Another conclusion one could draw is that there seem to be no “cures” for neurological problems involving music. A drug can alleviate a symptom in one patient and aggravate it in another or can have both positive and negative effects in the same patient. Treatments mentioned seem to be almost exclusively antiepileptic medications, which “damp down” the excitability of the brain in general; their effectiveness varies widely.</p>
                    <p><strong>J</strong>&nbsp;&nbsp;Finally, in many of the cases described here the patient with music-brain symptoms is reported to have “normal” EEG results. Although Sacks recognises the existence of new technologies, among them far more sensitive ways to analyze brain waves than the standard neurological EEG test, he does not call for their use. In fact, although he exhibits the greatest compassion for patients, he conveys no sense of urgency about the pursuit of new avenues in the diagnosis and treatment of music-brain disorders. This absence echoes the book’s preface, in which Sacks expresses fear that “the simple art of observation may be lost” if we rely too much on new technologies. He does call for both approaches, though, and we can only hope that the neurological community will respond.</p>
                `;
            }

            const questions3El = document.getElementById('questions-3');
            if (questions3El) {
                questions3El.innerHTML = `
                    <div class=\"questions-container\"> 
                        <div class=\"question\" data-q-start=\"27\" data-q-end=\"30\"> 
                            <div class=\"question-prompt\"> 
                                <p><strong>Questions 27-30</strong></p> 
                                <p>Choose the correct answer.</p> 
                            </div> 
                            <div class=\"multi-choice-question\" data-q-start=\"27\" data-q-end=\"27\"> 
                                <div class=\"question-prompt\"><p><strong>27</strong> Why does the writer have a mixed feeling about the book?</p></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q27\" value=\"A\"> The guilty feeling made him so.</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q27\" value=\"B\"> The writer expected it to be better than it was.</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q27\" value=\"C\"> Sacks failed to include his personal stories in the book.</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q27\" value=\"D\"> This is the only book written by Sacks.</label></div> 
                            </div> 
                            <div class=\"multi-choice-question\" data-q-start=\"28\" data-q-end=\"28\"> 
                                <div class=\"question-prompt\"><p><strong>28</strong> What is the best part of the book?</p></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q28\" value=\"A\"> the photo of Sacks listening to music</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q28\" value=\"B\"> the tone of voice of the book</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q28\" value=\"C\"> the autobiographical description in the book</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q28\" value=\"D\"> the description of Sacks’ wealth</label></div> 
                            </div> 
                            <div class=\"multi-choice-question\" data-q-start=\"29\" data-q-end=\"29\"> 
                                <div class=\"question-prompt\"><p><strong>29</strong> In the preface, what did Sacks try to achieve?</p></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q29\" value=\"A\"> make a herald introduction of the research work and technique applied</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q29\" value=\"B\"> give a detailed description of various musical disorders</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q29\" value=\"C\"> explain why he needs to do away with the simple observation</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q29\" value=\"D\"> explain why he needs to do away with the simple observation</label></div> 
                            </div> 
                            <div class=\"multi-choice-question\" data-q-start=\"30\" data-q-end=\"30\"> 
                                <div class=\"question-prompt\"><p><strong>30</strong> What is disappointing about Tony Cicoria’s case?</p></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q30\" value=\"A\"> He refuses to have further tests.</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q30\" value=\"B\"> He can’t determine the cause of his sudden musicality.</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q30\" value=\"C\"> He nearly died because of the lightning.</label></div> 
                                <div class=\"multi-choice-option\"><label><input type=\"radio\" name=\"q30\" value=\"D\"> His brain waves were too normal to show anything.</label></div> 
                            </div> 
                        </div> 

                        <div class=\"question\" data-q-start=\"31\" data-q-end=\"36\"> 
                            <div class=\"question-prompt\"> 
                                <p><strong>Questions 31-36</strong></p> 
                                <p>Do the following statements agree with the views of the writer in Reading Passage 3?</p> 
                                <p>In boxes 31-36 on your answer sheet, write</p> 
                                <ul style=\"list-style: none; padding-left: 0;\"> 
                                    <li><strong>YES</strong> if the statement agrees with the views of the writer</li> 
                                    <li><strong>NO</strong> if the statement contradicts with the views of the writer</li> 
                                    <li><strong>NOT GIVEN</strong> if it is impossible to say what the writer thinks about this</li> 
                                </ul> 
                            </div> 
                            <div class=\"tf-question\" data-q-start=\"31\" data-q-end=\"31\"> 
                                <div class=\"tf-question-line\"><span class=\"tf-question-number\">31</span><span class=\"tf-question-text\">It is difficult to give a well-reputable writer a less than totally favorable review.</span></div> 
                                <div class=\"tf-options\"> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q31\" value=\"YES\"> YES</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q31\" value=\"NO\"> NO</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q31\" value=\"NOT GIVEN\"> NOT GIVEN</label> 
                                </div> 
                            </div> 
                            <div class=\"tf-question\" data-q-start=\"32\" data-q-end=\"32\"> 
                                <div class=\"tf-question-line\"><span class=\"tf-question-number\">32</span><span class=\"tf-question-text\">Beethoven’s Pathetique Sonata is a good treatment for musical disorders.</span></div> 
                                <div class=\"tf-options\"> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q32\" value=\"YES\"> YES</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q32\" value=\"NO\"> NO</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q32\" value=\"NOT GIVEN\"> NOT GIVEN</label> 
                                </div> 
                            </div> 
                            <div class=\"tf-question\" data-q-start=\"33\" data-q-end=\"33\"> 
                                <div class=\"tf-question-line\"><span class=\"tf-question-number\">33</span><span class=\"tf-question-text\">Sacks believes technological methods is of little importance compared with traditional observation when studying his patients.</span></div> 
                                <div class=\"tf-options\"> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q33\" value=\"YES\"> YES</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q33\" value=\"NO\"> NO</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q33\" value=\"NOT GIVEN\"> NOT GIVEN</label> 
                                </div> 
                            </div> 
                            <div class=\"tf-question\" data-q-start=\"34\" data-q-end=\"34\"> 
                                <div class=\"tf-question-line\"><span class=\"tf-question-number\">34</span><span class=\"tf-question-text\">It is difficult to understand why music therapy is undervalued</span></div> 
                                <div class=\"tf-options\"> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q34\" value=\"YES\"> YES</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q34\" value=\"NO\"> NO</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q34\" value=\"NOT GIVEN\"> NOT GIVEN</label> 
                                </div> 
                            </div> 
                            <div class=\"tf-question\" data-q-start=\"35\" data-q-end=\"35\"> 
                                <div class=\"tf-question-line\"><span class=\"tf-question-number\">35</span><span class=\"tf-question-text\">Sacks held little skepticism when borrowing other theories and findings in describing reasons and notion for phenomena he depicts in the book.</span></div> 
                                <div class=\"tf-options\"> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q35\" value=\"YES\"> YES</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q35\" value=\"NO\"> NO</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q35\" value=\"NOT GIVEN\"> NOT GIVEN</label> 
                                </div> 
                            </div> 
                            <div class=\"tf-question\" data-q-start=\"36\" data-q-end=\"36\"> 
                                <div class=\"tf-question-line\"><span class=\"tf-question-number\">36</span><span class=\"tf-question-text\">Sacks is in a rush to use new testing methods to do treatment for patients.</span></div> 
                                <div class=\"tf-options\"> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q36\" value=\"YES\"> YES</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q36\" value=\"NO\"> NO</label> 
                                    <label class=\"tf-option\"><input type=\"radio\" name=\"q36\" value=\"NOT GIVEN\"> NOT GIVEN</label> 
                                </div> 
                            </div> 
                        </div> 

                        <div class=\"question\" data-q-start=\"37\" data-q-end=\"40\"> 
                            <div class=\"question-prompt\"> 
                                <p><strong>Questions 37-40</strong></p> 
                                <p>Complete each sentence with the correct ending, <strong>A–F</strong>, below.</p> 
                                <p>Write the correct letter, <strong>A–F</strong>, in boxes <strong>37–40</strong> on your answer sheet.</p> 
                            </div> 
                            <div class=\"drag-drop-container\"> 
                                <div class=\"matching-questions\"> 
                                    <div class=\"matching-question-item\" data-q-start=\"37\" data-q-end=\"37\"> 
                                        <span>The content covered dissociations in understanding between harmony and melody</span> 
                                        <div class=\"drop-zone\" data-dnd-group=\"p3-35-39\" data-q-start=\"37\">37</div> 
                                    </div> 
                                    <div class=\"matching-question-item\" data-q-start=\"38\" data-q-end=\"38\"> 
                                        <span>The study of treating musical disorders</span> 
                                        <div class=\"drop-zone\" data-dnd-group=\"p3-35-39\" data-q-start=\"38\">38</div> 
                                    </div> 
                                    <div class=\"matching-question-item\" data-q-start=\"39\" data-q-end=\"39\"> 
                                        <span>The EEG scans of Sacks’ patients</span> 
                                        <div class=\"drop-zone\" data-dnd-group=\"p3-35-39\" data-q-start=\"39\">39</div> 
                                    </div> 
                                    <div class=\"matching-question-item\" data-q-start=\"40\" data-q-end=\"40\"> 
                                        <span>Sacks believes testing based on new technologies</span> 
                                        <div class=\"drop-zone\" data-dnd-group=\"p3-35-39\" data-q-start=\"40\">40</div> 
                                    </div> 
                                </div> 
                                <div class=\"drag-options-container recommendations-box\" data-dnd-group=\"p3-35-39\"> 
                                    <div class=\"drag-item\" draggable=\"true\" data-dnd-group=\"p3-35-39\" data-value=\"A\"><strong>A</strong> show no music-brain disorders.</div> 
                                    <div class=\"drag-item\" draggable=\"true\" data-dnd-group=\"p3-35-39\" data-value=\"B\"><strong>B</strong> indicates that medication can have varied results.</div> 
                                    <div class=\"drag-item\" draggable=\"true\" data-dnd-group=\"p3-35-39\" data-value=\"C\"><strong>C</strong> is key for the neurological community to unravel the mysteries.</div> 
                                    <div class=\"drag-item\" draggable=\"true\" data-dnd-group=\"p3-35-39\" data-value=\"D\"><strong>D</strong> should not be used in isolation.</div> 
                                    <div class=\"drag-item\" draggable=\"true\" data-dnd-group=\"p3-35-39\" data-value=\"E\"><strong>E</strong> indicate that not everyone can receive a good education.</div> 
                                    <div class=\"drag-item\" draggable=\"true\" data-dnd-group=\"p3-35-39\" data-value=\"F\"><strong>F</strong> show a misconception that there is a function centre localized in the brain</div> 
                                </div> 
                            </div> 
                        </div> 
                    </div> 
                `;
            }
        } catch (e) {
            console.warn('Failed to override Part 3 with Musicophilia:', e);
        }

        // --- ICON SVGs ---
        const playIcon = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="#3e3e3e"><path d="M8 5v14l11-7z"/></svg>';
        const pauseIcon = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="#3e3e3e"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';

        // --- ANSWERS ---
        const correctAnswers = {
            // Part 1 (1-13) - New Agriculture in Oregon, US
            // Updated for Plain English Campaign
            '1': 'TRUE',   // marketing benefit
            '2': 'NOT GIVEN',   // medical label confusion
            '3': 'TRUE',   // Reagan rollback slowed progress
            '4': 'NOT GIVEN', // problem talking with officials
            '5': 'NOT GIVEN',  // not regularly checked by judge; litigation low
            '6': 'FALSE',  // more options now, so pressure greater, not less
            '7': 'jargon and waffle',
            '8': 'Gap',
            '9': 'do-it-yourself',
            '10': 'frustration',
            '11': 'first-time user',
            '12': 'legal',
            '13': 'courts',
            '14': 'ix',
            '15': 'iii',
            '16': 'ii',
            '17': 'vii',
            '18': 'vi',
            '19': 'B',
            '20': 'A',
            '21': 'D',
            '22': 'B',
            '23': 'C',
            '24': 'A',
            '25': 'C',
            '26': 'B',
            // Part 3 (27-40) - Musicophilia
            '27': 'B',
            '28': 'C',
            '29': 'A',
            '30': 'A',
            '31': 'YES',
            '32': 'NOT GIVEN',
            '33': 'FALSE',
            '34': 'NOT GIVEN',
            '35': 'TRUE',
            '36': 'FALSE',
            '37': 'F',
            '38': 'B',
            '39': 'A',
            '40': 'D'
        };

        // --- INITIALIZATION ---
        function initialize() {
            console.log(`🚀 Initializing application...`);
            startTimer();
            initializeDragAndDrop();
            // Normalize drop-zone widths for questions 35-39 to the longest option
            try {
                const group = 'p3-35-39';
                const options = Array.from(document.querySelectorAll(`.drag-options-container[data-dnd-group="${group}"] .drag-item`));
                if (options.length) {
                    const temp = document.createElement('div');
                    temp.style.position = 'absolute';
                    temp.style.visibility = 'hidden';
                    temp.style.whiteSpace = 'normal';
                    temp.style.padding = '4px 10px 4px 36px';
                    temp.style.border = '2px solid transparent';
                    temp.style.fontWeight = '700';
                    temp.style.fontSize = '15px';
                    temp.style.lineHeight = '1.4';
                    temp.style.maxWidth = 'none';
                    document.body.appendChild(temp);
                    let maxWidth = 200;
                    options.forEach(opt => {
                        temp.textContent = opt.textContent.trim();
                        maxWidth = Math.max(maxWidth, temp.scrollWidth + 20);
                    });
                    document.body.removeChild(temp);
                    const dropZones = document.querySelectorAll(`.drop-zone[data-dnd-group="${group}"]`);
                    dropZones.forEach(dz => {
                        dz.style.width = `${Math.ceil(maxWidth)}px`;
                    });
                }
            } catch(e) {
                console.warn('Drop-zone width normalization skipped:', e);
            }
            setupCheckboxLimits();
            setupExampleHeading();
            console.log(`📋 Setting up initial state - switching to part 1`);
            switchToPart(1); // Also calls goToQuestion(1) and updateNavigation
            
            document.body.addEventListener('input', updateAllIndicators);
            document.body.addEventListener('change', updateAllIndicators);
            deliverButton.addEventListener('click', checkAnswers);
            timerToggleButton.addEventListener('click', toggleTimer);
            timerResetButton.addEventListener('click', resetTimer);

            // Auto-close dropdowns for Questions 14-17 on selection
            ['q14','q15','q16','q17'].forEach(id => {
                const sel = document.getElementById(id);
                if (sel) {
                    sel.addEventListener('change', () => sel.blur());
                }
            });

            // Add click listeners to question containers for navigation
            document.querySelectorAll('[data-q-start]').forEach(el => {
                el.addEventListener('click', (event) => {
                    // Stop event propagation to prevent parent container clicks
                    event.stopPropagation();
                    
                    const qNum = parseInt(el.dataset.qStart, 10);
                    const qEnd = parseInt(el.dataset.qEnd, 10);
                    
                    console.log(`🖱️ Question container clicked - qNum: ${qNum}, qEnd: ${qEnd}, currentQuestion: ${currentQuestion}, element:`, el);
                    
                    // Handle cases where qNum is NaN
                    if (isNaN(qNum)) {
                        console.log(`ℹ️ Container without valid question number, ignoring navigation`);
                        return;
                    }
                    
                    // Only navigate if this is a single question (qStart === qEnd) or if we're clicking on a specific question within a group
                    if (qNum === qEnd || el.classList.contains('tf-question')) {
                        if (currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum}`);
                            goToQuestion(qNum);
                        } else {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed`);
                        }
                    } else {
                        console.log(`ℹ️ Ignoring click on group container (${qNum}-${qEnd})`);
                    }
                });
            });
            
            // Add specific click listeners for individual question elements to prevent parent container interference
            document.querySelectorAll('.tf-question, .summary-text').forEach(el => {
                el.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const qNum = parseInt(el.dataset.qStart, 10);
                    console.log(`🎯 Individual question element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, element:`, el);
                    
                    // Handle cases where qNum is NaN (like .summary-text containers)
                    if (isNaN(qNum)) {
                        console.log(`ℹ️ Container without specific question number, ignoring navigation`);
                        return;
                    }
                    
                    if (currentQuestion !== qNum) {
                        console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (individual element)`);
                        goToQuestion(qNum);
                    } else {
                        console.log(`ℹ️ Already on question ${qNum}, no navigation needed (individual element)`);
                    }
                });
            });
            
            // Add specific click listeners for individual input elements in questions 33-36
            document.querySelectorAll('.answer-input[id^="q3"]').forEach(input => {
                input.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const qNum = parseInt(input.id.replace('q', ''), 10);
                    console.log(`📝 Input element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, input:`, input);
                    
                    if (currentQuestion !== qNum) {
                        console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (input element)`);
                        goToQuestion(qNum);
                    } else {
                        console.log(`ℹ️ Already on question ${qNum}, no navigation needed (input element)`);
                    }
                });
            });
            
            // Add click listeners for the paragraph elements containing questions 33-36
            document.querySelectorAll('.summary-text p').forEach(p => {
                p.addEventListener('click', (event) => {
                    event.stopPropagation();
                    // Extract question number from the paragraph text (e.g., "33" from "<strong>33</strong>")
                    const strongElement = p.querySelector('strong');
                    if (strongElement) {
                        const qNum = parseInt(strongElement.textContent, 10);
                        console.log(`📄 Summary paragraph clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, paragraph:`, p);
                        
                        if (!isNaN(qNum) && currentQuestion !== qNum) {
                            console.log(`🚀 Navigating from question ${currentQuestion} to question ${qNum} (summary paragraph)`);
                            goToQuestion(qNum);
                        } else if (!isNaN(qNum)) {
                            console.log(`ℹ️ Already on question ${qNum}, no navigation needed (summary paragraph)`);
                        }
                    }
                });
            });

            resizer.addEventListener('mousedown', initResize, false);
            initializeContextMenu();

            // Build mobile quick question picker (8 visible around current)
            buildMobileQuestionPicker();
            setupPart2DragHeadings();
        }

        // --- CORE TEST LOGIC ---

        function checkAnswers() {
            // Disable all inputs to prevent changes
            const allInputs = document.querySelectorAll('input, select, textarea');
            allInputs.forEach(input => {
                input.disabled = true;
            });

            // Disable all drag and drop functionality
            document.querySelectorAll('.drag-item').forEach(item => {
                item.setAttribute('draggable', 'false');
                item.style.cursor = 'not-allowed';
                item.style.pointerEvents = 'none';
            });

            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.style.pointerEvents = 'none';
                zone.classList.add('disabled');
            });

            // Disable submit button
            deliverButton.disabled = true;
            deliverButton.style.cursor = 'not-allowed';
            
            clearInterval(timerInterval);
            let score = 0;
            const totalQuestions = 40;
            const resultsDetailsContainer = document.getElementById('results-details');
            resultsDetailsContainer.innerHTML = '';

            document.querySelectorAll('.correct, .incorrect, .correct-answer-highlight').forEach(el => {
                el.classList.remove('correct', 'incorrect', 'correct-answer-highlight');
            });
            document.querySelectorAll('.correct-answer-display').forEach(el => el.remove());

            for (let i = 1; i <= totalQuestions; i++) {
                const questionKey = String(i);
                const correctAnswer = correctAnswers[questionKey];
                let userAnswer = '';
                let isCorrect = false;
                
                let userAnswerDisplay = 'Not Answered';
                const correctAnswerText = Array.isArray(correctAnswer) ? correctAnswer.join(' / ') : correctAnswer;

                const textInput = document.getElementById(`q${i}`);
                const radioGroup = document.querySelectorAll(`input[name="q${i}"][type="radio"]`);
                
                // Handle Text and Select Inputs
                if (textInput && (textInput.tagName === 'INPUT' || textInput.tagName === 'SELECT')) {
                    const element = textInput.closest('.matching-form-row') || textInput;
                    userAnswer = textInput.value.trim();
                    userAnswerDisplay = userAnswer || 'Not Answered';

                    const normalize = (s) => (s || '')
                        .toString()
                        .toLowerCase()
                        .replace(/[^a-z0-9\s]/g, '')
                        .replace(/\s+/g, ' ')
                        .trim();

                    if (textInput.tagName === 'SELECT') {
                        isCorrect = userAnswer === correctAnswer;
                    } else {
                        const normUser = normalize(userAnswer);
                        if (Array.isArray(correctAnswer)) {
                            isCorrect = correctAnswer.some(ans => normalize(ans) === normUser);
                        } else {
                            isCorrect = normalize(correctAnswer) === normUser;
                        }
                    }
                    
                    if (isCorrect) {
                        score++;
                        element.classList.add('correct');
                    } else {
                        element.classList.add('incorrect');
                        const correctAnswerSpan = document.createElement('span');
                        correctAnswerSpan.className = 'correct-answer-display';
                        correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`;
                        textInput.parentNode.insertBefore(correctAnswerSpan, textInput.nextSibling);
                    }
                }
                // Handle drag and drop questions (any with a drop-zone for this question)
                else if (document.querySelector(`.drop-zone[data-q-start="${i}"]`)) {
                    console.log(`🔍 Checking drag-and-drop question ${i}`);
                    const dropZone = document.querySelector(`.drop-zone[data-q-start="${i}"]`);
                    const droppedItem = dropZone ? dropZone.querySelector('.drag-item') : null;
                    
                    console.log(`📍 Drop zone for question ${i}:`, dropZone);
                    console.log(`📍 Dropped item for question ${i}:`, droppedItem);
                    console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                    
                    if (droppedItem) {
                        userAnswer = droppedItem.dataset.value;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        // Mark the drop zone as correct or incorrect
                        dropZone.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                        
                        // Show correct answer if wrong
                        if (!isCorrect && correctAnswer) {
                            const correctAnswerSpan = document.createElement('span');
                            correctAnswerSpan.className = 'correct-answer-display';
                            correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswer}</span>`;
                            dropZone.appendChild(correctAnswerSpan);
                        }
                    } else {
                        // No answer provided - mark as incorrect
                        console.log(`⚠️ No answer provided for question ${i}`);
                        if (dropZone) {
                            dropZone.classList.add('incorrect');
                        }
                        if (correctAnswer) {
                            const correctAnswerSpan = document.createElement('span');
                            correctAnswerSpan.className = 'correct-answer-display';
                            correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswer}</span>`;
                            dropZone.appendChild(correctAnswerSpan);
                        }
                    }
                }
                // Handle Radio Button Inputs (T/F, MCQs)
                else if (radioGroup.length > 0) {
                    const questionContainer = radioGroup[0]?.closest('.tf-question') || radioGroup[0]?.closest('.multi-choice-question');
                    const checkedRadio = document.querySelector(`input[name="q${i}"]:checked`);

                    if (checkedRadio) {
                        userAnswer = checkedRadio.value;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;

                        const userLabel = checkedRadio.closest('.tf-option, .multi-choice-option');
                        if (userLabel) {
                            userLabel.classList.add(isCorrect ? 'correct' : 'incorrect');
                        }
                        
                        // Handle table radio buttons
                        if (checkedRadio.classList.contains('table-radio')) {
                            const tableCell = checkedRadio.closest('td');
                            if (tableCell) {
                                tableCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                            }
                        }
                    }

                    if (isCorrect) {
                        score++;
                    } else {
                        if (questionContainer){
                            const correctOptionEl = questionContainer.querySelector(`input[name="q${i}"][value="${correctAnswerText}"]`);
                            if (correctOptionEl) {
                                const correctLabel = correctOptionEl.closest('.tf-option, .multi-choice-option');
                                if (correctLabel) {
                                    correctLabel.classList.add('correct-answer-highlight');
                                }
                            }
                        }
                    }
                }
                // Handle clickable-cell matrix questions (generic for any i that has clickable cells)
                else if (document.querySelector(`.clickable-cell[data-question="${i}"]`)) {
                    console.log(`🔍 Checking clickable cell question ${i}`);
                    const selectedCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-selected="true"]`);
                    console.log(`📍 Selected cell for question ${i}:`, selectedCell);
                    console.log(`📍 Correct answer for question ${i}:`, correctAnswer);
                    
                    if (selectedCell) {
                        userAnswer = selectedCell.dataset.answer;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        selectedCell.classList.add(isCorrect ? 'correct' : 'incorrect');
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                    } else {
                        console.log(`⚠️ No answer provided for question ${i}`);
                        userAnswerDisplay = 'Not Answered';
                    }
                    
                    // Handle highlighting correct answers for incorrect responses
                    if (!isCorrect) {
                        const correctCell = document.querySelector(`.clickable-cell[data-question="${i}"][data-value="${correctAnswerText}"]`);
                        if (correctCell) {
                            correctCell.classList.add('correct-answer-highlight');
                            console.log(`✅ Highlighted correct answer for question ${i}:`, correctCell);
                        } else {
                            console.log(`⚠️ Could not find correct cell for question ${i} with value "${correctAnswerText}"`);
                        }
                    }
                }
                // Handle text input questions (33-39)
                else if (i >= 33 && i <= 39) {
                    console.log(`🔍 Checking text input question ${i}`);
                    const textInput = document.getElementById(`q${i}`);
                    
                    if (textInput) {
                        userAnswer = textInput.value.trim().toLowerCase();
                        userAnswerDisplay = userAnswer || 'Not Answered';
                        
                        // Handle special case for question 33 which has two answers
                        if (i === 33) {
                            const answers = userAnswer.split('&').map(ans => ans.trim());
                            isCorrect = answers.includes('breathing') && answers.includes('eating');
                        } else {
                            isCorrect = userAnswer === correctAnswer.toLowerCase();
                        }
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        if (isCorrect) {
                            score++;
                            textInput.classList.add('correct');
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            textInput.classList.add('incorrect');
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                        }
                    } else {
                        console.log(`⚠️ No answer provided for question ${i}`);
                        userAnswerDisplay = 'Not Answered';
                    }
                }
                // Handle question 40 (multiple choice)
                else if (i === 40) {
                    console.log(`🔍 Checking multiple choice question ${i}`);
                    const checkedRadio = document.querySelector(`input[name="q${i}"]:checked`);
                    
                    if (checkedRadio) {
                        userAnswer = checkedRadio.value;
                        userAnswerDisplay = userAnswer;
                        isCorrect = userAnswer === correctAnswer;
                        
                        console.log(`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`);
                        
                        const userLabel = checkedRadio.closest('.multi-choice-option');
                        if (userLabel) {
                            userLabel.classList.add(isCorrect ? 'correct' : 'incorrect');
                        }
                        
                        if (isCorrect) {
                            score++;
                            console.log(`🎉 Question ${i} is correct! Score: ${score}`);
                        } else {
                            console.log(`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`);
                            
                            // Highlight correct answer
                            const correctOptionEl = document.querySelector(`input[name="q${i}"][value="${correctAnswer}"]`);
                            if (correctOptionEl) {
                                const correctLabel = correctOptionEl.closest('.multi-choice-option');
                                if (correctLabel) {
                                    correctLabel.classList.add('correct-answer-highlight');
                                }
                            }
                        }
                    } else {
                        console.log(`⚠️ No answer provided for question ${i}`);
                        userAnswerDisplay = 'Not Answered';
                    }
                }
                // Handle Checkbox Inputs (Multiple choice questions like 24-26)

                 
                // For showing results in the modal
                 const resultRow = `
                    <div class="result-row ${isCorrect ? '' : 'incorrect'}">
                        <span class="q-num">${i}</span>
                        <span class="user-ans">${userAnswerDisplay}</span>
                        <span class="correct-ans">${correctAnswerText}</span>
                    </div>`;
                resultsDetailsContainer.innerHTML += resultRow;
                
                // Update nav button color
                const navButton = document.querySelector(`.subQuestion[onclick="goToQuestion(${i})"]`);
                if (navButton) {
                    navButton.classList.remove('answered', 'active');
                    navButton.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
            }

            document.getElementById('results-score').textContent = score;
            document.getElementById('results-band').textContent = calculateBandScore(score);
            document.body.classList.add('results-mode');
            document.getElementById('results-modal').classList.remove('hidden');
            
            // Change button to "My Result" with green styling
            deliverButton.innerHTML = `<span>My Result</span>`;
            deliverButton.style.backgroundColor = '#4CAF50';
            deliverButton.style.color = 'white';
            deliverButton.style.borderColor = '#4CAF50';
            deliverButton.disabled = false;
            deliverButton.style.cursor = 'pointer';
            deliverButton.removeEventListener('click', checkAnswers);
            deliverButton.addEventListener('click', showResultsModal);
            
            // Highlight correct answers in the passage
            highlightCorrectAnswersInPassage();
        }

        function buildMobileQuestionPicker() {
            const existing = document.getElementById('mobile-question-picker');
            if (existing) existing.remove();
            const bar = document.querySelector('.mobile-bottom-bar');
            if (!bar) return;
            const grid = document.createElement('div');
            grid.id = 'mobile-question-picker';
            grid.className = 'question-picker-grid';
            grid.style.position = 'fixed';
            grid.style.bottom = '62px';
            grid.style.left = '0';
            grid.style.right = '0';
            grid.style.background = '#fff';
            grid.style.padding = '8px 12px';
            grid.style.borderTop = '1px solid #e5e7eb';
            grid.style.display = 'none';
            grid.style.zIndex = '1100';
            document.body.appendChild(grid);

            // Toggle on long-press of center area or double-tap bar center
            let toggleTarget = document.createElement('div');
            toggleTarget.style.position = 'fixed';
            toggleTarget.style.bottom = '0';
            toggleTarget.style.left = '50%';
            toggleTarget.style.transform = 'translateX(-50%)';
            toggleTarget.style.width = '120px';
            toggleTarget.style.height = '60px';
            toggleTarget.style.zIndex = '1101';
            toggleTarget.style.background = 'transparent';
            document.body.appendChild(toggleTarget);
            let lastTap = 0;
            toggleTarget.addEventListener('touchend', () => {
                const now = Date.now();
                if (now - lastTap < 400) {
                    grid.style.display = (grid.style.display === 'none') ? 'grid' : 'none';
                    if (grid.style.display === 'grid') populateMobilePickerGrid(grid);
                }
                lastTap = now;
            });
        }

        function populateMobilePickerGrid(grid) {
            grid.innerHTML = '';
            const start = 1;
            const end = 40;
            for (let i = start; i <= end; i++) {
                const btn = document.createElement('button');
                btn.className = 'qp-btn';
                btn.dataset.q = String(i);
                btn.textContent = String(i);
                btn.onclick = () => { goToQuestion(i); grid.style.display = 'none'; };
                if (isQuestionAnswered(i)) btn.classList.add('answered');
                grid.appendChild(btn);
            }
        }

        function calculateBandScore(score) {
            if (score >= 39) return '9.0';
            const mapping = {
                40: 9.0, 39: 9.0, 38: 8.5, 37: 8.5, 36: 8.0, 35: 8.0, 34: 7.5,
                33: 7.5, 32: 7.0, 31: 7.0, 30: 7.0, 29: 6.5, 28: 6.5, 27: 6.5,
                26: 6.0, 25: 6.0, 24: 6.0, 23: 5.5, 22: 5.5, 21: 5.5, 20: 5.5,
                19: 5.0, 18: 5.0, 17: 5.0, 16: 5.0, 15: 5.0, 14: 4.5, 13: 4.5,
                12: 4.0, 11: 4.0, 10: 4.0, 9: 3.5, 8: 3.5, 7: 3.0, 6: 3.0,
                5: 2.5, 4: 2.5
            };
            if (score <= 0) return 0.0;
            if (score === 1) return 1.0;
            if (score <= 3) return 2.0;
            if (score <= 5) return 2.5;
            return mapping[score] || 0.0;
        }

        function highlightCorrectAnswersInPassage() {
            // Define highlights for Part 1 (Plain English Campaign)
            const part1Highlights = [
                { question: 1, text: "its sales rocketed", answer: "TRUE" },
                { question: 3, text: "has definitely slowed the pace of plain English legislation", answer: "TRUE" },
                { question: 6, text: "Never before have consumers had as many choices", answer: "FALSE" },
                { question: 7, text: "jargon and waffle", answer: "jargon and waffle" },
                { question: 9, text: "do-it-yourself products", answer: "do-it-yourself" },
                { question: 10, text: "cause expense and frustration", answer: "frustration" },
                { question: 11, text: "like a first-time user", answer: "first-time user" },
                { question: 12, text: "legal language", answer: "legal" },
                { question: 13, text: "tested for centuries in the courts", answer: "courts" }
            ];

            // Define highlights for Part 2 (Follow your nose)
            const part2Highlights = [
                { question: 19, text: "smell triggered their flashbacks", answer: "B" },
                { question: 20, text: "the memory itself was no better recalled by the odour", answer: "A" },
                { question: 21, text: "named the smells faster when the picture showed something semantically related", answer: "D" },
                { question: 22, text: "better protected against flashbacks", answer: "B" },
                { question: 23, text: "cannot be separated from the other senses", answer: "C" },
                { question: 24, text: "activated the amygdala", answer: "A" },
                { question: 25, text: "works only if you believe it will", answer: "C" },
                { question: 26, text: "we put more faith in those other modalities", answer: "B" }
            ];

            // Define highlights for Part 3 (Musicophilia)
            const part3Highlights = [
                { question: 27, text: "I had high expectations", answer: "B" },
                { question: 27, text: "reactions to the book are mixed", answer: "B" },
                { question: 28, text: "Sacks himself is the best part of Musicophilia", answer: "C" },
                { question: 29, text: "observation and description with the latest in technology", answer: "A" },
                { question: 30, text: "has declined to undergo them", answer: "A" },
                { question: 31, text: "feeling a little guilty", answer: "YES" },
                { question: 33, text: "with the latest in technology", answer: "NO" },
                { question: 35, text: "rather uncritical in accepting", answer: "YES" },
                { question: 36, text: "no sense of urgency", answer: "NO" },
                { question: 37, text: "no music center in the brain", answer: "F" },
                { question: 38, text: "effectiveness varies widely", answer: "B" },
                { question: 39, text: "reported to have \"normal\" EEG results", answer: "A" },
                { question: 40, text: "He does call for both approaches", answer: "D" }
            ];

            // Function to apply highlights to a passage
            function applyHighlights(passageElement, highlights) {
                if (!passageElement) return;

                // Clear any existing highlights
                passageElement.querySelectorAll('.answer-highlight').forEach(el => {
                    const parent = el.parentNode;
                    parent.replaceChild(document.createTextNode(el.textContent), el);
                    parent.normalize();
                });

                // Add highlights for each answer
                highlights.forEach(item => {
                    const paragraphs = passageElement.querySelectorAll('p');
                    paragraphs.forEach(paragraph => {
                        const html = paragraph.innerHTML;
                        if (!html || typeof html !== 'string') return;
                        if (html.includes(item.text)) {
                            const escapeRegExp = s => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                            const re = new RegExp(escapeRegExp(item.text), 'i');
                            const replaced = html.replace(
                                re,
                                `<span class="answer-highlight" data-question="${item.question}" style="
                                    background-color: #ffeb3b;
                                    padding: 2px 4px;
                                    border-radius: 3px;
                                    font-weight: bold;
                                    position: relative;
                                ">${item.text}<span style="
                                    position: absolute;
                                    top: -8px;
                                    right: -8px;
                                    background-color: #2196f3;
                                    color: white;
                                    border-radius: 50%;
                                    width: 20px;
                                    height: 20px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 12px;
                                    font-weight: bold;
                                ">${item.question}</span></span>`
                            );
                            paragraph.innerHTML = replaced;
                        }
                    });
                });
            }

            // Apply highlights to Part 1 (The Green Revolution in China)
            const passageText1 = document.getElementById('passage-text-1');
            applyHighlights(passageText1, part1Highlights);

            // Apply highlights to Part 2 (Reclaiming the Night)
            const passageText2 = document.getElementById('passage-text-2');
            applyHighlights(passageText2, part2Highlights);

            // Apply highlights to Part 3 (Learning lessons from the past)
            const passageText3 = document.getElementById('passage-text-3');
            applyHighlights(passageText3, part3Highlights);
        }

        function getUserAnswer(qNum) {
            const textInput = document.getElementById(`q${qNum}`);
            const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
            const dropZone = document.querySelector(`.drop-zone[data-q-start="${qNum}"]`);

            if (textInput) { // Handles <input type="text"> and <select>
                return { value: textInput.value, text: textInput.value || 'N/A' };
            }
            if (radioInput) {
                return { value: radioInput.value, text: radioInput.value };
            }
            if (dropZone) {
                const droppedItem = dropZone.querySelector('.drag-item');
                return { 
                    value: droppedItem ? droppedItem.dataset.value : null, 
                    text: droppedItem ? droppedItem.textContent.trim() : 'N/A' 
                };
            }
            // Handle clickable cells for questions 23-26
            if (qNum >= 23 && qNum <= 26) {
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return { value: selectedCell.dataset.answer, text: selectedCell.dataset.answer };
                }
            }
            return { value: null, text: 'N/A' };
        }

        function displayCorrectAnswer(qNum, correctAnswer) {
            // Handle multi-choice group questions (e.g., 24-26, 38-40)
            // No special checkbox groups used; fall through

            // Handle radio button questions by highlighting the correct label
            const correctRadioInput = document.querySelector(`input[name="q${qNum}"][value="${correctAnswer}"]`);
            if (correctRadioInput) {
                const parentOption = correctRadioInput.closest('.tf-option, .multi-choice-option');
                if (parentOption) {
                    parentOption.classList.add('correct-answer-highlight');
                    return;
                }
            }

            // Handle text inputs, select dropdowns, and others by showing the answer next to them
            const inputEl = document.getElementById(`q${qNum}`);
            if (inputEl) {
                const displaySpan = document.createElement('span');
                displaySpan.className = 'correct-answer-display';
                displaySpan.textContent = ` ✓ ${correctAnswer}`;
                inputEl.insertAdjacentElement('afterend', displaySpan);
                return; // Done
            }
            
            // Fallback for questions identified by a container (e.g., some T/F/NG questions)
            const element = findQuestionElement(qNum);
            if (element) {
                const displaySpan = document.createElement('span');
                displaySpan.className = 'correct-answer-display';
                displaySpan.textContent = ` ✓ ${correctAnswer}`;
                const itemContainer = element.querySelector('.tf-question-text');
                if (itemContainer) {
                     itemContainer.appendChild(displaySpan);
                } else {
                     element.appendChild(displaySpan);
                }
            }
        }
        
        function findQuestionElement(qNum) {
             return document.querySelector(`[data-q-start="${qNum}"]`);
        }

        function addResultToModal(qNum, userAnswer, correctAnswer, isCorrect) {
            const resultsDetails = document.getElementById('results-details');
            const row = document.createElement('div');
            row.className = 'result-row';
            if (!isCorrect) {
                row.classList.add('incorrect');
            }
            row.innerHTML = `
                <span class="q-num">${qNum}</span>
                <span class="user-ans">${userAnswer}</span>
                <span class="correct-ans">${correctAnswer}</span>
            `;
            resultsDetails.appendChild(row);
        }

        function showResultsModal() {
            document.getElementById('results-modal').classList.remove('hidden');
        }

        window.closeResultsModal = function() {
            document.getElementById('results-modal').classList.add('hidden');
            document.body.classList.remove('results-mode');
        }
        
        function disableInputs() {
            deliverButton.innerHTML = `<span>Checked! View Results.</span>`;
            deliverButton.removeEventListener('click', checkAnswers);
            deliverButton.onclick = showResultsModal;

            document.querySelectorAll('input, select').forEach(el => {
                el.disabled = true;
                 if (el.matches('input[type=radio], input[type=checkbox]')) {
                     el.style.cursor = 'not-allowed';
                     el.parentElement.style.cursor = 'not-allowed';
                 }
            });
            document.querySelectorAll('.drag-item').forEach(el => {
                el.setAttribute('draggable', 'false');
                el.style.cursor = 'default';
            });
            document.querySelectorAll('.drop-zone').forEach(el => {
                el.classList.add('disabled');
            });
        }

        function checkValue(userValue, correctValue) {
            if (userValue === null || userValue === undefined) return false;
            const formattedUserValue = userValue.trim().toLowerCase();
            if (Array.isArray(correctValue)) {
                return correctValue.map(v => v.toLowerCase()).includes(formattedUserValue);
            } else {
                return formattedUserValue === String(correctValue).toLowerCase();
            }
        }

        function markQuestion(qNum, isCorrect) {
            const subQuestionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
            subQuestionBtn?.classList.add(isCorrect ? 'correct' : 'incorrect');

            const elementsToMark = [
                document.querySelector(`.tf-question[data-q-start="${qNum}"]`),
                document.querySelector(`.multi-choice-question[data-q-start="${qNum}"]`),
                document.querySelector(`.matching-question-item[data-q-start="${qNum}"]`),
                document.querySelector(`.drop-zone[data-q-start="${qNum}"]`),
                document.getElementById(`q${qNum}`),
                document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.tf-option'),
                document.querySelector(`input[name="q${qNum}"]:checked`)?.closest('.multi-choice-option')
            ];
            
            elementsToMark.forEach(el => {
                if (el) el.classList.add(isCorrect ? 'correct' : 'incorrect');
            });

             if (qNum === 14 || qNum === 15) {
                const multiChoiceContainer = document.querySelector('.multi-choice-question[data-q-start="14"]');
                if (multiChoiceContainer) multiChoiceContainer.classList.add(isCorrect ? 'correct' : 'incorrect');
             } else if (qNum >= 1 && qNum <= 5) {
                const pMatchInput = document.getElementById(`q${qNum}`);
                if (pMatchInput) pMatchInput.classList.add(isCorrect ? 'correct' : 'incorrect');
            }
        }

        function switchToPart(partNumber) {
            console.log(`🔀 switchToPart called with partNumber: ${partNumber}, currentPassage: ${currentPassage}`);
            
            currentPassage = partNumber;

            // Hide all passages and questions
            document.querySelectorAll('.reading-passage, .question-set, .part-header').forEach(el => {
                el.classList.add('hidden');
            });

            // Show the correct passage, questions, and header
            document.getElementById(`passage-text-${partNumber}`).classList.remove('hidden');
            document.getElementById(`questions-${partNumber}`).classList.remove('hidden');
            document.getElementById(`part-header-${partNumber}`).classList.remove('hidden');

            // Update bottom navigation 'selected' state
            document.querySelectorAll('.footer__questionWrapper___1tZ46').forEach((wrapper, index) => {
                wrapper.classList.toggle('selected', (index + 1) === partNumber);
            });

            // Show/hide explanation buttons based on part
            const explanationButton = document.getElementById('show-explanation-btn');
            const explanationButtonPart3 = document.getElementById('show-explanation-btn-part3');
            
            if (explanationButton) {
                if (partNumber === 2) {
                    explanationButton.style.display = 'block';
                } else {
                    explanationButton.style.display = 'none';
                    // Hide explanation section when switching away from part 2
                    const explanationSection = document.getElementById('part-2-explanation');
                    if (explanationSection) {
                        explanationSection.classList.add('hidden');
                        explanationButton.textContent = 'Show Explanation';
                        explanationButton.style.backgroundColor = '#4a90e2';
                    }
                }
            }
            
            if (explanationButtonPart3) {
                if (partNumber === 3) {
                    explanationButtonPart3.style.display = 'block';
                } else {
                    explanationButtonPart3.style.display = 'none';
                    // Hide explanation section when switching away from part 3
                    const explanationSection = document.getElementById('part-3-explanation');
                    if (explanationSection) {
                        explanationSection.classList.add('hidden');
                        explanationButtonPart3.textContent = 'Show Explanation';
                        explanationButtonPart3.style.backgroundColor = '#4a90e2';
                    }
                }
            }

            console.log(`✅ switchToPart completed - switched to part ${partNumber}`);
            
            // Only go to first question when switching parts, not when staying in same part
            // This allows goToQuestion to work properly for specific question navigation
            // const firstQuestionOfPart = {1: 1, 2: 14, 3: 27}[partNumber];
            // goToQuestion(firstQuestionOfPart);
        }
        
        function goToQuestion(questionNumber) {
            console.log(`🎯 goToQuestion called with questionNumber: ${questionNumber}, currentQuestion: ${currentQuestion}, currentPassage: ${currentPassage}`);
            
            currentQuestion = questionNumber;

            let passageNumber = 1;
            if (questionNumber >= 14 && questionNumber <= 26) passageNumber = 2;
            else if (questionNumber >= 27) passageNumber = 3;
            
            console.log(`📍 Calculated passageNumber: ${passageNumber} for question ${questionNumber}`);
            
            if (currentPassage !== passageNumber) {
                console.log(`🔄 Switching from part ${currentPassage} to part ${passageNumber} for question ${questionNumber}`);
                switchToPart(passageNumber);
                return; 
            }

            console.log(`✅ Staying in same part (${currentPassage}) for question ${questionNumber}`);

            if (activeQuestionElement) {
                // Remove active style from previous block
                activeQuestionElement.classList.remove('active-question', 'active-input');
                // Also remove from the container block if we previously set it
                const prevBlock = activeQuestionElement.closest('[data-q-start]');
                if (prevBlock) prevBlock.classList.remove('active-question');
            }

            // First, try to find the specific input element for questions 33-36
            let targetEl = document.getElementById(`q${questionNumber}`);
            if (targetEl) {
                activeQuestionElement = targetEl;
                console.log(`✅ Found specific input element:`, targetEl);
                targetEl.classList.add('active-input');
                scrollIntoViewIfNeeded(targetEl);
            } else {
                // Fall back to looking for question containers
                targetEl = document.querySelector(`[data-q-start="${questionNumber}"]`);
                console.log(`🔍 Looking for target element with data-q-start="${questionNumber}":`, targetEl);

                if (targetEl) {
                    activeQuestionElement = targetEl;
                    console.log(`✅ Found target element:`, targetEl);
                    
                    if (targetEl.matches('input[type="text"]') || targetEl.matches('select')) {
                        targetEl.classList.add('active-input');
                        console.log(`📝 Added active-input class to input/select element`);
                    } else {
                        targetEl.classList.add('active-question');
                        console.log(`📋 Added active-question class to question element`);
                    }
                    scrollIntoViewIfNeeded(targetEl);
                } else {
                    console.log(`⚠️ Target element not found, looking for paragraph matching question`);
                    const pMatch = document.querySelector(`.paragraph-matching-question select[id="q${questionNumber}"]`);
                    if(pMatch) {
                        activeQuestionElement = pMatch;
                        pMatch.classList.add('active-input');
                        scrollIntoViewIfNeeded(pMatch);
                        console.log(`✅ Found paragraph matching question:`, pMatch);
                    } else {
                        console.log(`❌ No target element found for question ${questionNumber}`);
                    }
                }
            }

            updateNavigation();
            console.log(`✅ goToQuestion completed for question ${questionNumber}`);
        }
        
        // --- UI & NAVIGATION ---

        function updateNavigation() {
            console.log(`🔄 updateNavigation called for currentQuestion: ${currentQuestion}`);
            
            const navButtons = document.querySelectorAll('.subQuestion');
            navButtons.forEach(btn => btn.classList.remove('active'));
            const activeNav = document.querySelector(`.subQuestion[onclick="goToQuestion(${currentQuestion})"]`);
            if (activeNav) {
                activeNav.classList.add('active');
                console.log(`✅ Updated navigation - active nav button:`, activeNav);
            } else {
                console.log(`⚠️ No active navigation button found for question ${currentQuestion}`);
            }

            // Update mobile question picker buttons if present
            const qpButtons = document.querySelectorAll('.qp-btn');
            qpButtons.forEach(btn => btn.classList.remove('active'));
            const activeQp = document.querySelector(`.qp-btn[data-q="${currentQuestion}"]`);
            if (activeQp) activeQp.classList.add('active');

            const inputs = document.querySelectorAll('.answer-input, .drop-zone.filled, .summary-drop-zone.filled');
            inputs.forEach(input => input.classList.remove('active-input'));
            
            const activeInput = document.getElementById(`q${currentQuestion}`);
            if (activeInput) {
                activeInput.classList.add('active-input');
                if (typeof activeInput.focus === 'function') {
                    activeInput.focus();
                }
                console.log(`✅ Focused on input element:`, activeInput);
            } else {
                console.log(`⚠️ No direct input found for question ${currentQuestion}, looking in question block`);
                // Prefer the specific question element for styling (TF/MCQ), fallback to any data-q-start container
                let activeQuestionBlock = document.querySelector(`.tf-question[data-q-start="${currentQuestion}"]`) 
                    || document.querySelector(`.multi-choice-question[data-q-start="${currentQuestion}"]`) 
                    || document.querySelector(`[data-q-start="${currentQuestion}"]`);
                if (activeQuestionBlock) {
                    // Add active-question class to style number badge
                    activeQuestionBlock.classList.add('active-question');
                    const firstInput = activeQuestionBlock.querySelector('input, select');
                    if(firstInput) {
                        firstInput.classList.add('active-input');
                         if (typeof firstInput.focus === 'function') {
                            firstInput.focus();
                        }
                        console.log(`✅ Focused on input in question block:`, firstInput);
                    } else {
                        console.log(`⚠️ No input found in question block for question ${currentQuestion}`);
                    }
                } else {
                    console.log(`❌ No question block found for question ${currentQuestion}`);
                }
            }
            
            console.log(`✅ updateNavigation completed`);
        }
        
        function selectDragItem(item) {
            if (selectedDragItem) {
                selectedDragItem.classList.remove('selected');
            }
            selectedDragItem = item;
            if (selectedDragItem) {
                selectedDragItem.classList.add('selected');
            }
        }
        
        window.nextQuestion = () => currentQuestion < 40 && goToQuestion(currentQuestion + 1);
        window.previousQuestion = () => currentQuestion > 1 && goToQuestion(currentQuestion - 1);

        function updateAllIndicators() {
            updateAttemptedCount(1, 1, 13);
            updateAttemptedCount(2, 14, 26);
            updateAttemptedCount(3, 27, 40);
            updateAnsweredNav();
        }
        
        function updateAnsweredNav() {
            const navButtons = document.querySelectorAll('.subQuestion');
            navButtons.forEach(btn => {
                const qNum = parseInt(btn.textContent, 10);
                if (isQuestionAnswered(qNum)) {
                    btn.classList.add('answered');
                } else {
                    btn.classList.remove('answered');
                }
            });

            // Mirror state to mobile quick picker if any
            const qpButtons = document.querySelectorAll('.qp-btn');
            qpButtons.forEach(btn => {
                const q = parseInt(btn.dataset.q, 10);
                btn.classList.toggle('answered', isQuestionAnswered(q));
            });
        }
        
        function isQuestionAnswered(qNum) {
            const textInput = document.getElementById(`q${qNum}`);
            if (textInput && (textInput.value.trim() !== '' || (textInput.classList.contains('drop-zone') && textInput.children.length > 0))) {
                return true;
            }
            const radio = document.querySelector(`input[name="q${qNum}"]:checked`);
            if (radio) {
                return true;
            }
            const checkbox = document.querySelector(`input[name="q${qNum}"]:checked`);
            if (checkbox) {
                return true;
            }
            // Handle drag & drop questions (e.g., 20-23)
            const dz = document.querySelector(`.drop-zone[data-q-start="${qNum}"]`);
            if (dz && dz.querySelector('.drag-item')) {
                return true;
            }
            // Handle clickable-cell matrix questions (any question using clickable cells)
                const selectedCell = document.querySelector(`.clickable-cell[data-question="${qNum}"][data-selected="true"]`);
                if (selectedCell) {
                    return true;
            }
            return false;
        }

        function scrollIntoViewIfNeeded(element) {
            const panel = element.closest('.questions-panel, .passage-panel');
            const panelRect = panel.getBoundingClientRect();
            const elementRect = element.getBoundingClientRect();
            if (elementRect.top < panelRect.top || elementRect.bottom > panelRect.bottom) {
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        // --- DRAG AND DROP ---
        
        function initializeDragAndDrop() {
            document.querySelectorAll('.drag-item').forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                item.addEventListener('click', () => selectDragItem(item));
            });
            document.querySelectorAll('.drop-zone, .drag-options-container').forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
            });

            // Mobile/touch fallback: tap-to-place selected item into drop-zone
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.addEventListener('click', () => {
                    if (!selectedDragItem) return;
                    const targetZone = zone;
                    const sourceZone = selectedDragItem.parentElement;
                    if (targetZone === sourceZone) return;

                    const existingItemInTarget = targetZone.querySelector('.drag-item');

                    // Clear placeholder text nodes in target
                    Array.from(targetZone.childNodes).forEach(node => {
                        if (node.nodeType === Node.TEXT_NODE) node.remove();
                    });

                    // If target already has an item, move it back to source
                    if (existingItemInTarget) {
                        sourceZone.appendChild(existingItemInTarget);
                    }

                    // Move selected item to target
                    targetZone.appendChild(selectedDragItem);
                    targetZone.classList.add('filled');
                    selectedDragItem.style.cursor = 'default';

                    // Clean up source zone if it was a drop-zone and now empty
                    if (sourceZone.classList.contains('drop-zone') && !sourceZone.querySelector('.drag-item')) {
                        sourceZone.classList.remove('filled');
                        const qNum = sourceZone.dataset.qStart;
                        if (qNum) sourceZone.innerText = qNum;
                    }

                    updateAllIndicators();
                });
            });
        }

        function handleDragStart(e) {
            draggedItem = e.target;
            setTimeout(() => e.target.classList.add('dragging'), 0);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedItem = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            const targetZone = e.currentTarget;
            if (draggedItem && draggedItem.dataset.dndGroup === targetZone.dataset.dndGroup) {
                targetZone.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const targetZone = e.currentTarget;
            targetZone.classList.remove('drag-over');

            if (!draggedItem || draggedItem.dataset.dndGroup !== targetZone.dataset.dndGroup) {
                return;
            }

            const sourceZone = draggedItem.parentElement;
            if (sourceZone === targetZone) return; // Prevent dropping on itself

            const existingItemInTarget = targetZone.classList.contains('drop-zone') 
                ? targetZone.querySelector('.drag-item') 
                : null;

            // First, clear the target drop-zone of any text (like question numbers) before adding the new item.
            if (targetZone.classList.contains('drop-zone')) {
                Array.from(targetZone.childNodes).forEach(node => {
                    if (node.nodeType === Node.TEXT_NODE) {
                        node.remove();
                    }
                });
            }

            // Move the item that was in the target (if any) to the source zone.
            if (existingItemInTarget) {
                sourceZone.appendChild(existingItemInTarget);
            }
            
            // Finally, move the dragged item to the target zone.
            targetZone.appendChild(draggedItem);
            targetZone.classList.add('filled');
            // Lock the pill-like appearance for items dropped into zones
            if (draggedItem) {
                draggedItem.style.cursor = 'default';
            }
            // Hide placeholder text (question number) once filled
            if (targetZone.textContent && /^\d+$/.test(targetZone.textContent.trim())) {
                targetZone.textContent = '';
            }

            // After the move, clean up the source zone if it's a drop-zone and is now empty.
            if (sourceZone.classList.contains('drop-zone') && !sourceZone.querySelector('.drag-item')) {
                 sourceZone.classList.remove('filled');
                 const qNum = sourceZone.dataset.qStart;
                 sourceZone.innerText = qNum; // Restore the question number
            }
            
            updateAllIndicators();
        }
        
        // --- MISC HELPERS ---
        
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval); // Ensure no multiple intervals
            timerInterval = setInterval(() => {
                timeInSeconds--;
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                if (timeInSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "Time's up!";
                    // checkAnswers(); // Disabled to prevent modal from opening automatically.
                }
            }, 1000);
            timerToggleButton.innerHTML = pauseIcon;
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            timerToggleButton.innerHTML = playIcon;
        }

        function toggleTimer() {
            // Check based on the icon currently displayed
            if (timerToggleButton.innerHTML.includes('M6 19h4V5H6v14z')) { // Check for pause icon shape
                pauseTimer();
            } else {
                startTimer();
            }
        }

        function resetTimer() {
            timeInSeconds = 3600;
            const minutes = Math.floor(timeInSeconds / 60);
            const seconds = timeInSeconds % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            startTimer();
            timerToggleButton.innerHTML = pauseIcon;
        }
        
        function setupCheckboxLimits() {
            const checkboxGroups = [
                { name: 'q38-40', limit: 3 }
            ];
            checkboxGroups.forEach(group => {
                const checkboxes = document.querySelectorAll(`input[name="${group.name}"]`);
                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        const checkedCount = document.querySelectorAll(`input[name="${group.name}"]:checked`).length;
                        if (checkedCount > group.limit) checkbox.checked = false;
                        updateAllIndicators();
                    });
                });
            });
        }

        function setupExampleHeading() {
            const exampleBox = document.querySelector('.example-box');
            if(exampleBox){
                const title = document.createElement('p');
                title.style.fontWeight = 'bold';
                title.textContent = 'List of Statements';
                // exampleBox.insertBefore(title, exampleBox.firstChild);
            }
        }
        
        function initResize(e) {
            e.preventDefault();
            const startX = e.clientX;
            const startWidth = passagePanel.offsetWidth;
            
            const doDrag = (e) => {
                const newWidth = startWidth + e.clientX - startX;
                if (newWidth > 200 && (document.body.clientWidth - newWidth - resizer.offsetWidth) > 200) {
                    passagePanel.style.flex = `0 0 ${newWidth}px`;
                }
            };
            const stopDrag = () => {
                window.removeEventListener('mousemove', doDrag, false);
                window.removeEventListener('mouseup', stopDrag, false);
            };
            
            window.addEventListener('mousemove', doDrag, false);
            window.addEventListener('mouseup', stopDrag, false);
        }
        
        // --- CONTEXT MENU (Highlighting) ---
        
        function initializeContextMenu() {
            const panels = [passagePanel, questionsPanel];
            let targetElementForClear = null;

            // This listener simply tracks the last valid text selection in either panel.
            document.addEventListener('selectionchange', () => {
                const selection = window.getSelection();
                if (selection && !selection.isCollapsed && selection.toString().trim().length > 0) {
                    const range = selection.getRangeAt(0);
                    if (panels.some(panel => panel.contains(range.commonAncestorContainer))) {
                        selectedRange = range;
                        targetElementForClear = null; // New selection overrides clearing a specific element
                    }
                }
            });

            const showContextMenu = (e) => {
                const target = e.target;
                const isClickOnHighlight = target.closest('.highlight, .comment-highlight');
                const isSelectionActive = selectedRange && selectedRange.toString().trim().length > 0;
                
                let showMenu = false;

                if (isClickOnHighlight) {
                    document.getElementById('menu-highlight').style.display = 'none';
                    document.getElementById('menu-note').style.display = 'none';
                    document.getElementById('menu-clear').style.display = 'block';
                    document.getElementById('menu-clear-all').style.display = 'block';
                    contextMenu.targetElementForClear = isClickOnHighlight;
                    showMenu = true;
                } else if (isSelectionActive && panels.some(panel => panel.contains(selectedRange.commonAncestorContainer))) {
                    document.getElementById('menu-highlight').style.display = 'flex';
                    document.getElementById('menu-note').style.display = 'flex';
                    document.getElementById('menu-clear').style.display = 'none';
                    document.getElementById('menu-clear-all').style.display = 'block'; // Always show clear all
                    showMenu = true;
                }

                if (showMenu) {
                    e.preventDefault();
                    contextMenu.style.display = 'block';
                    const menuHeight = contextMenu.offsetHeight;
                    const menuWidth = contextMenu.offsetWidth;
                    let left = e.pageX;
                    let top = e.pageY;
                    if (left + menuWidth > window.innerWidth) left = window.innerWidth - menuWidth - 5;
                    if (top + menuHeight > window.innerHeight) top = e.pageY - menuHeight - 5;
                    else top = e.pageY - menuHeight - 5;
                    
                    contextMenu.style.left = `${left}px`;
                    contextMenu.style.top = `${top}px`;
                }
            };

            panels.forEach(panel => {
                panel.addEventListener('contextmenu', showContextMenu);
            });

            document.addEventListener('click', (e) => {
                if (contextMenu.style.display === 'block' && !contextMenu.contains(e.target)) {
                    closeContextMenu();
                }
            });
        }

        function closeContextMenu() {
            contextMenu.style.display = 'none';
            selectedRange = null; // Clear range after menu closes
        }

        function unwrapElement(element) {
            const parent = element.parentNode;
            if (!parent) return;
            while (element.firstChild) {
                parent.insertBefore(element.firstChild, element);
            }
            parent.removeChild(element);
            parent.normalize();
        }

        window.highlightText = () => {
            if (selectedRange && !selectedRange.collapsed) {
                const span = document.createElement('span');
                span.className = 'highlight';
                span.appendChild(selectedRange.extractContents());
                selectedRange.insertNode(span);
            }
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        window.addNote = () => {
            const note = prompt('Enter your note:');
            if (note && selectedRange && !selectedRange.collapsed) {
                const span = document.createElement('span');
                span.className = 'comment-highlight';
                const tooltip = document.createElement('span');
                tooltip.className = 'comment-tooltip';
                tooltip.textContent = note;
                span.appendChild(selectedRange.extractContents());
                span.appendChild(tooltip);
                selectedRange.insertNode(span);
            }
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        window.clearHighlight = () => {
             const elementToClear = contextMenu.targetElementForClear;
             if (elementToClear) {
                 unwrapElement(elementToClear);
             }
             closeContextMenu();
             window.getSelection().removeAllRanges();
        };
        
        window.clearAllHighlights = () => {
            document.querySelectorAll('.highlight, .comment-highlight').forEach(unwrapElement);
            closeContextMenu();
            window.getSelection().removeAllRanges();
        };

        function updateAttemptedCount(part, startQ, endQ) {
            let answeredCount = 0;
            for (let i = startQ; i <= endQ; i++) {
                if (isQuestionAnswered(i)) {
                    answeredCount++;
                }
            }
            const partHeader = document.querySelector(`.footer__questionNo___3WNct[onclick="switchToPart(${part})"]`);
            if (partHeader) {
                const countSpan = partHeader.querySelector('.attemptedCount');
                if (countSpan) {
                     countSpan.textContent = `${answeredCount} of ${endQ - startQ + 1}`;
                }
            }
        }

        // --- GLOBAL FUNCTION EXPOSURE ---
        window.nextQuestion = nextQuestion;
        window.previousQuestion = previousQuestion;
        window.goToQuestion = goToQuestion;
        window.switchToPart = switchToPart;
        window.closeResultsModal = closeResultsModal;
        window.highlightText = highlightText;
        window.addNote = addNote;
        window.clearHighlight = clearHighlight;
        window.clearAllHighlights = clearAllHighlights;
        
        // Explanation toggle function for Part 2
        window.toggleExplanation = function() {
            const explanationSection = document.getElementById('part-2-explanation');
            const button = document.getElementById('show-explanation-btn');
            
            if (explanationSection.classList.contains('hidden')) {
                explanationSection.classList.remove('hidden');
                button.textContent = 'Hide Explanation';
                button.style.backgroundColor = '#dc3545';
            } else {
                explanationSection.classList.add('hidden');
                button.textContent = 'Show Explanation';
                button.style.backgroundColor = '#4a90e2';
            }
        };
        
        // Explanation toggle function for Part 3
        window.toggleExplanationPart3 = function() {
            const explanationSection = document.getElementById('part-3-explanation');
            const button = document.getElementById('show-explanation-btn-part3');
            
            if (explanationSection.classList.contains('hidden')) {
                explanationSection.classList.remove('hidden');
                button.textContent = 'Hide Explanation';
                button.style.backgroundColor = '#dc3545';
            } else {
                explanationSection.classList.add('hidden');
                button.textContent = 'Show Explanation';
                button.style.backgroundColor = '#4a90e2';
            }
        };

        // --- START THE APP ---
        initialize();

        // Add event listeners for table radio buttons
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-hide scrollbar logic: show while scrolling or hovering
            const autoHideContainers = [
                document.getElementById('passage-panel'),
                document.getElementById('questions-panel'),
                document.querySelector('.results-details-container')
            ].filter(Boolean);

            autoHideContainers.forEach(container => {
                let hideTimeoutId;
                const showScrollbars = () => {
                    container.classList.add('scrollbar-visible');
                    container.classList.remove('scrollbar-hidden');
                    clearTimeout(hideTimeoutId);
                    hideTimeoutId = setTimeout(() => {
                        container.classList.remove('scrollbar-visible');
                        container.classList.add('scrollbar-hidden');
                    }, 800);
                };
                container.addEventListener('scroll', showScrollbars, { passive: true });
                container.addEventListener('mouseenter', showScrollbars);
                container.addEventListener('mouseleave', () => {
                    clearTimeout(hideTimeoutId);
                    container.classList.remove('scrollbar-visible');
                    container.classList.add('scrollbar-hidden');
                });
                // Initialize hidden state
                container.classList.add('scrollbar-hidden');
            });
            const tableRadios = document.querySelectorAll('.table-radio');
            tableRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Remove background color from all cells in the same row
                    const row = this.closest('tr');
                    const cells = row.querySelectorAll('td:not(.statement)');
                    cells.forEach(cell => {
                        cell.style.backgroundColor = '';
                    });
                    
                    // Add background color to the selected cell
                    if (this.checked) {
                        this.closest('td').style.backgroundColor = '#e3f2fd';
                    }
                    
                    updateAllIndicators();
                });
            });
            

        });

        // Global function for selecting cells
        window.selectCell = function(cell, questionNum, value) {
            console.log('selectCell called:', questionNum, value);
            
            // Remove selected class from all cells in the same row
            const row = cell.closest('tr');
            const cellsInRow = row.querySelectorAll('.clickable-cell');
            cellsInRow.forEach(c => {
                c.classList.remove('selected');
                c.removeAttribute('data-selected');
                c.removeAttribute('data-answer');
            });
            
            // Add selected class to clicked cell
            cell.classList.add('selected');
            cell.setAttribute('data-selected', 'true');
            cell.setAttribute('data-answer', value);
            
            console.log('Cell selected:', questionNum, value);
            updateAllIndicators();
        };



        // Note: switchToPart function is defined earlier in the code
        // This duplicate function has been removed to prevent conflicts
    });
    </script>
</body>
</html>